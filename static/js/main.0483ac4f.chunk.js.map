{"version":3,"sources":["infrastructure/functions.js","infrastructure/widgets.js","infrastructure/const.js","infrastructure/appicon/hole.png","infrastructure/appicon/imasugu.png","infrastructure/appicon/imasugu_rev.png","infrastructure/appicon/syllabus.png","infrastructure/appicon/score.png","infrastructure/appicon/course_survey.png","infrastructure/appicon/dropdown.png","infrastructure/appicon/dropdown_rev.png","infrastructure/appicon/homepage.png","color_picker.js","text_splitter.js","cache.js","flows_api.js","Common.js","react-lazyload/src/utils/event.js","react-lazyload/src/utils/scrollParent.js","react-lazyload/src/index.jsx","react-lazyload/src/utils/debounce.js","react-lazyload/src/utils/throttle.js","AudioWidget.js","Message.js","Config.js","UserAction.js","Flows.js","Title.js","Sidebar.js","PressureHelper.js","App.js","registerServiceWorker.js","index.js"],"names":["get_json","res","ok","Error","status","statusText","text","then","t","JSON","parse","e","console","error","trace","log","SyntaxError","substr","listen_darkmode","override","update_color_scheme","undefined","window","matchMedia","matches","document","body","classList","add","remove","addListener","API_VERSION_PARAM","encodeURIComponent","process","REACT_APP_BUILD_INFO","Math","floor","Date","LOGIN_POPUP_ANCHOR_ID","pad2","x","format_time","time","getMonth","getDate","getHours","getMinutes","getSeconds","chinese_format","buildFormatter","chineseStrings","Time","props","stamp","date","formatter","title","toLocaleString","timeZone","hour12","TitleLine","className","GlobalTitle","FALLBACK_APPS","bar","appicon_hole","appicon_imasugu","appicon_imasugu_rev","appicon_syllabus","appicon_score","dropdown","appicon_course_survey","appicon_homepage","fix","SWITCHER_DATA_VER","SWITCHER_DATA_URL","PKUHELPER_ROOT","AppSwitcher","state","apps","get_apps_from_localstorage","ret","localStorage","content","this","appid","setTimeout","HOTFIX_CONTEXT","build_info","build_env","eval","check_fix","fetch","txt","setState","catch","prevProps","prevState","cur_id","app_elem","id","url","icon_normal","icon_hover","new_tab","no_class","ref","key","href","target","src","dropdown_cur_app","forEach","app","map","length","appicon_dropdown","appicon_dropdown_rev","React","createRef","onClick","closest","current","click","Component","LoginPopupSelf","loading_status","excluded_scopes","username_ref","password_ref","input_token_ref","popup_anchor","getElementById","createElement","appendChild","type","value","method","headers","stringify","json","success","alert","msg","set_token","code","user_token","name","on_close","token","result","ReactDOM","createPortal","perm_alert","bind","scope","checked","indexOf","onChange","chk","exc","slice","pos","splice","push","autoFocus","do_sendcode","disabled","do_login","token_callback","placeholder","do_input_token","LoginPopup","popup_show","on_popup_bound","on_popup","on_close_bound","children","module","exports","ColorPicker","names","current_h","random","toLowerCase","PID_RE","URL_PID_RE","NICKNAME_RE","URL_RE","split_text","rules","rule","regex","concat","apply","part","split","seg","test","filter","HOLE_CACHE_DB_NAME","CACHE_DB_VER","Cache","db","added_items_since_maintenance","encrypt","decrypt","open_req","indexedDB","open","onerror","onupgradeneeded","event","createObjectStore","keyPath","createIndex","unique","onsuccess","maintenance","pid","data","s","o","i","new_key","charCodeAt","String","fromCharCode","c","target_version","parseInt","Promise","resolve","reject","store","transaction","objectStore","get_req","get","data_str","version","last_access","put","delete","warn","req","count_req","count","index","openKeyCursor","cur","primaryKey","continue","deleteDatabase","cache","hole_cache","token_param","handle_response","response","a","notify","parse_replies","replies","color_picker","sort","b","cid","info","_display_color","variant","API","load_replies","cache_version","API_BASE","load_replies_with_cache","cached","set_attention","attention","URLSearchParams","append","report","reason","get_list","page","get_search","keyword","get_single","get_attention","escape_regex","string","replace","build_highlight_re","option","RegExp","join","ColoredSpan","style","colors","HighlightedText","parts","idx","p","rel","preventDefault","show_pid","PureComponent","TEXTAREA_BACKUP","SafeTextarea","on_change_bound","on_change","on_keydown_bound","on_keydown","clear","area_ref","change_callback","submit_callback","on_submit","ctrlKey","altKey","focus","onKeyDown","pwa_prompt_event","PromotionBar","is_ios","navigator","userAgent","standalone","prompt","addEventListener","ClickHandler","moved","init_y","init_x","on_begin_bound","on_begin","on_move_bound","on_move","on_end_bound","on_end","MOVE_THRESHOLD","last_fire","touches","screenY","screenX","abs","do_callback","callback","onTouchStart","onMouseDown","onTouchMove","onMouseMove","on","el","eventName","opts","attachEvent","call","off","removeEventListener","detachEvent","node","HTMLElement","documentElement","excludeStaticParent","position","overflowRegex","parent","parentNode","ownerDocument","getComputedStyle","overflow","overflowX","overflowY","defaultBoundingClientRect","LISTEN_FLAG","listeners","pending","passiveEventSupported","Object","defineProperty","delayType","passiveEvent","capture","passive","checkVisible","component","ReactDom","findDOMNode","scrollParent","parentTop","parentHeight","getBoundingClientRect","top","height","windowInnerHeight","innerHeight","clientHeight","intersectionTop","max","intersectionHeight","min","offsetTop","offsets","Array","isArray","offset","checkOverflowVisible","elementHeight","offsetWidth","offsetHeight","getClientRects","checkNormalVisible","visible","hidden","once","unmountIfInvisible","hiddenIfInvisible","lazyLoadHandler","listener","finalLazyLoadHandler","LazyLoad","scrollport","scrollContainer","querySelector","needResetFinalLazyLoadHandler","debounce","func","wait","immediate","timeout","args","context","timestamp","later","last","arguments","callNow","throttle","fn","threshhold","deferTimer","now","clearTimeout","getAttribute","listenerCount","setAttribute","scroll","resize","removeAttribute","visibility","defaultProps","audio_cache","AudioWidget","all","AMR","load","err","blob","reader","FileReader","onload","raw","decode","wave","PCMData","encode","sampleRate","channelCount","bytesPerSample","binary_wave","Uint8Array","objurl","URL","createObjectURL","Blob","readAsBinaryString","controls","MessageViewer","BUILTIN_IMGS","DEFAULT_CONFIG","background_img","background_color","pressure","easter_egg","color_scheme","block_words","load_config","loaded_config","config","assign","keys","save_config","bgimg_style","img","color","background","backgroundImage","encodeURI","backgroundColor","backgroundSize","ConfigBackground","save_changes","img_select","on_select","on_change_img","on_change_color","ConfigColorScheme","ConfigBlockWords","v","ConfigSwitch","switch","val","description","ConfigUI","save_changes_bound","chg","confirm","location","reload","reset_settings","MAX_IMG_DIAM","MAX_IMG_PX","MAX_IMG_FILESIZE","TokenCtx","createContext","set_value","LifeInfoBox","_life_info_cache","CACHE_TIMEOUT_S","today_info","cache_get","card_balance","net_balance","mail_count","INTERNAL_NETWORK_FAILURE","API_NAME","cache_item","state_key","errMsg","errCode","k","value_fn","action","url_fn","cache_set","details","reload_all","render_line","schedule_url","balance","toFixed","InfoSidebar","show_sidebar","serviceWorker","getRegistrations","registrations","registration","unregister","ResetUsertokenWidget","uid","do_reset","LoginForm","copy","Consumer","copy_token","do_popup","ReplyForm","global_keypress_handler_bound","global_keypress_handler","tagName","on_complete","onSubmit","PostForm","img_tip","img_ref","on_img_change_bound","on_img_change","file","return_url","fixOrientation","fixed_dataurl","image","Image","width","compressed","rate","sqrt","canvas","ctx","getContext","drawImage","quality","new_url","quality_l","quality_r","toDataURL","round","on_got_img","readAsDataURL","files","proc_img","d","do_post","accept","IMAGE_BASE","AUDIO_BASE","CLICKABLE_TAGS","audio","QUOTE_BLACKLIST","LATEST_POST_ID","load_single_meta","title_elem","single","reply","deletion_detect","Reply","do_filter_name","tag","FlowItem","likenum","r","is_quote","copy_link","img_clickable","latest_reply","FlowSidebar","error_msg","filter_name","rev","syncState","sync_state","reply_ref","prev","update_count","set_variant","next_attention","should_text","set","replies_to_show","reverse","view_mode_key","replies_cnt","main_thread_elem","show_reply_bar","set_filter_name","toggle_rev","toggle_attention","float","FlowItemRow","reply_status","reply_error","some","word","includes","attention_override","hl_rules","search_param","quote_id","mode","reveal","FlowItemQuote","FlowChunk","list","ind","Flow","search_text","loaded_pages","chunks","on_scroll_bound","on_scroll","failed","max_id","finished","scrollHeight","scrollY","load_page","should_deletion_detect","flag_re","ControlBar","set_mode","on_keypress_bound","on_keypress","do_refresh_bound","do_refresh","do_attention_bound","do_attention","hash","decodeURIComponent","lastIndexOf","flag_res","exec","startsWith","scrollTo","onKeyPress","Title","Sidebar","do_close_bound","do_close","do_back_bound","do_back","contents","stack","cur_title","onTouchEnd","PressureHelper","level","fired","esc_interval","clearInterval","Pressure","change","force","do_fire","end","polyfill","only","preventSelect","repeat","THRESHOLD","setInterval","new_level","pad","left","right","bottom","DeprecatedAlert","display","App","default","light","dark","sidebar_stack","flow_render_key","show_sidebar_bound","set_mode_bound","on_pressure_bound","on_pressure","inpku_flag","atob","ns","pop","Provider","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","register","onupdatefound","installingWorker","installing","onstatechange","controller","render","origin","ready","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.0483ac4f.chunk.js","sourcesContent":["export function get_json(res) {\n    if(!res.ok) throw Error(`网络错误 ${res.status} ${res.statusText}`);\n    return (\n        res\n            .text()\n            .then((t)=>{\n                try {\n                    return JSON.parse(t);\n                } catch(e) {\n                    console.error('json parse error');\n                    console.trace(e);\n                    console.log(t);\n                    throw new SyntaxError('JSON Parse Error '+t.substr(0,50));\n                }\n            })\n    );\n}\n\nexport function listen_darkmode(override) { // override: true/false/undefined\n    function update_color_scheme() {\n        if(override===undefined ? window.matchMedia('(prefers-color-scheme: dark)').matches : override)\n            document.body.classList.add('root-dark-mode');\n        else\n            document.body.classList.remove('root-dark-mode');\n    }\n\n    update_color_scheme();\n    window.matchMedia('(prefers-color-scheme: dark)').addListener(()=>{\n        update_color_scheme();\n    });\n}\n\nexport function API_VERSION_PARAM() {\n    return '&PKUHelperAPI=3.0&jsapiver='+encodeURIComponent((process.env.REACT_APP_BUILD_INFO||'null')+'-'+(Math.floor(+new Date()/7200000)*2));\n}","import React, {Component, PureComponent} from 'react';\nimport ReactDOM from 'react-dom';\n\nimport TimeAgo from 'react-timeago';\nimport chineseStrings from 'react-timeago/lib/language-strings/zh-CN';\nimport buildFormatter from 'react-timeago/lib/formatters/buildFormatter';\n\nimport './global.css';\nimport './widgets.css';\n\nimport appicon_hole from './appicon/hole.png';\nimport appicon_imasugu from './appicon/imasugu.png';\nimport appicon_imasugu_rev from './appicon/imasugu_rev.png';\nimport appicon_syllabus from './appicon/syllabus.png';\nimport appicon_score from './appicon/score.png';\nimport appicon_course_survey from './appicon/course_survey.png';\nimport appicon_dropdown from './appicon/dropdown.png';\nimport appicon_dropdown_rev from './appicon/dropdown_rev.png';\nimport appicon_homepage from './appicon/homepage.png';\nimport {PKUHELPER_ROOT} from './const';\nimport {get_json, API_VERSION_PARAM} from './functions';\n\nconst LOGIN_POPUP_ANCHOR_ID='pkuhelper_login_popup_anchor';\n\nfunction pad2(x) {\n    return x<10 ? '0'+x : ''+x;\n}\nexport function format_time(time) {\n    return `${time.getMonth()+1}-${pad2(time.getDate())} ${time.getHours()}:${pad2(time.getMinutes())}:${pad2(time.getSeconds())}`;\n}\nconst chinese_format=buildFormatter(chineseStrings);\nexport function Time(props) {\n    const time=new Date(props.stamp*1000);\n    return (\n        <span>\n            <TimeAgo date={time} formatter={chinese_format} title={time.toLocaleString('zh-CN', {\n                timeZone: 'Asia/Shanghai',\n                hour12: false,\n            })} />\n            &nbsp;\n            {format_time(time)}\n        </span>\n    );\n}\n\nexport function TitleLine(props) {\n    return (\n        <p className=\"centered-line title-line aux-margin\">\n            <span className=\"black-outline\">{props.text}</span>\n        </p>\n    )\n}\n\nexport function GlobalTitle(props) {\n    return (\n        <div className=\"aux-margin\">\n            <div className=\"title\">\n                <p className=\"centered-line\">{props.text}</p>\n            </div>\n        </div>\n    );\n}\n\nconst FALLBACK_APPS={\n    // id, text, url, icon_normal, icon_hover, new_tab\n    bar: [\n        ['hole', '树洞', '/hole', appicon_hole, null, false],\n        ['imasugu', '教室', '/spare_classroom', appicon_imasugu, appicon_imasugu_rev, false],\n        ['syllabus', '课表', '/syllabus', appicon_syllabus, null, false],\n        ['score', '成绩', '/my_score', appicon_score, null, false],\n    ],\n    dropdown: [\n        ['course_survey', '课程测评', 'https://courses.pinzhixiaoyuan.com/', appicon_course_survey, null, true],\n        ['homepage', '客户端', '/', appicon_homepage, null, true],\n    ],\n    fix: {},\n};\nconst SWITCHER_DATA_VER='switcher_2';\nconst SWITCHER_DATA_URL=PKUHELPER_ROOT+'web_static/appswitcher_items.json';\n\nexport class AppSwitcher extends Component {\n    constructor(props) {\n        super(props);\n        this.state={\n            apps: this.get_apps_from_localstorage(),\n        }\n    }\n\n    get_apps_from_localstorage() {\n        let ret=FALLBACK_APPS;\n        if(localStorage['APPSWITCHER_ITEMS'])\n            try {\n                let content=JSON.parse(localStorage['APPSWITCHER_ITEMS'])[SWITCHER_DATA_VER];\n                if(!content || !content.bar)\n                    throw new Error('content is empty');\n\n                ret=content;\n            } catch(e) {\n                console.error('load appswitcher items from localstorage failed');\n                console.trace(e);\n            }\n\n        return ret;\n    }\n\n    check_fix() {\n        if(this.state.apps && this.state.apps.fix && this.state.apps.fix[this.props.appid])\n            setTimeout(()=>{\n                window.HOTFIX_CONTEXT={\n                    build_info: process.env.REACT_APP_BUILD_INFO || '---',\n                    build_env: process.env.NODE_ENV,\n                };\n                eval(this.state.apps.fix[this.props.appid]);\n            },1); // make it async so failures won't be critical\n    }\n\n    componentDidMount() {\n        this.check_fix();\n        setTimeout(()=>{\n            fetch(SWITCHER_DATA_URL)\n                .then((res)=>{\n                    if(!res.ok) throw Error(`网络错误 ${res.status} ${res.statusText}`);\n                    return res.text();\n                })\n                .then((txt)=>{\n                    if(txt!==localStorage['APPSWITCHER_ITEMS']) {\n                        console.log('loaded new appswitcher items',txt);\n                        localStorage['APPSWITCHER_ITEMS']=txt;\n\n                        this.setState({\n                            apps: this.get_apps_from_localstorage(),\n                        });\n                    } else {\n                        console.log('appswitcher items unchanged');\n                    }\n                })\n                .catch((e)=>{\n                    console.error('loading appswitcher items failed');\n                    console.trace(e);\n                });\n        },500);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if(this.state.apps!==prevState.apps)\n            this.check_fix();\n    }\n\n    render() {\n        let cur_id=this.props.appid;\n\n        function app_elem([id,title,url,icon_normal,icon_hover,new_tab],no_class=false,ref=null) {\n            return (\n                <a ref={ref} key={id} className={no_class ? null : ('app-switcher-item'+(id===cur_id ? ' app-switcher-item-current' : ''))}\n                   href={url} target={new_tab ? '_blank' : '_self'}>\n                    {!!icon_normal && [\n                        <img key=\"normal\" src={icon_normal} className=\"app-switcher-logo-normal\" />,\n                        <img key=\"hover\" src={icon_hover||icon_normal} className=\"app-switcher-logo-hover\" />\n                    ]}\n                    <span>{title}</span>\n                </a>\n            );\n        }\n\n        let dropdown_cur_app=null;\n        this.state.apps.dropdown.forEach((app)=>{\n            if(app[0]===cur_id)\n                dropdown_cur_app=app;\n        });\n\n        //console.log(JSON.stringify(this.state.apps));\n\n        return (\n            <div className=\"app-switcher\">\n                <span className=\"app-switcher-desc app-switcher-left\">PKUHelper</span>\n                {this.state.apps.bar.map((app)=>\n                    app_elem(app)\n                )}\n                {!!this.state.apps.dropdown.length &&\n                    <div className={\n                        'app-switcher-item app-switcher-dropdown '\n                        +(dropdown_cur_app ? ' app-switcher-item-current' : '')\n                    }>\n                        <p className=\"app-switcher-dropdown-title\">\n                            {!!dropdown_cur_app ?\n                                app_elem((()=>{\n                                    let [id,title,_url,icon_normal,icon_hover,_new_tab]=dropdown_cur_app;\n                                    return [id,title+'▾',null,icon_normal,icon_hover,false];\n                                })(),true) :\n                                app_elem(['-placeholder-elem','更多▾',null,appicon_dropdown,appicon_dropdown_rev,false],true)\n                            }\n                        </p>\n                        {this.state.apps.dropdown.map((app)=>{\n                            let ref=React.createRef();\n                            return (\n                                <p key={app[0]} className=\"app-switcher-dropdown-item\" onClick={(e)=>{\n                                    if(!e.target.closest('a') && ref.current)\n                                        ref.current.click();\n                                }}>\n                                    {app_elem(app,true,ref)}\n                                </p>\n                            );\n                        })}\n                    </div>\n                }\n                <span className=\"app-switcher-desc app-switcher-right\">网页版</span>\n            </div>\n        );\n    }\n}\n\nclass LoginPopupSelf extends Component {\n    constructor(props) {\n        super(props);\n        this.state={\n            loading_status: 'idle',\n            excluded_scopes: [],\n        };\n        this.username_ref=React.createRef();\n        this.password_ref=React.createRef();\n        this.input_token_ref=React.createRef();\n\n        this.popup_anchor=document.getElementById(LOGIN_POPUP_ANCHOR_ID);\n        if(!this.popup_anchor) {\n            this.popup_anchor=document.createElement('div');\n            this.popup_anchor.id=LOGIN_POPUP_ANCHOR_ID;\n            document.body.appendChild(this.popup_anchor);\n        }\n    }\n\n    do_sendcode(type) {\n        if(this.state.loading_status==='loading')\n            return;\n\n        this.setState({\n            loading_status: 'loading',\n        },()=>{\n            fetch(\n                PKUHELPER_ROOT+'api_xmcp/login/send_code'\n                +'?user='+encodeURIComponent(this.username_ref.current.value)\n                +'&code_type='+encodeURIComponent(type)\n                +API_VERSION_PARAM(), {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        excluded_scopes: this.state.excluded_scopes||[],\n                    }),\n                }\n            )\n                .then(get_json)\n                .then((json)=>{\n                    console.log(json);\n                    if(!json.success)\n                        throw new Error(JSON.stringify(json));\n\n                    alert(json.msg);\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                })\n                .catch((e)=>{\n                    console.error(e);\n                    alert('发送失败\\n'+e);\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                });\n\n        });\n    }\n\n    do_login(set_token) {\n        if(this.state.loading_status==='loading')\n            return;\n\n        this.setState({\n            loading_status: 'loading',\n        },()=>{\n            fetch(\n                PKUHELPER_ROOT+'api_xmcp/login/login'\n                +'?user='+encodeURIComponent(this.username_ref.current.value)\n                +'&valid_code='+encodeURIComponent(this.password_ref.current.value)\n                +API_VERSION_PARAM(), {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        excluded_scopes: this.state.excluded_scopes||[],\n                    }),\n                }\n            )\n                .then(get_json)\n                .then((json)=>{\n                    if(json.code!==0) {\n                        if(json.msg) throw new Error(json.msg);\n                        throw new Error(JSON.stringify(json));\n                    }\n\n                    set_token(json.user_token);\n                    alert(`成功以 ${json.name} 的身份登录`);\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                    this.props.on_close();\n                })\n                .catch((e)=>{\n                    console.error(e);\n                    alert('登录失败\\n'+e);\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                });\n        });\n    }\n\n    do_input_token(set_token) {\n        if(this.state.loading_status==='loading')\n            return;\n\n        let token=this.input_token_ref.current.value;\n        this.setState({\n            loading_status: 'loading',\n        },()=>{\n            fetch(PKUHELPER_ROOT+'api_xmcp/hole/system_msg?user_token='+encodeURIComponent(token)+API_VERSION_PARAM())\n                .then((res)=>res.json())\n                .then((json)=>{\n                    if(json.error)\n                        throw new Error(json.error);\n                    if(json.result.length===0)\n                        throw new Error('result check failed');\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                    set_token(token);\n                    this.props.on_close();\n                })\n                .catch((e)=>{\n                    alert('Token检验失败\\n'+e);\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                    console.error(e);\n                });\n        });\n    }\n\n    perm_alert() {\n        alert('如果你不需要 PKU Helper 的某项功能，可以取消相应权限。\\n其中【状态信息】包括你的网费、校园卡余额等。\\n该设置应用到你的【所有】设备，取消后如需再次启用相应功能需要重新登录。');\n    }\n\n    render() {\n        let PERM_SCOPES=[\n            ['score','成绩查询'],\n            ['syllabus','课表查询'],\n            ['my_info','状态信息'],\n        ];\n\n        return ReactDOM.createPortal(\n            <div>\n                <div className=\"pkuhelper-login-popup-shadow\" />\n                <div className=\"pkuhelper-login-popup\">\n                    <p>\n                        <b>接收验证码来登录 PKU Helper</b>\n                    </p>\n                    <p>\n                        授权功能<a onClick={this.perm_alert.bind(this)}>(?)</a>\n                        {PERM_SCOPES.map(([scope,title])=>(\n                            <label key={scope} className=\"perm-item\">\n                                <input type=\"checkbox\" checked={this.state.excluded_scopes.indexOf(scope)===-1} onChange={(e)=>{\n                                    let chk=e.target.checked;\n                                    this.setState((prevState)=>{\n                                        let exc=prevState.excluded_scopes.slice();\n                                        if(chk) { // remove from exc\n                                            let pos=exc.indexOf(scope);\n                                            if(pos!==-1)\n                                                exc.splice(pos,1);\n                                        } else { // add to exc\n                                            exc.push(scope);\n                                        }\n                                        return {\n                                            excluded_scopes: exc,\n                                        };\n                                    });\n                                }} />\n                                {title}\n                            </label>\n                        ))}\n                    </p>\n                    <p>\n                        <label>\n                            　学号&nbsp;\n                            <input ref={this.username_ref} type=\"tel\" autoFocus={true} />\n                        </label>\n                        <span className=\"pkuhelper-login-type\">\n                                <a onClick={(e)=>this.do_sendcode('sms')}>\n                                    &nbsp;短信&nbsp;\n                                </a>\n                                /\n                                <a onClick={(e)=>this.do_sendcode('mail')}>\n                                    &nbsp;邮件&nbsp;\n                                </a>\n                            </span>\n                    </p>\n                    <p>\n                        <label>\n                            验证码&nbsp;\n                            <input ref={this.password_ref} type=\"tel\" />\n                        </label>\n                        <button type=\"button\" disabled={this.state.loading_status==='loading'}\n                                onClick={(e)=>this.do_login(this.props.token_callback)}>\n                            登录\n                        </button>\n                    </p>\n                    <hr />\n                    <p>\n                        <b>从其他设备导入登录状态</b>\n                    </p>\n                    <p>\n                        <input ref={this.input_token_ref} placeholder=\"User Token\" />\n                        <button type=\"button\" disabled={this.state.loading_status==='loading'}\n                                onClick={(e)=>this.do_input_token(this.props.token_callback)}>\n                            导入\n                        </button>\n                    </p>\n                    <hr />\n                    <p>\n                        <button onClick={this.props.on_close}>\n                            取消\n                        </button>\n                    </p>\n                </div>\n            </div>,\n            this.popup_anchor,\n        );\n    }\n}\n\nexport class LoginPopup extends Component {\n    constructor(props) {\n        super(props);\n        this.state={\n            popup_show: false,\n        };\n        this.on_popup_bound=this.on_popup.bind(this);\n        this.on_close_bound=this.on_close.bind(this);\n    }\n\n    on_popup() {\n        this.setState({\n            popup_show: true,\n        });\n    }\n    on_close() {\n        this.setState({\n            popup_show: false,\n        });\n    }\n\n    render() {\n        return (\n            <>\n                {this.props.children(this.on_popup_bound)}\n                {this.state.popup_show &&\n                    <LoginPopupSelf token_callback={this.props.token_callback} on_close={this.on_close_bound} />\n                }\n            </>\n        );\n    }\n}","export const PKUHELPER_ROOT='//pkuhelper.pku.edu.cn/';\n","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAHF0lEQVR42q1XW0xUVxQ9d2Z4g4oiAiKYGiqQhhDkoVEkBmJT0QYUKgaMIDYSiEZFEFBRFBRQ1A9qsfhISkR80EogbcXyENHKV6GFYR4yw0uJRv3QD2OisWtNZsg4CiMpHzv3cufes9dZe+11NuLw4cPCPA4dOjR+Zezfv18qKCiQHzlyxOb48eM2x44dM1wLCwsVeC7h+sE3lutZCzEZgKKiIqmsrExUVFQIJBO7du0Su3fvNlwBSJw8edLwzv8B8cnEXLC4uFgcPHhQREdHi1WrVvl7eHh8K0lSukKhyMJ1U0BAQHhMTIzjvn37RGlp6TiQqYL4aPcM7iw1NVU4OzvHCCF+RvQgsd7R0XEEMerg4DCEZypEk5OT01aAdMrLyyNoiaCnAmI8qekDUp2YmOhga2tbjKQDs2bNGp4zZ45m5syZWgB6yJgxY4aWz1xdXXX29vYjAHLdy8tr8YEDBwwgpsLE+A2Rc+cJCQkOWLAKiR7PnTtXOXv2bA2SqYODgx+sW7fuVnx8/O/Lly/vQEn6AE7r7u7eCyDDKMtdb29v//z8fJZj6gwcPXpUbNmyRYDiQuzwsaenZy8AaFesWHG3rq6u9Pnz56nv37+PRXzz5s2bpK6urvyUlJQGANAQjJub2yiANwKcK4VrLkyrAHAj8Q8kXgpK1UiuxMJa7Pa3R48ebXr79u0X9+7dc+7s7JQzcG+vVCo93r17F41E5wFAjRKQkVEXF5fsvXv3GrrEvLQTAiD13H1GRgYBVHInXDA8PPzB06dP13d3d9txkezsbMGFGbzfsWOHaG5uFmAkeNu2bdcB+OH8+fO1NjY2nZGRke7l5eXCJMhJAUB0shMnToioqCgvfPyXj4+PFiB0Fy9eLOrp6bHds2cPF5K4I4uQ6AkdHR1Co9HE+fn59UIDKjCgCwwMjDUyIFllAMpVwN3EypUrIyE8DRbR+vv797S3t4eWlJTwd8lSVKZ7Ps/NzRUNDQ3OGzZsqIdmBsDCMMqYs337doHvJWss8CUbUgqlx8+bN08P+nVhYWF/wFxcJmsno1MK9L904cIFkZ6eXoxuGMIGhsFCOUtqMjNrIrThDdT+HUDosQBB/IKOkHOBydTM50ggw9nA7/PAwDDESN+ooEZM308KAKJSnD17ljv5GiUYgAYG4HR3QKkbF/6Us5nUzd9Ic1paGl2zEvQPQT/DERERRUbg1jWAF+WkEkC+8vX17YGa1XA9HXSwxrgDmWU7me4pTp4DMCkvALgPABqAHwSorZcvX6Y+JKtdQDVTSLdv33aOjY2tx0I6UKlHR/wKV3RmO0GIcu7IPEg9kstoXnZ2doWsP6hXoYT/1NfXh5w+fZpHufgcAAYlNzY2itra2gwcLjqw0AchDcpksgqcC47cJTsFJZEQMt7zGZMDaAp2rQH1/bgOoK1/RPs68sj+HEseP355COn1em/Y6w0sqsOCfaQTHl+3aNGiqOTkZMekpCSxceNGsXnzZjl6fbFcLi/B7rUomRq7V7J0SPr9pUuXDP7CFrY2K4zf5OTkiKtXr4qXL19+vWzZsjb4uh7W2oezYRD3akQDohJxClGL+Bv9zpbrJwAygNDi+X20cTjNjUG2aPUTgfigp1mKtrY22ydPniSsXbu2CTvU4FjWoiwqhGkeGMH9EEKD3WvAlhYn5r8AqzGyMATW7mNgiVuyZEkoT1da/UQDy0eU0F5bWloc4PGrq6qqTkHh7Ujah51pEFpTYFboR8t2YSI6D9C5oaGh7QBrYA3g+M5DI3PXFyxY4MeWhd5kliA+ai2KkgfOzZs3Za9evfJ7/fp1AgAVQHQ/ZGVl1WRmZtZgsZ+uXbtWAqbSADQE77mpVKrkkJCQDiRXsyy49qNEKoDiwHIHLepvAmHuLRNaLDVBtE1NTQok8kCiQEQ4IgwR9OzZM5/R0VHH6upqmpgYGxuzRytnslw4VVVGECqUqY9aMYIIsGRiQoslE3yJEw5PxMrKSnHlyhVDnDt3znAkcyBl93A8p9hgXF/CR7oBQIPoBwg1QQBAH4AMmpgwDr0GTUzYn+YnHs2K/x8goSGYkM/4m/F3g4BxgjpAdDVINAhjUhqZUENDBiYQHGbbCYIbo1V/1txmKotpFrA0GFMHcUBBaVYvXbq0BYl0EGQ/GGEHEYTaDERrUFCQL2fQKf8nMxlAlgqCtcX8GI8D6U+CQFsqWQYCoCgBoBetOwZxlvH9aQFgDoIW3NraavfixYv1MCSCGEAplCwD500AUCL0NDZ01fQCMJWDXkIQKEc8ZstmgjB2hRIl6cXfIwsXLqyhQU0bAEsQZMLoquth7bdo7SwJA/T3o723Yu6cXgDmwwrFShDQhD3Olzj4SjXmzqa4uLgbOHnz8b+FJ9+ZdgDmQDjQ7Ny5kyAUMK8IRCJiDcLzzJkzBg/5D61/ySenao8dAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFdklEQVR42sVW+VNTVxS+f4Od9oeW0RmlU8dOcRx3BEHbqiio3dtfamds+0N1bGe62emirYpSLRYDguAWJQihLZBAEkgKgbCHgIBAXbBTtgSykhAQEL/ecyWtwwMHx9DemS/vvXvv+c73zj3n5DEAjHBodJz9MD7BvuP3KVbb0xqV1p6lzENzS9u7Y3zOVWNittXPMmvMWmaNjZgeW8OZY91i1pSbzSqcg6y01Lj7V7UOap3Bma9WhyiKtEyh0bGsQg0L+P3n5talDNZ5LpWZCwqYqqYxJk9TggK1Bkpza7pWrWNdsZHM/uKymZ1Pgvb07ohiel0Jy7VcO1ug0iCfc+WbW7fUa0vYrUw5u6G8IhXglR1l/qR45tu/l9WeTo5XGqvxS3k1tPmF+t6Y8MXOVYui+3ZEb+ROHoq+HVEb3WtCo23bIhZrCwoNuZyHuKpTU474v/2M+dOSmDdDJhVgzUxn1oQDcd7w59C5+00oqxqgsLTBnHAIQ8vnoy9uPbiDWYH2kk1dwmFkWdqRU2nG9V2vw8e5rScOx/ZnX5YK6Dvw6Z6+VzYMepY8hT8++ZALMONKfQuqkxLhWf88rNvCZy2A54KwqTp1UnCQgPZ9H8Cz5ElYX93gsR38/COpgO3r5bata+FYHYrKve8jp7EDuW23USRLQveKhXDERc5agCMuAt0rF6JQdkpw5DS1o3LPbsFti1nLIxQplx7BljVyO3fSExUG/YYVyFMVIa/lOvLfewcdyxbAvTNq1gJobzu3Ue16G3nNnCNfDUP0cvRELwX5IF9SAbERchtftO+MRsOKUKjXhUG9JRJlSxegm4fUvn32OUB7ycYYNh/qzRFQh4cJTuK23Y+kVED/1nA5BxycwMZxbWUoml4IQdemVXBujwStPQpc3KZr8yo0hYWglXMRJ3FPrksF2F57Sc4BK4f9jZfhfmuzgPPNTWLO9oggG7IN8BDnAzxSAaWL5sk58C+emMS8x8S0PFIBjQf3yznwH0EqwAfIOTAThqZgpjXf7CAV4PAMyjkwFXa3R1xHx+9i4h4wzn/o6r8zKtb6XW4MjdwBnxLw+ofF3HRcD2D2AlxeH5yDXpgsjdBWmFBcVY3S2jr0DTiEKN/wCFpu3ERReQUM1TW4+VcXfFxQ0AQMDvmFiPQcJb5PTkHi+Qs4cEqGo2fS0dndCxrFlVX4OvEkvvjxOCrMDSISQRMQgM3pgtXhFPd0lV3OxOmsKyICdByd3T04xkVVNFhw994cCPDwSIyMjQtyGhVms4hIt61fPA/wcz+WnjF3Alw8DygKvXYHbvf0IlmhgDy/QCQdCeviQuZUAL04kX/1UyK++TkJB2XJ+JMLIWd0DHMugEqNMrysrh6GmlocP3ceOlMlhkfHRA7MuYCByXoPDD0vucOnU2HlR0IOe/oHRBJSuU4EswoCjYjelOqeGhENpVaHhIyzounQcPNSjU87g/qWVvF83zYIAty+IdGI1GVGXCpQ4Te9ARnKXHx5/AQqLU3CWUNbu5g7kpomypOaFdmQ7WMLoPKjClCo1Dh54SJSMhVIy85BbXMLRnhUKNzUGU+cPYdsjRYpiixc4tVBzcsz9AgCXF7vQ3OAOiJlO139PBfG7k4IJ5Qb9Ka0RiUZ2PPQkua+JAKcfJIvzGhEZxwAOZ7aIzwPrLunrE/z3zLN90Brh9zu8vCmMsY3DIozDCYcHJTIlNTNHdelAorLTPG1lmbYuUrfCA/nsB+D/uDA679/fBSBWstVaPTGIxIBXX22EH151UVdqQn1V1sF6ppagoIAX6mpBhpD+YUSY9Uz0s/ygQFWXtPA1MXGjzUGo4Fv1HCoggRNkcGoLykz7fvdVMP0HBIB/xf+Bi8VajXQRja5AAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAG2klEQVR42pVXaUxVRxSee+8DRNlEEA1qBGVLS8XIFllKqiBqUcQispgWLKgFFRsMmxuCiGgA/dM2VdvfJjbpkjRpUrv8aRrTdE2Tpqtt05q0tZVa68aj3zc583J98Cz8+N69983MmbN858wZdeTIEeXG4cOHNfh+4MAB59ChQ8FDQ0Pq+PHjqqKiInTRokV1juO8ppT6FrgGjALf479LGHtm8+bNsZw7MjKijh49GtTd3e0x8szTjQmbm+fBgwedY8eO6W9svCw+Pv5UUFDQZ5Zl/WXb9i3gHjAGeOX9NsZGg4ODv8LcF4qLi/M7Ozu14jDCCaTEpJtjgX3ixAm1ffv2OAh7DhbeAManiTtRUVEXysvLk/v7+1VPT48NuROUuO8PTuBELigoKNgAIT9RGCwzQn+NjIy8sHz58qb8/PziLVu2ZACP5OXlPZaTk/NUbGzsecz5wU+R66mpqTsRTtXb26v8lZiwOWKmUlJS9vht/GNycvKehoaGGI7TrfTQwMCABt8JymhqagrLzs6u9Xg8n3MtuKFlLFy48CTCSl5YbiXuczstT0pK2i0L7/EJq85i4zkcE07QlQ6E8WkJ9H8c6+vr00q1tLSELliwoMctC0qM0BMw1DFK6B8KowVw63pM9GLBHS5ISEho40RuTlLyfTIy+fFHz6Ui2EhlZWVVQdZNyLxLmfSkyLO1B+BSst0C4eYwxmQ1Jy5evLiNQuAyB1prK7GJMxVAsI0NLL4PDg4q8KNcPDGG520Q8yF6qaury6HGwdQ0Li7ueUMcuP0cLeHmjBvJwwX4nhJoIZXnWijjYehgUIfhVUhIyKV9+/bRQx41PDysNm3a9DAG/wHGMOHn+vr6CAixGC8KbG1tDcnMzGyYN29eF9AOZTsnA8Y6OCctLa1l165ds6m4GOBAhgIxP4R8etgLoq5nsdKMnj9//pCxfunSpbtNjAw3VqxYsXO6dQBeHKYCEg6b+4BjazBGQnrDwsLeoOdpfThi8wX/BK6C8ZF0GUNAhtP1RUVFG8RD3ilszjl3kMqtDAMU0GlHZdra2uiFj2TOn2VlZXMVUqOGxYKLw8PDLzDPQR7LnAnUkv+h4CxDSV4LlEDpNQFQgvFSIKe9vV2Hz8ghifmN1OylAgxFdHR0i4L1r+PjFv9EhXuaFjON3CnGhYzX6dOn1ZkzZx4IM4fWm1w3qU7ZpaWljwoZ6YVPFU8ypJ7OUZZXxhzks/09gIXZq1atehwoBdYGAMfWAYVguS0cMB6wyIOampokhsgVTnUN2jA/vZWVlRniAUvKs9Ya58ITzJDpkBAVtYNcIgnFAzqVq6qqojH+u5R5Gq6uuxRIdytgsoChmW4WIB0HxQOWnwJRGP/NrcAVfOgQ8FQTBXwhYPzhTk9GRkYVUnQP0Ay0BEAzzxLMrd+xY0eY+/TjkyGorq5OYDX0hQAkfIfNhBSHbbTYn4QUxK6IRWuqMKnsanB0SqMM57pI+B3TcKe0VboEi+W+NDQHTV1dXSzSKw1IAVIDgGNpSNl41HlNYLOeXuWZg8OoXdJwHGnYzUI0F8Xha3HJlcbGxlB3IaLbSkpKCpgtoijxdwCMSk25ijDUiBzLhHL//v0KLdv7stcNFKJEHRcQ5qwhD8putUlF05qlp6c/O10SonN6kZuyR6AsuN9CemZK/MdwIL2rj2MWDgzkSW6OofH8srm5OQiFhAstFhQQKhoVrB+Kvgycw8FzPgDOYfwlYAShSKAHyH42IKwlqP9vGvLB0G3kim6d2b3OmjXrotEejWgP4wftPQwFlSARp3ocE1IDNKHpZZymtYZ8CPknOB2DMM/DpsDDCWDnEsZFmoZxLKhkMwEhjtQFe4qwpG2zsM5DK1evXp0Fmf+a1gwVt0gaEo/voKASYGijdC6sCzfRyVTQElhvuWvDZP29353CNt017ge5sPoX3h0oG0f/SZln+5pS0xGzAUFannI3komJiR1wl84GOd0caUItyRTlbkw5h9Yx5qwrNERyfnzmzJmv7N27l7zy3RHua8vZMpM07F65wPSHiNkHcNs6nufkBjODCpm23LzTW0w1uHwlGw4xxGx+EeQOlWZnYltulKC76QlcJloZN3dqQZHLuP/14WQsqq2tTdq6dWs0MBsnXCI4tBJrOmbMmPGe1HjfOmTQSViu/Def9Grmvh2hSGVA87cC5Do3+YMHi+T2hDkoOpcLCwuLKds0qZNezQL09w7dyu41Nze3LCIi4lW5DfMyqrtbPl3vXsnxUSj9NrLoSaYawyO8efDl1F8JgncG1gl2Q/zeuHHj3JiYmGZs8rH0B3cFfP8GY52Ys4QymH5s6//vev4fhVL/4/SeszAAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAFfklEQVR42qWXWWicVRiG/39mUim4NRq88MZWXIpLe+FS6lYKtZsW0UrRUmyllUIXpQiN3hXBC1sxdyom6q2lVRGhUqvFClURUVFUsu+ZmD2TTDKTycTn/fudcPzNJJMaeDOTnHO+7z3ffoLm5uagFFpaWpJ8LmloaAgaGxuD3t7epePj49unpqbeLhQKn4EvwQVwjv+dYm1fOp2u0t76+vqgqampAhmp+XTMqxwB0XcUr8pmsydQ8jPK0oYe0G3f+8AgGGDPn+x9t7+//8HW1taIODKSiyWQ0MGurq4bEKbbjoEZUATTYApMgglDrnDpp2j7hPzk5ORJyN9qJBLlEoiUDw4ObkNIhydQ6JHQ4eHhF1jfgLlXg7v5vn5oaGj3xMTE++xpjZ0ZyWQy+7Fo4Cw6H4GENnLgcExIu/6HRa7XugjOBcno7Oy8EjI7ccVvOstnJIP4OG4kwlIEopuj6JAdlElnuFUtiq/Tmt1ApkwiTJ+hIWF+TmiP9nZ0dChgj/my+LtGJPyYcAHnzL5VfuRAXgfGxsZe1rrWLCOCcuAHMO7agazs1CUWM7KkyYtiwm0OdUuL7KJTLiFAt/VvWQ4SdiYpZbjkCbOEAjhHYN7hLiWWS8QEU7/jfM73Ov3PlAfOrEZoQbi9Zu6UvnOhaic/n89/3dbWFq1FBQNGd7IwbinWiTWuRkjolLe3t1+BKZ8nJV8FRyH4ylxgrVp7RkdHDxIDyxwJXQQZARb4wSxcxCpbpTtiy6E3HTuYHnI+crGB8v2xrFgQEHrLBa0XYxtdvcjlcp9HMcDtr4LZr8Ysze2v8fI11MGBgYFtZqFiGcq1J0+wvWRyQnNnILOj6yfb8zc/VQGp8RR/9Mr8sDppfgtjUR1QcFZBdjN4FGwsAa1tAverDMcKT5Si6HvNKmmGorZbjGrFRqwx9d65Uk4H5a/FIF71nBv6+voesdKt/nEq4NcX1lByKq9+jvoW4OB9NJjHwCawuQS0tgU8jLkTMRKRO3t6em5ReVZ1Bd+KwFfW1bKq7UYgjPWF7ZYhZQchMVDtVc7AlXB0VJpy9YwzInDeCpAI3OUT8LJg72KzgMx6ww9Cj8C1rLeBFkfgrOeC9XEXWPSmRkZGdpCih8EBcLAEDqiXsHePmlI8DswFy9E1rHoDLioIP+JLvyKT4rCrVBBqKvqfQRjaVLXGglA6zyot9lhEFl0Jjqeh0N3dXcXhleA2cHsJaG0lZr7R0vlfWaCeg4WOWhqOkYYvilEVVvjLikMbplsaL0RE9UPms1FDpgRGLcLTuOHZeCFSbUDXBQvoIQrRTa4U17rgIeCe8eIgCkKEHVlsEHK792KlOOQi95j5p2lI56NSLH+x8IAKkRZg+AeNpILDUUuVEKxSiateh+iHoE6jVwnUsf4BqMGyy72OGHVVKu0ZV8656K6oGWl0lmlYPO2l0DFzQcqZ73LghhNL5Z2uV3DJX+iOumRKG1IWnTcrMGxoEMOn3UjtDSTlwO1VO0+Zhe/V9OxGM9J9nbk5FZ8H99nkop1Z0vJJu00YL88LjGSz8YPyNVZpC2bd407nf4ZS+Qlfn/AHSU0ymCv0htKkd9PAS9toZHMTkWSprugizu8E3seSpfiacyy3m4pEjdfbReY7zLbFxqiSY7lLNW69VgOHnXXKT2tSduRKPkwcCQ0U9uqZTS2E/ah+Tmdcp64GKsEysIIYWqsGhKJvrNDMntObQCNZXPmCTzOErkbg2di0U7CUVeHpstdTxpRO+1OTCDNNbXCZFFc+7+PUjdQyO758HJN+apNTxh6iae9xOmBVUBYbhvQ5sug5pdrlPk79B0aFUsleyVUUG/WOT8D39jS/CH7XJ2tH2LNCe60hJRd6nv8Dwj5T3q96iTAAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,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\"","// https://martin.ankerl.com/2009/12/09/how-to-create-random-colors-programmatically/\n\nconst golden_ratio_conjugate = 0.618033988749895;\n\nexport class ColorPicker {\n  constructor() {\n    this.names = {};\n    this.current_h = Math.random();\n  }\n\n  get(name) {\n    name = name.toLowerCase();\n    if(name === '洞主')\n      return ['hsl(0,0%,97%)', 'hsl(0,0%,16%)'];\n\n    if(!this.names[name]) {\n      this.current_h += golden_ratio_conjugate;\n      this.current_h %= 1;\n      this.names[name] = [\n        `hsl(${this.current_h * 360}, 50%, 90%)`,\n        `hsl(${this.current_h * 360}, 60%, 20%)`,\n      ];\n    }\n    return this.names[name];\n  }\n}","// regexp should match the WHOLE segmented part\nexport const PID_RE = /(^|[^\\d\\u20e3\\ufe0e\\ufe0f])([2-9]\\d{4,5}|1\\d{4,6})(?![\\d\\u20e3\\ufe0e\\ufe0f])/g;\nexport const URL_PID_RE = /((?:https?:\\/\\/)?pkuhelper\\.pku\\.edu\\.cn\\/hole\\/?#(?:#|%23)([2-9]\\d{4,5}|1\\d{4,6}))(?!\\d|\\u20e3|\\ufe0e|\\ufe0f)/g;\nexport const NICKNAME_RE = /(^|[^A-Za-z])((?:(?:Angry|Baby|Crazy|Diligent|Excited|Fat|Greedy|Hungry|Interesting|Jolly|Kind|Little|Magic|Naïve|Old|Powerful|Quiet|Rich|Superman|THU|Undefined|Valuable|Wifeless|Xiangbuchulai|Young|Zombie)\\s)?(?:Alice|Bob|Carol|Dave|Eve|Francis|Grace|Hans|Isabella|Jason|Kate|Louis|Margaret|Nathan|Olivia|Paul|Queen|Richard|Susan|Thomas|Uma|Vivian|Winnie|Xander|Yasmine|Zach)|You Win(?: \\d+)?|洞主)(?![A-Za-z])/gi;\nexport const URL_RE = /(^|[^.@a-zA-Z0-9_])((?:https?:\\/\\/)?(?:(?:[\\w-]+\\.)+[a-zA-Z]{2,3}|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})(?::\\d{1,5})?(?:\\/[\\w~!@#$%^&*()\\-_=+[\\]{};:,./?|]*)?)(?![a-zA-Z0-9])/gi;\n\nexport function split_text(txt, rules) {\n  // rules: [['name',/regex/],...]\n  // return: [['name','part'],[null,'part'],...]\n\n  txt = [[null, txt]];\n  rules.forEach((rule) => {\n    let [name, regex] = rule;\n    txt = [].concat.apply([], txt.map((part) => {\n      let [rule, content] = part;\n      if(rule) // already tagged by previous rules\n        return [part];\n      else {\n        return content\n          .split(regex)\n          .map((seg) => (\n            regex.test(seg) ? [name, seg] : [null, seg]\n          ))\n          .filter(([name, seg]) => (\n            name !== null || seg\n          ));\n      }\n    }));\n  });\n  return txt;\n}\n","const HOLE_CACHE_DB_NAME = 'hole_cache_db';\nconst CACHE_DB_VER = 1;\nconst MAINTENANCE_STEP = 200;\nconst MAINTENANCE_COUNT = 2500;\n\nconst ENC_KEY = 42;\n\nclass Cache {\n  constructor() {\n    this.db = null;\n    this.added_items_since_maintenance = 0;\n    this.encrypt = this.encrypt.bind(this);\n    this.decrypt = this.decrypt.bind(this);\n    const open_req = indexedDB.open(HOLE_CACHE_DB_NAME, CACHE_DB_VER);\n    open_req.onerror = console.error.bind(console);\n    open_req.onupgradeneeded = (event) => {\n      console.log('comment cache db upgrade');\n      const db = event.target.result;\n      const store = db.createObjectStore('comment', {\n        keyPath: 'pid',\n      });\n      store.createIndex('last_access', 'last_access', {unique: false});\n    };\n    open_req.onsuccess = (event) => {\n      console.log('comment cache db loaded');\n      this.db = event.target.result;\n      setTimeout(this.maintenance.bind(this), 1);\n    };\n  }\n\n  // use window.hole_cache.encrypt() only after cache is loaded!\n  encrypt(pid, data) {\n    let s = JSON.stringify(data);\n    let o = '';\n    for(let i = 0, key = (ENC_KEY ^ pid) % 128;i < s.length;i++) {\n      let c = s.charCodeAt(i);\n      let new_key = (key ^ (c / 2)) % 128;\n      o += String.fromCharCode(key ^ s.charCodeAt(i));\n      key = new_key;\n    }\n    return o;\n  }\n\n  // use window.hole_cache.decrypt() only after cache is loaded!\n  decrypt(pid, s) {\n    let o = '';\n    if(typeof(s) !== typeof('str'))\n      return null;\n\n    for(let i = 0, key = (ENC_KEY ^ pid) % 128;i < s.length;i++) {\n      let c = key ^ s.charCodeAt(i);\n      o += String.fromCharCode(c);\n      key = (key ^ (c / 2)) % 128;\n    }\n\n    try {\n      return JSON.parse(o);\n    } catch(e) {\n      console.error('decrypt failed');\n      console.trace(e);\n      return null;\n    }\n  }\n\n  get(pid, target_version) {\n    pid = parseInt(pid);\n    return new Promise((resolve, reject) => {\n      if(!this.db)\n        return resolve(null);\n      const tx = this.db.transaction(['comment'], 'readwrite');\n      const store = tx.objectStore('comment');\n      const get_req = store.get(pid);\n      get_req.onsuccess = () => {\n        let res = get_req.result;\n        if(!res || !res.data_str) {\n          //console.log('comment cache miss '+pid);\n          resolve(null);\n        } else if(target_version === res.version) { // hit\n          console.log('comment cache hit', pid);\n          res.last_access = (+new Date());\n          store.put(res);\n          let data = this.decrypt(pid, res.data_str);\n          resolve(data); // obj or null\n        } else { // expired\n          console.log('comment cache expired', pid, ': ver', res.version, 'target', target_version);\n          store.delete(pid);\n          resolve(null);\n        }\n      };\n      get_req.onerror = (e) => {\n        console.warn('comment cache indexeddb open failed');\n        console.error(e);\n        resolve(null);\n      };\n    });\n  }\n\n  put(pid, target_version, data) {\n    pid = parseInt(pid);\n    return new Promise((resolve, reject) => {\n      if(!this.db)\n        return resolve();\n      const tx = this.db.transaction(['comment'], 'readwrite');\n      const store = tx.objectStore('comment');\n      store.put({\n        pid: pid,\n        version: target_version,\n        data_str: this.encrypt(pid, data),\n        last_access: +new Date(),\n      });\n      console.log('comment cache put', pid);\n      if(++this.added_items_since_maintenance === MAINTENANCE_STEP)\n        setTimeout(this.maintenance.bind(this), 1);\n    });\n  }\n\n  delete(pid) {\n    pid = parseInt(pid);\n    return new Promise((resolve, reject) => {\n      if(!this.db)\n        return resolve();\n      const tx = this.db.transaction(['comment'], 'readwrite');\n      const store = tx.objectStore('comment');\n      let req = store.delete(pid);\n      console.log('comment cache delete', pid);\n      req.onerror = () => {\n        console.warn('comment cache delete failed ', pid);\n        return resolve();\n      };\n      req.onsuccess = () => resolve();\n    });\n  }\n\n  maintenance() {\n    if(!this.db)\n      return;\n    const tx = this.db.transaction(['comment'], 'readwrite');\n    const store = tx.objectStore('comment');\n    let count_req = store.count();\n    count_req.onsuccess = () => {\n      let count = count_req.result;\n      if(count > MAINTENANCE_COUNT) {\n        console.log('comment cache db maintenance', count);\n        store.index('last_access').openKeyCursor().onsuccess = (e) => {\n          let cur = e.target.result;\n          if(cur) {\n            //console.log('maintenance: delete',cur);\n            store.delete(cur.primaryKey);\n            if(--count > MAINTENANCE_COUNT)\n              cur.continue();\n          }\n        };\n      } else {\n        console.log('comment cache db no need to maintenance', count);\n      }\n      this.added_items_since_maintenance = 0;\n    };\n    count_req.onerror = console.error.bind(console);\n  }\n\n  clear() {\n    if(!this.db)\n      return;\n    indexedDB.deleteDatabase(HOLE_CACHE_DB_NAME);\n    console.log('delete comment cache db');\n  }\n}\n\nexport function cache() {\n  if(!window.hole_cache)\n    window.hole_cache = new Cache();\n  return window.hole_cache;\n}\n","import {get_json, API_VERSION_PARAM} from './infrastructure/functions';\nimport {PKUHELPER_ROOT} from './infrastructure/const';\nimport {API_BASE} from './Common';\nimport {cache} from './cache';\n\nexport {PKUHELPER_ROOT, API_VERSION_PARAM};\n\nexport function token_param(token) {\n  return API_VERSION_PARAM() + (token ? ('&user_token=' + token) : '');\n}\n\nexport {get_json};\n\nconst SEARCH_PAGESIZE = 50;\n\nconst handle_response = async (response, notify = false) => {\n  let json = await get_json(response);\n  if(json.code !== 0) {\n    if(json.msg) {\n      if (notify) alert(json.msg);\n      else throw new Error(json.msg);\n    } else throw new Error(JSON.stringify(json));\n  }\n  return json;\n};\n\nconst parse_replies = (replies, color_picker) =>\n  replies\n    .sort((a, b) => parseInt(a.cid, 10) - parseInt(b.cid, 10))\n    .map((info) => {\n      info._display_color = color_picker.get(info.name);\n      info.variant = {};\n      return info;\n    });\n\nexport const API = {\n  load_replies: async (pid, token, color_picker, cache_version) => {\n    pid = parseInt(pid);\n    let response = await fetch(\n      API_BASE + '/api.php?action=getcomment' +\n      '&pid=' + pid + token_param(token)\n    );\n    let json = await handle_response(response);\n    // Why delete then put ??\n    cache().put(pid, cache_version, json);\n    json.data = parse_replies(json.data, color_picker);\n    return json;\n  },\n\n  load_replies_with_cache: async (pid, token, color_picker, cache_version) => {\n    pid = parseInt(pid);\n    let json = await cache().get(pid, cache_version);\n    if(json) {\n      json.data = parse_replies(json.data, color_picker);\n      return { data: json, cached: true };\n    } else {\n      json = await API.load_replies(pid, token, color_picker, cache_version);\n      return { data: json, cached: !json };\n    }\n  },\n\n  set_attention: async (pid, attention, token) => {\n    let data = new URLSearchParams();\n    data.append('user_token', token);\n    data.append('pid', pid);\n    data.append('switch', attention ? '1' : '0');\n    let response = await fetch(\n      API_BASE + '/api.php?action=attention' + token_param(token), {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded',\n        },\n        body: data,\n      });\n    // cache().delete(pid); // Magic operation...\n    return handle_response(response, true);\n  },\n\n  report: async (pid, reason, token) => {\n    let data = new URLSearchParams();\n    data.append('user_token', token);\n    data.append('pid', pid);\n    data.append('reason', reason);\n    let response = await fetch(\n      API_BASE + '/api.php?action=report' + token_param(token), {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded',\n        },\n        body: data,\n      });\n    return handle_response(response, true);\n  },\n\n  get_list: async (page, token) => {\n    let response = await fetch(\n      API_BASE + '/api.php?action=getlist' +\n      '&p=' + page + token_param(token)\n    );\n    return handle_response(response);\n  },\n\n  get_search: async (page, keyword, token) => {\n    let response = await fetch(\n      API_BASE + '/api.php?action=search' +\n      '&pagesize=' + SEARCH_PAGESIZE +\n      '&page=' + page +\n      '&keywords=' + encodeURIComponent(keyword) +\n      token_param(token)\n    );\n    return handle_response(response);\n  },\n\n  get_single: async (pid, token) => {\n    let response = await fetch(\n      API_BASE + '/api.php?action=getone' +\n      '&pid=' + pid + token_param(token)\n    );\n    return handle_response(response);\n  },\n\n  get_attention: async (token) => {\n    let response = await fetch(\n      API_BASE + '/api.php?action=getattention' +\n      token_param(token)\n    );\n    return handle_response(response);\n  },\n};\n","import React, {Component, PureComponent} from 'react';\nimport {format_time, Time, TitleLine} from './infrastructure/widgets';\nimport {PKUHELPER_ROOT} from './flows_api';\n\nimport './Common.css';\n\nexport {format_time, Time, TitleLine};\n\nexport const API_BASE = PKUHELPER_ROOT + 'services/pkuhole';\n\n// https://stackoverflow.com/questions/3446170/escape-string-for-use-in-javascript-regex\nfunction escape_regex(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nexport function build_highlight_re(txt, split, option = 'g') {\n  return txt ? new RegExp(`(${txt.split(split).filter((x) => !!x).map(escape_regex).join('|')})`, option) : /^$/g;\n}\n\nexport function ColoredSpan(props) {\n  return (\n    <span className=\"colored-span\" style={{\n      '--coloredspan-bgcolor-light': props.colors[0],\n      '--coloredspan-bgcolor-dark': props.colors[1],\n    }}>{props.children}</span>\n  );\n}\n\nexport class HighlightedText extends PureComponent {\n  render() {\n    function normalize_url(url) {\n      return /^https?:\\/\\//.test(url) ? url : 'http://' + url;\n    }\n    return (\n      <pre>\n        {this.props.parts.map((part, idx) => {\n          let [rule, p] = part;\n          return (\n            <span key={idx}>{\n              rule === 'url_pid' ? <span className=\"url-pid-link\" title={p}>/hole/##</span> :\n                rule === 'url' ? <a href={normalize_url(p)} target=\"_blank\" rel=\"noopener\">{p}</a> :\n                  rule === 'pid' ? <a href={'##' + p} onClick={(e) => {e.preventDefault(); this.props.show_pid(p);}}>{p}</a> :\n                    rule === 'nickname' ? <ColoredSpan colors={this.props.color_picker.get(p)}>{p}</ColoredSpan> :\n                      rule === 'search' ? <span className=\"search-query-highlight\">{p}</span> :\n                        p\n            }</span>\n          );\n        })}\n      </pre>\n    );\n  }\n}\n\nwindow.TEXTAREA_BACKUP = {};\n\nexport class SafeTextarea extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      text: '',\n    };\n    this.on_change_bound = this.on_change.bind(this);\n    this.on_keydown_bound = this.on_keydown.bind(this);\n    this.clear = this.clear.bind(this);\n    this.area_ref = React.createRef();\n    this.change_callback = props.on_change || (() => {});\n    this.submit_callback = props.on_submit || (() => {});\n  }\n\n  componentDidMount() {\n    this.setState({\n      text: window.TEXTAREA_BACKUP[this.props.id] || ''\n    }, () => {\n      this.change_callback(this.state.text);\n    });\n  }\n\n  componentWillUnmount() {\n    window.TEXTAREA_BACKUP[this.props.id] = this.state.text;\n    this.change_callback(this.state.text);\n  }\n\n  on_change(event) {\n    this.setState({\n      text: event.target.value,\n    });\n    this.change_callback(event.target.value);\n  }\n  on_keydown(event) {\n    if(event.key === 'Enter' && event.ctrlKey && !event.altKey) {\n      event.preventDefault();\n      this.submit_callback();\n    }\n  }\n\n  clear() {\n    this.setState({\n      text: '',\n    });\n  }\n  set(text) {\n    this.change_callback(text);\n    this.setState({\n      text: text,\n    });\n  }\n  get() {\n    return this.state.text;\n  }\n  focus() {\n    this.area_ref.current.focus();\n  }\n\n  render() {\n    return (\n      <textarea ref={this.area_ref} onChange={this.on_change_bound} value={this.state.text} onKeyDown={this.on_keydown_bound} />\n    );\n  }\n}\n\nlet pwa_prompt_event = null;\nwindow.addEventListener('beforeinstallprompt', (e) => {\n  console.log('pwa: received before install prompt');\n  pwa_prompt_event = e;\n});\n\nexport function PromotionBar(props) {\n  let is_ios = /iPhone|iPad|iPod/i.test(window.navigator.userAgent);\n  let is_installed = (window.matchMedia('(display-mode: standalone)').matches) || (window.navigator.standalone);\n\n  if(is_installed)\n    return null;\n\n  if(is_ios)\n  // noinspection JSConstructorReturnsPrimitive\n    return !navigator.standalone ? (\n      <div className=\"box promotion-bar\">\n        <span className=\"icon icon-about\" />&nbsp;\n        用 Safari 把树洞 <b>添加到主屏幕</b> 更好用\n      </div>\n    ) : null;\n  else\n  // noinspection JSConstructorReturnsPrimitive\n    return pwa_prompt_event ? (\n      <div className=\"box promotion-bar\">\n        <span className=\"icon icon-about\" />&nbsp;\n        把网页版树洞 <b><a onClick={() => {\n          if(pwa_prompt_event)\n            pwa_prompt_event.prompt();\n        }}>安装到桌面</a></b> 更好用\n      </div>\n    ) : null;\n}\n\nexport class ClickHandler extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      moved: true,\n      init_y: 0,\n      init_x: 0,\n    };\n    this.on_begin_bound = this.on_begin.bind(this);\n    this.on_move_bound = this.on_move.bind(this);\n    this.on_end_bound = this.on_end.bind(this);\n\n    this.MOVE_THRESHOLD = 3;\n    this.last_fire = 0;\n  }\n\n  on_begin(e) {\n    //console.log('click',(e.touches?e.touches[0]:e).screenY,(e.touches?e.touches[0]:e).screenX);\n    this.setState({\n      moved: false,\n      init_y: (e.touches ? e.touches[0] : e).screenY,\n      init_x: (e.touches ? e.touches[0] : e).screenX,\n    });\n  }\n  on_move(e) {\n    if(!this.state.moved) {\n      let mvmt = Math.abs((e.touches ? e.touches[0] : e).screenY - this.state.init_y) + Math.abs((e.touches ? e.touches[0] : e).screenX - this.state.init_x);\n      //console.log('move',mvmt);\n      if(mvmt > this.MOVE_THRESHOLD)\n        this.setState({\n          moved: true,\n        });\n    }\n  }\n  on_end(event) {\n    //console.log('end');\n    if(!this.state.moved)\n      this.do_callback(event);\n    this.setState({\n      moved: true,\n    });\n  }\n\n  do_callback(event) {\n    if(this.last_fire + 100 > +new Date()) return;\n    this.last_fire = +new Date();\n    this.props.callback(event);\n  }\n\n  render() {\n    return (\n      <div onTouchStart={this.on_begin_bound} onMouseDown={this.on_begin_bound}\n        onTouchMove={this.on_move_bound} onMouseMove={this.on_move_bound}\n        onClick={this.on_end_bound} >\n        {this.props.children}\n      </div>\n    );\n  }\n}","export function on(el, eventName, callback, opts) {\n  opts = opts || false;\n  if (el.addEventListener) {\n    el.addEventListener(eventName, callback, opts);\n  } else if (el.attachEvent) {\n    el.attachEvent(`on${eventName}`, (e) => {\n      callback.call(el, e || window.event);\n    });\n  }\n}\n\nexport function off(el, eventName, callback, opts) {\n  opts = opts || false;\n  if (el.removeEventListener) {\n    el.removeEventListener(eventName, callback, opts);\n  } else if (el.detachEvent) {\n    el.detachEvent(`on${eventName}`, callback);\n  }\n}\n","/**\n * @fileOverview Find scroll parent\n */\n\nexport default (node) => {\n  if (!(node instanceof HTMLElement)) {\n    return document.documentElement;\n  }\n\n  const excludeStaticParent = node.style.position === 'absolute';\n  const overflowRegex = /(scroll|auto)/;\n  let parent = node;\n\n  while (parent) {\n    if (!parent.parentNode) {\n      return node.ownerDocument || document.documentElement;\n    }\n\n    const style = window.getComputedStyle(parent);\n    const position = style.position;\n    const overflow = style.overflow;\n    const overflowX = style['overflow-x'];\n    const overflowY = style['overflow-y'];\n\n    if (position === 'static' && excludeStaticParent) {\n      parent = parent.parentNode;\n      continue;\n    }\n\n    if (overflowRegex.test(overflow) && overflowRegex.test(overflowX) && overflowRegex.test(overflowY)) {\n      return parent;\n    }\n\n    parent = parent.parentNode;\n  }\n\n  return node.ownerDocument || node.documentElement || document.documentElement;\n};\n","/**\n * react-lazyload\n */\nimport React, { Component, PureComponent } from 'react';\nimport ReactDom from 'react-dom';\nimport PropTypes from 'prop-types';\nimport { on, off } from './utils/event';\nimport scrollParent from './utils/scrollParent';\nimport debounce from './utils/debounce';\nimport throttle from './utils/throttle';\n\nconst defaultBoundingClientRect = { top: 0, right: 0, bottom: 0, left: 0, width: 0, height: 0 };\nconst LISTEN_FLAG = 'data-lazyload-listened';\nconst listeners = [];\nlet pending = [];\n\n// try to handle passive events\nlet passiveEventSupported = false;\ntry {\n  const opts = Object.defineProperty({}, 'passive', {\n    get() {\n      passiveEventSupported = true;\n    }\n  });\n  window.addEventListener('test', null, opts);\n}\ncatch (e) { }\n// if they are supported, setup the optional params\n// IMPORTANT: FALSE doubles as the default CAPTURE value!\nconst passiveEvent = passiveEventSupported ? { capture: false, passive: true } : false;\n\n\n/**\n * Check if `component` is visible in overflow container `parent`\n * @param  {node} component React component\n * @param  {node} parent    component's scroll parent\n * @return {bool}\n */\nconst checkOverflowVisible = function checkOverflowVisible(component, parent) {\n  const node = ReactDom.findDOMNode(component);\n\n  let parentTop;\n  let parentHeight;\n\n  try {\n    ({ top: parentTop, height: parentHeight } = parent.getBoundingClientRect());\n  } catch (e) {\n    ({ top: parentTop, height: parentHeight } = defaultBoundingClientRect);\n  }\n\n  const windowInnerHeight = window.innerHeight || document.documentElement.clientHeight;\n\n  // calculate top and height of the intersection of the element's scrollParent and viewport\n  const intersectionTop = Math.max(parentTop, 0); // intersection's top relative to viewport\n  const intersectionHeight = Math.min(windowInnerHeight, parentTop + parentHeight) - intersectionTop; // height\n\n  // check whether the element is visible in the intersection\n  let top;\n  let height;\n\n  try {\n    ({ top, height } = node.getBoundingClientRect());\n  } catch (e) {\n    ({ top, height } = defaultBoundingClientRect);\n  }\n\n  const offsetTop = top - intersectionTop; // element's top relative to intersection\n\n  const offsets = Array.isArray(component.props.offset) ?\n                component.props.offset :\n                [component.props.offset, component.props.offset]; // Be compatible with previous API\n\n  return (offsetTop - offsets[0] <= intersectionHeight) &&\n         (offsetTop + height + offsets[1] >= 0);\n};\n\n/**\n * Check if `component` is visible in document\n * @param  {node} component React component\n * @return {bool}\n */\nconst checkNormalVisible = function checkNormalVisible(component) {\n  const node = ReactDom.findDOMNode(component);\n\n  // If this element is hidden by css rules somehow, it's definitely invisible\n  if (!(node.offsetWidth || node.offsetHeight || node.getClientRects().length)) return false;\n\n  let top;\n  let elementHeight;\n\n  try {\n    ({ top, height: elementHeight } = node.getBoundingClientRect());\n  } catch (e) {\n    ({ top, height: elementHeight } = defaultBoundingClientRect);\n  }\n\n  const windowInnerHeight = window.innerHeight || document.documentElement.clientHeight;\n\n  const offsets = Array.isArray(component.props.offset) ?\n                component.props.offset :\n                [component.props.offset, component.props.offset]; // Be compatible with previous API\n\n  return (top - offsets[0] <= windowInnerHeight) &&\n         (top + elementHeight + offsets[1] >= 0);\n};\n\n\n/**\n * Detect if element is visible in viewport, if so, set `visible` state to true.\n * If `once` prop is provided true, remove component as listener after checkVisible\n *\n * @param  {React} component   React component that respond to scroll and resize\n */\nconst checkVisible = function checkVisible(component) {\n  const node = ReactDom.findDOMNode(component);\n  if (!(node instanceof HTMLElement)) {\n    return;\n  }\n\n  const parent = scrollParent(node);\n  const isOverflow = component.props.overflow &&\n                     parent !== node.ownerDocument &&\n                     parent !== document &&\n                     parent !== document.documentElement;\n  const visible = isOverflow ?\n                  checkOverflowVisible(component, parent) :\n                  checkNormalVisible(component);\n  if (visible) {\n    // Avoid extra render if previously is visible\n    if (!component.state.visible || component.state.hidden) {\n      if (component.props.once) {\n        pending.push(component);\n      }\n\n      //console.log('lazyload 1');\n      component.setState({\n        visible: true,\n        hidden: false,\n      });\n    }\n  } else if (!component.props.once) {\n    if (component.props.unmountIfInvisible) {\n      if(component.visible===true)\n        component.setState({\n          visible: false,\n        });\n    } else if(component.props.hiddenIfInvisible) {\n      if(component.state.hidden===false) {\n        //console.log('lazyload 3');\n        component.setState({\n          hidden: true,\n        });\n      }\n    }\n  }\n};\n\n\nconst purgePending = function purgePending() {\n  pending.forEach((component) => {\n    const index = listeners.indexOf(component);\n    if (index !== -1) {\n      listeners.splice(index, 1);\n    }\n  });\n\n  pending = [];\n};\n\nconst lazyLoadHandler = () => {\n  for (let i = 0; i < listeners.length; ++i) {\n    const listener = listeners[i];\n    checkVisible(listener);\n  }\n  // Remove `once` component in listeners\n  purgePending();\n};\n\n// Depending on component's props\nlet delayType;\nlet finalLazyLoadHandler = null;\n\nconst isString = string => typeof string === 'string';\n\nclass LazyLoad extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state={\n      visible: false,\n      hidden: false,\n    };\n  }\n\n  componentDidMount() {\n    // It's unlikely to change delay type on the fly, this is mainly\n    // designed for tests\n    let scrollport = window;\n    const {\n      scrollContainer,\n    } = this.props;\n    if (scrollContainer) {\n      if (isString(scrollContainer)) {\n        scrollport = scrollport.document.querySelector(scrollContainer);\n      }\n    }\n    const needResetFinalLazyLoadHandler = (this.props.debounce !== undefined && delayType === 'throttle')\n      || (delayType === 'debounce' && this.props.debounce === undefined);\n\n    if (needResetFinalLazyLoadHandler) {\n      off(scrollport, 'scroll', finalLazyLoadHandler, passiveEvent);\n      off(window, 'resize', finalLazyLoadHandler, passiveEvent);\n      finalLazyLoadHandler = null;\n    }\n\n    if (!finalLazyLoadHandler) {\n      if (this.props.debounce !== undefined) {\n        finalLazyLoadHandler = debounce(lazyLoadHandler, typeof this.props.debounce === 'number' ?\n                                                         this.props.debounce :\n                                                         300);\n        delayType = 'debounce';\n      } else if (this.props.throttle !== undefined) {\n        finalLazyLoadHandler = throttle(lazyLoadHandler, typeof this.props.throttle === 'number' ?\n                                                         this.props.throttle :\n                                                         300);\n        delayType = 'throttle';\n      } else {\n        finalLazyLoadHandler = lazyLoadHandler;\n      }\n    }\n\n    if (this.props.overflow) {\n      const parent = scrollParent(ReactDom.findDOMNode(this));\n      if (parent && typeof parent.getAttribute === 'function') {\n        const listenerCount = 1 + (+parent.getAttribute(LISTEN_FLAG));\n        if (listenerCount === 1) {\n          parent.addEventListener('scroll', finalLazyLoadHandler, passiveEvent);\n        }\n        parent.setAttribute(LISTEN_FLAG, listenerCount);\n      }\n    } else if (listeners.length === 0 || needResetFinalLazyLoadHandler) {\n      const { scroll, resize } = this.props;\n\n      if (scroll) {\n        on(scrollport, 'scroll', finalLazyLoadHandler, passiveEvent);\n      }\n\n      if (resize) {\n        on(window, 'resize', finalLazyLoadHandler, passiveEvent);\n      }\n    }\n\n    listeners.push(this);\n    checkVisible(this);\n  }\n\n  componentWillUnmount() {\n    if (this.props.overflow) {\n      const parent = scrollParent(ReactDom.findDOMNode(this));\n      if (parent && typeof parent.getAttribute === 'function') {\n        const listenerCount = (+parent.getAttribute(LISTEN_FLAG)) - 1;\n        if (listenerCount === 0) {\n          parent.removeEventListener('scroll', finalLazyLoadHandler, passiveEvent);\n          parent.removeAttribute(LISTEN_FLAG);\n        } else {\n          parent.setAttribute(LISTEN_FLAG, listenerCount);\n        }\n      }\n    }\n\n    const index = listeners.indexOf(this);\n    if (index !== -1) {\n      listeners.splice(index, 1);\n    }\n\n    if (listeners.length === 0 && typeof window !== 'undefined') {\n      off(window, 'resize', finalLazyLoadHandler, passiveEvent);\n      off(window, 'scroll', finalLazyLoadHandler, passiveEvent);\n    }\n  }\n\n  render() {\n    //console.log('lazyload render');\n    if(this.state.visible) {\n      if(this.props.hiddenIfInvisible)\n        return this.state.hidden ?\n            <div style={{visibility: 'hidden'}}>{this.props.children}</div> :\n            <div>{this.props.children}</div>;\n      else\n        return this.props.children;\n    }\n    else\n      return this.props.placeholder ?\n                this.props.placeholder :\n                <div style={{ height: this.props.height }} className=\"lazyload-placeholder\" />;\n  }\n}\n\nLazyLoad.propTypes = {\n  once: PropTypes.bool,\n  height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  offset: PropTypes.oneOfType([PropTypes.number, PropTypes.arrayOf(PropTypes.number)]),\n  overflow: PropTypes.bool,\n  resize: PropTypes.bool,\n  scroll: PropTypes.bool,\n  children: PropTypes.node,\n  throttle: PropTypes.oneOfType([PropTypes.number, PropTypes.bool]),\n  debounce: PropTypes.oneOfType([PropTypes.number, PropTypes.bool]),\n  placeholder: PropTypes.node,\n  scrollContainer: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\n  unmountIfInvisible: PropTypes.bool,\n  hiddenIfInvisible: PropTypes.bool,\n};\n\nLazyLoad.defaultProps = {\n  once: false,\n  offset: 0,\n  overflow: false,\n  resize: false,\n  scroll: true,\n  unmountIfInvisible: false,\n  hiddenIfInvisible: false,\n};\n\nconst getDisplayName = WrappedComponent => WrappedComponent.displayName || WrappedComponent.name || 'Component';\n\nconst decorator = (options = {}) => function lazyload(WrappedComponent) {\n  return class LazyLoadDecorated extends Component {\n    constructor() {\n      super();\n      this.displayName = `LazyLoad${getDisplayName(WrappedComponent)}`;\n    }\n\n    render() {\n      return (\n        <LazyLoad {...options}>\n          <WrappedComponent {...this.props} />\n        </LazyLoad>\n      );\n    }\n  };\n};\n\nexport { decorator as lazyload };\nexport default LazyLoad;\nexport { lazyLoadHandler as forceCheck };\n","export default function debounce(func, wait, immediate) {\n  let timeout;\n  let args;\n  let context;\n  let timestamp;\n  let result;\n\n  const later = function later() {\n    const last = +(new Date()) - timestamp;\n\n    if (last < wait && last >= 0) {\n      timeout = setTimeout(later, wait - last);\n    } else {\n      timeout = null;\n      if (!immediate) {\n        result = func.apply(context, args);\n        if (!timeout) {\n          context = null;\n          args = null;\n        }\n      }\n    }\n  };\n\n  return function debounced() {\n    context = this;\n    args = arguments;\n    timestamp = +(new Date());\n\n    const callNow = immediate && !timeout;\n    if (!timeout) {\n      timeout = setTimeout(later, wait);\n    }\n\n    if (callNow) {\n      result = func.apply(context, args);\n      context = null;\n      args = null;\n    }\n\n    return result;\n  };\n}\n","/*eslint-disable */\nexport default function throttle(fn, threshhold, scope) {\n  threshhold || (threshhold = 250);\n  var last,\n      deferTimer;\n  return function () {\n    var context = scope || this;\n\n    var now = +new Date,\n        args = arguments;\n    if (last && now < last + threshhold) {\n      // hold on to it\n      clearTimeout(deferTimer);\n      deferTimer = setTimeout(function () {\n        last = now;\n        fn.apply(context, args);\n      }, threshhold);\n    } else {\n      last = now;\n      fn.apply(context, args);\n    }\n  };\n}\n","import React, {Component} from 'react';\nimport load from 'load-script';\n\nwindow.audio_cache = {};\n\nfunction load_amrnb() {\n  return new Promise((resolve, reject) => {\n    if(window.AMR)\n      resolve();\n    else\n      load('static/amr_all.min.js', (err) => {\n        if(err)\n          reject(err);\n        else\n          resolve();\n      });\n  });\n}\n\nexport class AudioWidget extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      url: this.props.src,\n      state: 'waiting',\n      data: null,\n    };\n  }\n\n  load() {\n    if(window.audio_cache[this.state.url]) {\n      this.setState({\n        state: 'loaded',\n        data: window.audio_cache[this.state.url],\n      });\n      return;\n    }\n\n    console.log('fetching audio', this.state.url);\n    this.setState({\n      state: 'loading',\n    });\n    Promise.all([\n      fetch(this.state.url),\n      load_amrnb(),\n    ])\n      .then((res) => {\n        res[0].blob().then((blob) => {\n          const reader = new FileReader();\n          reader.onload = (event) => {\n            const raw = new window.AMR().decode(event.target.result);\n            if(!raw) {\n              alert('audio decoding failed');\n              return;\n            }\n            const wave = window.PCMData.encode({\n              sampleRate: 8000,\n              channelCount: 1,\n              bytesPerSample: 2,\n              data: raw\n            });\n            const binary_wave = new Uint8Array(wave.length);\n            for(let i = 0;i < wave.length;i++)\n              binary_wave[i] = wave.charCodeAt(i);\n\n            const objurl = URL.createObjectURL(new Blob([binary_wave], {type: 'audio/wav'}));\n            window.audio_cache[this.state.url] = objurl;\n            this.setState({\n              state: 'loaded',\n              data: objurl,\n            });\n          };\n          reader.readAsBinaryString(blob);\n        });\n        this.setState({\n          state: 'decoding',\n        });\n      });\n  }\n\n  render() {\n    if(this.state.state === 'waiting')\n      return (<p><a onClick={this.load.bind(this)}>加载音频</a></p>);\n    if(this.state.state === 'loading')\n      return (<p>正在下载……</p>);\n    else if(this.state.state === 'decoding')\n      return (<p>正在解码……</p>);\n    else if(this.state.state === 'loaded')\n      return (<p><audio src={this.state.data} controls /></p>);\n  }\n}","import React, {PureComponent} from 'react';\nimport {PKUHELPER_ROOT, get_json, API_VERSION_PARAM} from './flows_api';\nimport {Time} from './Common';\n\nexport class MessageViewer extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading_status: 'idle',\n      msg: [],\n    };\n  }\n\n  componentDidMount() {\n    this.load();\n  }\n\n  load() {\n    if(this.state.loading_status === 'loading') return;\n    this.setState({\n      loading_status: 'loading',\n    }, () => {\n      fetch(PKUHELPER_ROOT + 'api_xmcp/hole/system_msg?user_token=' + encodeURIComponent(this.props.token) + API_VERSION_PARAM())\n        .then(get_json)\n        .then((json) => {\n          if(json.error)\n            throw new Error(json.error);\n          else\n            this.setState({\n              loading_status: 'done',\n              msg: json.result,\n            });\n        })\n        .catch((err) => {\n          console.error(err);\n          alert('' + err);\n          this.setState({\n            loading_status: 'failed',\n          });\n        });\n\n    });\n  }\n\n  render() {\n    if(this.state.loading_status === 'loading')\n      return (<p className=\"box box-tip\">加载中……</p>);\n    else if(this.state.loading_status === 'failed')\n      return (<div className=\"box box-tip\"><a onClick={() => {this.load();}}>重新加载</a></div>);\n    else if(this.state.loading_status === 'done')\n      return this.state.msg.map((msg) => (\n        <div className=\"box\" key={msg.timestamp}>\n          <div className=\"box-header\">\n            <Time stamp={msg.timestamp} />\n            <b>{msg.title}</b>\n          </div>\n          <div className=\"box-content\">\n            <pre>{msg.content}</pre>\n          </div>\n        </div>\n      ));\n    else\n      return null;\n  }\n}\n","import React, {PureComponent} from 'react';\n\nimport './Config.css';\n\nconst BUILTIN_IMGS = {\n  'static/bg/gbp.jpg': '寻觅繁星（默认）',\n  'static/bg/eriri.jpg': '平成著名画师',\n  'static/bg/yurucamp.jpg': '露营天下第一',\n  'static/bg/minecraft.jpg': '麦恩·库拉夫特',\n  'static/bg/sif.jpg': '梦开始的地方',\n};\n\nconst DEFAULT_CONFIG = {\n  background_img: 'static/bg/gbp.jpg',\n  background_color: '#113366',\n  pressure: false,\n  easter_egg: true,\n  color_scheme: 'default',\n  block_words: ['xz', 'ao3', 'ghs']\n};\n\nexport function load_config() {\n  let config = Object.assign({}, DEFAULT_CONFIG);\n  let loaded_config;\n  try {\n    loaded_config = JSON.parse(localStorage['hole_config'] || '{}');\n  } catch(e) {\n    alert('设置加载失败，将重置为默认设置！\\n' + e);\n    delete localStorage['hole_config'];\n    loaded_config = {};\n  }\n\n  // unrecognized configs are removed\n  Object.keys(loaded_config).forEach((key) => {\n    if(config[key] !== undefined)\n      config[key] = loaded_config[key];\n  });\n\n  console.log('config loaded', config);\n  window.config = config;\n}\nexport function save_config() {\n  localStorage['hole_config'] = JSON.stringify(window.config);\n  load_config();\n}\n\nexport function bgimg_style(img, color) {\n  if(img === undefined) img = window.config.background_img;\n  if(color === undefined) color = window.config.background_color;\n  return {\n    background: 'transparent center center',\n    backgroundImage: img === null ? 'unset' : 'url(\"' + encodeURI(img) + '\")',\n    backgroundColor: color,\n    backgroundSize: 'cover',\n  };\n}\n\nclass ConfigBackground extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      img: window.config.background_img,\n      color: window.config.background_color,\n    };\n  }\n\n  save_changes() {\n    this.props.callback({\n      background_img: this.state.img,\n      background_color: this.state.color,\n    });\n  }\n\n  on_select(e) {\n    let value = e.target.value;\n    this.setState({\n      img: value === '##other' ? '' :\n        value === '##color' ? null : value,\n    }, this.save_changes.bind(this));\n  }\n  on_change_img(e) {\n    this.setState({\n      img: e.target.value,\n    }, this.save_changes.bind(this));\n  }\n  on_change_color(e) {\n    this.setState({\n      color: e.target.value,\n    }, this.save_changes.bind(this));\n  }\n\n  render() {\n    let img_select = this.state.img === null ? '##color' :\n      Object.keys(BUILTIN_IMGS).indexOf(this.state.img) === -1 ? '##other' : this.state.img;\n    return (\n      <div>\n        <p>\n          <b>背景图片：</b>\n          <select value={img_select} onChange={this.on_select.bind(this)}>\n            {Object.keys(BUILTIN_IMGS).map((key) => (\n              <option key={key} value={key}>{BUILTIN_IMGS[key]}</option>\n            ))}\n            <option value=\"##other\">输入图片网址……</option>\n            <option value=\"##color\">纯色背景……</option>\n          </select>\n                    &nbsp;\n          {img_select === '##other' &&\n            <input type=\"url\" placeholder=\"图片网址\" value={this.state.img} onChange={this.on_change_img.bind(this)} />\n          }\n          {img_select === '##color' &&\n            <input type=\"color\" value={this.state.color} onChange={this.on_change_color.bind(this)} />\n          }\n        </p>\n        <div className=\"bg-preview\" style={bgimg_style(this.state.img, this.state.color)} />\n      </div>\n    );\n  }\n}\n\nclass ConfigColorScheme extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      color_scheme: window.config.color_scheme,\n    };\n  }\n\n  save_changes() {\n    this.props.callback({\n      color_scheme: this.state.color_scheme,\n    });\n  }\n\n  on_select(e) {\n    let value = e.target.value;\n    this.setState({\n      color_scheme: value,\n    }, this.save_changes.bind(this));\n  }\n\n  render() {\n    return (\n      <div>\n        <p>\n          <b>夜间模式：</b>\n          <select value={this.state.color_scheme} onChange={this.on_select.bind(this)}>\n            <option value=\"default\">跟随系统</option>\n            <option value=\"light\">始终浅色模式</option>\n            <option value=\"dark\">始终深色模式</option>\n          </select>\n          <small>#color_scheme</small>\n        </p>\n        <p>\n          选择浅色或深色模式，深色模式下将会调暗图片亮度\n        </p>\n      </div>\n    );\n  }\n}\n\nclass ConfigBlockWords extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      block_words: window.config.block_words,\n    };\n  }\n\n  save_changes() {\n    this.props.callback({\n      block_words: this.state.block_words.filter(v => v),\n    });\n  }\n\n  on_change(e) {\n    // Filter out those blank lines\n    let value = e.target.value.split('\\n');\n    this.setState({\n      block_words: value,\n    }, this.save_changes.bind(this));\n  }\n\n  render() {\n    return (\n      <div>\n        <p> <b>设置屏蔽词 </b></p>\n        <p>\n          <textarea\n            className='block-words'\n            value={this.state.block_words.join('\\n')}\n            onChange={this.on_change.bind(this)}\n          />\n        </p>\n\n      </div>\n    );\n  }\n}\n\nclass ConfigSwitch extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      switch: window.config[this.props.id],\n    };\n  }\n\n  on_change(e) {\n    let val = e.target.checked;\n    this.setState({\n      switch: val,\n    }, () => {\n      this.props.callback({\n        [this.props.id]: val,\n      });\n    });\n  }\n\n  render() {\n    return (\n      <div>\n        <p>\n          <label>\n            <input name={'config-' + this.props.id} type=\"checkbox\" checked={this.state.switch} onChange={this.on_change.bind(this)} />\n            <b>{this.props.name}</b>\n            <small>#{this.props.id}</small>\n          </label>\n        </p>\n        <p>\n          {this.props.description}\n        </p>\n      </div>\n    );\n  }\n}\n\nexport class ConfigUI extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.save_changes_bound = this.save_changes.bind(this);\n  }\n\n  save_changes(chg) {\n    console.log(chg);\n    Object.keys(chg).forEach((key) => {\n      window.config[key] = chg[key];\n    });\n    save_config();\n  }\n\n  reset_settings() {\n    if(window.confirm('重置所有设置？')) {\n      window.config = {};\n      save_config();\n      window.location.reload();\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <div className=\"box config-ui-header\">\n          <p>这些功能仍在测试，可能不稳定（<a onClick={this.reset_settings.bind(this)}>全部重置</a>）</p>\n          <p><b>修改设置后 <a onClick={() => {window.location.reload();}}>刷新页面</a> 方可生效</b></p>\n        </div>\n        <div className=\"box\">\n          <ConfigBackground callback={this.save_changes_bound} />\n          <hr />\n          <ConfigColorScheme callback={this.save_changes_bound} />\n          <hr />\n          <ConfigBlockWords callback={this.save_changes_bound} />\n          <hr />\n          <ConfigSwitch callback={this.save_changes_bound} id=\"pressure\" name=\"快速返回\"\n            description=\"短暂按住 Esc 键或重压屏幕（3D Touch）可以快速返回或者刷新树洞\"\n          />\n          <hr />\n          <ConfigSwitch callback={this.save_changes_bound} id=\"easter_egg\" name=\"允许彩蛋\"\n            description=\"在某些情况下显示彩蛋\"\n          />\n          <hr />\n          <p>\n            新功能建议或问题反馈请在&nbsp;\n            <a href=\"https://github.com/pkuhelper-web/webhole/issues\" target=\"_blank\">GitHub <span className=\"icon icon-github\" /></a>\n                        &nbsp;提出。\n          </p>\n        </div>\n      </div>\n    );\n  }\n}\n","import React, {Component} from 'react';\nimport {API_BASE, SafeTextarea, PromotionBar} from './Common';\nimport {MessageViewer} from './Message';\nimport {LoginPopup} from './infrastructure/widgets';\nimport {ConfigUI} from './Config';\nimport fixOrientation from 'fix-orientation';\nimport copy from 'copy-to-clipboard';\nimport {cache} from './cache';\nimport {API_VERSION_PARAM, PKUHELPER_ROOT, get_json, token_param} from './flows_api';\n\nimport './UserAction.css';\n\nconst BASE64_RATE = 4 / 3;\nconst MAX_IMG_DIAM = 8000;\nconst MAX_IMG_PX = 5000000;\nconst MAX_IMG_FILESIZE = 450000 * BASE64_RATE;\n\nexport const TokenCtx = React.createContext({\n  value: null,\n  set_value: () => {},\n});\n\nclass LifeInfoBox extends Component {\n  constructor(props) {\n    super(props);\n    if(!window._life_info_cache)\n      window._life_info_cache = {};\n    this.CACHE_TIMEOUT_S = 15;\n    this.state = {\n      today_info: this.cache_get('today_info'),\n      card_balance: this.cache_get('card_balance'),\n      net_balance: this.cache_get('net_balance'),\n      mail_count: this.cache_get('mail_count'),\n    };\n    this.INTERNAL_NETWORK_FAILURE = '_network_failure';\n    this.API_NAME = {\n      today_info: 'hole/today_info',\n      card_balance: 'isop/card_balance',\n      net_balance: 'isop/net_balance',\n      mail_count: 'isop/mail_count',\n    };\n  }\n\n  cache_get(key) {\n    let cache_item = window._life_info_cache[key];\n    if(!cache_item || (+new Date()) - cache_item[0] > 1000 * this.CACHE_TIMEOUT_S)\n      return null;\n    else\n      return cache_item[1];\n  }\n  cache_set(key, value) {\n    if(!window._life_info_cache[key] || window._life_info_cache[key][1] !== value)\n      window._life_info_cache[key] = [+new Date(), value];\n  }\n\n  load(state_key) {\n    this.setState({\n      [state_key]: null,\n    }, () => {\n      fetch(\n        PKUHELPER_ROOT + 'api_xmcp/' + this.API_NAME[state_key]\n                + '?user_token=' + encodeURIComponent(this.props.token)\n                + API_VERSION_PARAM()\n      )\n        .then(get_json)\n        .then((json) => {\n          //console.log(json);\n          this.setState({\n            [state_key]: json,\n          });\n        })\n        .catch((e) => {\n          this.setState({\n            [state_key]: {\n              errMsg: '网络错误 ' + e,\n              errCode: this.INTERNAL_NETWORK_FAILURE,\n              success: false,\n            }\n          });\n        });\n    });\n  }\n\n  componentDidMount() {\n    ['today_info', 'card_balance', 'net_balance', 'mail_count'].forEach((k) => {\n      if(!this.state[k])\n        this.load(k);\n    });\n  }\n\n  reload_all() {\n    ['today_info', 'card_balance', 'net_balance', 'mail_count'].forEach((k) => {\n      this.load(k);\n    });\n  }\n\n  render_line(state_key, title, value_fn, action, url_fn, do_login) {\n    let s = this.state[state_key];\n    if(!s)\n      return (\n        <tr>\n          <td>{title}</td>\n          <td>加载中……</td>\n          <td />\n        </tr>\n      );\n    else if(!s.success) {\n      let type = '加载失败';\n      if(s.errCode === this.INTERNAL_NETWORK_FAILURE)\n        type = '网络错误';\n      else if(['E01', 'E02', 'E03'].indexOf(s.errCode) !== -1)\n        type = '授权失效';\n\n      let details = JSON.stringify(s);\n      if(s.errMsg)\n        details = s.errMsg;\n      else if(s.error)\n        details = s.error;\n\n      return (\n        <tr>\n          <td>{title}</td>\n          <td className=\"life-info-error\">\n            <a onClick={() => alert(details)}>{type}</a>\n          </td>\n          <td>\n            {type === '授权失效' ?\n              <a onClick={do_login}>\n                <span className=\"icon icon-forward\" />&nbsp;重新登录\n              </a> :\n              <a onClick={() => this.load(state_key)}>\n                <span className=\"icon icon-forward\" />&nbsp;重试\n              </a>\n            }\n          </td>\n        </tr>\n      );\n    }\n    else {\n      this.cache_set(state_key, s);\n\n      return (\n        <tr>\n          <td>{title}</td>\n          <td>{value_fn(s)}</td>\n          <td>\n            <a href={url_fn(s)} target=\"_blank\">\n              <span className=\"icon icon-forward\" />&nbsp;{action}\n            </a>\n          </td>\n        </tr>\n      );\n    }\n  }\n\n  render() {\n    return (\n      <LoginPopup token_callback={(t) => {\n        this.props.set_token(t);\n        this.reload_all();\n      }}>{\n          (do_login) => (\n            <div className=\"box\">\n              <table className=\"life-info-table\">\n                <tbody>\n                  {this.render_line(\n                    'today_info',\n                    '今日', (s) => s.info,\n                    '校历', (s) => s.schedule_url,\n                    do_login,\n                  )}\n                  {this.render_line(\n                    'card_balance',\n                    '校园卡', (s) => `余额￥${s.balance.toFixed(2)}`,\n                    '充值', () => 'https://virtualprod.alipay.com/educate/educatePcRecharge.htm?schoolCode=PKU&schoolName=',\n                    do_login,\n                  )}\n                  {this.render_line(\n                    'net_balance',\n                    '网费', (s) => `余额￥${s.balance.toFixed(2)}`,\n                    '充值', () => 'https://its.pku.edu.cn/epay.jsp',\n                    do_login,\n                  )}\n                  {this.render_line(\n                    'mail_count',\n                    '邮件', (s) => `未读 ${s.count} 封`,\n                    '查看', () => 'https://mail.pku.edu.cn/',\n                    do_login,\n                  )}\n                </tbody>\n              </table>\n            </div>\n          )}</LoginPopup>\n    );\n  }\n}\n\nexport function InfoSidebar(props) {\n  return (\n    <div>\n      <PromotionBar />\n      <LoginForm show_sidebar={props.show_sidebar} />\n      <div className=\"box list-menu\">\n        <a onClick={() => {props.show_sidebar(\n          '设置',\n          <ConfigUI />\n        );}}>\n          <span className=\"icon icon-settings\" /><label>网页版树洞设置</label>\n        </a>\n                &nbsp;&nbsp;\n        <a href=\"http://pkuhelper.pku.edu.cn/treehole_rules.html\" target=\"_blank\">\n          <span className=\"icon icon-textfile\" /><label>树洞规范</label>\n        </a>\n                &nbsp;&nbsp;\n        <a href=\"https://github.com/AllanChain/PKUHoleCommunity/issues\" target=\"_blank\">\n          <span className=\"icon icon-github\" /><label>意见反馈</label>\n        </a>\n      </div>\n      <div className=\"box help-desc-box\">\n        <p>\n          PKUHelper 网页版树洞社区版 by @xmcp, and awesome community.\n          基于&nbsp;\n          <a href=\"https://www.gnu.org/licenses/gpl-3.0.zh-cn.html\" target=\"_blank\">GPLv3</a>\n                    &nbsp;协议在 <a href=\"https://github.com/AllanChain/PKUHoleCommunity\" target=\"_blank\">GitHub</a> 开源\n        </p>\n        <p>\n          PKUHelper 网页版的诞生离不开&nbsp;\n          <a href=\"https://reactjs.org/\" target=\"_blank\" rel=\"noopener\">React</a>\n          、\n          <a href=\"https://icomoon.io/#icons\" target=\"_blank\" rel=\"noopener\">IcoMoon</a>\n                    &nbsp;等开源项目\n        </p>\n        <p>\n          PKU Helper 的“同意”\n        </p>\n        <blockquote>\n          <p>\n            根据 GPL，你有权 fork【网页版树洞前端】的代码并进行相应的修改。\n            请注意，你的修改版本必须依然基于 GPL 授权，并依据此公开源码。\n          </p>\n          <p>\n            根据树洞规范 5.3 规定，非官方客户端在 PKU Helper 团队认定造成不利影响，\n            例如非法攻击服务器、盗取用户个人信息时，我们有权对其进行封禁。\n          </p>\n        </blockquote>\n        <p>\n          用户需对不恰当使用此版本或利用此版本的漏洞对 PKU Helper 造成的不利影响承担风险。\n          作为社区版本，社区（no warranty）维护版本的安全，同时也欢迎同学实现你的想法。\n        </p>\n        <p>\n          <a onClick={() => {\n            if('serviceWorker' in navigator) {\n              navigator.serviceWorker.getRegistrations()\n                .then((registrations) => {\n                  for(let registration of registrations) {\n                    console.log('unregister', registration);\n                    registration.unregister();\n                  }\n                });\n            }\n            cache().clear();\n            setTimeout(() => {\n              window.location.reload(true);\n            }, 200);\n          }}>强制检查更新</a>\n          （Community v{process.env.REACT_APP_VERSION || '---'} {process.env.NODE_ENV} 会自动在后台检查更新并在下次访问时更新）\n        </p>\n      </div>\n    </div>\n  );\n}\n\nclass ResetUsertokenWidget extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading_status: 'done',\n    };\n  }\n\n  do_reset() {\n    if(window.confirm('您正在重置 UserToken！\\n您的账号将会在【所有设备】上注销，您需要手动重新登录！')) {\n      let uid = window.prompt('您正在重置 UserToken！\\n请输入您的学号以确认身份：');\n      if(uid)\n        this.setState({\n          loading_status: 'loading',\n        }, () => {\n          fetch(PKUHELPER_ROOT + 'api_xmcp/hole/reset_usertoken', {\n            method: 'post',\n            headers: {\n              'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n              user_token: this.props.token,\n              uid: uid,\n            }),\n          })\n            .then(get_json)\n            .then((json) => {\n              if(json.error)\n                throw new Error(json.error);\n              else\n                alert('重置成功！您需要在所有设备上重新登录。');\n\n              this.setState({\n                loading_status: 'done',\n              });\n            })\n            .catch((e) => {\n              alert('重置失败：' + e);\n              this.setState({\n                loading_status: 'done',\n              });\n            });\n        });\n    }\n  }\n\n  render() {\n    if(this.state.loading_status === 'done')\n      return (<a onClick={this.do_reset.bind(this)}>重置</a>);\n    else if(this.state.loading_status === 'loading')\n      return (<a><span className=\"icon icon-loading\" /></a>);\n  }\n}\n\nexport class LoginForm extends Component {\n  copy_token(token) {\n    if(copy(token))\n      alert('复制成功！\\n请一定不要泄露哦');\n  }\n\n  render() {\n    return (\n      <TokenCtx.Consumer>{(token) =>\n        <div>\n          {!!token.value &&\n            <LifeInfoBox token={token.value} set_token={token.set_value} />\n          }\n          <div className=\"login-form box\">\n            {token.value ?\n              <div>\n                <p>\n                  <b>您已登录。</b>\n                  <button type=\"button\" onClick={() => {token.set_value(null);}}>\n                    <span className=\"icon icon-logout\" /> 注销\n                  </button>\n                  <br />\n                </p>\n                <p>\n                  根据计算中心要求，访问授权三个月内有效，过期需重新登录。\n                </p>\n                <p>\n                  <a onClick={() => {this.props.show_sidebar(\n                    '系统消息',\n                    <MessageViewer token={token.value} />\n                  );}}>查看系统消息</a><br />\n                  当您发送的内容违规时，我们将用系统消息提示您\n                </p>\n                <p>\n                  <a onClick={this.copy_token.bind(this, token.value)}>复制 User Token</a><br />\n                  User Token 用于迁移登录状态，切勿告知他人，若怀疑被盗号请尽快 <ResetUsertokenWidget token={token.value} />\n                </p>\n              </div> :\n              <LoginPopup token_callback={token.set_value}>{(do_popup) => (\n                <div>\n                  <p>\n                    <button type=\"button\" onClick={do_popup}>\n                      <span className=\"icon icon-login\" />\n                                            &nbsp;登录\n                    </button>\n                  </p>\n                  <p><small>\n                    PKU Helper 面向北京大学学生，通过 ISOP（北京大学数据共享开放服务平台）验证您的身份并提供服务。\n                  </small></p>\n                </div>\n              )}</LoginPopup>\n            }\n          </div>\n        </div>\n      }</TokenCtx.Consumer>\n    );\n  }\n}\n\nexport class ReplyForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      text: '',\n      loading_status: 'done',\n    };\n    this.on_change_bound = this.on_change.bind(this);\n    this.area_ref = this.props.area_ref || React.createRef();\n    this.global_keypress_handler_bound = this.global_keypress_handler.bind(this);\n  }\n\n  global_keypress_handler(e) {\n    if(e.code === 'Enter' && !e.ctrlKey && !e.altKey && ['input', 'textarea'].indexOf(e.target.tagName.toLowerCase()) === -1) {\n      if(this.area_ref.current) {\n        e.preventDefault();\n        this.area_ref.current.focus();\n      }\n    }\n  }\n  componentDidMount() {\n    document.addEventListener('keypress', this.global_keypress_handler_bound);\n  }\n  componentWillUnmount() {\n    document.removeEventListener('keypress', this.global_keypress_handler_bound);\n  }\n\n  on_change(value) {\n    this.setState({\n      text: value,\n    });\n  }\n\n  on_submit(event) {\n    if(event) event.preventDefault();\n    if(this.state.loading_status === 'loading')\n      return;\n    this.setState({\n      loading_status: 'loading',\n    });\n\n    let data = new URLSearchParams();\n    data.append('pid', this.props.pid);\n    data.append('text', this.state.text);\n    data.append('user_token', this.props.token);\n    fetch(API_BASE + '/api.php?action=docomment' + token_param(this.props.token), {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      body: data,\n    })\n      .then(get_json)\n      .then((json) => {\n        if(json.code !== 0) {\n          if(json.msg) alert(json.msg);\n          throw new Error(JSON.stringify(json));\n        }\n\n        this.setState({\n          loading_status: 'done',\n          text: '',\n        });\n        this.area_ref.current.clear();\n        this.props.on_complete();\n      })\n      .catch((e) => {\n        console.error(e);\n        alert('回复失败');\n        this.setState({\n          loading_status: 'done',\n        });\n      });\n  }\n\n  render() {\n    return (\n      <form onSubmit={this.on_submit.bind(this)} className={'reply-form box' + (this.state.text ? ' reply-sticky' : '')}>\n        <SafeTextarea key={this.props.pid} ref={this.area_ref} id={this.props.pid} on_change={this.on_change_bound} on_submit={this.on_submit.bind(this)} />\n        {this.state.loading_status === 'loading' ?\n          <button disabled=\"disabled\">\n            <span className=\"icon icon-loading\" />\n          </button> :\n          <button type=\"submit\">\n            <span className=\"icon icon-send\" />\n          </button>\n        }\n      </form>\n    );\n  }\n}\n\nexport class PostForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      text: '',\n      loading_status: 'done',\n      img_tip: null,\n    };\n    this.img_ref = React.createRef();\n    this.area_ref = React.createRef();\n    this.on_change_bound = this.on_change.bind(this);\n    this.on_img_change_bound = this.on_img_change.bind(this);\n  }\n\n  componentDidMount() {\n    if(this.area_ref.current)\n      this.area_ref.current.focus();\n  }\n\n  on_change(value) {\n    this.setState({\n      text: value,\n    });\n  }\n\n  do_post(text, img) {\n    let data = new URLSearchParams();\n    data.append('text', this.state.text);\n    data.append('type', img ? 'image' : 'text');\n    data.append('user_token', this.props.token);\n    if(img)\n      data.append('data', img);\n\n    fetch(API_BASE + '/api.php?action=dopost' + token_param(this.props.token), {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      body: data,\n    })\n      .then(get_json)\n      .then((json) => {\n        if(json.code !== 0) {\n          if(json.msg) alert(json.msg);\n          throw new Error(JSON.stringify(json));\n        }\n\n        this.setState({\n          loading_status: 'done',\n          text: '',\n        });\n        this.area_ref.current.clear();\n        this.props.on_complete();\n      })\n      .catch((e) => {\n        console.error(e);\n        alert('发表失败');\n        this.setState({\n          loading_status: 'done',\n        });\n      });\n  }\n\n  proc_img(file) {\n    return new Promise((resolve, reject) => {\n      function return_url(url) {\n        const idx = url.indexOf(';base64,');\n        if(idx === -1)\n          throw new Error('img not base64 encoded');\n\n        return url.substr(idx + 8);\n      }\n\n      let reader = new FileReader();\n      function on_got_img(url) {\n        const image = new Image();\n        image.onload = (() => {\n          let width = image.width;\n          let height = image.height;\n          let compressed = false;\n\n          if(width > MAX_IMG_DIAM) {\n            height = height * MAX_IMG_DIAM / width;\n            width = MAX_IMG_DIAM;\n            compressed = true;\n          }\n          if(height > MAX_IMG_DIAM) {\n            width = width * MAX_IMG_DIAM / height;\n            height = MAX_IMG_DIAM;\n            compressed = true;\n          }\n          if(height * width > MAX_IMG_PX) {\n            let rate = Math.sqrt(height * width / MAX_IMG_PX);\n            height /= rate;\n            width /= rate;\n            compressed = true;\n          }\n          console.log('chosen img size', width, height);\n\n          let canvas = document.createElement('canvas');\n          let ctx = canvas.getContext('2d');\n          canvas.width = width;\n          canvas.height = height;\n          ctx.drawImage(image, 0, 0, width, height);\n\n          let quality_l = .1, quality_r = .9, quality, new_url;\n          while(quality_r - quality_l >= .03) {\n            quality = (quality_r + quality_l) / 2;\n            new_url = canvas.toDataURL('image/jpeg', quality);\n            console.log(quality_l, quality_r, 'trying quality', quality, 'size', new_url.length);\n            if(new_url.length <= MAX_IMG_FILESIZE)\n              quality_l = quality;\n            else\n              quality_r = quality;\n          }\n          if(quality_l >= .101) {\n            console.log('chosen img quality', quality);\n            resolve({\n              img: return_url(new_url),\n              quality: quality,\n              width: Math.round(width),\n              height: Math.round(height),\n              compressed: compressed,\n            });\n          } else {\n            reject('图片过大，无法上传');\n          }\n        });\n        image.src = url;\n      }\n      reader.onload = (event) => {\n        fixOrientation(event.target.result, {}, (fixed_dataurl) => {\n          on_got_img(fixed_dataurl);\n        });\n      };\n      reader.readAsDataURL(file);\n    });\n  }\n\n  on_img_change() {\n    if(this.img_ref.current && this.img_ref.current.files.length)\n      this.setState({\n        img_tip: '（正在处理图片……）'\n      }, () => {\n        this.proc_img(this.img_ref.current.files[0])\n          .then((d) => {\n            this.setState({\n              img_tip: `（${d.compressed ? '压缩到' : '尺寸'} ${d.width}*${d.height} / ` +\n                                `质量 ${Math.floor(d.quality * 100)}% / ${Math.floor(d.img.length / BASE64_RATE / 1000)}KB）`,\n            });\n          })\n          .catch((e) => {\n            this.setState({\n              img_tip: `图片无效：${e}`,\n            });\n          });\n      });\n    else\n      this.setState({\n        img_tip: null,\n      });\n  }\n\n  on_submit(event) {\n    if(event) event.preventDefault();\n    if(this.state.loading_status === 'loading')\n      return;\n    if(this.img_ref.current.files.length) {\n      this.setState({\n        loading_status: 'processing',\n      });\n      this.proc_img(this.img_ref.current.files[0])\n        .then((d) => {\n          this.setState({\n            loading_status: 'loading',\n          });\n          this.do_post(this.state.text, d.img);\n        })\n        .catch((e) => {\n          alert(e);\n        });\n    } else {\n      this.setState({\n        loading_status: 'loading',\n      });\n      this.do_post(this.state.text, null);\n    }\n  }\n\n  render() {\n    return (\n      <form onSubmit={this.on_submit.bind(this)} className=\"post-form box\">\n        <div className=\"post-form-bar\">\n          <label>\n            图片\n            <input ref={this.img_ref} type=\"file\" accept=\"image/*\" disabled={this.state.loading_status !== 'done'}\n              onChange={this.on_img_change_bound}\n            />\n          </label>\n          {this.state.loading_status !== 'done' ?\n            <button disabled=\"disabled\">\n              <span className=\"icon icon-loading\" />\n                            &nbsp;正在{this.state.loading_status === 'processing' ? '处理' : '上传'}\n            </button> :\n            <button type=\"submit\">\n              <span className=\"icon icon-send\" />\n                            &nbsp;发表\n            </button>\n          }\n        </div>\n        {!!this.state.img_tip &&\n          <p className=\"post-form-img-tip\">\n            <a onClick={() => {this.img_ref.current.value = ''; this.on_img_change();}}>删除图片</a>\n            {this.state.img_tip}\n          </p>\n        }\n        <SafeTextarea ref={this.area_ref} id=\"new_post\" on_change={this.on_change_bound} on_submit={this.on_submit.bind(this)} />\n        <p><small>\n          请遵守<a href=\"http://pkuhelper.pku.edu.cn/treehole_rules.html\" target=\"_blank\">树洞管理规范</a>，文明发言\n        </small></p>\n      </form>\n    );\n  }\n}\n","import React, {PureComponent} from 'react';\nimport copy from 'copy-to-clipboard';\nimport {ColorPicker} from './color_picker';\nimport {split_text, NICKNAME_RE, PID_RE, URL_RE, URL_PID_RE} from './text_splitter';\nimport {format_time, build_highlight_re, Time, TitleLine, HighlightedText, ClickHandler, ColoredSpan} from './Common';\nimport './Flows.css';\nimport LazyLoad from './react-lazyload/src';\nimport {AudioWidget} from './AudioWidget';\nimport {TokenCtx, ReplyForm} from './UserAction';\n\nimport {API, PKUHELPER_ROOT} from './flows_api';\n\nconst IMAGE_BASE = PKUHELPER_ROOT + 'services/pkuhole/images/';\nconst AUDIO_BASE = PKUHELPER_ROOT + 'services/pkuhole/audios/';\n\nconst CLICKABLE_TAGS = {a: true, audio: true};\nconst PREVIEW_REPLY_COUNT = 10;\nconst QUOTE_BLACKLIST = ['23333', '233333', '66666', '666666', '10086', '10000', '100000', '99999', '999999', '55555', '555555'];\n\nwindow.LATEST_POST_ID = parseInt(localStorage['_LATEST_POST_ID'], 10) || 0;\n\nconst DZ_NAME = '洞主';\n\nfunction load_single_meta(show_sidebar, token) {\n  return async (pid, replace = false) => {\n    let color_picker = new ColorPicker();\n    let title_elem = '树洞 #' + pid;\n    show_sidebar(\n      title_elem,\n      <div className=\"box box-tip\">\n        正在加载 #{pid}\n      </div>,\n      replace ? 'replace' : 'push'\n    );\n    try {\n      let single = await API.get_single(pid, token);\n      single.data.variant = {};\n      let {data: replies} = await API.load_replies_with_cache(\n        pid, token, color_picker, parseInt(single.data.reply)\n      );\n      show_sidebar(\n        title_elem,\n        <FlowSidebar key={+new Date()}\n          info={single.data} replies={replies.data} attention={replies.attention}\n          token={token} show_sidebar={show_sidebar} color_picker={color_picker}\n          deletion_detect={localStorage['DELETION_DETECT'] === 'on'}\n        />,\n        'replace'\n      );\n    } catch(e) {\n      console.error(e);\n      show_sidebar(\n        title_elem,\n        <div className=\"box box-tip\">\n          <p><a onClick={() => load_single_meta(show_sidebar, token)(pid, true)}>重新加载</a></p>\n          <p>{'' + e}</p>\n        </div>,\n        'replace'\n      );\n    }\n  };\n}\n\nclass Reply extends PureComponent {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let parts = split_text(this.props.info.text, [\n      ['url_pid', URL_PID_RE],\n      ['url', URL_RE],\n      ['pid', PID_RE],\n      ['nickname', NICKNAME_RE],\n    ]);\n\n    return (\n      <div className={'flow-reply box'} style={this.props.info._display_color ? {\n        '--box-bgcolor-light': this.props.info._display_color[0],\n        '--box-bgcolor-dark': this.props.info._display_color[1],\n      } : null}>\n        <div className=\"box-header\">\n          <code className=\"box-id\">#{this.props.info.cid}</code>\n          {!!this.props.do_filter_name &&\n            <span className=\"reply-header-badge clickable\" onClick={() => {this.props.do_filter_name(this.props.info.name);}}>\n              <span className=\"icon icon-locate\" />\n            </span>\n          }\n                    &nbsp;\n          {this.props.info.tag !== null &&\n            <span className=\"box-header-tag\">\n              {this.props.info.tag}\n            </span>\n          }\n          <Time stamp={this.props.info.timestamp} />\n        </div>\n        <div className=\"box-content\">\n          <HighlightedText parts={parts} color_picker={this.props.color_picker} show_pid={this.props.show_pid} />\n        </div>\n      </div>\n    );\n  }\n}\n\nclass FlowItem extends PureComponent {\n  constructor(props) {\n    super(props);\n  }\n\n  copy_link(event) {\n    event.preventDefault();\n    copy(\n      `${event.target.href}${this.props.info.tag ? ' 【' + this.props.info.tag + '】' : ''}\\n` +\n            `${this.props.info.text}${this.props.info.type === 'image' ? ' [图片]' : this.props.info.type === 'audio' ? ' [语音]' : ''}\\n` +\n            `（${format_time(new Date(this.props.info.timestamp * 1000))} ${this.props.info.likenum}关注 ${this.props.info.reply}回复）\\n` +\n            this.props.replies.map((r) => (\n              (r.tag ? '【' + r.tag + '】' : '') +\n                r.text\n            )).join('\\n')\n    );\n  }\n\n  render() {\n    let props = this.props;\n    let parts = props.parts || split_text(props.info.text, [\n      ['url_pid', URL_PID_RE],\n      ['url', URL_RE],\n      ['pid', PID_RE],\n      ['nickname', NICKNAME_RE],\n    ]);\n    return (\n      <div className={'flow-item' + (props.is_quote ? ' flow-item-quote' : '')}>\n        {!!props.is_quote &&\n          <div className=\"quote-tip black-outline\">\n            <div><span className=\"icon icon-quote\" /></div>\n            <div><small>提到</small></div>\n          </div>\n        }\n        <div className=\"box\">\n          {!!window.LATEST_POST_ID && parseInt(props.info.pid, 10) > window.LATEST_POST_ID &&\n            <div className=\"flow-item-dot\" />\n          }\n          {!!this.props.attention && !this.props.cached && <div className=\"flow-item-dot\" />}\n          <div className=\"box-header\">\n            {!!this.props.do_filter_name &&\n              <span className=\"reply-header-badge clickable\" onClick={() => {this.props.do_filter_name(DZ_NAME);}}>\n                <span className=\"icon icon-locate\" />\n              </span>\n            }\n            {!!parseInt(props.info.likenum, 10) &&\n              <span className=\"box-header-badge\">\n                {props.info.likenum}&nbsp;\n                <span className={'icon icon-' + (props.attention ? 'star-ok' : 'star')} />\n              </span>\n            }\n            {!!parseInt(props.info.reply, 10) &&\n              <span className=\"box-header-badge\">\n                {props.info.reply}&nbsp;\n                <span className=\"icon icon-reply\" />\n              </span>\n            }\n            <code className=\"box-id\"><a href={'##' + props.info.pid} onClick={this.copy_link.bind(this)}>#{props.info.pid}</a></code>\n                        &nbsp;\n            {props.info.tag !== null &&\n              <span className=\"box-header-tag\">\n                {props.info.tag}\n              </span>\n            }\n            <Time stamp={props.info.timestamp} />\n          </div>\n          <div className=\"box-content\">\n            <HighlightedText parts={parts} color_picker={props.color_picker} show_pid={props.show_pid} />\n            {props.info.type === 'image' &&\n              <p className=\"img\">\n                {props.img_clickable ?\n                  <a className=\"no-underline\" href={IMAGE_BASE + props.info.url} target=\"_blank\"><img src={IMAGE_BASE + props.info.url} /></a> :\n                  <img src={IMAGE_BASE + props.info.url} />\n                }\n              </p>\n            }\n            {props.info.type === 'audio' && <AudioWidget src={AUDIO_BASE + props.info.url} />}\n          </div>\n          {!!(props.attention && props.info.variant.latest_reply) &&\n            <p className=\"box-footer\">最新回复 <Time stamp={props.info.variant.latest_reply} /></p>\n          }\n        </div>\n      </div>\n    );\n  }\n}\n\nclass FlowSidebar extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      attention: props.attention,\n      info: props.info,\n      replies: props.replies,\n      loading_status: 'done',\n      error_msg: null,\n      filter_name: null,\n      rev: false,\n    };\n    this.color_picker = props.color_picker;\n    this.syncState = props.sync_state || (() => {});\n    this.reply_ref = React.createRef();\n  }\n\n  set_variant(cid, variant) {\n    this.setState((prev) => {\n      if(cid)\n        return {\n          replies: prev.replies.map((reply) => {\n            if(reply.cid === cid)\n              return Object.assign({}, reply, {variant: Object.assign({}, reply.variant, variant)});\n            else\n              return reply;\n          }),\n        };\n      else\n        return {\n          info: Object.assign({}, prev.info, {variant: Object.assign({}, prev.info.variant, variant)}),\n        };\n    }, function() {\n      this.syncState({\n        info: this.state.info,\n        replies: this.state.replies,\n      });\n    });\n  }\n\n  load_replies(update_count = true) {\n    this.setState({\n      loading_status: 'loading',\n      error_msg: null,\n    });\n    API.load_replies(this.state.info.pid, this.props.token, this.color_picker, null)\n      .then((json) => {\n        this.setState((prev, props) => ({\n          replies: json.data,\n          info: update_count ? Object.assign({}, prev.info, {\n            reply: '' + json.data.length,\n          }) : prev.info,\n          attention: !!json.attention,\n          loading_status: 'done',\n          error_msg: null,\n        }), () => {\n          this.syncState({\n            replies: this.state.replies,\n            attention: this.state.attention,\n            info: this.state.info,\n          });\n          if(this.state.replies.length)\n            this.set_variant(null, {latest_reply: Math.max.apply(null, this.state.replies.map((r) => parseInt(r.timestamp)))});\n        });\n      })\n      .catch((e) => {\n        console.error(e);\n        this.setState({\n          replies: [],\n          loading_status: 'done',\n          error_msg: '' + e,\n        });\n      });\n  }\n\n  toggle_attention() {\n    this.setState({\n      loading_status: 'loading',\n    });\n    const next_attention = !this.state.attention;\n    API.set_attention(this.state.info.pid, next_attention, this.props.token)\n      .then((json) => {\n        this.setState({\n          loading_status: 'done',\n          attention: next_attention,\n        });\n        this.syncState({\n          attention: next_attention,\n        });\n      })\n      .catch((e) => {\n        this.setState({\n          loading_status: 'done'\n        });\n        alert('设置关注失败');\n        console.error(e);\n      });\n  }\n\n  report() {\n    let reason = prompt(`举报 #${this.state.info.pid} 的理由：`);\n    if(reason !== null) {\n      API.report(this.state.info.pid, reason, this.props.token)\n        .then((json) => {\n          alert('举报成功');\n        })\n        .catch((e) => {\n          alert('举报失败');\n          console.error(e);\n        });\n    }\n  }\n\n  set_filter_name(name) {\n    this.setState((prevState) => ({\n      filter_name: name === prevState.filter_name ? null : name,\n    }));\n  }\n\n  toggle_rev() {\n    this.setState((prevState) => ({\n      rev: !prevState.rev,\n    }));\n  }\n\n  show_reply_bar(name, event) {\n    if(this.reply_ref.current && !event.target.closest('a, .clickable')) {\n      let text = this.reply_ref.current.get();\n      if(/^\\s*(?:Re (?:|洞主|(?:[A-Z][a-z]+ )?(?:[A-Z][a-z]+)|You Win(?: \\d+)?):)?\\s*$/.test(text)) {// text is nearly empty so we can replace it\n        let should_text = 'Re ' + name + ': ';\n        if(should_text === this.reply_ref.current.get())\n          this.reply_ref.current.set('');\n        else\n          this.reply_ref.current.set(should_text);\n      }\n    }\n  }\n\n  render() {\n    if(this.state.loading_status === 'loading')\n      return (<p className=\"box box-tip\">加载中……</p>);\n\n    let show_pid = load_single_meta(this.props.show_sidebar, this.props.token);\n\n    let replies_to_show = this.state.filter_name ? this.state.replies.filter((r) => r.name === this.state.filter_name) : this.state.replies.slice();\n    if(this.state.rev) replies_to_show.reverse();\n\n    // key for lazyload elem\n    let view_mode_key = (this.state.rev ? 'y-' : 'n-') + (this.state.filter_name || 'null');\n\n    let replies_cnt = {[DZ_NAME]:1};\n    replies_to_show.forEach((r) => {\n      if(replies_cnt[r.name] === undefined)\n        replies_cnt[r.name] = 0;\n      replies_cnt[r.name]++;\n    });\n\n    // hide main thread when filtered\n    let main_thread_elem = (this.state.filter_name && this.state.filter_name !== DZ_NAME) ? null : (\n      <ClickHandler callback={(e) => {this.show_reply_bar('', e);}}>\n        <FlowItem info={this.state.info} attention={this.state.attention} img_clickable={true}\n          color_picker={this.color_picker} show_pid={show_pid} replies={this.state.replies}\n          set_variant={(variant) => {this.set_variant(null, variant);}}\n          do_filter_name={replies_cnt[DZ_NAME] > 1 ? this.set_filter_name.bind(this) : null}\n        />\n      </ClickHandler>\n    );\n\n    return (\n      <div className=\"flow-item-row sidebar-flow-item\">\n        <div className=\"box box-tip\">\n          {!!this.props.token &&\n            <span>\n              <a onClick={this.report.bind(this)}>\n                <span className=\"icon icon-flag\" /><label>举报</label>\n              </a>\n                            &nbsp;&nbsp;\n            </span>\n          }\n          <a onClick={this.load_replies.bind(this)}>\n            <span className=\"icon icon-refresh\" /><label>刷新</label>\n          </a>\n          {(this.state.replies.length >= 1 || this.state.rev) &&\n            <span>\n                            &nbsp;&nbsp;\n              <a onClick={this.toggle_rev.bind(this)}>\n                <span className=\"icon icon-order-rev\" /><label>{this.state.rev ? '还原' : '逆序'}</label>\n              </a>\n            </span>\n          }\n          {!!this.props.token &&\n            <span>\n                            &nbsp;&nbsp;\n              <a onClick={() => {\n                this.toggle_attention();\n              }}>\n                {this.state.attention ?\n                  <span><span className=\"icon icon-star-ok\" /><label>已关注</label></span> :\n                  <span><span className=\"icon icon-star\" /><label>未关注</label></span>\n                }\n              </a>\n            </span>\n          }\n        </div>\n        {!!this.state.filter_name &&\n          <div className=\"box box-tip flow-item filter-name-bar\">\n            <p>\n              <span style={{float: 'left'}}><a onClick={() => {this.set_filter_name(null);}}>还原</a></span>\n              <span className=\"icon icon-locate\" />&nbsp;当前只看&nbsp;\n              <ColoredSpan colors={this.color_picker.get(this.state.filter_name)}>{this.state.filter_name}</ColoredSpan>\n            </p>\n          </div>\n        }\n        {!this.state.rev &&\n                    main_thread_elem\n        }\n        {!!this.state.error_msg &&\n          <div className=\"box box-tip flow-item\">\n            <p>回复加载失败</p>\n            <p>{this.state.error_msg}</p>\n          </div>\n        }\n        {(this.props.deletion_detect && parseInt(this.state.info.reply) > this.state.replies.length) && !!this.state.replies.length &&\n          <div className=\"box box-tip flow-item box-danger\">\n            {parseInt(this.state.info.reply) - this.state.replies.length} 条回复被删除\n          </div>\n        }\n        {replies_to_show.map((reply) => (\n          <LazyLoad key={reply.cid + view_mode_key} offset={1500} height=\"5em\" overflow={true} once={true}>\n            <ClickHandler callback={(e) => {this.show_reply_bar(reply.name, e);}}>\n              <Reply\n                info={reply} color_picker={this.color_picker} show_pid={show_pid}\n                set_variant={(variant) => {this.set_variant(reply.cid, variant);}}\n                do_filter_name={replies_cnt[reply.name] > 1 ? this.set_filter_name.bind(this) : null}\n              />\n            </ClickHandler>\n          </LazyLoad>\n        ))}\n        {this.state.rev &&\n                    main_thread_elem\n        }\n        {this.props.token ?\n          <ReplyForm pid={this.state.info.pid} token={this.props.token}\n            area_ref={this.reply_ref} on_complete={this.load_replies.bind(this)} /> :\n          <div className=\"box box-tip flow-item\">登录后可以回复树洞</div>\n        }\n      </div>\n    );\n  }\n}\n\nclass FlowItemRow extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      replies: [],\n      reply_status: 'done',\n      reply_error: null,\n      info: Object.assign({}, props.info, {variant: {}}),\n      hidden: window.config.block_words.some(word => props.info.text.includes(word)),\n      attention: props.attention_override === null ? false : props.attention_override,\n      cached: true, // default no display anything\n    };\n    this.color_picker = new ColorPicker();\n  }\n\n  componentDidMount() {\n    if(parseInt(this.state.info.reply, 10)) {\n      this.load_replies(null, /*update_count=*/false);\n    }\n  }\n\n  reveal() {\n    this.setState({ hidden: false });\n  }\n\n  load_replies(callback, update_count = true) {\n    console.log('fetching reply', this.state.info.pid);\n    this.setState({\n      reply_status: 'loading',\n      reply_error: null,\n    });\n    API.load_replies_with_cache(this.state.info.pid, this.props.token, this.color_picker, parseInt(this.state.info.reply))\n      .then(({data: json, cached}) => {\n        this.setState((prev, props) => ({\n          replies: json.data,\n          info: Object.assign({}, prev.info, {\n            reply: update_count ? '' + json.data.length : prev.info.reply,\n            variant: json.data.length ? {\n              latest_reply: Math.max.apply(null, json.data.map((r) => parseInt(r.timestamp))),\n            } : {},\n          }),\n          attention: !!json.attention,\n          reply_status: 'done',\n          reply_error: null,\n          cached\n        }), callback);\n      })\n      .catch((e) => {\n        console.error(e);\n        this.setState({\n          replies: [],\n          reply_status: 'failed',\n          reply_error: '' + e,\n        }, callback);\n      });\n  }\n\n  show_sidebar() {\n    this.props.show_sidebar(\n      '树洞 #' + this.state.info.pid,\n      <FlowSidebar key={+new Date()}\n        info={this.state.info} replies={this.state.replies} attention={this.state.attention} sync_state={this.setState.bind(this)}\n        token={this.props.token} show_sidebar={this.props.show_sidebar} color_picker={this.color_picker}\n        deletion_detect={this.props.deletion_detect}\n      />\n    );\n  }\n\n  render() {\n    let show_pid = load_single_meta(this.props.show_sidebar, this.props.token, [this.state.info.pid]);\n\n    let hl_rules = [\n      ['url_pid', URL_PID_RE],\n      ['url', URL_RE],\n      ['pid', PID_RE],\n      ['nickname', NICKNAME_RE],\n    ];\n    if(this.props.search_param)\n      hl_rules.push(['search', build_highlight_re(this.props.search_param, ' ', 'gi')]);\n    let parts = split_text(this.state.info.text, hl_rules);\n\n    let quote_id = null;\n    if(!this.props.is_quote)\n      for(let [mode, content] of parts)\n        if(mode === 'pid' && QUOTE_BLACKLIST.indexOf(content) === -1 && parseInt(content) < parseInt(this.state.info.pid))\n          if(quote_id === null)\n            quote_id = parseInt(content);\n          else {\n            quote_id = null;\n            break;\n          }\n\n    let res = (\n      <div className={'flow-item-row flow-item-row-with-prompt' + (this.props.is_quote ? ' flow-item-row-quote' : '')} onClick={(event) => {\n        if(!CLICKABLE_TAGS[event.target.tagName.toLowerCase()])\n          this.show_sidebar();\n      }}>\n        <FlowItem parts={parts} info={this.state.info} attention={this.state.attention} img_clickable={false} is_quote={this.props.is_quote}\n          color_picker={this.color_picker} show_pid={show_pid} replies={this.state.replies} cached={this.state.cached} />\n        <div className=\"flow-reply-row\">\n          {this.state.reply_status === 'loading' && <div className=\"box box-tip\">加载中</div>}\n          {this.state.reply_status === 'failed' &&\n            <div className=\"box box-tip\">\n              <p><a onClick={() => {this.load_replies();}}>重新加载评论</a></p>\n              <p>{this.state.reply_error}</p>\n            </div>\n          }\n          {this.state.replies.slice(0, PREVIEW_REPLY_COUNT).map((reply) => (\n            <Reply key={reply.cid} info={reply} color_picker={this.color_picker} show_pid={show_pid} />\n          ))}\n          {this.state.replies.length > PREVIEW_REPLY_COUNT &&\n            <div className=\"box box-tip\">还有 {this.state.replies.length - PREVIEW_REPLY_COUNT} 条</div>\n          }\n        </div>\n      </div>\n    );\n\n    if (this.state.hidden) {\n      return (\n        <div\n          className=\"flow-item-row flow-item-row-with-prompt\"\n          onClick={() => this.reveal()}>\n          <div className={'flow-item' + (this.props.is_quote ? ' flow-item-quote' : '')}>\n            {!!this.props.is_quote &&\n              <div className=\"quote-tip black-outline\">\n                <div><span className=\"icon icon-quote\" /></div>\n                <div><small>提到</small></div>\n              </div>\n            }\n            <div className=\"box\">\n              <div className=\"box-header\">\n                {!!this.props.do_filter_name &&\n                  <span className=\"reply-header-badge clickable\" onClick={() => {this.props.do_filter_name(DZ_NAME);}}>\n                    <span className=\"icon icon-locate\" />\n                  </span>\n                }\n                <code className=\"box-id\">#{this.props.info.pid}</code>\n                &nbsp;\n                {this.props.info.tag !== null &&\n                  <span className=\"box-header-tag\">\n                    {this.props.info.tag}\n                  </span>\n                }\n                <Time stamp={this.props.info.timestamp} />\n                <span className=\"box-header-badge\">已隐藏</span>\n                <div style={{clear: 'both'}} />\n              </div>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    return quote_id ? (\n      <div>\n        {res}\n        <FlowItemQuote pid={quote_id} show_sidebar={this.props.show_sidebar} token={this.props.token}\n          deletion_detect={this.props.deletion_detect} />\n      </div>\n    ) : res;\n  }\n}\n\nclass FlowItemQuote extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading_status: 'empty',\n      error_msg: null,\n      info: null,\n    };\n  }\n\n  componentDidMount() {\n    this.load();\n  }\n\n  load() {\n    this.setState({\n      loading_status: 'loading',\n    }, () => {\n      API.get_single(this.props.pid, this.props.token)\n        .then((json) => {\n          this.setState({\n            loading_status: 'done',\n            info: json.data,\n          });\n        })\n        .catch((err) => {\n          if(('' + err).indexOf('没有这条树洞') !== -1)\n            this.setState({\n              loading_status: 'empty',\n            });\n          else\n            this.setState({\n              loading_status: 'error',\n              error_msg: '' + err,\n            });\n        });\n    });\n  }\n\n  render() {\n    if(this.state.loading_status === 'empty')\n      return null;\n    else if(this.state.loading_status === 'loading')\n      return (\n        <div className=\"aux-margin\">\n          <div className=\"box box-tip\">\n            <span className=\"icon icon-loading\" />\n            提到了 #{this.props.pid}\n          </div>\n        </div>\n      );\n    else if(this.state.loading_status === 'error')\n      return (\n        <div className=\"aux-margin\">\n          <div className=\"box box-tip\">\n            <p><a onClick={this.load.bind(this)}>重新加载</a></p>\n            <p>{this.state.error_msg}</p>\n          </div>\n        </div>\n      );\n    else // 'done'\n      return (\n        <FlowItemRow info={this.state.info} show_sidebar={this.props.show_sidebar} token={this.props.token}\n          is_quote={true} deletion_detect={this.props.deletion_detect} />\n      );\n  }\n}\n\nfunction FlowChunk(props) {\n  return (\n    <TokenCtx.Consumer>{({value: token}) => (\n      <div className=\"flow-chunk\">\n        {!!props.title && <TitleLine text={props.title} />}\n        {props.list.map((info, ind) => (\n          <LazyLoad key={info.pid} offset={1500} height=\"15em\" hiddenIfInvisible={true}>\n            <div>\n              {!!(props.deletion_detect && props.mode === 'list' && ind && props.list[ind - 1].pid - info.pid > 1) &&\n                <div className=\"flow-item-row\">\n                  <div className=\"box box-tip flow-item box-danger\">\n                    {props.list[ind - 1].pid - info.pid - 1} 条被删除\n                  </div>\n                </div>\n              }\n              <FlowItemRow info={info} show_sidebar={props.show_sidebar} token={token}\n                attention_override={props.mode === 'attention_finished' ? true : null}\n                deletion_detect={props.deletion_detect} search_param={props.search_param} />\n            </div>\n          </LazyLoad>\n        ))}\n      </div>\n    )}</TokenCtx.Consumer>\n  );\n}\n\nexport class Flow extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      mode: props.mode,\n      search_param: props.search_text,\n      loaded_pages: 0,\n      chunks: {\n        title: '',\n        data: [],\n      },\n      loading_status: 'done',\n      error_msg: null,\n    };\n    this.on_scroll_bound = this.on_scroll.bind(this);\n    window.LATEST_POST_ID = parseInt(localStorage['_LATEST_POST_ID'], 10) || 0;\n  }\n\n  load_page(page) {\n    const failed = (err) => {\n      console.error(err);\n      this.setState((prev, props) => ({\n        loaded_pages: prev.loaded_pages - 1,\n        loading_status: 'failed',\n        error_msg: '' + err,\n      }));\n    };\n\n    if(page > this.state.loaded_pages + 1)\n      throw new Error('bad page');\n    if(page === this.state.loaded_pages + 1) {\n      console.log('fetching page', page);\n      if(this.state.mode === 'list') {\n        API.get_list(page, this.props.token)\n          .then((json) => {\n            if(page === 1 && json.data.length) { // update latest_post_id\n              let max_id = -1;\n              json.data.forEach((x) => {\n                if(parseInt(x.pid, 10) > max_id)\n                  max_id = parseInt(x.pid, 10);\n              });\n              localStorage['_LATEST_POST_ID'] = '' + max_id;\n            }\n            this.setState((prev, props) => ({\n              chunks: {\n                title: 'News Feed',\n                data: prev.chunks.data.concat(json.data.filter((x) => (\n                  prev.chunks.data.length === 0 ||\n                                    !(prev.chunks.data.slice(-100).some((p) => p.pid === x.pid))\n                ))),\n              },\n              loading_status: 'done',\n            }));\n          })\n          .catch(failed);\n      } else if(this.state.mode === 'search') {\n        API.get_search(page, this.state.search_param, this.props.token)\n          .then((json) => {\n            const finished = json.data.length === 0;\n            this.setState((prev, props) => ({\n              chunks: {\n                title: 'Result for \"' + this.state.search_param + '\"',\n                data: prev.chunks.data.concat(json.data.filter((x) => (\n                  prev.chunks.data.length === 0 ||\n                                    !(prev.chunks.data.slice(-100).some((p) => p.pid === x.pid))\n                ))),\n              },\n              mode: finished ? 'search_finished' : 'search',\n              loading_status: 'done',\n            }));\n          })\n          .catch(failed);\n      } else if(this.state.mode === 'single') {\n        const pid = parseInt(this.state.search_param.substr(1), 10);\n        API.get_single(pid, this.props.token)\n          .then((json) => {\n            this.setState({\n              chunks: {\n                title: 'PID = ' + pid,\n                data: [json.data],\n              },\n              mode: 'single_finished',\n              loading_status: 'done',\n            });\n          })\n          .catch(failed);\n      } else if(this.state.mode === 'attention') {\n        API.get_attention(this.props.token)\n          .then((json) => {\n            this.setState({\n              chunks: {\n                title: 'Attention List',\n                data: json.data,\n              },\n              mode: 'attention_finished',\n              loading_status: 'done',\n            });\n          })\n          .catch(failed);\n      } else {\n        console.log('nothing to load');\n        return;\n      }\n\n      this.setState((prev, props) => ({\n        loaded_pages: prev.loaded_pages + 1,\n        loading_status: 'loading',\n        error_msg: null,\n      }));\n    }\n  }\n\n  on_scroll(event) {\n    if(event.target === document) {\n      const avail = document.body.scrollHeight - window.scrollY - window.innerHeight;\n      if(avail < window.innerHeight && this.state.loading_status === 'done')\n        this.load_page(this.state.loaded_pages + 1);\n    }\n  }\n\n  componentDidMount() {\n    this.load_page(1);\n    window.addEventListener('scroll', this.on_scroll_bound);\n    window.addEventListener('resize', this.on_scroll_bound);\n  }\n  componentWillUnmount() {\n    window.removeEventListener('scroll', this.on_scroll_bound);\n    window.removeEventListener('resize', this.on_scroll_bound);\n  }\n\n  render() {\n    const should_deletion_detect = localStorage['DELETION_DETECT'] === 'on';\n    return (\n      <div className=\"flow-container\">\n        <FlowChunk\n          title={this.state.chunks.title} list={this.state.chunks.data} mode={this.state.mode}\n          search_param={this.state.search_param || null}\n          show_sidebar={this.props.show_sidebar} deletion_detect={should_deletion_detect}\n        />\n        {this.state.loading_status === 'failed' &&\n          <div className=\"aux-margin\">\n            <div className=\"box box-tip\">\n              <p><a onClick={() => {this.load_page(this.state.loaded_pages + 1);}}>重新加载</a></p>\n              <p>{this.state.error_msg}</p>\n            </div>\n          </div>\n        }\n        <TitleLine text={\n          this.state.loading_status === 'loading' ?\n            <span><span className=\"icon icon-loading\" />&nbsp;Loading...</span> :\n            '© xmcp'\n        } />\n      </div>\n    );\n  }\n}\n","import React, {PureComponent} from 'react';\nimport {AppSwitcher} from './infrastructure/widgets';\nimport {InfoSidebar, PostForm} from './UserAction';\nimport {TokenCtx} from './UserAction';\n\nimport './Title.css';\n\nconst flag_re = /^\\/\\/setflag ([a-zA-Z0-9_]+)=(.*)$/;\n\nclass ControlBar extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      search_text: '',\n    };\n    this.set_mode = props.set_mode;\n\n    this.on_change_bound = this.on_change.bind(this);\n    this.on_keypress_bound = this.on_keypress.bind(this);\n    this.do_refresh_bound = this.do_refresh.bind(this);\n    this.do_attention_bound = this.do_attention.bind(this);\n  }\n\n  componentDidMount() {\n    if(window.location.hash) {\n      let text = decodeURIComponent(window.location.hash).substr(1);\n      if(text.lastIndexOf('?') !== -1)\n        text = text.substr(0, text.lastIndexOf('?')); // fuck wechat '#param?nsukey=...'\n      this.setState({\n        search_text: text,\n      }, () => {\n        this.on_keypress({key: 'Enter'});\n      });\n    }\n  }\n\n  on_change(event) {\n    this.setState({\n      search_text: event.target.value,\n    });\n  }\n\n  on_keypress(event) {\n    if(event.key === 'Enter') {\n      let flag_res = flag_re.exec(this.state.search_text);\n      if(flag_res) {\n        if(flag_res[2]) {\n          localStorage[flag_res[1]] = flag_res[2];\n          alert('Set Flag ' + flag_res[1] + '=' + flag_res[2] + '\\nYou may need to refresh this webpage.');\n        } else {\n          delete localStorage[flag_res[1]];\n          alert('Clear Flag ' + flag_res[1] + '\\nYou may need to refresh this webpage.');\n        }\n        return;\n      }\n\n      const mode = this.state.search_text.startsWith('#') ? 'single' : 'search';\n      this.set_mode(mode, this.state.search_text || '');\n    }\n  }\n\n  do_refresh() {\n    window.scrollTo(0, 0);\n    this.setState({\n      search_text: '',\n    });\n    this.set_mode('list', null);\n  }\n\n  do_attention() {\n    window.scrollTo(0, 0);\n    this.setState({\n      search_text: '',\n    });\n    this.set_mode('attention', null);\n  }\n\n  render() {\n    return (\n      <TokenCtx.Consumer>{({value: token}) => (\n        <div className=\"control-bar\">\n          <a className=\"no-underline control-btn\" onClick={this.do_refresh_bound}>\n            <span className=\"icon icon-refresh\" />\n            <span className=\"control-btn-label\">最新</span>\n          </a>\n          {!!token &&\n            <a className=\"no-underline control-btn\" onClick={this.do_attention_bound}>\n              <span className=\"icon icon-attention\" />\n              <span className=\"control-btn-label\">关注</span>\n            </a>\n          }\n          <input className=\"control-search\" value={this.state.search_text} placeholder=\"搜索 或 #PID\"\n            onChange={this.on_change_bound} onKeyPress={this.on_keypress_bound}\n          />\n          <a className=\"no-underline control-btn\" onClick={() => {\n            this.props.show_sidebar(\n              'P大树洞',\n              <InfoSidebar show_sidebar={this.props.show_sidebar} />\n            );\n          }}>\n            <span className={'icon icon-' + (token ? 'about' : 'login')} />\n            <span className=\"control-btn-label\">{token ? '账户' : '登录'}</span>\n          </a>\n          {!!token &&\n            <a className=\"no-underline control-btn\" onClick={() => {\n              this.props.show_sidebar(\n                '发表树洞',\n                <PostForm token={token} on_complete={() => {\n                  this.props.show_sidebar(null, null);\n                  this.do_refresh();\n                }} />\n              );\n            }}>\n              <span className=\"icon icon-plus\" />\n              <span className=\"control-btn-label\">发表</span>\n            </a>\n          }\n        </div>\n      )}</TokenCtx.Consumer>\n    );\n  }\n}\n\nexport function Title(props) {\n  return (\n    <div className=\"title-bar\">\n      <AppSwitcher appid=\"hole\" />\n      <div className=\"aux-margin\">\n        <div className=\"title\">\n          <p className=\"centered-line\">\n            <span onClick={() => props.show_sidebar(\n              'P大树洞',\n              <InfoSidebar show_sidebar={props.show_sidebar} />\n            )}>\n              P大树洞\n            </span>\n          </p>\n        </div>\n        <ControlBar show_sidebar={props.show_sidebar} set_mode={props.set_mode} />\n      </div>\n    </div>\n  );\n}\n","import React, {PureComponent} from 'react';\nimport './Sidebar.css';\n\nexport class Sidebar extends PureComponent {\n  constructor(props) {\n    super(props);\n    // this.sidebar_ref = React.createRef();\n    this.do_close_bound = this.do_close.bind(this);\n    this.do_back_bound = this.do_back.bind(this);\n  }\n\n  do_close() {\n    this.props.show_sidebar(null, null, 'clear');\n  }\n  do_back() {\n    this.props.show_sidebar(null, null, 'pop');\n  }\n\n  render() {\n    // hide old contents to remember state\n    let contents = this.props.stack.map(({1: content}, i) => content && (\n      <div\n        key={content.key}\n        className={i === this.props.stack.length - 1 ?\n          'sidebar-content-show' :\n          'sidebar-content-hide'}\n      >\n        {content}\n      </div>\n    ));\n    let cur_title = this.props.stack[this.props.stack.length - 1][0];\n    return (\n      <div className={'sidebar-container ' + (cur_title !== null ? 'sidebar-on' : 'sidebar-off')}>\n        <div className=\"sidebar-shadow\" onClick={this.do_back_bound} onTouchEnd={(e) => {e.preventDefault();e.target.click();}} />\n        <div className=\"sidebar\">{contents}</div>\n        <div className=\"sidebar-title\">\n          <a className=\"no-underline\" onClick={this.do_close_bound}>&nbsp;<span className=\"icon icon-close\" />&nbsp;</a>\n          {this.props.stack.length > 2 &&\n            <a className=\"no-underline\" onClick={this.do_back_bound}>&nbsp;<span className=\"icon icon-back\" />&nbsp;</a>\n          }\n          {cur_title}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, {Component} from 'react';\nimport Pressure from 'pressure';\n\nimport './PressureHelper.css';\n\nconst THRESHOLD = .4;\nconst MULTIPLIER = 25;\nconst BORDER_WIDTH = 500; // also change css!\n\nexport class PressureHelper extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      level: 0,\n      fired: false,\n    };\n    this.callback = props.callback;\n    this.esc_interval = null;\n  }\n\n  do_fire() {\n    if(this.esc_interval) {\n      clearInterval(this.esc_interval);\n      this.esc_interval = null;\n    }\n    this.setState({\n      level: 1,\n      fired: true,\n    });\n    this.callback();\n    window.setTimeout(() => {\n      this.setState({\n        level: 0,\n        fired: false,\n      });\n    }, 300);\n  }\n\n  componentDidMount() {\n    if(window.config.pressure) {\n      Pressure.set(document.body, {\n        change: (force) => {\n          if(!this.state.fired) {\n            if(force >= .999) {\n              this.do_fire();\n            }\n            else\n              this.setState({\n                level: force,\n              });\n          }\n        },\n        end: () => {\n          this.setState({\n            level: 0,\n            fired: false,\n          });\n        },\n      }, {\n        polyfill: false,\n        only: 'touch',\n        preventSelect: false,\n      });\n\n      document.addEventListener('keydown', (e) => {\n        if(!e.repeat && e.key === 'Escape') {\n          if(this.esc_interval)\n            clearInterval(this.esc_interval);\n          this.setState({\n            level: THRESHOLD / 2,\n          }, () => {\n            this.esc_interval = setInterval(() => {\n              let new_level = this.state.level + .1;\n              if(new_level >= .999)\n                this.do_fire();\n              else\n                this.setState({\n                  level: new_level,\n                });\n            }, 30);\n          });\n        }\n      });\n      document.addEventListener('keyup', (e) => {\n        if(e.key === 'Escape') {\n          if(this.esc_interval) {\n            clearInterval(this.esc_interval);\n            this.esc_interval = null;\n          }\n          this.setState({\n            level: 0,\n          });\n        }\n      });\n    }\n  }\n\n  render() {\n    const pad = MULTIPLIER * (this.state.level - THRESHOLD) - BORDER_WIDTH;\n    return (\n      <div className={\n        'pressure-box'\n                + (this.state.fired ? ' pressure-box-fired' : '')\n                + (this.state.level <= .0001 ? ' pressure-box-empty' : '')\n      } style={{\n        left: pad,\n        right: pad,\n        top: pad,\n        bottom: pad,\n      }} />\n    );\n  }\n}","import React, {Component} from 'react';\nimport {Flow} from './Flows';\nimport {Title} from './Title';\nimport {Sidebar} from './Sidebar';\nimport {PressureHelper} from './PressureHelper';\nimport {TokenCtx} from './UserAction';\nimport {load_config, bgimg_style} from './Config';\nimport {listen_darkmode} from './infrastructure/functions';\nimport {LoginPopup, TitleLine} from './infrastructure/widgets';\n\nconst MAX_SIDEBAR_STACK_SIZE = 10;\n\nfunction DeprecatedAlert(props) {\n  return (\n    <div id=\"global-hint-container\" style={{display: 'none'}} />\n  );\n}\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    load_config();\n    listen_darkmode({default: undefined, light: false, dark: true}[window.config.color_scheme]);\n    this.state = {\n      sidebar_stack: [[null, null]], // list of [status, content]\n      mode: 'list', // list, single, search, attention\n      search_text: null,\n      flow_render_key: +new Date(),\n      token: localStorage['TOKEN'] || null,\n    };\n    this.show_sidebar_bound = this.show_sidebar.bind(this);\n    this.set_mode_bound = this.set_mode.bind(this);\n    this.on_pressure_bound = this.on_pressure.bind(this);\n    // a silly self-deceptive approach to ban guests, enough to fool those muggles\n    //                     document             cookie                    'pku_ip_flag=yes'\n    this.inpku_flag = window[atob('ZG9jdW1lbnQ')][atob('Y29va2ll')].indexOf(atob('cGt1X2lwX2ZsYWc9eWVz')) !== -1;\n  }\n\n  static is_darkmode() {\n    if(window.config.color_scheme === 'dark') return true;\n    if(window.config.color_scheme === 'light') return false;\n    else { // 'default'\n      return window.matchMedia('(prefers-color-scheme: dark)').matches;\n    }\n  }\n\n  on_pressure() {\n    if(this.state.sidebar_stack.length > 1)\n      this.show_sidebar(null, null, 'clear');\n    else\n      this.set_mode('list', null);\n  }\n\n  show_sidebar(title, content, mode = 'push') {\n    this.setState((prevState) => {\n      let ns = prevState.sidebar_stack.slice();\n      if(mode === 'push') {\n        if(ns.length > MAX_SIDEBAR_STACK_SIZE)\n          ns.splice(1, 1);\n        ns = ns.concat([[title, content]]);\n      } else if(mode === 'pop') {\n        if(ns.length === 1) return;\n        ns.pop();\n      } else if(mode === 'replace') {\n        ns.pop();\n        ns = ns.concat([[title, content]]);\n      } else if(mode === 'clear') {\n        ns = [[null, null]];\n      } else\n        throw new Error('bad show_sidebar mode');\n      return {\n        sidebar_stack: ns,\n      };\n    });\n  }\n\n  set_mode(mode, search_text) {\n    this.setState({\n      mode: mode,\n      search_text: search_text,\n      flow_render_key: +new Date(),\n    });\n  }\n\n  render() {\n    return (\n      <TokenCtx.Provider value={{\n        value: this.state.token,\n        set_value: (x) => {\n          localStorage['TOKEN'] = x || '';\n          this.setState({\n            token: x,\n          });\n        },\n      }}>\n        <PressureHelper callback={this.on_pressure_bound} />\n        <div className=\"bg-img\" style={bgimg_style()} />\n        <Title show_sidebar={this.show_sidebar_bound} set_mode={this.set_mode_bound} />\n        <TokenCtx.Consumer>{(token) => (\n          <div className=\"left-container\">\n            <DeprecatedAlert token={token.value} />\n            {!token.value &&\n              <div className=\"flow-item-row aux-margin\">\n                <div className=\"box box-tip\">\n                  <p>\n                    <LoginPopup token_callback={token.set_value}>{(do_popup) => (\n                      <a onClick={do_popup}>\n                        <span className=\"icon icon-login\" />\n                        &nbsp;登录到 PKU Helper\n                      </a>\n                    )}</LoginPopup>\n                  </p>\n                </div>\n              </div>\n            }\n            {this.inpku_flag || token.value ?\n              <Flow key={this.state.flow_render_key} show_sidebar={this.show_sidebar_bound}\n                mode={this.state.mode} search_text={this.state.search_text} token={token.value}\n              /> :\n              <TitleLine text=\"请登录后查看内容\" />\n            }\n            <br />\n          </div>\n        )}</TokenCtx.Consumer>\n        <Sidebar show_sidebar={this.show_sidebar_bound} stack={this.state.sidebar_stack} />\n      </TokenCtx.Provider>\n    );\n  }\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n//import {elevate} from './infrastructure/elevator';\nimport registerServiceWorker from './registerServiceWorker';\n\n//elevate();\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n"],"sourceRoot":""}