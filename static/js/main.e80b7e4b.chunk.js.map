{"version":3,"sources":["infrastructure/functions.js","infrastructure/widgets.js","infrastructure/const.js","infrastructure/appicon/hole.png","infrastructure/appicon/imasugu.png","infrastructure/appicon/imasugu_rev.png","infrastructure/appicon/syllabus.png","infrastructure/appicon/score.png","infrastructure/appicon/course_survey.png","infrastructure/appicon/dropdown.png","infrastructure/appicon/dropdown_rev.png","infrastructure/appicon/homepage.png","color_picker.js","text_splitter.js","cache.js","flows_api.js","Common.js","react-lazyload/src/utils/event.js","react-lazyload/src/utils/scrollParent.js","react-lazyload/src/index.jsx","react-lazyload/src/utils/debounce.js","react-lazyload/src/utils/throttle.js","AudioWidget.js","Message.js","Config.js","UserAction.js","Flows.js","Title.js","Sidebar.js","PressureHelper.js","App.js","registerServiceWorker.js","index.js"],"names":["get_json","res","ok","Error","status","statusText","text","then","t","JSON","parse","e","console","error","trace","log","SyntaxError","substr","listen_darkmode","override","update_color_scheme","undefined","window","matchMedia","matches","document","body","classList","add","remove","addListener","API_VERSION_PARAM","encodeURIComponent","process","REACT_APP_BUILD_INFO","Math","floor","Date","LOGIN_POPUP_ANCHOR_ID","pad2","x","format_time","time","getMonth","getDate","getHours","getMinutes","getSeconds","chinese_format","buildFormatter","chineseStrings","Time","props","stamp","date","formatter","title","toLocaleString","timeZone","hour12","TitleLine","className","GlobalTitle","FALLBACK_APPS","bar","appicon_hole","appicon_imasugu","appicon_imasugu_rev","appicon_syllabus","appicon_score","dropdown","appicon_course_survey","appicon_homepage","fix","SWITCHER_DATA_VER","SWITCHER_DATA_URL","PKUHELPER_ROOT","AppSwitcher","state","apps","get_apps_from_localstorage","ret","localStorage","content","this","appid","setTimeout","HOTFIX_CONTEXT","build_info","build_env","eval","check_fix","fetch","txt","setState","catch","prevProps","prevState","cur_id","app_elem","id","url","icon_normal","icon_hover","new_tab","no_class","ref","key","href","target","src","dropdown_cur_app","forEach","app","map","length","appicon_dropdown","appicon_dropdown_rev","React","createRef","onClick","closest","current","click","Component","LoginPopupSelf","loading_status","excluded_scopes","username_ref","password_ref","input_token_ref","popup_anchor","getElementById","createElement","appendChild","type","value","method","headers","stringify","json","success","alert","msg","set_token","code","user_token","name","on_close","token","result","ReactDOM","createPortal","perm_alert","bind","scope","checked","indexOf","onChange","chk","exc","slice","pos","splice","push","autoFocus","do_sendcode","disabled","do_login","token_callback","placeholder","do_input_token","LoginPopup","popup_show","on_popup_bound","on_popup","on_close_bound","children","module","exports","ColorPicker","names","current_h","random","toLowerCase","PID_RE","URL_PID_RE","NICKNAME_RE","URL_RE","split_text","rules","rule","regex","concat","apply","part","split","seg","test","filter","HOLE_CACHE_DB_NAME","CACHE_DB_VER","Cache","db","added_items_since_maintenance","encrypt","decrypt","open_req","indexedDB","open","onerror","onupgradeneeded","event","createObjectStore","keyPath","createIndex","unique","onsuccess","maintenance","pid","data","s","o","i","new_key","charCodeAt","String","fromCharCode","c","target_version","parseInt","Promise","resolve","reject","store","transaction","objectStore","get_req","get","data_str","version","last_access","put","delete","warn","req","count_req","count","index","openKeyCursor","cur","primaryKey","continue","deleteDatabase","cache","hole_cache","token_param","API","load_replies","color_picker","cache_version","API_BASE","sort","a","b","cid","info","_display_color","variant","load_replies_with_cache","set_attention","attention","URLSearchParams","append","report","reason","get_list","page","get_search","keyword","get_single","get_attention","escape_regex","string","replace","build_highlight_re","option","RegExp","join","ColoredSpan","style","colors","HighlightedText","parts","idx","p","rel","preventDefault","show_pid","PureComponent","TEXTAREA_BACKUP","SafeTextarea","on_change_bound","on_change","on_keydown_bound","on_keydown","clear","area_ref","change_callback","submit_callback","on_submit","ctrlKey","altKey","focus","onKeyDown","pwa_prompt_event","PromotionBar","is_ios","navigator","userAgent","standalone","prompt","addEventListener","ClickHandler","moved","init_y","init_x","on_begin_bound","on_begin","on_move_bound","on_move","on_end_bound","on_end","MOVE_THRESHOLD","last_fire","touches","screenY","screenX","abs","do_callback","callback","onTouchStart","onMouseDown","onTouchMove","onMouseMove","on","el","eventName","opts","attachEvent","call","off","removeEventListener","detachEvent","node","HTMLElement","documentElement","excludeStaticParent","position","overflowRegex","parent","parentNode","ownerDocument","getComputedStyle","overflow","overflowX","overflowY","defaultBoundingClientRect","LISTEN_FLAG","listeners","pending","passiveEventSupported","Object","defineProperty","delayType","passiveEvent","capture","passive","checkVisible","component","ReactDom","findDOMNode","scrollParent","parentTop","parentHeight","getBoundingClientRect","top","height","windowInnerHeight","innerHeight","clientHeight","intersectionTop","max","intersectionHeight","min","offsetTop","offsets","Array","isArray","offset","checkOverflowVisible","elementHeight","offsetWidth","offsetHeight","getClientRects","checkNormalVisible","visible","hidden","once","unmountIfInvisible","hiddenIfInvisible","lazyLoadHandler","listener","finalLazyLoadHandler","LazyLoad","scrollport","scrollContainer","querySelector","needResetFinalLazyLoadHandler","debounce","func","wait","immediate","timeout","args","context","timestamp","later","last","arguments","callNow","throttle","fn","threshhold","deferTimer","now","clearTimeout","getAttribute","listenerCount","setAttribute","scroll","resize","removeAttribute","visibility","defaultProps","audio_cache","AudioWidget","all","AMR","load","err","blob","reader","FileReader","onload","raw","decode","wave","PCMData","encode","sampleRate","channelCount","bytesPerSample","binary_wave","Uint8Array","objurl","URL","createObjectURL","Blob","readAsBinaryString","controls","MessageViewer","BUILTIN_IMGS","DEFAULT_CONFIG","background_img","background_color","pressure","easter_egg","color_scheme","block_words","load_config","loaded_config","config","assign","keys","save_config","bgimg_style","img","color","background","backgroundImage","encodeURI","backgroundColor","backgroundSize","ConfigBackground","save_changes","img_select","on_select","on_change_img","on_change_color","ConfigColorScheme","ConfigBlockWords","ConfigSwitch","switch","val","description","ConfigUI","save_changes_bound","chg","confirm","location","reload","reset_settings","MAX_IMG_DIAM","MAX_IMG_PX","MAX_IMG_FILESIZE","TokenCtx","createContext","set_value","LifeInfoBox","_life_info_cache","CACHE_TIMEOUT_S","today_info","cache_get","card_balance","net_balance","mail_count","INTERNAL_NETWORK_FAILURE","API_NAME","cache_item","state_key","errMsg","errCode","k","value_fn","action","url_fn","cache_set","details","reload_all","render_line","schedule_url","balance","toFixed","InfoSidebar","show_sidebar","serviceWorker","getRegistrations","registrations","registration","unregister","ResetUsertokenWidget","uid","do_reset","LoginForm","copy","Consumer","copy_token","do_popup","ReplyForm","global_keypress_handler_bound","global_keypress_handler","tagName","on_complete","onSubmit","PostForm","img_tip","img_ref","on_img_change_bound","on_img_change","file","return_url","fixOrientation","fixed_dataurl","image","Image","width","compressed","rate","sqrt","canvas","ctx","getContext","drawImage","quality","new_url","quality_l","quality_r","toDataURL","round","on_got_img","readAsDataURL","files","proc_img","d","do_post","accept","IMAGE_BASE","AUDIO_BASE","CLICKABLE_TAGS","audio","QUOTE_BLACKLIST","LATEST_POST_ID","load_single_meta","title_elem","single","reply","replies","deletion_detect","Reply","do_filter_name","tag","FlowItem","likenum","r","is_quote","copy_link","img_clickable","latest_reply","FlowSidebar","error_msg","filter_name","rev","syncState","sync_state","reply_ref","prev","update_count","set_variant","next_attention","should_text","set","replies_to_show","reverse","view_mode_key","replies_cnt","main_thread_elem","show_reply_bar","set_filter_name","toggle_rev","toggle_attention","float","FlowItemRow","reply_status","reply_error","some","word","includes","attention_override","hl_rules","search_param","quote_id","mode","reveal","FlowItemQuote","FlowChunk","list","ind","Flow","search_text","loaded_pages","chunks","on_scroll_bound","on_scroll","failed","max_id","finished","scrollHeight","scrollY","load_page","should_deletion_detect","flag_re","ControlBar","set_mode","on_keypress_bound","on_keypress","do_refresh_bound","do_refresh","do_attention_bound","do_attention","hash","decodeURIComponent","lastIndexOf","flag_res","exec","startsWith","scrollTo","onKeyPress","Title","Sidebar","sidebar_ref","do_close_bound","do_close","do_back_bound","do_back","nextProps","stack","scrollTop","cur_title","cur_content","onTouchEnd","PressureHelper","level","fired","esc_interval","clearInterval","Pressure","change","force","do_fire","end","polyfill","only","preventSelect","repeat","THRESHOLD","setInterval","new_level","pad","left","right","bottom","DeprecatedAlert","display","App","default","light","dark","sidebar_stack","flow_render_key","show_sidebar_bound","set_mode_bound","on_pressure_bound","on_pressure","inpku_flag","atob","ns","pop","Provider","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","register","onupdatefound","installingWorker","installing","onstatechange","controller","render","origin","response","ready","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.e80b7e4b.chunk.js","sourcesContent":["export function get_json(res) {\n    if(!res.ok) throw Error(`网络错误 ${res.status} ${res.statusText}`);\n    return (\n        res\n            .text()\n            .then((t)=>{\n                try {\n                    return JSON.parse(t);\n                } catch(e) {\n                    console.error('json parse error');\n                    console.trace(e);\n                    console.log(t);\n                    throw new SyntaxError('JSON Parse Error '+t.substr(0,50));\n                }\n            })\n    );\n}\n\nexport function listen_darkmode(override) { // override: true/false/undefined\n    function update_color_scheme() {\n        if(override===undefined ? window.matchMedia('(prefers-color-scheme: dark)').matches : override)\n            document.body.classList.add('root-dark-mode');\n        else\n            document.body.classList.remove('root-dark-mode');\n    }\n\n    update_color_scheme();\n    window.matchMedia('(prefers-color-scheme: dark)').addListener(()=>{\n        update_color_scheme();\n    });\n}\n\nexport function API_VERSION_PARAM() {\n    return '&PKUHelperAPI=3.0&jsapiver='+encodeURIComponent((process.env.REACT_APP_BUILD_INFO||'null')+'-'+(Math.floor(+new Date()/7200000)*2));\n}","import React, {Component, PureComponent} from 'react';\nimport ReactDOM from 'react-dom';\n\nimport TimeAgo from 'react-timeago';\nimport chineseStrings from 'react-timeago/lib/language-strings/zh-CN';\nimport buildFormatter from 'react-timeago/lib/formatters/buildFormatter';\n\nimport './global.css';\nimport './widgets.css';\n\nimport appicon_hole from './appicon/hole.png';\nimport appicon_imasugu from './appicon/imasugu.png';\nimport appicon_imasugu_rev from './appicon/imasugu_rev.png';\nimport appicon_syllabus from './appicon/syllabus.png';\nimport appicon_score from './appicon/score.png';\nimport appicon_course_survey from './appicon/course_survey.png';\nimport appicon_dropdown from './appicon/dropdown.png';\nimport appicon_dropdown_rev from './appicon/dropdown_rev.png';\nimport appicon_homepage from './appicon/homepage.png';\nimport {PKUHELPER_ROOT} from './const';\nimport {get_json, API_VERSION_PARAM} from './functions';\n\nconst LOGIN_POPUP_ANCHOR_ID='pkuhelper_login_popup_anchor';\n\nfunction pad2(x) {\n    return x<10 ? '0'+x : ''+x;\n}\nexport function format_time(time) {\n    return `${time.getMonth()+1}-${pad2(time.getDate())} ${time.getHours()}:${pad2(time.getMinutes())}:${pad2(time.getSeconds())}`;\n}\nconst chinese_format=buildFormatter(chineseStrings);\nexport function Time(props) {\n    const time=new Date(props.stamp*1000);\n    return (\n        <span>\n            <TimeAgo date={time} formatter={chinese_format} title={time.toLocaleString('zh-CN', {\n                timeZone: 'Asia/Shanghai',\n                hour12: false,\n            })} />\n            &nbsp;\n            {format_time(time)}\n        </span>\n    );\n}\n\nexport function TitleLine(props) {\n    return (\n        <p className=\"centered-line title-line aux-margin\">\n            <span className=\"black-outline\">{props.text}</span>\n        </p>\n    )\n}\n\nexport function GlobalTitle(props) {\n    return (\n        <div className=\"aux-margin\">\n            <div className=\"title\">\n                <p className=\"centered-line\">{props.text}</p>\n            </div>\n        </div>\n    );\n}\n\nconst FALLBACK_APPS={\n    // id, text, url, icon_normal, icon_hover, new_tab\n    bar: [\n        ['hole', '树洞', '/hole', appicon_hole, null, false],\n        ['imasugu', '教室', '/spare_classroom', appicon_imasugu, appicon_imasugu_rev, false],\n        ['syllabus', '课表', '/syllabus', appicon_syllabus, null, false],\n        ['score', '成绩', '/my_score', appicon_score, null, false],\n    ],\n    dropdown: [\n        ['course_survey', '课程测评', 'https://courses.pinzhixiaoyuan.com/', appicon_course_survey, null, true],\n        ['homepage', '客户端', '/', appicon_homepage, null, true],\n    ],\n    fix: {},\n};\nconst SWITCHER_DATA_VER='switcher_2';\nconst SWITCHER_DATA_URL=PKUHELPER_ROOT+'web_static/appswitcher_items.json';\n\nexport class AppSwitcher extends Component {\n    constructor(props) {\n        super(props);\n        this.state={\n            apps: this.get_apps_from_localstorage(),\n        }\n    }\n\n    get_apps_from_localstorage() {\n        let ret=FALLBACK_APPS;\n        if(localStorage['APPSWITCHER_ITEMS'])\n            try {\n                let content=JSON.parse(localStorage['APPSWITCHER_ITEMS'])[SWITCHER_DATA_VER];\n                if(!content || !content.bar)\n                    throw new Error('content is empty');\n\n                ret=content;\n            } catch(e) {\n                console.error('load appswitcher items from localstorage failed');\n                console.trace(e);\n            }\n\n        return ret;\n    }\n\n    check_fix() {\n        if(this.state.apps && this.state.apps.fix && this.state.apps.fix[this.props.appid])\n            setTimeout(()=>{\n                window.HOTFIX_CONTEXT={\n                    build_info: process.env.REACT_APP_BUILD_INFO || '---',\n                    build_env: process.env.NODE_ENV,\n                };\n                eval(this.state.apps.fix[this.props.appid]);\n            },1); // make it async so failures won't be critical\n    }\n\n    componentDidMount() {\n        this.check_fix();\n        setTimeout(()=>{\n            fetch(SWITCHER_DATA_URL)\n                .then((res)=>{\n                    if(!res.ok) throw Error(`网络错误 ${res.status} ${res.statusText}`);\n                    return res.text();\n                })\n                .then((txt)=>{\n                    if(txt!==localStorage['APPSWITCHER_ITEMS']) {\n                        console.log('loaded new appswitcher items',txt);\n                        localStorage['APPSWITCHER_ITEMS']=txt;\n\n                        this.setState({\n                            apps: this.get_apps_from_localstorage(),\n                        });\n                    } else {\n                        console.log('appswitcher items unchanged');\n                    }\n                })\n                .catch((e)=>{\n                    console.error('loading appswitcher items failed');\n                    console.trace(e);\n                });\n        },500);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if(this.state.apps!==prevState.apps)\n            this.check_fix();\n    }\n\n    render() {\n        let cur_id=this.props.appid;\n\n        function app_elem([id,title,url,icon_normal,icon_hover,new_tab],no_class=false,ref=null) {\n            return (\n                <a ref={ref} key={id} className={no_class ? null : ('app-switcher-item'+(id===cur_id ? ' app-switcher-item-current' : ''))}\n                   href={url} target={new_tab ? '_blank' : '_self'}>\n                    {!!icon_normal && [\n                        <img key=\"normal\" src={icon_normal} className=\"app-switcher-logo-normal\" />,\n                        <img key=\"hover\" src={icon_hover||icon_normal} className=\"app-switcher-logo-hover\" />\n                    ]}\n                    <span>{title}</span>\n                </a>\n            );\n        }\n\n        let dropdown_cur_app=null;\n        this.state.apps.dropdown.forEach((app)=>{\n            if(app[0]===cur_id)\n                dropdown_cur_app=app;\n        });\n\n        //console.log(JSON.stringify(this.state.apps));\n\n        return (\n            <div className=\"app-switcher\">\n                <span className=\"app-switcher-desc app-switcher-left\">PKUHelper</span>\n                {this.state.apps.bar.map((app)=>\n                    app_elem(app)\n                )}\n                {!!this.state.apps.dropdown.length &&\n                    <div className={\n                        'app-switcher-item app-switcher-dropdown '\n                        +(dropdown_cur_app ? ' app-switcher-item-current' : '')\n                    }>\n                        <p className=\"app-switcher-dropdown-title\">\n                            {!!dropdown_cur_app ?\n                                app_elem((()=>{\n                                    let [id,title,_url,icon_normal,icon_hover,_new_tab]=dropdown_cur_app;\n                                    return [id,title+'▾',null,icon_normal,icon_hover,false];\n                                })(),true) :\n                                app_elem(['-placeholder-elem','更多▾',null,appicon_dropdown,appicon_dropdown_rev,false],true)\n                            }\n                        </p>\n                        {this.state.apps.dropdown.map((app)=>{\n                            let ref=React.createRef();\n                            return (\n                                <p key={app[0]} className=\"app-switcher-dropdown-item\" onClick={(e)=>{\n                                    if(!e.target.closest('a') && ref.current)\n                                        ref.current.click();\n                                }}>\n                                    {app_elem(app,true,ref)}\n                                </p>\n                            );\n                        })}\n                    </div>\n                }\n                <span className=\"app-switcher-desc app-switcher-right\">网页版</span>\n            </div>\n        );\n    }\n}\n\nclass LoginPopupSelf extends Component {\n    constructor(props) {\n        super(props);\n        this.state={\n            loading_status: 'idle',\n            excluded_scopes: [],\n        };\n        this.username_ref=React.createRef();\n        this.password_ref=React.createRef();\n        this.input_token_ref=React.createRef();\n\n        this.popup_anchor=document.getElementById(LOGIN_POPUP_ANCHOR_ID);\n        if(!this.popup_anchor) {\n            this.popup_anchor=document.createElement('div');\n            this.popup_anchor.id=LOGIN_POPUP_ANCHOR_ID;\n            document.body.appendChild(this.popup_anchor);\n        }\n    }\n\n    do_sendcode(type) {\n        if(this.state.loading_status==='loading')\n            return;\n\n        this.setState({\n            loading_status: 'loading',\n        },()=>{\n            fetch(\n                PKUHELPER_ROOT+'api_xmcp/login/send_code'\n                +'?user='+encodeURIComponent(this.username_ref.current.value)\n                +'&code_type='+encodeURIComponent(type)\n                +API_VERSION_PARAM(), {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        excluded_scopes: this.state.excluded_scopes||[],\n                    }),\n                }\n            )\n                .then(get_json)\n                .then((json)=>{\n                    console.log(json);\n                    if(!json.success)\n                        throw new Error(JSON.stringify(json));\n\n                    alert(json.msg);\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                })\n                .catch((e)=>{\n                    console.error(e);\n                    alert('发送失败\\n'+e);\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                });\n\n        });\n    }\n\n    do_login(set_token) {\n        if(this.state.loading_status==='loading')\n            return;\n\n        this.setState({\n            loading_status: 'loading',\n        },()=>{\n            fetch(\n                PKUHELPER_ROOT+'api_xmcp/login/login'\n                +'?user='+encodeURIComponent(this.username_ref.current.value)\n                +'&valid_code='+encodeURIComponent(this.password_ref.current.value)\n                +API_VERSION_PARAM(), {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        excluded_scopes: this.state.excluded_scopes||[],\n                    }),\n                }\n            )\n                .then(get_json)\n                .then((json)=>{\n                    if(json.code!==0) {\n                        if(json.msg) throw new Error(json.msg);\n                        throw new Error(JSON.stringify(json));\n                    }\n\n                    set_token(json.user_token);\n                    alert(`成功以 ${json.name} 的身份登录`);\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                    this.props.on_close();\n                })\n                .catch((e)=>{\n                    console.error(e);\n                    alert('登录失败\\n'+e);\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                });\n        });\n    }\n\n    do_input_token(set_token) {\n        if(this.state.loading_status==='loading')\n            return;\n\n        let token=this.input_token_ref.current.value;\n        this.setState({\n            loading_status: 'loading',\n        },()=>{\n            fetch(PKUHELPER_ROOT+'api_xmcp/hole/system_msg?user_token='+encodeURIComponent(token)+API_VERSION_PARAM())\n                .then((res)=>res.json())\n                .then((json)=>{\n                    if(json.error)\n                        throw new Error(json.error);\n                    if(json.result.length===0)\n                        throw new Error('result check failed');\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                    set_token(token);\n                    this.props.on_close();\n                })\n                .catch((e)=>{\n                    alert('Token检验失败\\n'+e);\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                    console.error(e);\n                });\n        });\n    }\n\n    perm_alert() {\n        alert('如果你不需要 PKU Helper 的某项功能，可以取消相应权限。\\n其中【状态信息】包括你的网费、校园卡余额等。\\n该设置应用到你的【所有】设备，取消后如需再次启用相应功能需要重新登录。');\n    }\n\n    render() {\n        let PERM_SCOPES=[\n            ['score','成绩查询'],\n            ['syllabus','课表查询'],\n            ['my_info','状态信息'],\n        ];\n\n        return ReactDOM.createPortal(\n            <div>\n                <div className=\"pkuhelper-login-popup-shadow\" />\n                <div className=\"pkuhelper-login-popup\">\n                    <p>\n                        <b>接收验证码来登录 PKU Helper</b>\n                    </p>\n                    <p>\n                        授权功能<a onClick={this.perm_alert.bind(this)}>(?)</a>\n                        {PERM_SCOPES.map(([scope,title])=>(\n                            <label key={scope} className=\"perm-item\">\n                                <input type=\"checkbox\" checked={this.state.excluded_scopes.indexOf(scope)===-1} onChange={(e)=>{\n                                    let chk=e.target.checked;\n                                    this.setState((prevState)=>{\n                                        let exc=prevState.excluded_scopes.slice();\n                                        if(chk) { // remove from exc\n                                            let pos=exc.indexOf(scope);\n                                            if(pos!==-1)\n                                                exc.splice(pos,1);\n                                        } else { // add to exc\n                                            exc.push(scope);\n                                        }\n                                        return {\n                                            excluded_scopes: exc,\n                                        };\n                                    });\n                                }} />\n                                {title}\n                            </label>\n                        ))}\n                    </p>\n                    <p>\n                        <label>\n                            　学号&nbsp;\n                            <input ref={this.username_ref} type=\"tel\" autoFocus={true} />\n                        </label>\n                        <span className=\"pkuhelper-login-type\">\n                                <a onClick={(e)=>this.do_sendcode('sms')}>\n                                    &nbsp;短信&nbsp;\n                                </a>\n                                /\n                                <a onClick={(e)=>this.do_sendcode('mail')}>\n                                    &nbsp;邮件&nbsp;\n                                </a>\n                            </span>\n                    </p>\n                    <p>\n                        <label>\n                            验证码&nbsp;\n                            <input ref={this.password_ref} type=\"tel\" />\n                        </label>\n                        <button type=\"button\" disabled={this.state.loading_status==='loading'}\n                                onClick={(e)=>this.do_login(this.props.token_callback)}>\n                            登录\n                        </button>\n                    </p>\n                    <hr />\n                    <p>\n                        <b>从其他设备导入登录状态</b>\n                    </p>\n                    <p>\n                        <input ref={this.input_token_ref} placeholder=\"User Token\" />\n                        <button type=\"button\" disabled={this.state.loading_status==='loading'}\n                                onClick={(e)=>this.do_input_token(this.props.token_callback)}>\n                            导入\n                        </button>\n                    </p>\n                    <hr />\n                    <p>\n                        <button onClick={this.props.on_close}>\n                            取消\n                        </button>\n                    </p>\n                </div>\n            </div>,\n            this.popup_anchor,\n        );\n    }\n}\n\nexport class LoginPopup extends Component {\n    constructor(props) {\n        super(props);\n        this.state={\n            popup_show: false,\n        };\n        this.on_popup_bound=this.on_popup.bind(this);\n        this.on_close_bound=this.on_close.bind(this);\n    }\n\n    on_popup() {\n        this.setState({\n            popup_show: true,\n        });\n    }\n    on_close() {\n        this.setState({\n            popup_show: false,\n        });\n    }\n\n    render() {\n        return (\n            <>\n                {this.props.children(this.on_popup_bound)}\n                {this.state.popup_show &&\n                    <LoginPopupSelf token_callback={this.props.token_callback} on_close={this.on_close_bound} />\n                }\n            </>\n        );\n    }\n}","export const PKUHELPER_ROOT='//pkuhelper.pku.edu.cn/';\n","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFdklEQVR42sVW+VNTVxS+f4Od9oeW0RmlU8dOcRx3BEHbqiio3dtfamds+0N1bGe62emirYpSLRYDguAWJQihLZBAEkgKgbCHgIBAXbBTtgSykhAQEL/ecyWtwwMHx9DemS/vvXvv+c73zj3n5DEAjHBodJz9MD7BvuP3KVbb0xqV1p6lzENzS9u7Y3zOVWNittXPMmvMWmaNjZgeW8OZY91i1pSbzSqcg6y01Lj7V7UOap3Bma9WhyiKtEyh0bGsQg0L+P3n5talDNZ5LpWZCwqYqqYxJk9TggK1Bkpza7pWrWNdsZHM/uKymZ1Pgvb07ohiel0Jy7VcO1ug0iCfc+WbW7fUa0vYrUw5u6G8IhXglR1l/qR45tu/l9WeTo5XGqvxS3k1tPmF+t6Y8MXOVYui+3ZEb+ROHoq+HVEb3WtCo23bIhZrCwoNuZyHuKpTU474v/2M+dOSmDdDJhVgzUxn1oQDcd7w59C5+00oqxqgsLTBnHAIQ8vnoy9uPbiDWYH2kk1dwmFkWdqRU2nG9V2vw8e5rScOx/ZnX5YK6Dvw6Z6+VzYMepY8hT8++ZALMONKfQuqkxLhWf88rNvCZy2A54KwqTp1UnCQgPZ9H8Cz5ElYX93gsR38/COpgO3r5bata+FYHYrKve8jp7EDuW23USRLQveKhXDERc5agCMuAt0rF6JQdkpw5DS1o3LPbsFti1nLIxQplx7BljVyO3fSExUG/YYVyFMVIa/lOvLfewcdyxbAvTNq1gJobzu3Ue16G3nNnCNfDUP0cvRELwX5IF9SAbERchtftO+MRsOKUKjXhUG9JRJlSxegm4fUvn32OUB7ycYYNh/qzRFQh4cJTuK23Y+kVED/1nA5BxycwMZxbWUoml4IQdemVXBujwStPQpc3KZr8yo0hYWglXMRJ3FPrksF2F57Sc4BK4f9jZfhfmuzgPPNTWLO9oggG7IN8BDnAzxSAaWL5sk58C+emMS8x8S0PFIBjQf3yznwH0EqwAfIOTAThqZgpjXf7CAV4PAMyjkwFXa3R1xHx+9i4h4wzn/o6r8zKtb6XW4MjdwBnxLw+ofF3HRcD2D2AlxeH5yDXpgsjdBWmFBcVY3S2jr0DTiEKN/wCFpu3ERReQUM1TW4+VcXfFxQ0AQMDvmFiPQcJb5PTkHi+Qs4cEqGo2fS0dndCxrFlVX4OvEkvvjxOCrMDSISQRMQgM3pgtXhFPd0lV3OxOmsKyICdByd3T04xkVVNFhw994cCPDwSIyMjQtyGhVms4hIt61fPA/wcz+WnjF3Alw8DygKvXYHbvf0IlmhgDy/QCQdCeviQuZUAL04kX/1UyK++TkJB2XJ+JMLIWd0DHMugEqNMrysrh6GmlocP3ceOlMlhkfHRA7MuYCByXoPDD0vucOnU2HlR0IOe/oHRBJSuU4EswoCjYjelOqeGhENpVaHhIyzounQcPNSjU87g/qWVvF83zYIAty+IdGI1GVGXCpQ4Te9ARnKXHx5/AQqLU3CWUNbu5g7kpomypOaFdmQ7WMLoPKjClCo1Dh54SJSMhVIy85BbXMLRnhUKNzUGU+cPYdsjRYpiixc4tVBzcsz9AgCXF7vQ3OAOiJlO139PBfG7k4IJ5Qb9Ka0RiUZ2PPQkua+JAKcfJIvzGhEZxwAOZ7aIzwPrLunrE/z3zLN90Brh9zu8vCmMsY3DIozDCYcHJTIlNTNHdelAorLTPG1lmbYuUrfCA/nsB+D/uDA679/fBSBWstVaPTGIxIBXX22EH151UVdqQn1V1sF6ppagoIAX6mpBhpD+YUSY9Uz0s/ygQFWXtPA1MXGjzUGo4Fv1HCoggRNkcGoLykz7fvdVMP0HBIB/xf+Bi8VajXQRja5AAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAHWklEQVR42q1XCWxUVRR9f19mptAWqYKSEoUgETQC1rIZW6UaFKo0KsoixhQRjGAIhSCimGitlgq4ASXKUgJKiAQFQXYVLGUtO7SlWFuUli5TWtqyPO97/z7m9acat0nOzJ+/vHvuuffdez8hf/5RfFAlKNKvQv6nj2zk33zU/0KGPajJJ1yXxN/TUxmcPFB95uGB6pjUh9VxjzygjU3urz6XlKAO69ZVSXAsEu8zauE6frWUv1JLkb0e+qA6cu1yc3v1cbueVjmUXnY9tACaAI2AS3D+V4dWHbDrdnxp7fswy8jt0knp/g+UkslFDj6epa+gNEA56sBQBRj6BXFOOi4DXITrDQDqcAwdpEwL2KRDKEgS4zuTAZ3jSGIoQPqGHHInLB0H0H1EDOE4lz71IW08N1wJC54BlCDO+owznHdoy0mb1u216OWjFg3vs2jRFquq+oAdDh/xnrsKa4QLHVp30G4o2WGVbVluHcibb27IzjQW39tT6Y/GdRECsiLb2MQJFKHhk4Ba5iHK34hgx+dsenGbSS8fZ+Tgfxmg3vVUqwFUAqrwuA6fY+twdYN0Wro+F1UwhRzRJzZZpfSKG/G82qXl+Xb1zJf03BEp6luQfLMAs5MHqVPGp2l5VyAH6AW4v1hSq6QNtUT4xHkgMipVy0C7Nv92TNKr/rDdyNmKReDG4Unqe3hjFCAECLA/rz6vf8y9KZHUuoAeXkOPG3yqXYuoMCJFewXXdfh30CZ9LxXaLVzyEkwyyPweXZVJGKfbAV0AN7Pb135q7mpFAIzXHbWbM6fq68cM1zKZUklMrQGgHOCJIerbo4dr70x4Vnt/arr2QaeOSj/03iNgaKT7+T12DWctEg/Y5rxurJP2LlMhmv1uXmoWcG8EASCTlWF8w8gBYgDtUC1XgoOZT1DN9lg3eDZa3+aae7lXIqYsxpBYC7OM7+7ro6bBPbEiYbYsN/f5CUweZyzCHdUNcBtuvZskdJDIBVEB/UYivD5RX8IylJ7GRU8jCUYKwpG/wTqaPkafHRNF7s7LMbf7CeRmGtvkQooetpPyJ4iqOOi5LuoAI6B2jlP6NuBi3LhQokgQ8RKousBqKd0B4aqQCEDBai51ri/OMTcNS1HHw3qdJTIa2rAwBLq/kRkiu3vHKyMqi52mG5WwVCJSjLkB25OetLxiVYrXTnkkvH3u0uPb7XNvTjPm9eqhDPFVP60tAhrKwiQjsQ4ZsGqJubXmLCOCW+s311Oi2Nsh9ftNXv1oueuRKpHUYqSu4HMXHbpxpfnDC6O0jFvjlN5tNC1FVEId4xaL/6OiosigkcO1OdvXWkd4eWYLNrtejQCjtfkmrSuwPRJlbutiVIxkzovqF6Atle71N6fo86Wua4kcEN3QQBLRmK1BPNe1Rzfl6bcyjOVFe+2LXBXWFc/YNFxg0pqfoSQftiPGarA6yqFjCHvX18znyaojEcPfJnVMmCAS6Yjbx8I86ZP2mDrjdL59gRctCMflQguKkElPbTZr1nxqFoSPQUEToftVamxMkXJPyace9ZXiNmYDAy8GcCvFIhmeJ5NGagu4ARb/Mq/MHttgVsClxJh2JGlyurZw/2arhJdhNkuckkjAcz+usk6gk7rsfVuDg47eO0iEkSCjHtNmcC/FLgB5oe026gpJkSpm98GJ6uTzhXaY7ygREjhuOeHQgEMG+ieUv/3JmWWsadULwMvSnValqhDW5zuxvMHqR5L7qjN48pbhvSxpqx2a0FsZK8tOUpPVtK+WmWvnv2HkzX7VWPrGK/qSWRO1z2ZO0BfMSNezM17Us6BafrR6nrmTx/Y3N9JmQY2dq6yTsEw8Go5DkJggGcJrxO9OpNHBSJecoE1sReCD6cZSSkM3to0oKpFBIrKlWDI1H7Jp01GbNh+z6bWrLp32op7XllojH9fe5gr8EqmarD70u0sZ1yr+c6YYy1rJWuIbywQg7k0whtXvh1FsvzeONZ+w6ReZ+m4YXj6cnq5/AmSyQbm5ue8a668LtUQOwO5pgkkK5seHWs2Je1azbhiKeHsVx6xahBivGM5YN6oi94xld4NfLVFFnUiDw12we7VVhP0iJEqxkZaijpmbZeR9kW18v/Fz8+Der63SC/l2be0h+0pdIQ6Yhfa1sl1WTfkuq4HnwV8pddZ3jdUDNitCx4XhRExa0WIwDEphC+L008vSyeCgQ4bCeJ0aCihPhlwyDLZa95U5bCJCtS653ohegYqU+cb331FJzJ+Fc4wNsPYtWFOihAKWVP06SENELJ5rj7/svzW4H1dr3dYV5pHyn+2aRjYTVnnZ3WoWvORVv4rDdjhvkfnTkIHqZNwd0fjriiTUUAkXibSTekIskuqAheg2abDooqskITaGDL2vlzIaXtkmJSWqryX316bCXPha0v3qy3d0VdJ0gwxAr0003BHtmP53Q9EgTFRFDI4CAWmeixYzIp638TnTt0YA7++IiMZzpv999M9exVWJnI6LWz612ktq+REjxVsQFa9lyh/6q3mOr9bMWwAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAFfklEQVR42qWXWWicVRiG/39mUim4NRq88MZWXIpLe+FS6lYKtZsW0UrRUmyllUIXpQiN3hXBC1sxdyom6q2lVRGhUqvFClURUVFUsu+ZmD2TTDKTycTn/fudcPzNJJMaeDOTnHO+7z3ffoLm5uagFFpaWpJ8LmloaAgaGxuD3t7epePj49unpqbeLhQKn4EvwQVwjv+dYm1fOp2u0t76+vqgqampAhmp+XTMqxwB0XcUr8pmsydQ8jPK0oYe0G3f+8AgGGDPn+x9t7+//8HW1taIODKSiyWQ0MGurq4bEKbbjoEZUATTYApMgglDrnDpp2j7hPzk5ORJyN9qJBLlEoiUDw4ObkNIhydQ6JHQ4eHhF1jfgLlXg7v5vn5oaGj3xMTE++xpjZ0ZyWQy+7Fo4Cw6H4GENnLgcExIu/6HRa7XugjOBcno7Oy8EjI7ccVvOstnJIP4OG4kwlIEopuj6JAdlElnuFUtiq/Tmt1ApkwiTJ+hIWF+TmiP9nZ0dChgj/my+LtGJPyYcAHnzL5VfuRAXgfGxsZe1rrWLCOCcuAHMO7agazs1CUWM7KkyYtiwm0OdUuL7KJTLiFAt/VvWQ4SdiYpZbjkCbOEAjhHYN7hLiWWS8QEU7/jfM73Ov3PlAfOrEZoQbi9Zu6UvnOhaic/n89/3dbWFq1FBQNGd7IwbinWiTWuRkjolLe3t1+BKZ8nJV8FRyH4ylxgrVp7RkdHDxIDyxwJXQQZARb4wSxcxCpbpTtiy6E3HTuYHnI+crGB8v2xrFgQEHrLBa0XYxtdvcjlcp9HMcDtr4LZr8Ysze2v8fI11MGBgYFtZqFiGcq1J0+wvWRyQnNnILOj6yfb8zc/VQGp8RR/9Mr8sDppfgtjUR1QcFZBdjN4FGwsAa1tAverDMcKT5Si6HvNKmmGorZbjGrFRqwx9d65Uk4H5a/FIF71nBv6+voesdKt/nEq4NcX1lByKq9+jvoW4OB9NJjHwCawuQS0tgU8jLkTMRKRO3t6em5ReVZ1Bd+KwFfW1bKq7UYgjPWF7ZYhZQchMVDtVc7AlXB0VJpy9YwzInDeCpAI3OUT8LJg72KzgMx6ww9Cj8C1rLeBFkfgrOeC9XEXWPSmRkZGdpCih8EBcLAEDqiXsHePmlI8DswFy9E1rHoDLioIP+JLvyKT4rCrVBBqKvqfQRjaVLXGglA6zyot9lhEFl0Jjqeh0N3dXcXhleA2cHsJaG0lZr7R0vlfWaCeg4WOWhqOkYYvilEVVvjLikMbplsaL0RE9UPms1FDpgRGLcLTuOHZeCFSbUDXBQvoIQrRTa4U17rgIeCe8eIgCkKEHVlsEHK792KlOOQi95j5p2lI56NSLH+x8IAKkRZg+AeNpILDUUuVEKxSiateh+iHoE6jVwnUsf4BqMGyy72OGHVVKu0ZV8656K6oGWl0lmlYPO2l0DFzQcqZ73LghhNL5Z2uV3DJX+iOumRKG1IWnTcrMGxoEMOn3UjtDSTlwO1VO0+Zhe/V9OxGM9J9nbk5FZ8H99nkop1Z0vJJu00YL88LjGSz8YPyNVZpC2bd407nf4ZS+Qlfn/AHSU0ymCv0htKkd9PAS9toZHMTkWSprugizu8E3seSpfiacyy3m4pEjdfbReY7zLbFxqiSY7lLNW69VgOHnXXKT2tSduRKPkwcCQ0U9uqZTS2E/ah+Tmdcp64GKsEysIIYWqsGhKJvrNDMntObQCNZXPmCTzOErkbg2di0U7CUVeHpstdTxpRO+1OTCDNNbXCZFFc+7+PUjdQyO758HJN+apNTxh6iae9xOmBVUBYbhvQ5sug5pdrlPk79B0aFUsleyVUUG/WOT8D39jS/CH7XJ2tH2LNCe60hJRd6nv8Dwj5T3q96iTAAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,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\"","// https://martin.ankerl.com/2009/12/09/how-to-create-random-colors-programmatically/\n\nconst golden_ratio_conjugate=0.618033988749895;\n\nexport class ColorPicker {\n    constructor() {\n        this.names={};\n        this.current_h=Math.random();\n    }\n\n    get(name) {\n        name=name.toLowerCase();\n        if(name==='洞主')\n            return ['hsl(0,0%,97%)','hsl(0,0%,16%)'];\n\n        if(!this.names[name]) {\n            this.current_h+=golden_ratio_conjugate;\n            this.current_h%=1;\n            this.names[name]=[\n                `hsl(${this.current_h*360}, 50%, 90%)`,\n                `hsl(${this.current_h*360}, 60%, 20%)`,\n            ];\n        }\n        return this.names[name];\n    }\n}","// regexp should match the WHOLE segmented part\nexport const PID_RE=/(^|[^\\d\\u20e3\\ufe0e\\ufe0f])([2-9]\\d{4,5}|1\\d{4,6})(?![\\d\\u20e3\\ufe0e\\ufe0f])/g;\nexport const URL_PID_RE=/((?:https?:\\/\\/)?pkuhelper\\.pku\\.edu\\.cn\\/hole\\/?#(?:#|%23)([2-9]\\d{4,5}|1\\d{4,6}))(?!\\d|\\u20e3|\\ufe0e|\\ufe0f)/g;\nexport const NICKNAME_RE=/(^|[^A-Za-z])((?:(?:Angry|Baby|Crazy|Diligent|Excited|Fat|Greedy|Hungry|Interesting|Jolly|Kind|Little|Magic|Naïve|Old|Powerful|Quiet|Rich|Superman|THU|Undefined|Valuable|Wifeless|Xiangbuchulai|Young|Zombie)\\s)?(?:Alice|Bob|Carol|Dave|Eve|Francis|Grace|Hans|Isabella|Jason|Kate|Louis|Margaret|Nathan|Olivia|Paul|Queen|Richard|Susan|Thomas|Uma|Vivian|Winnie|Xander|Yasmine|Zach)|You Win(?: \\d+)?|洞主)(?![A-Za-z])/gi;\nexport const URL_RE=/(^|[^.@a-zA-Z0-9_])((?:https?:\\/\\/)?(?:(?:[\\w-]+\\.)+[a-zA-Z]{2,3}|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})(?::\\d{1,5})?(?:\\/[\\w~!@#$%^&*()\\-_=+[\\]{};:,./?|]*)?)(?![a-zA-Z0-9])/gi;\n\nexport function split_text(txt,rules) {\n    // rules: [['name',/regex/],...]\n    // return: [['name','part'],[null,'part'],...]\n\n    txt=[[null,txt]];\n    rules.forEach((rule)=>{\n        let [name,regex]=rule;\n        txt=[].concat.apply([],txt.map((part)=>{\n            let [rule,content]=part;\n            if(rule) // already tagged by previous rules\n                return [part];\n            else {\n                return content\n                    .split(regex)\n                    .map((seg)=>(\n                        regex.test(seg) ? [name,seg] : [null,seg]\n                    ))\n                    .filter(([name,seg])=>(\n                        name!==null || seg\n                    ));\n            }\n        }));\n    });\n    return txt;\n}\n","const HOLE_CACHE_DB_NAME='hole_cache_db';\nconst CACHE_DB_VER=1;\nconst MAINTENANCE_STEP=200;\nconst MAINTENANCE_COUNT=2500;\n\nconst ENC_KEY=42;\n\nclass Cache {\n    constructor() {\n        this.db=null;\n        this.added_items_since_maintenance=0;\n        this.encrypt=this.encrypt.bind(this);\n        this.decrypt=this.decrypt.bind(this);\n        const open_req=indexedDB.open(HOLE_CACHE_DB_NAME,CACHE_DB_VER);\n        open_req.onerror=console.error.bind(console);\n        open_req.onupgradeneeded=(event)=>{\n            console.log('comment cache db upgrade');\n            const db=event.target.result;\n            const store=db.createObjectStore('comment',{\n                keyPath: 'pid',\n            });\n            store.createIndex('last_access','last_access',{unique: false});\n        };\n        open_req.onsuccess=(event)=>{\n            console.log('comment cache db loaded');\n            this.db=event.target.result;\n            setTimeout(this.maintenance.bind(this),1);\n        };\n    }\n\n    // use window.hole_cache.encrypt() only after cache is loaded!\n    encrypt(pid,data) {\n        let s=JSON.stringify(data);\n        let o='';\n        for(let i=0,key=(ENC_KEY^pid)%128;i<s.length;i++) {\n            let c=s.charCodeAt(i);\n            let new_key=(key^(c/2))%128;\n            o+=String.fromCharCode(key^s.charCodeAt(i));\n            key=new_key;\n        }\n        return o;\n    }\n\n    // use window.hole_cache.decrypt() only after cache is loaded!\n    decrypt(pid,s) {\n        let o='';\n        if(typeof(s)!==typeof('str'))\n            return null;\n\n        for(let i=0,key=(ENC_KEY^pid)%128;i<s.length;i++) {\n            let c=key^s.charCodeAt(i);\n            o+=String.fromCharCode(c);\n            key=(key^(c/2))%128;\n        }\n\n        try {\n            return JSON.parse(o);\n        } catch(e) {\n            console.error('decrypt failed');\n            console.trace(e);\n            return null;\n        }\n    }\n\n    get(pid,target_version) {\n        pid=parseInt(pid);\n        return new Promise((resolve,reject)=>{\n            if(!this.db)\n                return resolve(null);\n            const tx=this.db.transaction(['comment'],'readwrite');\n            const store=tx.objectStore('comment');\n            const get_req=store.get(pid);\n            get_req.onsuccess=()=>{\n                let res=get_req.result;\n                if(!res || !res.data_str)  {\n                    //console.log('comment cache miss '+pid);\n                    resolve(null);\n                } else if(target_version===res.version) { // hit\n                    console.log('comment cache hit',pid);\n                    res.last_access=(+new Date());\n                    store.put(res);\n                    let data=this.decrypt(pid,res.data_str);\n                    resolve(data); // obj or null\n                } else { // expired\n                    console.log('comment cache expired',pid,': ver',res.version,'target',target_version);\n                    store.delete(pid);\n                    resolve(null);\n                }\n            };\n            get_req.onerror=(e)=>{\n                console.warn('comment cache indexeddb open failed');\n                console.error(e);\n                resolve(null);\n            };\n        });\n    }\n\n    put(pid,target_version,data) {\n        pid=parseInt(pid);\n        return new Promise((resolve,reject)=>{\n            if(!this.db)\n                return resolve();\n            const tx=this.db.transaction(['comment'],'readwrite');\n            const store=tx.objectStore('comment');\n            store.put({\n                pid: pid,\n                version: target_version,\n                data_str: this.encrypt(pid,data),\n                last_access: +new Date(),\n            });\n            if(++this.added_items_since_maintenance===MAINTENANCE_STEP)\n                setTimeout(this.maintenance.bind(this),1);\n        });\n    }\n\n    delete(pid) {\n        pid=parseInt(pid);\n        return new Promise((resolve,reject)=>{\n            if(!this.db)\n                return resolve();\n            const tx=this.db.transaction(['comment'],'readwrite');\n            const store=tx.objectStore('comment');\n            let req=store.delete(pid);\n            //console.log('comment cache delete',pid);\n            req.onerror=()=>{\n                console.warn('comment cache delete failed ',pid);\n                return resolve();\n            };\n            req.onsuccess=()=>resolve();\n        });\n    }\n\n    maintenance() {\n        if(!this.db)\n            return;\n        const tx=this.db.transaction(['comment'],'readwrite');\n        const store=tx.objectStore('comment');\n        let count_req=store.count();\n        count_req.onsuccess=()=>{\n            let count=count_req.result;\n            if(count>MAINTENANCE_COUNT) {\n                console.log('comment cache db maintenance',count);\n                store.index('last_access').openKeyCursor().onsuccess=(e)=>{\n                    let cur=e.target.result;\n                    if(cur) {\n                        //console.log('maintenance: delete',cur);\n                        store.delete(cur.primaryKey);\n                        if(--count>MAINTENANCE_COUNT)\n                            cur.continue();\n                    }\n                };\n            } else {\n                console.log('comment cache db no need to maintenance',count);\n            }\n            this.added_items_since_maintenance=0;\n        };\n        count_req.onerror=console.error.bind(console);\n    }\n\n    clear() {\n        if(!this.db)\n            return;\n        indexedDB.deleteDatabase(HOLE_CACHE_DB_NAME);\n        console.log('delete comment cache db');\n    }\n};\n\nexport function cache() {\n    if(!window.hole_cache)\n        window.hole_cache=new Cache();\n    return window.hole_cache;\n}","import {get_json, API_VERSION_PARAM} from './infrastructure/functions';\nimport {PKUHELPER_ROOT} from './infrastructure/const';\nimport {API_BASE} from './Common';\nimport {cache} from './cache';\n\nexport {PKUHELPER_ROOT, API_VERSION_PARAM};\n\nexport function token_param(token) {\n    return API_VERSION_PARAM()+(token ? ('&user_token='+token) : '');\n}\n\nexport {get_json};\n\nconst SEARCH_PAGESIZE=50;\n\nexport const API={\n    load_replies: (pid,token,color_picker,cache_version)=>{\n        pid=parseInt(pid);\n        return fetch(\n            API_BASE+'/api.php?action=getcomment'+\n            '&pid='+pid+\n            token_param(token)\n        )\n            .then(get_json)\n            .then((json)=>{\n                if(json.code!==0) {\n                    if(json.msg) throw new Error(json.msg);\n                    else throw new Error(JSON.stringify(json));\n                }\n\n                cache().delete(pid).then(()=>{\n                    cache().put(pid,cache_version,json);\n                });\n\n                // also change load_replies_with_cache!\n                json.data=json.data\n                    .sort((a,b)=>{\n                        return parseInt(a.cid,10)-parseInt(b.cid,10);\n                    })\n                    .map((info)=>{\n                        info._display_color=color_picker.get(info.name);\n                        info.variant={};\n                        return info;\n                    });\n\n                return json;\n            });\n    },\n\n    load_replies_with_cache: (pid,token,color_picker,cache_version)=> {\n        pid=parseInt(pid);\n        return cache().get(pid,cache_version)\n            .then((json)=>{\n                if(json) {\n                    // also change load_replies!\n                    json.data=json.data\n                        .sort((a,b)=>{\n                            return parseInt(a.cid,10)-parseInt(b.cid,10);\n                        })\n                        .map((info)=>{\n                            info._display_color=color_picker.get(info.name);\n                            info.variant={};\n                            return info;\n                        });\n\n                    return json;\n                }\n                else\n                    return API.load_replies(pid,token,color_picker,cache_version);\n            });\n    },\n\n    set_attention: (pid,attention,token)=>{\n        let data=new URLSearchParams();\n        data.append('user_token',token);\n        data.append('pid',pid);\n        data.append('switch',attention ? '1' : '0');\n        return fetch(API_BASE+'/api.php?action=attention'+token_param(token), {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded',\n            },\n            body: data,\n        })\n            .then(get_json)\n            .then((json)=>{\n                cache().delete(pid);\n                if(json.code!==0) {\n                    if(json.msg && json.msg==='已经关注过了') {}\n                    else {\n                        if(json.msg) alert(json.msg);\n                        throw new Error(JSON.stringify(json));\n                    }\n                }\n                return json;\n            });\n    },\n\n    report: (pid,reason,token)=>{\n        let data=new URLSearchParams();\n        data.append('user_token',token);\n        data.append('pid',pid);\n        data.append('reason',reason);\n        return fetch(API_BASE+'/api.php?action=report'+token_param(token), {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded',\n            },\n            body: data,\n        })\n            .then(get_json)\n            .then((json)=>{\n                if(json.code!==0) {\n                    if(json.msg) alert(json.msg);\n                    throw new Error(JSON.stringify(json));\n                }\n                return json;\n            });\n    },\n\n    get_list: (page,token)=>{\n        return fetch(\n            API_BASE+'/api.php?action=getlist'+\n            '&p='+page+\n            token_param(token)\n        )\n            .then(get_json)\n            .then((json)=>{\n                if(json.code!==0)\n                    throw new Error(JSON.stringify(json));\n                return json;\n            });\n    },\n\n    get_search: (page,keyword,token)=>{\n        return fetch(\n            API_BASE+'/api.php?action=search'+\n            '&pagesize='+SEARCH_PAGESIZE+\n            '&page='+page+\n            '&keywords='+encodeURIComponent(keyword)+\n            token_param(token)\n        )\n            .then(get_json)\n            .then((json)=>{\n                if(json.code!==0) {\n                    if(json.msg) throw new Error(json.msg);\n                    throw new Error(JSON.stringify(json));\n                }\n                return json;\n            });\n    },\n\n    get_single: (pid,token)=>{\n        return fetch(\n            API_BASE+'/api.php?action=getone'+\n            '&pid='+pid+\n            token_param(token)\n        )\n            .then(get_json)\n            .then((json)=>{\n                if(json.code!==0) {\n                    if(json.msg) throw new Error(json.msg);\n                    else throw new Error(JSON.stringify(json));\n                }\n                return json;\n            });\n    },\n\n    get_attention: (token)=>{\n        return fetch(\n            API_BASE+'/api.php?action=getattention'+\n            token_param(token)\n        )\n            .then(get_json)\n            .then((json)=>{\n                if(json.code!==0) {\n                    if(json.msg) throw new Error(json.msg);\n                    throw new Error(JSON.stringify(json));\n                }\n                return json;\n            });\n    },\n};","import React, {Component, PureComponent} from 'react';\nimport {format_time,Time,TitleLine} from './infrastructure/widgets';\nimport {PKUHELPER_ROOT} from './flows_api';\n\nimport './Common.css';\n\nexport {format_time,Time,TitleLine};\n\nexport const API_BASE=PKUHELPER_ROOT+'services/pkuhole';\n\n// https://stackoverflow.com/questions/3446170/escape-string-for-use-in-javascript-regex\nfunction escape_regex(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nexport function build_highlight_re(txt,split,option='g') {\n    return txt ? new RegExp(`(${txt.split(split).filter((x)=>!!x).map(escape_regex).join('|')})`,option) : /^$/g;\n}\n\nexport function ColoredSpan(props) {\n    return (\n        <span className=\"colored-span\" style={{\n            '--coloredspan-bgcolor-light': props.colors[0],\n            '--coloredspan-bgcolor-dark': props.colors[1],\n        }}>{props.children}</span>\n    )\n}\n\nexport class HighlightedText extends PureComponent {\n    render() {\n        function normalize_url(url) {\n            return /^https?:\\/\\//.test(url) ? url : 'http://'+url;\n        }\n        return (\n            <pre>\n                {this.props.parts.map((part,idx)=>{\n                    let [rule,p]=part;\n                    return (\n                        <span key={idx}>{\n                            rule==='url_pid' ? <span className=\"url-pid-link\" title={p}>/hole/##</span> :\n                            rule==='url' ? <a href={normalize_url(p)} target=\"_blank\" rel=\"noopener\">{p}</a> :\n                            rule==='pid' ? <a href={'##'+p} onClick={(e)=>{e.preventDefault(); this.props.show_pid(p);}}>{p}</a> :\n                            rule==='nickname' ? <ColoredSpan colors={this.props.color_picker.get(p)}>{p}</ColoredSpan> :\n                            rule==='search' ? <span className=\"search-query-highlight\">{p}</span> :\n                            p\n                        }</span>\n                    );\n                })}\n            </pre>\n        )\n    }\n}\n\nwindow.TEXTAREA_BACKUP={};\n\nexport class SafeTextarea extends Component {\n    constructor(props) {\n        super(props);\n        this.state={\n            text: '',\n        };\n        this.on_change_bound=this.on_change.bind(this);\n        this.on_keydown_bound=this.on_keydown.bind(this);\n        this.clear=this.clear.bind(this);\n        this.area_ref=React.createRef();\n        this.change_callback=props.on_change||(()=>{});\n        this.submit_callback=props.on_submit||(()=>{});\n    }\n\n    componentDidMount() {\n        this.setState({\n            text: window.TEXTAREA_BACKUP[this.props.id]||''\n        },()=>{\n            this.change_callback(this.state.text);\n        });\n    }\n\n    componentWillUnmount() {\n        window.TEXTAREA_BACKUP[this.props.id]=this.state.text;\n        this.change_callback(this.state.text);\n    }\n\n    on_change(event) {\n        this.setState({\n            text: event.target.value,\n        });\n        this.change_callback(event.target.value);\n    }\n    on_keydown(event) {\n        if(event.key==='Enter' && event.ctrlKey && !event.altKey) {\n            event.preventDefault();\n            this.submit_callback();\n        }\n    }\n\n    clear() {\n        this.setState({\n            text: '',\n        });\n    }\n    set(text) {\n        this.change_callback(text);\n        this.setState({\n            text: text,\n        });\n    }\n    get() {\n        return this.state.text;\n    }\n    focus() {\n        this.area_ref.current.focus();\n    }\n\n    render() {\n        return (\n            <textarea ref={this.area_ref} onChange={this.on_change_bound} value={this.state.text} onKeyDown={this.on_keydown_bound} />\n        )\n    }\n}\n\nlet pwa_prompt_event=null;\nwindow.addEventListener('beforeinstallprompt', (e) => {\n    console.log('pwa: received before install prompt');\n    pwa_prompt_event=e;\n});\n\nexport function PromotionBar(props) {\n    let is_ios=/iPhone|iPad|iPod/i.test(window.navigator.userAgent);\n    let is_installed=(window.matchMedia('(display-mode: standalone)').matches) || (window.navigator.standalone);\n\n    if(is_installed)\n        return null;\n\n    if(is_ios)\n        // noinspection JSConstructorReturnsPrimitive\n        return !navigator.standalone ? (\n            <div className=\"box promotion-bar\">\n                <span className=\"icon icon-about\" />&nbsp;\n                用 Safari 把树洞 <b>添加到主屏幕</b> 更好用\n            </div>\n        ) : null;\n    else\n        // noinspection JSConstructorReturnsPrimitive\n        return pwa_prompt_event ? (\n            <div className=\"box promotion-bar\">\n                <span className=\"icon icon-about\" />&nbsp;\n                把网页版树洞 <b><a onClick={()=>{\n                    if(pwa_prompt_event)\n                        pwa_prompt_event.prompt();\n            }}>安装到桌面</a></b> 更好用\n            </div>\n        ) : null;\n}\n\nexport class ClickHandler extends PureComponent {\n    constructor(props) {\n        super(props);\n        this.state={\n            moved: true,\n            init_y: 0,\n            init_x: 0,\n        };\n        this.on_begin_bound=this.on_begin.bind(this);\n        this.on_move_bound=this.on_move.bind(this);\n        this.on_end_bound=this.on_end.bind(this);\n\n        this.MOVE_THRESHOLD=3;\n        this.last_fire=0;\n    }\n\n    on_begin(e) {\n        //console.log('click',(e.touches?e.touches[0]:e).screenY,(e.touches?e.touches[0]:e).screenX);\n        this.setState({\n            moved: false,\n            init_y: (e.touches?e.touches[0]:e).screenY,\n            init_x: (e.touches?e.touches[0]:e).screenX,\n        });\n    }\n    on_move(e) {\n        if(!this.state.moved) {\n            let mvmt=Math.abs((e.touches?e.touches[0]:e).screenY-this.state.init_y)+Math.abs((e.touches?e.touches[0]:e).screenX-this.state.init_x);\n            //console.log('move',mvmt);\n            if(mvmt>this.MOVE_THRESHOLD)\n                this.setState({\n                    moved: true,\n                });\n        }\n    }\n    on_end(event) {\n        //console.log('end');\n        if(!this.state.moved)\n            this.do_callback(event);\n        this.setState({\n            moved: true,\n        });\n    }\n\n    do_callback(event) {\n        if(this.last_fire+100>+new Date()) return;\n        this.last_fire=+new Date();\n        this.props.callback(event);\n    }\n\n    render() {\n        return (\n            <div onTouchStart={this.on_begin_bound} onMouseDown={this.on_begin_bound}\n                 onTouchMove={this.on_move_bound} onMouseMove={this.on_move_bound}\n                 onClick={this.on_end_bound} >\n                {this.props.children}\n            </div>\n        )\n    }\n}","export function on(el, eventName, callback, opts) {\n  opts = opts || false;\n  if (el.addEventListener) {\n    el.addEventListener(eventName, callback, opts);\n  } else if (el.attachEvent) {\n    el.attachEvent(`on${eventName}`, (e) => {\n      callback.call(el, e || window.event);\n    });\n  }\n}\n\nexport function off(el, eventName, callback, opts) {\n  opts = opts || false;\n  if (el.removeEventListener) {\n    el.removeEventListener(eventName, callback, opts);\n  } else if (el.detachEvent) {\n    el.detachEvent(`on${eventName}`, callback);\n  }\n}\n","/**\n * @fileOverview Find scroll parent\n */\n\nexport default (node) => {\n  if (!(node instanceof HTMLElement)) {\n    return document.documentElement;\n  }\n\n  const excludeStaticParent = node.style.position === 'absolute';\n  const overflowRegex = /(scroll|auto)/;\n  let parent = node;\n\n  while (parent) {\n    if (!parent.parentNode) {\n      return node.ownerDocument || document.documentElement;\n    }\n\n    const style = window.getComputedStyle(parent);\n    const position = style.position;\n    const overflow = style.overflow;\n    const overflowX = style['overflow-x'];\n    const overflowY = style['overflow-y'];\n\n    if (position === 'static' && excludeStaticParent) {\n      parent = parent.parentNode;\n      continue;\n    }\n\n    if (overflowRegex.test(overflow) && overflowRegex.test(overflowX) && overflowRegex.test(overflowY)) {\n      return parent;\n    }\n\n    parent = parent.parentNode;\n  }\n\n  return node.ownerDocument || node.documentElement || document.documentElement;\n};\n","/**\n * react-lazyload\n */\nimport React, { Component, PureComponent } from 'react';\nimport ReactDom from 'react-dom';\nimport PropTypes from 'prop-types';\nimport { on, off } from './utils/event';\nimport scrollParent from './utils/scrollParent';\nimport debounce from './utils/debounce';\nimport throttle from './utils/throttle';\n\nconst defaultBoundingClientRect = { top: 0, right: 0, bottom: 0, left: 0, width: 0, height: 0 };\nconst LISTEN_FLAG = 'data-lazyload-listened';\nconst listeners = [];\nlet pending = [];\n\n// try to handle passive events\nlet passiveEventSupported = false;\ntry {\n  const opts = Object.defineProperty({}, 'passive', {\n    get() {\n      passiveEventSupported = true;\n    }\n  });\n  window.addEventListener('test', null, opts);\n}\ncatch (e) { }\n// if they are supported, setup the optional params\n// IMPORTANT: FALSE doubles as the default CAPTURE value!\nconst passiveEvent = passiveEventSupported ? { capture: false, passive: true } : false;\n\n\n/**\n * Check if `component` is visible in overflow container `parent`\n * @param  {node} component React component\n * @param  {node} parent    component's scroll parent\n * @return {bool}\n */\nconst checkOverflowVisible = function checkOverflowVisible(component, parent) {\n  const node = ReactDom.findDOMNode(component);\n\n  let parentTop;\n  let parentHeight;\n\n  try {\n    ({ top: parentTop, height: parentHeight } = parent.getBoundingClientRect());\n  } catch (e) {\n    ({ top: parentTop, height: parentHeight } = defaultBoundingClientRect);\n  }\n\n  const windowInnerHeight = window.innerHeight || document.documentElement.clientHeight;\n\n  // calculate top and height of the intersection of the element's scrollParent and viewport\n  const intersectionTop = Math.max(parentTop, 0); // intersection's top relative to viewport\n  const intersectionHeight = Math.min(windowInnerHeight, parentTop + parentHeight) - intersectionTop; // height\n\n  // check whether the element is visible in the intersection\n  let top;\n  let height;\n\n  try {\n    ({ top, height } = node.getBoundingClientRect());\n  } catch (e) {\n    ({ top, height } = defaultBoundingClientRect);\n  }\n\n  const offsetTop = top - intersectionTop; // element's top relative to intersection\n\n  const offsets = Array.isArray(component.props.offset) ?\n                component.props.offset :\n                [component.props.offset, component.props.offset]; // Be compatible with previous API\n\n  return (offsetTop - offsets[0] <= intersectionHeight) &&\n         (offsetTop + height + offsets[1] >= 0);\n};\n\n/**\n * Check if `component` is visible in document\n * @param  {node} component React component\n * @return {bool}\n */\nconst checkNormalVisible = function checkNormalVisible(component) {\n  const node = ReactDom.findDOMNode(component);\n\n  // If this element is hidden by css rules somehow, it's definitely invisible\n  if (!(node.offsetWidth || node.offsetHeight || node.getClientRects().length)) return false;\n\n  let top;\n  let elementHeight;\n\n  try {\n    ({ top, height: elementHeight } = node.getBoundingClientRect());\n  } catch (e) {\n    ({ top, height: elementHeight } = defaultBoundingClientRect);\n  }\n\n  const windowInnerHeight = window.innerHeight || document.documentElement.clientHeight;\n\n  const offsets = Array.isArray(component.props.offset) ?\n                component.props.offset :\n                [component.props.offset, component.props.offset]; // Be compatible with previous API\n\n  return (top - offsets[0] <= windowInnerHeight) &&\n         (top + elementHeight + offsets[1] >= 0);\n};\n\n\n/**\n * Detect if element is visible in viewport, if so, set `visible` state to true.\n * If `once` prop is provided true, remove component as listener after checkVisible\n *\n * @param  {React} component   React component that respond to scroll and resize\n */\nconst checkVisible = function checkVisible(component) {\n  const node = ReactDom.findDOMNode(component);\n  if (!(node instanceof HTMLElement)) {\n    return;\n  }\n\n  const parent = scrollParent(node);\n  const isOverflow = component.props.overflow &&\n                     parent !== node.ownerDocument &&\n                     parent !== document &&\n                     parent !== document.documentElement;\n  const visible = isOverflow ?\n                  checkOverflowVisible(component, parent) :\n                  checkNormalVisible(component);\n  if (visible) {\n    // Avoid extra render if previously is visible\n    if (!component.state.visible || component.state.hidden) {\n      if (component.props.once) {\n        pending.push(component);\n      }\n\n      //console.log('lazyload 1');\n      component.setState({\n        visible: true,\n        hidden: false,\n      });\n    }\n  } else if (!component.props.once) {\n    if (component.props.unmountIfInvisible) {\n      if(component.visible===true)\n        component.setState({\n          visible: false,\n        });\n    } else if(component.props.hiddenIfInvisible) {\n      if(component.state.hidden===false) {\n        //console.log('lazyload 3');\n        component.setState({\n          hidden: true,\n        });\n      }\n    }\n  }\n};\n\n\nconst purgePending = function purgePending() {\n  pending.forEach((component) => {\n    const index = listeners.indexOf(component);\n    if (index !== -1) {\n      listeners.splice(index, 1);\n    }\n  });\n\n  pending = [];\n};\n\nconst lazyLoadHandler = () => {\n  for (let i = 0; i < listeners.length; ++i) {\n    const listener = listeners[i];\n    checkVisible(listener);\n  }\n  // Remove `once` component in listeners\n  purgePending();\n};\n\n// Depending on component's props\nlet delayType;\nlet finalLazyLoadHandler = null;\n\nconst isString = string => typeof string === 'string';\n\nclass LazyLoad extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state={\n      visible: false,\n      hidden: false,\n    };\n  }\n\n  componentDidMount() {\n    // It's unlikely to change delay type on the fly, this is mainly\n    // designed for tests\n    let scrollport = window;\n    const {\n      scrollContainer,\n    } = this.props;\n    if (scrollContainer) {\n      if (isString(scrollContainer)) {\n        scrollport = scrollport.document.querySelector(scrollContainer);\n      }\n    }\n    const needResetFinalLazyLoadHandler = (this.props.debounce !== undefined && delayType === 'throttle')\n      || (delayType === 'debounce' && this.props.debounce === undefined);\n\n    if (needResetFinalLazyLoadHandler) {\n      off(scrollport, 'scroll', finalLazyLoadHandler, passiveEvent);\n      off(window, 'resize', finalLazyLoadHandler, passiveEvent);\n      finalLazyLoadHandler = null;\n    }\n\n    if (!finalLazyLoadHandler) {\n      if (this.props.debounce !== undefined) {\n        finalLazyLoadHandler = debounce(lazyLoadHandler, typeof this.props.debounce === 'number' ?\n                                                         this.props.debounce :\n                                                         300);\n        delayType = 'debounce';\n      } else if (this.props.throttle !== undefined) {\n        finalLazyLoadHandler = throttle(lazyLoadHandler, typeof this.props.throttle === 'number' ?\n                                                         this.props.throttle :\n                                                         300);\n        delayType = 'throttle';\n      } else {\n        finalLazyLoadHandler = lazyLoadHandler;\n      }\n    }\n\n    if (this.props.overflow) {\n      const parent = scrollParent(ReactDom.findDOMNode(this));\n      if (parent && typeof parent.getAttribute === 'function') {\n        const listenerCount = 1 + (+parent.getAttribute(LISTEN_FLAG));\n        if (listenerCount === 1) {\n          parent.addEventListener('scroll', finalLazyLoadHandler, passiveEvent);\n        }\n        parent.setAttribute(LISTEN_FLAG, listenerCount);\n      }\n    } else if (listeners.length === 0 || needResetFinalLazyLoadHandler) {\n      const { scroll, resize } = this.props;\n\n      if (scroll) {\n        on(scrollport, 'scroll', finalLazyLoadHandler, passiveEvent);\n      }\n\n      if (resize) {\n        on(window, 'resize', finalLazyLoadHandler, passiveEvent);\n      }\n    }\n\n    listeners.push(this);\n    checkVisible(this);\n  }\n\n  componentWillUnmount() {\n    if (this.props.overflow) {\n      const parent = scrollParent(ReactDom.findDOMNode(this));\n      if (parent && typeof parent.getAttribute === 'function') {\n        const listenerCount = (+parent.getAttribute(LISTEN_FLAG)) - 1;\n        if (listenerCount === 0) {\n          parent.removeEventListener('scroll', finalLazyLoadHandler, passiveEvent);\n          parent.removeAttribute(LISTEN_FLAG);\n        } else {\n          parent.setAttribute(LISTEN_FLAG, listenerCount);\n        }\n      }\n    }\n\n    const index = listeners.indexOf(this);\n    if (index !== -1) {\n      listeners.splice(index, 1);\n    }\n\n    if (listeners.length === 0 && typeof window !== 'undefined') {\n      off(window, 'resize', finalLazyLoadHandler, passiveEvent);\n      off(window, 'scroll', finalLazyLoadHandler, passiveEvent);\n    }\n  }\n\n  render() {\n    //console.log('lazyload render');\n    if(this.state.visible) {\n      if(this.props.hiddenIfInvisible)\n        return this.state.hidden ?\n            <div style={{visibility: 'hidden'}}>{this.props.children}</div> :\n            <div>{this.props.children}</div>;\n      else\n        return this.props.children;\n    }\n    else\n      return this.props.placeholder ?\n                this.props.placeholder :\n                <div style={{ height: this.props.height }} className=\"lazyload-placeholder\" />;\n  }\n}\n\nLazyLoad.propTypes = {\n  once: PropTypes.bool,\n  height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  offset: PropTypes.oneOfType([PropTypes.number, PropTypes.arrayOf(PropTypes.number)]),\n  overflow: PropTypes.bool,\n  resize: PropTypes.bool,\n  scroll: PropTypes.bool,\n  children: PropTypes.node,\n  throttle: PropTypes.oneOfType([PropTypes.number, PropTypes.bool]),\n  debounce: PropTypes.oneOfType([PropTypes.number, PropTypes.bool]),\n  placeholder: PropTypes.node,\n  scrollContainer: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\n  unmountIfInvisible: PropTypes.bool,\n  hiddenIfInvisible: PropTypes.bool,\n};\n\nLazyLoad.defaultProps = {\n  once: false,\n  offset: 0,\n  overflow: false,\n  resize: false,\n  scroll: true,\n  unmountIfInvisible: false,\n  hiddenIfInvisible: false,\n};\n\nconst getDisplayName = WrappedComponent => WrappedComponent.displayName || WrappedComponent.name || 'Component';\n\nconst decorator = (options = {}) => function lazyload(WrappedComponent) {\n  return class LazyLoadDecorated extends Component {\n    constructor() {\n      super();\n      this.displayName = `LazyLoad${getDisplayName(WrappedComponent)}`;\n    }\n\n    render() {\n      return (\n        <LazyLoad {...options}>\n          <WrappedComponent {...this.props} />\n        </LazyLoad>\n      );\n    }\n  };\n};\n\nexport { decorator as lazyload };\nexport default LazyLoad;\nexport { lazyLoadHandler as forceCheck };\n","export default function debounce(func, wait, immediate) {\n  let timeout;\n  let args;\n  let context;\n  let timestamp;\n  let result;\n\n  const later = function later() {\n    const last = +(new Date()) - timestamp;\n\n    if (last < wait && last >= 0) {\n      timeout = setTimeout(later, wait - last);\n    } else {\n      timeout = null;\n      if (!immediate) {\n        result = func.apply(context, args);\n        if (!timeout) {\n          context = null;\n          args = null;\n        }\n      }\n    }\n  };\n\n  return function debounced() {\n    context = this;\n    args = arguments;\n    timestamp = +(new Date());\n\n    const callNow = immediate && !timeout;\n    if (!timeout) {\n      timeout = setTimeout(later, wait);\n    }\n\n    if (callNow) {\n      result = func.apply(context, args);\n      context = null;\n      args = null;\n    }\n\n    return result;\n  };\n}\n","/*eslint-disable */\nexport default function throttle(fn, threshhold, scope) {\n  threshhold || (threshhold = 250);\n  var last,\n      deferTimer;\n  return function () {\n    var context = scope || this;\n\n    var now = +new Date,\n        args = arguments;\n    if (last && now < last + threshhold) {\n      // hold on to it\n      clearTimeout(deferTimer);\n      deferTimer = setTimeout(function () {\n        last = now;\n        fn.apply(context, args);\n      }, threshhold);\n    } else {\n      last = now;\n      fn.apply(context, args);\n    }\n  };\n}\n","import React, {Component} from 'react';\nimport load from 'load-script';\n\nwindow.audio_cache={};\n\nfunction load_amrnb() {\n    return new Promise((resolve,reject)=>{\n        if(window.AMR)\n            resolve();\n        else\n            load('static/amr_all.min.js', (err)=>{\n                if(err)\n                    reject(err);\n                else\n                    resolve();\n            });\n    });\n}\n\nexport class AudioWidget extends Component {\n    constructor(props) {\n        super(props);\n        this.state={\n            url: this.props.src,\n            state: 'waiting',\n            data: null,\n        };\n    }\n\n    load() {\n        if(window.audio_cache[this.state.url]) {\n            this.setState({\n                state: 'loaded',\n                data: window.audio_cache[this.state.url],\n            });\n            return;\n        }\n\n        console.log('fetching audio',this.state.url);\n        this.setState({\n            state: 'loading',\n        });\n        Promise.all([\n            fetch(this.state.url),\n            load_amrnb(),\n        ])\n            .then((res)=>{\n                res[0].blob().then((blob)=>{\n                    const reader=new FileReader();\n                    reader.onload=(event)=>{\n                        const raw=new window.AMR().decode(event.target.result);\n                        if(!raw) {\n                            alert('audio decoding failed');\n                            return;\n                        }\n                        const wave=window.PCMData.encode({\n                            sampleRate: 8000,\n                            channelCount: 1,\n                            bytesPerSample: 2,\n                            data: raw\n                        });\n                        const binary_wave=new Uint8Array(wave.length);\n                        for(let i=0;i<wave.length;i++)\n                            binary_wave[i]=wave.charCodeAt(i);\n\n                        const objurl=URL.createObjectURL(new Blob([binary_wave], {type: 'audio/wav'}));\n                        window.audio_cache[this.state.url]=objurl;\n                        this.setState({\n                            state: 'loaded',\n                            data: objurl,\n                        });\n                    };\n                    reader.readAsBinaryString(blob);\n                });\n                this.setState({\n                    state: 'decoding',\n                });\n            });\n    }\n\n    render() {\n        if(this.state.state==='waiting')\n            return (<p><a onClick={this.load.bind(this)}>加载音频</a></p>);\n        if(this.state.state==='loading')\n            return (<p>正在下载……</p>);\n        else if(this.state.state==='decoding')\n            return (<p>正在解码……</p>);\n        else if(this.state.state==='loaded')\n            return (<p><audio src={this.state.data} controls /></p>);\n    }\n}","import React, {Component, PureComponent} from 'react';\nimport {PKUHELPER_ROOT, get_json, API_VERSION_PARAM} from './flows_api';\nimport {Time} from './Common';\n\nexport class MessageViewer extends PureComponent {\n    constructor(props) {\n        super(props);\n        this.state={\n            loading_status: 'idle',\n            msg: [],\n        };\n    }\n\n    componentDidMount() {\n        this.load();\n    }\n\n    load() {\n        if(this.state.loading_status==='loading') return;\n        this.setState({\n            loading_status: 'loading',\n        },()=>{\n            fetch(PKUHELPER_ROOT+'api_xmcp/hole/system_msg?user_token='+encodeURIComponent(this.props.token)+API_VERSION_PARAM())\n                .then(get_json)\n                .then((json)=>{\n                    if(json.error)\n                        throw new Error(json.error);\n                    else\n                        this.setState({\n                            loading_status: 'done',\n                            msg: json.result,\n                        });\n                })\n                .catch((err)=>{\n                    console.error(err);\n                    alert(''+err);\n                    this.setState({\n                        loading_status: 'failed',\n                    });\n                })\n\n        });\n    }\n\n    render() {\n        if(this.state.loading_status==='loading')\n            return (<p className=\"box box-tip\">加载中……</p>);\n        else if(this.state.loading_status==='failed')\n            return (<div className=\"box box-tip\"><a onClick={()=>{this.load()}}>重新加载</a></div>);\n        else if(this.state.loading_status==='done')\n            return this.state.msg.map((msg)=>(\n                <div className=\"box\">\n                    <div className=\"box-header\">\n                        <Time stamp={msg.timestamp} />\n                        &nbsp; <b>{msg.title}</b>\n                    </div>\n                    <div className=\"box-content\">\n                        <pre>{msg.content}</pre>\n                    </div>\n                </div>\n            ));\n        else\n            return null;\n    }\n}","import React, {Component, PureComponent} from 'react';\n\nimport './Config.css';\n\nconst BUILTIN_IMGS={\n    'static/bg/gbp.jpg': '寻觅繁星（默认）',\n    'static/bg/eriri.jpg': '平成著名画师',\n    'static/bg/yurucamp.jpg': '露营天下第一',\n    'static/bg/minecraft.jpg': '麦恩·库拉夫特',\n    'static/bg/sif.jpg': '梦开始的地方',\n};\n\nconst DEFAULT_CONFIG={\n    background_img: 'static/bg/gbp.jpg',\n    background_color: '#113366',\n    pressure: false,\n    easter_egg: true,\n    color_scheme: 'default',\n    block_words: ['xz', 'ao3', 'ghs']\n};\n\nexport function load_config() {\n    let config=Object.assign({},DEFAULT_CONFIG);\n    let loaded_config;\n    try {\n        loaded_config=JSON.parse(localStorage['hole_config']||'{}');\n    } catch(e) {\n        alert('设置加载失败，将重置为默认设置！\\n'+e);\n        delete localStorage['hole_config'];\n        loaded_config={};\n    }\n\n    // unrecognized configs are removed\n    Object.keys(loaded_config).forEach((key)=>{\n        if(config[key]!==undefined)\n            config[key]=loaded_config[key];\n    });\n\n    console.log('config loaded',config);\n    window.config=config;\n}\nexport function save_config() {\n    localStorage['hole_config']=JSON.stringify(window.config);\n    load_config();\n}\n\nexport function bgimg_style(img,color) {\n    if(img===undefined) img=window.config.background_img;\n    if(color===undefined) color=window.config.background_color;\n    return {\n        background: 'transparent center center',\n        backgroundImage: img===null ? 'unset' : 'url(\"'+encodeURI(img)+'\")',\n        backgroundColor: color,\n        backgroundSize: 'cover',\n    };\n}\n\nclass ConfigBackground extends PureComponent {\n    constructor(props) {\n        super(props);\n        this.state={\n            img: window.config.background_img,\n            color: window.config.background_color,\n        };\n    }\n\n    save_changes() {\n        this.props.callback({\n            background_img: this.state.img,\n            background_color: this.state.color,\n        });\n    }\n\n    on_select(e) {\n        let value=e.target.value;\n        this.setState({\n            img: value==='##other' ? '' :\n                 value==='##color' ? null : value,\n        },this.save_changes.bind(this));\n    }\n    on_change_img(e) {\n        this.setState({\n            img: e.target.value,\n        },this.save_changes.bind(this));\n    }\n    on_change_color(e) {\n        this.setState({\n            color: e.target.value,\n        },this.save_changes.bind(this));\n    }\n\n    render() {\n        let img_select= this.state.img===null ? '##color' :\n                        Object.keys(BUILTIN_IMGS).indexOf(this.state.img)===-1 ? '##other' : this.state.img;\n        return (\n            <div>\n                <p>\n                    <b>背景图片：</b>\n                    <select value={img_select} onChange={this.on_select.bind(this)}>\n                        {Object.keys(BUILTIN_IMGS).map((key)=>(\n                            <option key={key} value={key}>{BUILTIN_IMGS[key]}</option>\n                        ))}\n                        <option value=\"##other\">输入图片网址……</option>\n                        <option value=\"##color\">纯色背景……</option>\n                    </select>\n                    &nbsp;\n                    {img_select==='##other' &&\n                        <input type=\"url\" placeholder=\"图片网址\" value={this.state.img} onChange={this.on_change_img.bind(this)} />\n                    }\n                    {img_select==='##color' &&\n                        <input type=\"color\" value={this.state.color} onChange={this.on_change_color.bind(this)} />\n                    }\n                </p>\n                <div className=\"bg-preview\" style={bgimg_style(this.state.img,this.state.color)} />\n            </div>\n        );\n    }\n}\n\nclass ConfigColorScheme extends PureComponent {\n    constructor(props) {\n        super(props);\n        this.state={\n            color_scheme: window.config.color_scheme,\n        };\n    }\n\n    save_changes() {\n        this.props.callback({\n            color_scheme: this.state.color_scheme,\n        });\n    }\n\n    on_select(e) {\n        let value=e.target.value;\n        this.setState({\n            color_scheme: value,\n        },this.save_changes.bind(this));\n    }\n\n    render() {\n        return (\n            <div>\n                <p>\n                    <b>夜间模式：</b>\n                    <select value={this.state.color_scheme} onChange={this.on_select.bind(this)}>\n                        <option value=\"default\">跟随系统</option>\n                        <option value=\"light\">始终浅色模式</option>\n                        <option value=\"dark\">始终深色模式</option>\n                    </select>\n                    &nbsp; <small>#color_scheme</small>\n                </p>\n                <p>\n                    选择浅色或深色模式，深色模式下将会调暗图片亮度\n                </p>\n            </div>\n        )\n    }\n}\n\nclass ConfigBlockWords extends PureComponent {\n    constructor(props) {\n        super(props);\n        this.state={\n            block_words: window.config.block_words,\n        };\n    }\n\n    save_changes() {\n        this.props.callback({\n            block_words: this.state.block_words,\n        });\n    }\n\n    on_change(e) {\n        let value=e.target.value.split('\\n');\n        this.setState({\n            block_words: value,\n        },this.save_changes.bind(this));\n    }\n\n    render() {\n        return (\n            <div>\n                <p> <b>设置屏蔽词 </b></p>\n                <p>\n                    <textarea \n                    className='block-words'\n                    value={this.state.block_words.join('\\n')} \n                    onChange={this.on_change.bind(this)}>\n\n                    </textarea>\n                </p>\n\n            </div>\n        )\n    }\n}\n\nclass ConfigSwitch extends PureComponent {\n    constructor(props) {\n        super(props);\n        this.state={\n            switch: window.config[this.props.id],\n        };\n    }\n\n    on_change(e) {\n        let val=e.target.checked;\n        this.setState({\n            switch: val,\n        },()=>{\n            this.props.callback({\n                [this.props.id]: val,\n            });\n        });\n    }\n\n    render() {\n        return (\n            <div>\n                <p>\n                    <label>\n                        <input name={'config-'+this.props.id} type=\"checkbox\" checked={this.state.switch} onChange={this.on_change.bind(this)} />\n                        <b>{this.props.name}</b>\n                        &nbsp; <small>#{this.props.id}</small>\n                    </label>\n                </p>\n                <p>\n                    {this.props.description}\n                </p>\n            </div>\n        );\n    }\n}\n\nexport class ConfigUI extends PureComponent {\n    constructor(props) {\n        super(props);\n        this.save_changes_bound=this.save_changes.bind(this);\n    }\n\n    save_changes(chg) {\n        console.log(chg);\n        Object.keys(chg).forEach((key)=>{\n            window.config[key]=chg[key];\n        });\n        save_config();\n    }\n\n    reset_settings() {\n        if(window.confirm('重置所有设置？')) {\n            window.config={};\n            save_config();\n            window.location.reload();\n        }\n    }\n\n    render() {\n        return (\n            <div>\n                <div className=\"box config-ui-header\">\n                    <p>这些功能仍在测试，可能不稳定（<a onClick={this.reset_settings.bind(this)}>全部重置</a>）</p>\n                    <p><b>修改设置后 <a onClick={()=>{window.location.reload()}}>刷新页面</a> 方可生效</b></p>\n                </div>\n                <div className=\"box\">\n                    <ConfigBackground callback={this.save_changes_bound} />\n                    <hr />\n                    <ConfigColorScheme callback={this.save_changes_bound} />\n                    <hr />\n                    <ConfigBlockWords callback={this.save_changes_bound} />\n                    <hr />\n                    <ConfigSwitch callback={this.save_changes_bound} id=\"pressure\" name=\"快速返回\"\n                                  description=\"短暂按住 Esc 键或重压屏幕（3D Touch）可以快速返回或者刷新树洞\"\n                    />\n                    <hr />\n                    <ConfigSwitch callback={this.save_changes_bound} id=\"easter_egg\" name=\"允许彩蛋\"\n                                  description=\"在某些情况下显示彩蛋\"\n                    />\n                    <hr />\n                    <p>\n                        新功能建议或问题反馈请在&nbsp;\n                        <a href=\"https://github.com/pkuhelper-web/webhole/issues\" target=\"_blank\">GitHub <span className=\"icon icon-github\" /></a>\n                        &nbsp;提出。\n                    </p>\n                </div>\n            </div>\n        )\n    }\n}\n","import React, {Component, PureComponent} from 'react';\nimport {API_BASE, SafeTextarea, PromotionBar} from './Common';\nimport {MessageViewer} from './Message';\nimport {LoginPopup} from './infrastructure/widgets';\nimport {ConfigUI} from './Config';\nimport fixOrientation from 'fix-orientation';\nimport copy from 'copy-to-clipboard';\nimport {cache} from './cache';\nimport {API_VERSION_PARAM, PKUHELPER_ROOT, API, get_json, token_param} from './flows_api';\n\nimport './UserAction.css';\n\nconst BASE64_RATE=4/3;\nconst MAX_IMG_DIAM=8000;\nconst MAX_IMG_PX=5000000;\nconst MAX_IMG_FILESIZE=450000*BASE64_RATE;\n\nexport const TokenCtx=React.createContext({\n    value: null,\n    set_value: ()=>{},\n});\n\nclass LifeInfoBox extends Component {\n    constructor(props) {\n        super(props);\n        if(!window._life_info_cache)\n            window._life_info_cache={};\n        this.CACHE_TIMEOUT_S=15;\n        this.state={\n            today_info: this.cache_get('today_info'),\n            card_balance: this.cache_get('card_balance'),\n            net_balance: this.cache_get('net_balance'),\n            mail_count: this.cache_get('mail_count'),\n        };\n        this.INTERNAL_NETWORK_FAILURE='_network_failure';\n        this.API_NAME={\n            today_info: 'hole/today_info',\n            card_balance: 'isop/card_balance',\n            net_balance: 'isop/net_balance',\n            mail_count: 'isop/mail_count',\n        };\n    }\n\n    cache_get(key) {\n        let cache_item=window._life_info_cache[key];\n        if(!cache_item || (+new Date())-cache_item[0]>1000*this.CACHE_TIMEOUT_S)\n            return null;\n        else\n            return cache_item[1];\n    }\n    cache_set(key,value) {\n        if(!window._life_info_cache[key] || window._life_info_cache[key][1]!==value)\n            window._life_info_cache[key]=[+new Date(),value];\n    }\n\n    load(state_key) {\n        this.setState({\n            [state_key]: null,\n        },()=>{\n            fetch(\n                PKUHELPER_ROOT+'api_xmcp/'+this.API_NAME[state_key]\n                +'?user_token='+encodeURIComponent(this.props.token)\n                +API_VERSION_PARAM()\n            )\n                .then(get_json)\n                .then((json)=>{\n                    //console.log(json);\n                    this.setState({\n                        [state_key]: json,\n                    });\n                })\n                .catch((e)=>{\n                    this.setState({\n                        [state_key]: {\n                            errMsg: '网络错误 '+e,\n                            errCode: this.INTERNAL_NETWORK_FAILURE,\n                            success: false,\n                        }\n                    });\n                })\n        });\n    }\n\n    componentDidMount() {\n        ['today_info','card_balance','net_balance','mail_count'].forEach((k)=>{\n            if(!this.state[k])\n                this.load(k);\n        });\n    }\n\n    reload_all() {\n        ['today_info','card_balance','net_balance','mail_count'].forEach((k)=>{\n            this.load(k);\n        });\n    }\n\n    render_line(state_key,title,value_fn,action,url_fn,do_login) {\n        let s=this.state[state_key];\n        if(!s)\n            return (\n                <tr>\n                    <td>{title}</td>\n                    <td>加载中……</td>\n                    <td />\n                </tr>\n            );\n        else if(!s.success) {\n            let type='加载失败';\n            if(s.errCode===this.INTERNAL_NETWORK_FAILURE)\n                type='网络错误';\n            else if(['E01','E02','E03'].indexOf(s.errCode)!==-1)\n                type='授权失效';\n\n            let details=JSON.stringify(s);\n            if(s.errMsg)\n                details=s.errMsg;\n            else if(s.error)\n                details=s.error;\n\n            return (\n                <tr>\n                    <td>{title}</td>\n                    <td className=\"life-info-error\">\n                        <a onClick={()=>alert(details)}>{type}</a>\n                    </td>\n                    <td>\n                        {type==='授权失效' ?\n                            <a onClick={do_login}>\n                                <span className=\"icon icon-forward\" />&nbsp;重新登录\n                            </a> :\n                            <a onClick={()=>this.load(state_key)}>\n                                <span className=\"icon icon-forward\" />&nbsp;重试\n                            </a>\n                        }\n                    </td>\n                </tr>\n            )\n        }\n        else {\n            this.cache_set(state_key,s);\n\n            return (\n                <tr>\n                    <td>{title}</td>\n                    <td>{value_fn(s)}</td>\n                    <td>\n                        <a href={url_fn(s)} target=\"_blank\">\n                            <span className=\"icon icon-forward\" />&nbsp;{action}\n                        </a>\n                    </td>\n                </tr>\n            );\n        }\n    }\n\n    render() {\n        return (\n            <LoginPopup token_callback={(t)=>{\n                this.props.set_token(t);\n                this.reload_all();\n            }}>{(do_login)=>(\n                <div className=\"box\">\n                    <table className=\"life-info-table\">\n                        <tbody>\n                            {this.render_line(\n                                'today_info',\n                                '今日',(s)=>s.info,\n                                '校历',(s)=>s.schedule_url,\n                                do_login,\n                            )}\n                            {this.render_line(\n                                'card_balance',\n                                '校园卡',(s)=>`余额￥${s.balance.toFixed(2)}`,\n                                '充值',()=>'https://virtualprod.alipay.com/educate/educatePcRecharge.htm?schoolCode=PKU&schoolName=',\n                                do_login,\n                            )}\n                            {this.render_line(\n                                'net_balance',\n                                '网费',(s)=>`余额￥${s.balance.toFixed(2)}`,\n                                '充值',()=>'https://its.pku.edu.cn/epay.jsp',\n                                do_login,\n                            )}\n                            {this.render_line(\n                                'mail_count',\n                                '邮件',(s)=>`未读 ${s.count} 封`,\n                                '查看',()=>'https://mail.pku.edu.cn/',\n                                do_login,\n                            )}\n                        </tbody>\n                    </table>\n                </div>\n            )}</LoginPopup>\n        )\n    }\n}\n\nexport function InfoSidebar(props) {\n    return (\n        <div>\n            <PromotionBar />\n            <LoginForm show_sidebar={props.show_sidebar} />\n            <div className=\"box list-menu\">\n                <a onClick={()=>{props.show_sidebar(\n                    '设置',\n                    <ConfigUI />\n                )}}>\n                    <span className=\"icon icon-settings\" /><label>网页版树洞设置</label>\n                </a>\n                &nbsp;&nbsp;\n                <a href=\"http://pkuhelper.pku.edu.cn/treehole_rules.html\" target=\"_blank\">\n                    <span className=\"icon icon-textfile\" /><label>树洞规范</label>\n                </a>\n                &nbsp;&nbsp;\n                <a href=\"https://github.com/pkuhelper-web/webhole/issues\" target=\"_blank\">\n                    <span className=\"icon icon-github\" /><label>意见反馈</label>\n                </a>\n            </div>\n            <div className=\"box help-desc-box\">\n                <p>\n                    PKUHelper 网页版树洞 by @xmcp，\n                    基于&nbsp;\n                    <a href=\"https://www.gnu.org/licenses/gpl-3.0.zh-cn.html\" target=\"_blank\">GPLv3</a>\n                    &nbsp;协议在 <a href=\"https://github.com/pkuhelper-web/webhole\" target=\"_blank\">GitHub</a> 开源\n                </p>\n                <p>\n                    PKUHelper 网页版的诞生离不开&nbsp;\n                    <a href=\"https://reactjs.org/\" target=\"_blank\" rel=\"noopener\">React</a>\n                    、\n                    <a href=\"https://icomoon.io/#icons\" target=\"_blank\" rel=\"noopener\">IcoMoon</a>\n                    &nbsp;等开源项目\n                </p>\n                <p>\n                    <a onClick={()=>{\n                        if('serviceWorker' in navigator) {\n                            navigator.serviceWorker.getRegistrations()\n                                .then((registrations)=>{\n                                    for(let registration of registrations) {\n                                        console.log('unregister',registration);\n                                        registration.unregister();\n                                    }\n                                });\n                        }\n                        cache().clear();\n                        setTimeout(()=>{\n                            window.location.reload(true);\n                        },200);\n                    }}>强制检查更新</a>\n                    （{process.env.REACT_APP_BUILD_INFO||'---'} {process.env.NODE_ENV} 会自动在后台检查更新并在下次访问时更新）\n                </p>\n                <p>\n                    This program is free software: you can redistribute it and/or modify\n                    it under the terms of the GNU General Public License as published by\n                    the Free Software Foundation, either version 3 of the License, or\n                    (at your option) any later version.\n                </p>\n                <p>\n                    This program is distributed in the hope that it will be useful,\n                    but WITHOUT ANY WARRANTY; without even the implied warranty of\n                    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the&nbsp;\n                    <a href=\"https://www.gnu.org/licenses/gpl-3.0.zh-cn.html\" target=\"_blank\">GNU General Public License</a>\n                    &nbsp;for more details.\n                </p>\n            </div>\n        </div>\n    );\n}\n\nclass ResetUsertokenWidget extends Component {\n    constructor(props) {\n        super(props);\n        this.state={\n            loading_status: 'done',\n        };\n    }\n\n    do_reset() {\n        if(window.confirm('您正在重置 UserToken！\\n您的账号将会在【所有设备】上注销，您需要手动重新登录！')) {\n            let uid=window.prompt('您正在重置 UserToken！\\n请输入您的学号以确认身份：');\n            if(uid)\n                this.setState({\n                    loading_status: 'loading',\n                },()=>{\n                    fetch(PKUHELPER_ROOT+'api_xmcp/hole/reset_usertoken', {\n                        method: 'post',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                        body: JSON.stringify({\n                            user_token: this.props.token,\n                            uid: uid,\n                        }),\n                    })\n                        .then(get_json)\n                        .then((json)=>{\n                            if(json.error)\n                                throw new Error(json.error);\n                            else\n                                alert('重置成功！您需要在所有设备上重新登录。');\n\n                            this.setState({\n                                loading_status: 'done',\n                            });\n                        })\n                        .catch((e)=>{\n                            alert('重置失败：'+e);\n                            this.setState({\n                                loading_status: 'done',\n                            });\n                        })\n                });\n        }\n    }\n\n    render() {\n        if(this.state.loading_status==='done')\n            return (<a onClick={this.do_reset.bind(this)}>重置</a>);\n        else if(this.state.loading_status==='loading')\n            return (<a><span className=\"icon icon-loading\" /></a>);\n    }\n}\n\nexport class LoginForm extends Component {\n    copy_token(token) {\n        if(copy(token))\n            alert('复制成功！\\n请一定不要泄露哦');\n    }\n\n    render() {\n        return (\n            <TokenCtx.Consumer>{(token)=>\n                <div>\n                    {!!token.value &&\n                        <LifeInfoBox token={token.value} set_token={token.set_value} />\n                    }\n                    <div className=\"login-form box\">\n                        {token.value ?\n                            <div>\n                                <p>\n                                    <b>您已登录。</b>\n                                    <button type=\"button\" onClick={()=>{token.set_value(null);}}>\n                                        <span className=\"icon icon-logout\" /> 注销\n                                    </button>\n                                    <br />\n                                </p>\n                                <p>\n                                    根据计算中心要求，访问授权三个月内有效，过期需重新登录。\n                                </p>\n                                <p>\n                                    <a onClick={()=>{this.props.show_sidebar(\n                                        '系统消息',\n                                        <MessageViewer token={token.value} />\n                                    )}}>查看系统消息</a><br />\n                                    当您发送的内容违规时，我们将用系统消息提示您\n                                </p>\n                                <p>\n                                    <a onClick={this.copy_token.bind(this,token.value)}>复制 User Token</a><br />\n                                    User Token 用于迁移登录状态，切勿告知他人，若怀疑被盗号请尽快 <ResetUsertokenWidget token={token.value} />\n                                </p>\n                            </div> :\n                            <LoginPopup token_callback={token.set_value}>{(do_popup)=>(\n                                <div>\n                                    <p>\n                                        <button type=\"button\" onClick={do_popup}>\n                                            <span className=\"icon icon-login\" />\n                                            &nbsp;登录\n                                        </button>\n                                    </p>\n                                    <p><small>\n                                        PKU Helper 面向北京大学学生，通过 ISOP（北京大学数据共享开放服务平台）验证您的身份并提供服务。\n                                    </small></p>\n                                </div>\n                            )}</LoginPopup>\n                        }\n                    </div>\n                </div>\n            }</TokenCtx.Consumer>\n        )\n    }\n}\n\nexport class ReplyForm extends Component {\n    constructor(props) {\n        super(props);\n        this.state={\n            text: '',\n            loading_status: 'done',\n        };\n        this.on_change_bound=this.on_change.bind(this);\n        this.area_ref=this.props.area_ref||React.createRef();\n        this.global_keypress_handler_bound=this.global_keypress_handler.bind(this);\n    }\n\n    global_keypress_handler(e) {\n        if(e.code==='Enter' && !e.ctrlKey && !e.altKey && ['input','textarea'].indexOf(e.target.tagName.toLowerCase())===-1) {\n            if(this.area_ref.current) {\n                e.preventDefault();\n                this.area_ref.current.focus();\n            }\n        }\n    }\n    componentDidMount() {\n        document.addEventListener('keypress',this.global_keypress_handler_bound);\n    }\n    componentWillUnmount() {\n        document.removeEventListener('keypress',this.global_keypress_handler_bound);\n    }\n\n    on_change(value) {\n        this.setState({\n            text: value,\n        });\n    }\n\n    on_submit(event) {\n        if(event) event.preventDefault();\n        if(this.state.loading_status==='loading')\n            return;\n        this.setState({\n            loading_status: 'loading',\n        });\n\n        let data=new URLSearchParams();\n        data.append('pid',this.props.pid);\n        data.append('text',this.state.text);\n        data.append('user_token',this.props.token);\n        fetch(API_BASE+'/api.php?action=docomment'+token_param(this.props.token), {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded',\n            },\n            body: data,\n        })\n            .then(get_json)\n            .then((json)=>{\n                if(json.code!==0) {\n                    if(json.msg) alert(json.msg);\n                    throw new Error(JSON.stringify(json));\n                }\n\n                this.setState({\n                    loading_status: 'done',\n                    text: '',\n                });\n                this.area_ref.current.clear();\n                this.props.on_complete();\n            })\n            .catch((e)=>{\n                console.error(e);\n                alert('回复失败');\n                this.setState({\n                    loading_status: 'done',\n                });\n            });\n    }\n\n    render() {\n        return (\n            <form onSubmit={this.on_submit.bind(this)} className={'reply-form box'+(this.state.text?' reply-sticky':'')}>\n                <SafeTextarea key={this.props.pid} ref={this.area_ref} id={this.props.pid} on_change={this.on_change_bound} on_submit={this.on_submit.bind(this)} />\n                {this.state.loading_status==='loading' ?\n                    <button disabled=\"disabled\">\n                        <span className=\"icon icon-loading\" />\n                    </button> :\n                    <button type=\"submit\">\n                        <span className=\"icon icon-send\" />\n                    </button>\n                }\n            </form>\n        )\n    }\n}\n\nexport class PostForm extends Component {\n    constructor(props) {\n        super(props);\n        this.state={\n            text: '',\n            loading_status: 'done',\n            img_tip: null,\n        };\n        this.img_ref=React.createRef();\n        this.area_ref=React.createRef();\n        this.on_change_bound=this.on_change.bind(this);\n        this.on_img_change_bound=this.on_img_change.bind(this);\n    }\n\n    componentDidMount() {\n        if(this.area_ref.current)\n            this.area_ref.current.focus();\n    }\n\n    on_change(value) {\n        this.setState({\n            text: value,\n        });\n    }\n\n    do_post(text,img) {\n        let data=new URLSearchParams();\n        data.append('text',this.state.text);\n        data.append('type',img ? 'image' : 'text');\n        data.append('user_token',this.props.token);\n        if(img)\n            data.append('data',img);\n\n        fetch(API_BASE+'/api.php?action=dopost'+token_param(this.props.token), {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded',\n            },\n            body: data,\n        })\n            .then(get_json)\n            .then((json)=>{\n                if(json.code!==0) {\n                    if(json.msg) alert(json.msg);\n                    throw new Error(JSON.stringify(json));\n                }\n\n                this.setState({\n                    loading_status: 'done',\n                    text: '',\n                });\n                this.area_ref.current.clear();\n                this.props.on_complete();\n            })\n            .catch((e)=>{\n                console.error(e);\n                alert('发表失败');\n                this.setState({\n                    loading_status: 'done',\n                });\n            });\n    }\n\n    proc_img(file) {\n        return new Promise((resolve,reject)=>{\n            function return_url(url) {\n                const idx=url.indexOf(';base64,');\n                if(idx===-1)\n                    throw new Error('img not base64 encoded');\n\n                return url.substr(idx+8);\n            }\n\n            let reader=new FileReader();\n            function on_got_img(url) {\n                const image = new Image();\n                image.onload=(()=>{\n                    let width=image.width;\n                    let height=image.height;\n                    let compressed=false;\n                    \n                    if(width>MAX_IMG_DIAM) {\n                        height=height*MAX_IMG_DIAM/width;\n                        width=MAX_IMG_DIAM;\n                        compressed=true;\n                    }\n                    if(height>MAX_IMG_DIAM) {\n                        width=width*MAX_IMG_DIAM/height;\n                        height=MAX_IMG_DIAM;\n                        compressed=true;\n                    }\n                    if(height*width>MAX_IMG_PX) {\n                        let rate=Math.sqrt(height*width/MAX_IMG_PX);\n                        height/=rate;\n                        width/=rate;\n                        compressed=true;\n                    }\n                    console.log('chosen img size',width,height);\n\n                    let canvas=document.createElement('canvas');\n                    let ctx=canvas.getContext('2d');\n                    canvas.width=width;\n                    canvas.height=height;\n                    ctx.drawImage(image,0,0,width,height);\n\n                    let quality_l=.1,quality_r=.9,quality,new_url;\n                    while(quality_r-quality_l>=.03) {\n                        quality=(quality_r+quality_l)/2;\n                        new_url=canvas.toDataURL('image/jpeg',quality);\n                        console.log(quality_l,quality_r,'trying quality',quality,'size',new_url.length);\n                        if(new_url.length<=MAX_IMG_FILESIZE)\n                            quality_l=quality;\n                        else\n                            quality_r=quality;\n                    }\n                    if(quality_l>=.101) {\n                        console.log('chosen img quality',quality);\n                        resolve({\n                            img: return_url(new_url),\n                            quality: quality,\n                            width: Math.round(width),\n                            height: Math.round(height),\n                            compressed: compressed,\n                        });\n                    } else {\n                        reject('图片过大，无法上传');\n                    }\n                });\n                image.src=url;\n            }\n            reader.onload=(event)=>{\n                fixOrientation(event.target.result,{},(fixed_dataurl)=>{\n                    on_got_img(fixed_dataurl);\n                });\n            };\n            reader.readAsDataURL(file);\n        });\n    }\n\n    on_img_change() {\n        if(this.img_ref.current && this.img_ref.current.files.length)\n            this.setState({\n                img_tip: '（正在处理图片……）'\n            },()=>{\n                this.proc_img(this.img_ref.current.files[0])\n                    .then((d)=>{\n                        this.setState({\n                            img_tip: `（${d.compressed?'压缩到':'尺寸'} ${d.width}*${d.height} / `+\n                                `质量 ${Math.floor(d.quality*100)}% / ${Math.floor(d.img.length/BASE64_RATE/1000)}KB）`,\n                        });\n                    })\n                    .catch((e)=>{\n                        this.setState({\n                            img_tip: `图片无效：${e}`,\n                        });\n                    });\n            });\n        else\n            this.setState({\n                img_tip: null,\n            });\n    }\n\n    on_submit(event) {\n        if(event) event.preventDefault();\n        if(this.state.loading_status==='loading')\n            return;\n        if(this.img_ref.current.files.length) {\n            this.setState({\n                loading_status: 'processing',\n            });\n            this.proc_img(this.img_ref.current.files[0])\n                .then((d)=>{\n                    this.setState({\n                        loading_status: 'loading',\n                    });\n                    this.do_post(this.state.text,d.img);\n                })\n                .catch((e)=>{\n                    alert(e);\n                });\n        } else {\n            this.setState({\n                loading_status: 'loading',\n            });\n            this.do_post(this.state.text,null);\n        }\n    }\n\n    render() {\n        return (\n            <form onSubmit={this.on_submit.bind(this)} className=\"post-form box\">\n                <div className=\"post-form-bar\">\n                    <label>\n                        图片\n                        <input ref={this.img_ref} type=\"file\" accept=\"image/*\" disabled={this.state.loading_status!=='done'}\n                               onChange={this.on_img_change_bound}\n                        />\n                    </label>\n                    {this.state.loading_status!=='done' ?\n                        <button disabled=\"disabled\">\n                            <span className=\"icon icon-loading\" />\n                            &nbsp;正在{this.state.loading_status==='processing' ? '处理' : '上传'}\n                        </button> :\n                        <button type=\"submit\">\n                            <span className=\"icon icon-send\" />\n                            &nbsp;发表\n                        </button>\n                    }\n                </div>\n                {!!this.state.img_tip &&\n                    <p className=\"post-form-img-tip\">\n                        <a onClick={()=>{this.img_ref.current.value=\"\"; this.on_img_change();}}>删除图片</a>\n                        {this.state.img_tip}\n                    </p>\n                }\n                <SafeTextarea ref={this.area_ref} id=\"new_post\" on_change={this.on_change_bound} on_submit={this.on_submit.bind(this)} />\n                <p><small>\n                    请遵守<a href=\"http://pkuhelper.pku.edu.cn/treehole_rules.html\" target=\"_blank\">树洞管理规范</a>，文明发言\n                </small></p>\n            </form>\n        )\n    }\n}\n","import React, {Component, PureComponent} from 'react';\nimport copy from 'copy-to-clipboard';\nimport {ColorPicker} from './color_picker';\nimport {split_text, NICKNAME_RE, PID_RE, URL_RE, URL_PID_RE} from './text_splitter';\nimport {format_time, build_highlight_re, Time, TitleLine, HighlightedText, ClickHandler, ColoredSpan} from './Common';\nimport './Flows.css';\nimport LazyLoad from './react-lazyload/src';\nimport {AudioWidget} from './AudioWidget';\nimport {TokenCtx, ReplyForm} from './UserAction';\n\nimport {API, PKUHELPER_ROOT} from './flows_api';\n\nconst IMAGE_BASE=PKUHELPER_ROOT+'services/pkuhole/images/';\nconst AUDIO_BASE=PKUHELPER_ROOT+'services/pkuhole/audios/';\n\nconst CLICKABLE_TAGS={a: true, audio: true};\nconst PREVIEW_REPLY_COUNT=10;\nconst QUOTE_BLACKLIST=['23333','233333','66666','666666','10086','10000','100000','99999','999999','55555','555555'];\n\nwindow.LATEST_POST_ID=parseInt(localStorage['_LATEST_POST_ID'],10)||0;\n\nconst DZ_NAME='洞主';\n\nfunction load_single_meta(show_sidebar,token) {\n    return (pid,replace=false)=>{\n        let color_picker=new ColorPicker();\n        let title_elem='树洞 #'+pid;\n        show_sidebar(\n            title_elem,\n            <div className=\"box box-tip\">\n                正在加载 #{pid}\n            </div>,\n            replace?'replace':'push'\n        );\n        API.get_single(pid,token)\n            .then((single)=>{\n                single.data.variant={};\n                return new Promise((resolve,reject)=>{\n                    API.load_replies_with_cache(pid,token,color_picker,parseInt(single.data.reply))\n                        .then((replies)=>{resolve([single,replies])})\n                        .catch(reject);\n                });\n            })\n            .then((res)=>{\n                let [single,replies]=res;\n                show_sidebar(\n                    title_elem,\n                    <FlowSidebar key={+new Date()}\n                        info={single.data} replies={replies.data} attention={replies.attention}\n                        token={token} show_sidebar={show_sidebar} color_picker={color_picker}\n                        deletion_detect={localStorage['DELETION_DETECT']==='on'}\n                    />,\n                    'replace'\n                )\n            })\n            .catch((e)=>{\n                console.error(e);\n                show_sidebar(\n                    title_elem,\n                    <div className=\"box box-tip\">\n                        <p><a onClick={()=>load_single_meta(show_sidebar,token)(pid,true)}>重新加载</a></p>\n                        <p>{''+e}</p>\n                    </div>,\n                    'replace'\n                );\n            })\n    };\n}\n\nclass Reply extends PureComponent {\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        let parts=split_text(this.props.info.text,[\n            ['url_pid',URL_PID_RE],\n            ['url',URL_RE],\n            ['pid',PID_RE],\n            ['nickname',NICKNAME_RE],\n        ]);\n\n        return (\n            <div className={'flow-reply box'} style={this.props.info._display_color ? {\n                '--box-bgcolor-light': this.props.info._display_color[0],\n                '--box-bgcolor-dark': this.props.info._display_color[1],\n            } : null}>\n                <div className=\"box-header\">\n                    <code className=\"box-id\">#{this.props.info.cid}</code>\n                    {!!this.props.do_filter_name &&\n                        <span className=\"reply-header-badge clickable\" onClick={()=>{this.props.do_filter_name(this.props.info.name);}}>\n                            <span className=\"icon icon-locate\" />\n                        </span>\n                    }\n                    &nbsp;\n                    {this.props.info.tag!==null &&\n                        <span className=\"box-header-tag\">\n                                {this.props.info.tag}\n                            </span>\n                    }\n                    <Time stamp={this.props.info.timestamp} />\n                </div>\n                <div className=\"box-content\">\n                    <HighlightedText parts={parts} color_picker={this.props.color_picker} show_pid={this.props.show_pid} />\n                </div>\n            </div>\n        );\n    }\n}\n\nclass FlowItem extends PureComponent {\n    constructor(props) {\n        super(props);\n    }\n\n    copy_link(event) {\n        event.preventDefault();\n        copy(\n            `${event.target.href}${this.props.info.tag ? ' 【'+this.props.info.tag+'】' : ''}\\n`+\n            `${this.props.info.text}${this.props.info.type==='image'?' [图片]':this.props.info.type==='audio'?' [语音]':''}\\n`+\n            `（${format_time(new Date(this.props.info.timestamp*1000))} ${this.props.info.likenum}关注 ${this.props.info.reply}回复）\\n`+\n            this.props.replies.map((r)=>(\n                (r.tag ? '【'+r.tag+'】' : '')+\n                r.text\n            )).join('\\n')\n        );\n    }\n\n    render() {\n        let props=this.props;\n        let parts=props.parts||split_text(props.info.text,[\n            ['url_pid',URL_PID_RE],\n            ['url',URL_RE],\n            ['pid',PID_RE],\n            ['nickname',NICKNAME_RE],\n        ]);\n        return (\n            <div className={'flow-item'+(props.is_quote ? ' flow-item-quote' : '')}>\n                {!!props.is_quote &&\n                    <div className=\"quote-tip black-outline\">\n                        <div><span className=\"icon icon-quote\" /></div>\n                        <div><small>提到</small></div>\n                    </div>\n                }\n                <div className=\"box\">\n                    {!!window.LATEST_POST_ID && parseInt(props.info.pid,10)>window.LATEST_POST_ID &&\n                        <div className=\"flow-item-dot\" />\n                    }\n                    <div className=\"box-header\">\n                        {!!this.props.do_filter_name &&\n                            <span className=\"reply-header-badge clickable\" onClick={()=>{this.props.do_filter_name(DZ_NAME);}}>\n                                <span className=\"icon icon-locate\" />\n                            </span>\n                        }\n                        {!!parseInt(props.info.likenum,10) &&\n                            <span className=\"box-header-badge\">\n                                {props.info.likenum}&nbsp;\n                                <span className={'icon icon-'+(props.attention ? 'star-ok' : 'star')} />\n                            </span>\n                        }\n                        {!!parseInt(props.info.reply,10) &&\n                            <span className=\"box-header-badge\">\n                                {props.info.reply}&nbsp;\n                                <span className=\"icon icon-reply\" />\n                            </span>\n                        }\n                        <code className=\"box-id\"><a href={'##'+props.info.pid} onClick={this.copy_link.bind(this)}>#{props.info.pid}</a></code>\n                        &nbsp;\n                        {props.info.tag!==null &&\n                            <span className=\"box-header-tag\">\n                                {props.info.tag}\n                            </span>\n                        }\n                        <Time stamp={props.info.timestamp} />\n                    </div>\n                    <div className=\"box-content\">\n                        <HighlightedText parts={parts} color_picker={props.color_picker} show_pid={props.show_pid} />\n                        {props.info.type==='image' &&\n                            <p className=\"img\">\n                                {props.img_clickable ?\n                                    <a className=\"no-underline\" href={IMAGE_BASE+props.info.url} target=\"_blank\"><img src={IMAGE_BASE+props.info.url} /></a> :\n                                    <img src={IMAGE_BASE+props.info.url} />\n                                }\n                            </p>\n                        }\n                        {props.info.type==='audio' && <AudioWidget src={AUDIO_BASE+props.info.url} />}\n                    </div>\n                    {!!(props.attention && props.info.variant.latest_reply) &&\n                        <p className=\"box-footer\">最新回复 <Time stamp={props.info.variant.latest_reply} /></p>\n                    }\n                </div>\n            </div>\n        );\n    }\n}\n\nclass FlowSidebar extends PureComponent {\n    constructor(props) {\n        super(props);\n        this.state={\n            attention: props.attention,\n            info: props.info,\n            replies: props.replies,\n            loading_status: 'done',\n            error_msg: null,\n            filter_name: null,\n            rev: false,\n        };\n        this.color_picker=props.color_picker;\n        this.syncState=props.sync_state||(()=>{});\n        this.reply_ref=React.createRef();\n    }\n\n    set_variant(cid,variant) {\n        this.setState((prev)=>{\n            if(cid)\n                return {\n                    replies: prev.replies.map((reply)=>{\n                        if(reply.cid===cid)\n                            return Object.assign({},reply,{variant: Object.assign({},reply.variant,variant)});\n                        else\n                            return reply;\n                    }),\n                };\n            else\n                return {\n                    info: Object.assign({},prev.info,{variant: Object.assign({},prev.info.variant,variant)}),\n                }\n        },function() {\n            this.syncState({\n                info: this.state.info,\n                replies: this.state.replies,\n            });\n        });\n    }\n\n    load_replies(update_count=true) {\n        this.setState({\n            loading_status: 'loading',\n            error_msg: null,\n        });\n        API.load_replies(this.state.info.pid,this.props.token,this.color_picker,null)\n            .then((json)=>{\n                this.setState((prev,props)=>({\n                    replies: json.data,\n                    info: update_count ? Object.assign({}, prev.info, {\n                        reply: ''+json.data.length,\n                    }) : prev.info,\n                    attention: !!json.attention,\n                    loading_status: 'done',\n                    error_msg: null,\n                }), ()=>{\n                    this.syncState({\n                        replies: this.state.replies,\n                        attention: this.state.attention,\n                        info: this.state.info,\n                    });\n                    if(this.state.replies.length)\n                        this.set_variant(null,{latest_reply: Math.max.apply(null,this.state.replies.map((r)=>parseInt(r.timestamp)))});\n                });\n            })\n            .catch((e)=>{\n                console.error(e);\n                this.setState({\n                    replies: [],\n                    loading_status: 'done',\n                    error_msg: ''+e,\n                });\n            });\n    }\n\n    toggle_attention() {\n        this.setState({\n            loading_status: 'loading',\n        });\n        const next_attention=!this.state.attention;\n        API.set_attention(this.state.info.pid,next_attention,this.props.token)\n            .then((json)=>{\n                this.setState({\n                    loading_status: 'done',\n                    attention: next_attention,\n                });\n                this.syncState({\n                    attention: next_attention,\n                });\n            })\n            .catch((e)=>{\n                this.setState({\n                    loading_status: 'done'\n                });\n                alert('设置关注失败');\n                console.error(e);\n            });\n    }\n\n    report() {\n        let reason=prompt(`举报 #${this.state.info.pid} 的理由：`);\n        if(reason!==null) {\n            API.report(this.state.info.pid,reason,this.props.token)\n                .then((json)=>{\n                    alert('举报成功');\n                })\n                .catch((e)=>{\n                    alert('举报失败');\n                    console.error(e);\n                })\n        }\n    }\n\n    set_filter_name(name) {\n        this.setState((prevState)=>({\n            filter_name: name===prevState.filter_name ? null : name,\n        }));\n    }\n\n    toggle_rev() {\n        this.setState((prevState)=>({\n            rev: !prevState.rev,\n        }));\n    }\n\n    show_reply_bar(name,event) {\n        if(this.reply_ref.current && !event.target.closest('a, .clickable')) {\n            let text=this.reply_ref.current.get();\n            if(/^\\s*(?:Re (?:|洞主|(?:[A-Z][a-z]+ )?(?:[A-Z][a-z]+)|You Win(?: \\d+)?):)?\\s*$/.test(text)) {// text is nearly empty so we can replace it\n                let should_text='Re '+name+': ';\n                if(should_text===this.reply_ref.current.get())\n                    this.reply_ref.current.set('');\n                else\n                    this.reply_ref.current.set(should_text);\n            }\n        }\n    }\n\n    render() {\n        if(this.state.loading_status==='loading')\n            return (<p className=\"box box-tip\">加载中……</p>);\n\n        let show_pid=load_single_meta(this.props.show_sidebar,this.props.token);\n\n        let replies_to_show=this.state.filter_name ? this.state.replies.filter((r)=>r.name===this.state.filter_name) : this.state.replies.slice();\n        if(this.state.rev) replies_to_show.reverse();\n\n        // key for lazyload elem\n        let view_mode_key=(this.state.rev ? 'y-' : 'n-')+(this.state.filter_name||'null');\n\n        let replies_cnt={[DZ_NAME]:1};\n        replies_to_show.forEach((r)=>{\n            if(replies_cnt[r.name]===undefined)\n                replies_cnt[r.name]=0;\n            replies_cnt[r.name]++;\n        });\n\n        // hide main thread when filtered\n        let main_thread_elem=(this.state.filter_name && this.state.filter_name!==DZ_NAME) ? null : (\n            <ClickHandler callback={(e)=>{this.show_reply_bar('',e);}}>\n                <FlowItem info={this.state.info} attention={this.state.attention} img_clickable={true}\n                          color_picker={this.color_picker} show_pid={show_pid} replies={this.state.replies}\n                          set_variant={(variant)=>{this.set_variant(null,variant);}}\n                          do_filter_name={replies_cnt[DZ_NAME]>1 ? this.set_filter_name.bind(this) : null}\n                />\n            </ClickHandler>\n        );\n\n        return (\n            <div className=\"flow-item-row sidebar-flow-item\">\n                <div className=\"box box-tip\">\n                    {!!this.props.token &&\n                        <span>\n                            <a onClick={this.report.bind(this)}>\n                                <span className=\"icon icon-flag\" /><label>举报</label>\n                            </a>\n                            &nbsp;&nbsp;\n                        </span>\n                    }\n                    <a onClick={this.load_replies.bind(this)}>\n                        <span className=\"icon icon-refresh\" /><label>刷新</label>\n                    </a>\n                    {(this.state.replies.length>=1 || this.state.rev) &&\n                        <span>\n                            &nbsp;&nbsp;\n                            <a onClick={this.toggle_rev.bind(this)}>\n                                <span className=\"icon icon-order-rev\" /><label>{this.state.rev ? '还原' : '逆序'}</label>\n                            </a>\n                        </span>\n                    }\n                    {!!this.props.token &&\n                        <span>\n                            &nbsp;&nbsp;\n                            <a onClick={()=>{\n                                this.toggle_attention();\n                            }}>\n                                {this.state.attention ?\n                                    <span><span className=\"icon icon-star-ok\" /><label>已关注</label></span> :\n                                    <span><span className=\"icon icon-star\" /><label>未关注</label></span>\n                                }\n                            </a>\n                        </span>\n                    }\n                </div>\n                {!!this.state.filter_name &&\n                    <div className=\"box box-tip flow-item filter-name-bar\">\n                        <p>\n                            <span style={{float: 'left'}}><a onClick={()=>{this.set_filter_name(null)}}>还原</a></span>\n                            <span className=\"icon icon-locate\" />&nbsp;当前只看&nbsp;\n                            <ColoredSpan colors={this.color_picker.get(this.state.filter_name)}>{this.state.filter_name}</ColoredSpan>\n                        </p>\n                    </div>\n                }\n                {!this.state.rev &&\n                    main_thread_elem\n                }\n                {!!this.state.error_msg &&\n                    <div className=\"box box-tip flow-item\">\n                        <p>回复加载失败</p>\n                        <p>{this.state.error_msg}</p>\n                    </div>\n                }\n                {(this.props.deletion_detect && parseInt(this.state.info.reply)>this.state.replies.length) && !!this.state.replies.length &&\n                    <div className=\"box box-tip flow-item box-danger\">\n                        {parseInt(this.state.info.reply)-this.state.replies.length} 条回复被删除\n                    </div>\n                }\n                {replies_to_show.map((reply)=>(\n                    <LazyLoad key={reply.cid+view_mode_key} offset={1500} height=\"5em\" overflow={true} once={true}>\n                        <ClickHandler callback={(e)=>{this.show_reply_bar(reply.name,e);}}>\n                            <Reply\n                                info={reply} color_picker={this.color_picker} show_pid={show_pid}\n                                set_variant={(variant)=>{this.set_variant(reply.cid,variant);}}\n                                do_filter_name={replies_cnt[reply.name]>1 ? this.set_filter_name.bind(this) : null}\n                            />\n                        </ClickHandler>\n                    </LazyLoad>\n                ))}\n                {this.state.rev &&\n                    main_thread_elem\n                }\n                {!!this.props.token ?\n                    <ReplyForm pid={this.state.info.pid} token={this.props.token}\n                               area_ref={this.reply_ref} on_complete={this.load_replies.bind(this)} /> :\n                    <div className=\"box box-tip flow-item\">登录后可以回复树洞</div>\n                }\n            </div>\n        )\n    }\n}\n\nclass FlowItemRow extends PureComponent {\n    constructor(props) {\n        super(props);\n        this.state={\n            replies: [],\n            reply_status: 'done',\n            reply_error: null,\n            info: Object.assign({},props.info,{variant: {}}),\n            hidden: window.config.block_words.some(word => props.info.text.includes(word)),\n            attention: props.attention_override===null ? false : props.attention_override,\n        };\n        this.color_picker=new ColorPicker();\n    }\n\n    componentDidMount() {\n        if(parseInt(this.state.info.reply,10)) {\n            this.load_replies(null,/*update_count=*/false);\n        }\n    }\n\n    reveal() {\n        this.setState({ hidden: false })\n    }\n\n    load_replies(callback,update_count=true) {\n        console.log('fetching reply',this.state.info.pid);\n        this.setState({\n            reply_status: 'loading',\n            reply_error: null,\n        });\n        API.load_replies_with_cache(this.state.info.pid,this.props.token,this.color_picker,parseInt(this.state.info.reply))\n            .then((json)=>{\n                this.setState((prev,props)=>({\n                    replies: json.data,\n                    info: Object.assign({}, prev.info, {\n                        reply: update_count ? ''+json.data.length : prev.info.reply,\n                        variant: json.data.length ? {\n                            latest_reply: Math.max.apply(null,json.data.map((r)=>parseInt(r.timestamp))),\n                        } : {},\n                    }),\n                    attention: !!json.attention,\n                    reply_status: 'done',\n                    reply_error: null,\n                }),callback);\n            })\n            .catch((e)=>{\n                console.error(e);\n                this.setState({\n                    replies: [],\n                    reply_status: 'failed',\n                    reply_error: ''+e,\n                },callback);\n            });\n    }\n\n    show_sidebar() {\n        this.props.show_sidebar(\n            '树洞 #'+this.state.info.pid,\n            <FlowSidebar key={+new Date()}\n                info={this.state.info} replies={this.state.replies} attention={this.state.attention} sync_state={this.setState.bind(this)}\n                token={this.props.token} show_sidebar={this.props.show_sidebar} color_picker={this.color_picker}\n                deletion_detect={this.props.deletion_detect}\n            />\n        );\n    }\n\n    render() {\n        let show_pid=load_single_meta(this.props.show_sidebar,this.props.token,[this.state.info.pid]);\n\n        let hl_rules=[\n            ['url_pid',URL_PID_RE],\n            ['url',URL_RE],\n            ['pid',PID_RE],\n            ['nickname',NICKNAME_RE],\n        ];\n        if(this.props.search_param)\n            hl_rules.push(['search',build_highlight_re(this.props.search_param,' ','gi')]);\n        let parts=split_text(this.state.info.text,hl_rules);\n\n        let quote_id=null;\n        if(!this.props.is_quote)\n            for(let [mode,content] of parts)\n                if(mode==='pid' && QUOTE_BLACKLIST.indexOf(content)===-1 && parseInt(content)<parseInt(this.state.info.pid))\n                    if(quote_id===null)\n                        quote_id=parseInt(content);\n                    else {\n                        quote_id=null;\n                        break;\n                    }\n\n        let res=(\n            <div className={'flow-item-row flow-item-row-with-prompt'+(this.props.is_quote ? ' flow-item-row-quote' : '')} onClick={(event)=>{\n                if(!CLICKABLE_TAGS[event.target.tagName.toLowerCase()])\n                    this.show_sidebar();\n            }}>\n                <FlowItem parts={parts} info={this.state.info} attention={this.state.attention} img_clickable={false} is_quote={this.props.is_quote}\n                    color_picker={this.color_picker} show_pid={show_pid} replies={this.state.replies} />\n                <div className=\"flow-reply-row\">\n                    {this.state.reply_status==='loading' && <div className=\"box box-tip\">加载中</div>}\n                    {this.state.reply_status==='failed' &&\n                        <div className=\"box box-tip\">\n                            <p><a onClick={()=>{this.load_replies()}}>重新加载评论</a></p>\n                            <p>{this.state.reply_error}</p>\n                        </div>\n                    }\n                    {this.state.replies.slice(0,PREVIEW_REPLY_COUNT).map((reply)=>(\n                        <Reply key={reply.cid} info={reply} color_picker={this.color_picker} show_pid={show_pid} />\n                    ))}\n                    {this.state.replies.length>PREVIEW_REPLY_COUNT &&\n                        <div className=\"box box-tip\">还有 {this.state.replies.length-PREVIEW_REPLY_COUNT} 条</div>\n                    }\n                </div>\n            </div>\n        );\n\n        if (this.state.hidden) {\n            return (<div\n                className=\"flow-item-row flow-item-row-with-prompt box box-tip\"\n                onClick={() => this.reveal()}>\n                隐藏了 #{this.props.info.pid} 点击加载\n            </div>)\n        }\n\n        return quote_id ? (\n            <div>\n                {res}\n                <FlowItemQuote pid={quote_id} show_sidebar={this.props.show_sidebar} token={this.props.token}\n                    deletion_detect={this.props.deletion_detect} />\n            </div>\n        ) : res;\n    }\n}\n\nclass FlowItemQuote extends PureComponent {\n    constructor(props) {\n        super(props);\n        this.state={\n            loading_status: 'empty',\n            error_msg: null,\n            info: null,\n        };\n    }\n\n    componentDidMount() {\n        this.load();\n    }\n\n    load() {\n        this.setState({\n            loading_status: 'loading',\n        },()=>{\n            API.get_single(this.props.pid,this.props.token)\n                .then((json)=>{\n                    this.setState({\n                        loading_status: 'done',\n                        info: json.data,\n                    });\n                })\n                .catch((err)=>{\n                    if((''+err).indexOf('没有这条树洞')!==-1)\n                        this.setState({\n                            loading_status: 'empty',\n                        });\n                    else\n                        this.setState({\n                            loading_status: 'error',\n                            error_msg: ''+err,\n                        });\n                });\n        });\n    }\n\n    render() {\n        if(this.state.loading_status==='empty')\n            return null;\n        else if(this.state.loading_status==='loading')\n            return (\n                <div className=\"aux-margin\">\n                    <div className=\"box box-tip\">\n                        <span className=\"icon icon-loading\" />\n                        提到了 #{this.props.pid}\n                    </div>\n                </div>\n            );\n        else if(this.state.loading_status==='error')\n            return (\n                <div className=\"aux-margin\">\n                    <div className=\"box box-tip\">\n                        <p><a onClick={this.load.bind(this)}>重新加载</a></p>\n                        <p>{this.state.error_msg}</p>\n                    </div>\n                </div>\n            );\n        else // 'done'\n            return (\n                <FlowItemRow info={this.state.info} show_sidebar={this.props.show_sidebar} token={this.props.token}\n                    is_quote={true} deletion_detect={this.props.deletion_detect} />\n            );\n    }\n}\n\nfunction FlowChunk(props) {\n    return (\n        <TokenCtx.Consumer>{({value: token})=>(\n            <div className=\"flow-chunk\">\n                {!!props.title && <TitleLine text={props.title} />}\n                {props.list.map((info,ind)=>(\n                    <LazyLoad key={info.pid} offset={1500} height=\"15em\" hiddenIfInvisible={true}>\n                        <div>\n                            {!!(props.deletion_detect && props.mode==='list' && ind && props.list[ind-1].pid-info.pid>1) &&\n                                <div className=\"flow-item-row\">\n                                    <div className=\"box box-tip flow-item box-danger\">\n                                        {props.list[ind-1].pid-info.pid-1} 条被删除\n                                    </div>\n                                </div>\n                            }\n                            <FlowItemRow info={info} show_sidebar={props.show_sidebar} token={token}\n                                    attention_override={props.mode==='attention_finished' ? true : null}\n                                    deletion_detect={props.deletion_detect} search_param={props.search_param} />\n                        </div>\n                    </LazyLoad>\n                ))}\n            </div>\n        )}</TokenCtx.Consumer>\n    );\n}\n\nexport class Flow extends PureComponent {\n    constructor(props) {\n        super(props);\n        this.state={\n            mode: props.mode,\n            search_param: props.search_text,\n            loaded_pages: 0,\n            chunks: {\n                title: '',\n                data: [],\n            },\n            loading_status: 'done',\n            error_msg: null,\n        };\n        this.on_scroll_bound=this.on_scroll.bind(this);\n        window.LATEST_POST_ID=parseInt(localStorage['_LATEST_POST_ID'],10)||0;\n    }\n\n    load_page(page) {\n        const failed=(err)=>{\n            console.error(err);\n            this.setState((prev,props)=>({\n                loaded_pages: prev.loaded_pages-1,\n                loading_status: 'failed',\n                error_msg: ''+err,\n            }));\n        };\n\n        if(page>this.state.loaded_pages+1)\n            throw new Error('bad page');\n        if(page===this.state.loaded_pages+1) {\n            console.log('fetching page',page);\n            if(this.state.mode==='list') {\n                API.get_list(page,this.props.token)\n                    .then((json)=>{\n                        if(page===1 && json.data.length) { // update latest_post_id\n                            let max_id=-1;\n                            json.data.forEach((x)=>{\n                                if(parseInt(x.pid,10)>max_id)\n                                    max_id=parseInt(x.pid,10);\n                            });\n                            localStorage['_LATEST_POST_ID']=''+max_id;\n                        }\n                        this.setState((prev,props)=>({\n                            chunks: {\n                                title: 'News Feed',\n                                data: prev.chunks.data.concat(json.data.filter((x)=>(\n                                    prev.chunks.data.length===0 ||\n                                    !(prev.chunks.data.slice(-100).some((p)=>p.pid===x.pid))\n                                ))),\n                            },\n                            loading_status: 'done',\n                        }));\n                    })\n                    .catch(failed);\n            } else if(this.state.mode==='search') {\n                API.get_search(page,this.state.search_param,this.props.token)\n                    .then((json)=>{\n                        const finished=json.data.length===0;\n                        this.setState((prev,props)=>({\n                            chunks: {\n                                title: 'Result for \"'+this.state.search_param+'\"',\n                                data: prev.chunks.data.concat(json.data.filter((x)=>(\n                                    prev.chunks.data.length===0 ||\n                                    !(prev.chunks.data.slice(-100).some((p)=>p.pid===x.pid))\n                                ))),\n                            },\n                            mode: finished ? 'search_finished' : 'search',\n                            loading_status: 'done',\n                        }));\n                    })\n                    .catch(failed);\n            } else if(this.state.mode==='single') {\n                const pid=parseInt(this.state.search_param.substr(1),10);\n                API.get_single(pid,this.props.token)\n                    .then((json)=>{\n                        this.setState({\n                            chunks: {\n                                title: 'PID = '+pid,\n                                data: [json.data],\n                            },\n                            mode: 'single_finished',\n                            loading_status: 'done',\n                        });\n                    })\n                    .catch(failed);\n            } else if(this.state.mode==='attention') {\n                API.get_attention(this.props.token)\n                    .then((json)=>{\n                        this.setState({\n                            chunks: {\n                                title: 'Attention List',\n                                data: json.data,\n                            },\n                            mode: 'attention_finished',\n                            loading_status: 'done',\n                        });\n                    })\n                    .catch(failed);\n            } else {\n                console.log('nothing to load');\n                return;\n            }\n\n            this.setState((prev,props)=>({\n                loaded_pages: prev.loaded_pages+1,\n                loading_status: 'loading',\n                error_msg: null,\n            }));\n        }\n    }\n\n    on_scroll(event) {\n        if(event.target===document) {\n            const avail=document.body.scrollHeight-window.scrollY-window.innerHeight;\n            if(avail<window.innerHeight && this.state.loading_status==='done')\n                this.load_page(this.state.loaded_pages+1);\n        }\n    }\n\n    componentDidMount() {\n        this.load_page(1);\n        window.addEventListener('scroll',this.on_scroll_bound);\n        window.addEventListener('resize',this.on_scroll_bound);\n    }\n    componentWillUnmount() {\n        window.removeEventListener('scroll',this.on_scroll_bound);\n        window.removeEventListener('resize',this.on_scroll_bound);\n    }\n\n    render() {\n        const should_deletion_detect=localStorage['DELETION_DETECT']==='on';\n        return (\n            <div className=\"flow-container\">\n                <FlowChunk\n                    title={this.state.chunks.title} list={this.state.chunks.data} mode={this.state.mode}\n                    search_param={this.state.search_param||null}\n                    show_sidebar={this.props.show_sidebar} deletion_detect={should_deletion_detect}\n                />\n                {this.state.loading_status==='failed' &&\n                    <div className=\"aux-margin\">\n                        <div className=\"box box-tip\">\n                            <p><a onClick={()=>{this.load_page(this.state.loaded_pages+1)}}>重新加载</a></p>\n                            <p>{this.state.error_msg}</p>\n                        </div>\n                    </div>\n                }\n                <TitleLine text={\n                    this.state.loading_status==='loading' ?\n                        <span><span className=\"icon icon-loading\" />&nbsp;Loading...</span> :\n                        '© xmcp'\n                } />\n            </div>\n        );\n    }\n}\n","import React, {Component, PureComponent} from 'react';\nimport {AppSwitcher} from './infrastructure/widgets';\nimport {InfoSidebar, PostForm} from './UserAction';\nimport {TokenCtx} from './UserAction';\n\nimport './Title.css';\n\nconst flag_re=/^\\/\\/setflag ([a-zA-Z0-9_]+)=(.*)$/;\n\nclass ControlBar extends PureComponent {\n    constructor(props) {\n        super(props);\n        this.state={\n            search_text: '',\n        };\n        this.set_mode=props.set_mode;\n\n        this.on_change_bound=this.on_change.bind(this);\n        this.on_keypress_bound=this.on_keypress.bind(this);\n        this.do_refresh_bound=this.do_refresh.bind(this);\n        this.do_attention_bound=this.do_attention.bind(this);\n    }\n\n    componentDidMount() {\n        if(window.location.hash) {\n            let text=decodeURIComponent(window.location.hash).substr(1);\n            if(text.lastIndexOf('?')!==-1)\n                text=text.substr(0,text.lastIndexOf('?')); // fuck wechat '#param?nsukey=...'\n            this.setState({\n                search_text: text,\n            }, ()=>{\n                this.on_keypress({key: 'Enter'});\n            });\n        }\n    }\n\n    on_change(event) {\n        this.setState({\n            search_text: event.target.value,\n        });\n    }\n\n    on_keypress(event) {\n        if(event.key==='Enter') {\n            let flag_res=flag_re.exec(this.state.search_text);\n            if(flag_res) {\n                if(flag_res[2]) {\n                    localStorage[flag_res[1]]=flag_res[2];\n                    alert('Set Flag '+flag_res[1]+'='+flag_res[2]+'\\nYou may need to refresh this webpage.');\n                } else {\n                    delete localStorage[flag_res[1]];\n                    alert('Clear Flag '+flag_res[1]+'\\nYou may need to refresh this webpage.');\n                }\n                return;\n            }\n\n            const mode=this.state.search_text.startsWith('#') ? 'single' : 'search';\n            this.set_mode(mode,this.state.search_text||'');\n        }\n    }\n\n    do_refresh() {\n        window.scrollTo(0,0);\n        this.setState({\n            search_text: '',\n        });\n        this.set_mode('list',null);\n    }\n\n    do_attention() {\n        window.scrollTo(0,0);\n        this.setState({\n            search_text: '',\n        });\n        this.set_mode('attention',null);\n    }\n\n    render() {\n        return (\n            <TokenCtx.Consumer>{({value: token})=>(\n                <div className=\"control-bar\">\n                    <a className=\"no-underline control-btn\" onClick={this.do_refresh_bound}>\n                        <span className=\"icon icon-refresh\" />\n                        <span className=\"control-btn-label\">最新</span>\n                    </a>\n                    {!!token &&\n                        <a className=\"no-underline control-btn\" onClick={this.do_attention_bound}>\n                            <span className=\"icon icon-attention\" />\n                            <span className=\"control-btn-label\">关注</span>\n                        </a>\n                    }\n                    <input className=\"control-search\" value={this.state.search_text} placeholder=\"搜索 或 #PID\"\n                           onChange={this.on_change_bound} onKeyPress={this.on_keypress_bound}\n                    />\n                    <a className=\"no-underline control-btn\" onClick={()=>{\n                        this.props.show_sidebar(\n                            'P大树洞',\n                            <InfoSidebar show_sidebar={this.props.show_sidebar} />\n                        )\n                    }}>\n                        <span className={'icon icon-'+(token ? 'about' : 'login')} />\n                        <span className=\"control-btn-label\">{token ? '账户' : '登录'}</span>\n                    </a>\n                    {!!token &&\n                        <a className=\"no-underline control-btn\" onClick={()=>{\n                            this.props.show_sidebar(\n                                '发表树洞',\n                                <PostForm token={token} on_complete={()=>{\n                                    this.props.show_sidebar(null,null);\n                                    this.do_refresh();\n                                }} />\n                            )\n                        }}>\n                            <span className=\"icon icon-plus\" />\n                            <span className=\"control-btn-label\">发表</span>\n                        </a>\n                    }\n                </div>\n            )}</TokenCtx.Consumer>\n        )\n    }\n}\n\nexport function Title(props) {\n    return (\n        <div className=\"title-bar\">\n            <AppSwitcher appid=\"hole\" />\n            <div className=\"aux-margin\">\n                <div className=\"title\">\n                    <p className=\"centered-line\">\n                        <span onClick={()=>props.show_sidebar(\n                            'P大树洞',\n                            <InfoSidebar show_sidebar={props.show_sidebar} />\n                        )}>\n                            P大树洞\n                        </span>\n                    </p>\n                </div>\n                <ControlBar show_sidebar={props.show_sidebar} set_mode={props.set_mode} />\n            </div>\n        </div>\n    )\n}","import React, {Component, PureComponent} from 'react';\nimport './Sidebar.css';\n\nexport class Sidebar extends PureComponent {\n    constructor(props) {\n        super(props);\n        this.sidebar_ref=React.createRef();\n        this.do_close_bound=this.do_close.bind(this);\n        this.do_back_bound=this.do_back.bind(this);\n    }\n\n    componentDidUpdate(nextProps) {\n        if(this.props.stack!==nextProps.stack) {\n            //console.log('sidebar top');\n            if(this.sidebar_ref.current)\n                this.sidebar_ref.current.scrollTop=0;\n        }\n    }\n\n    do_close() {\n        this.props.show_sidebar(null,null,'clear');\n    }\n    do_back() {\n        this.props.show_sidebar(null,null,'pop');\n    }\n\n    render() {\n        let [cur_title,cur_content]=this.props.stack[this.props.stack.length-1];\n        return (\n            <div className={'sidebar-container '+(cur_title!==null ? 'sidebar-on' : 'sidebar-off')}>\n                <div className=\"sidebar-shadow\" onClick={this.do_back_bound} onTouchEnd={(e)=>{e.preventDefault();e.target.click();}} />\n                <div ref={this.sidebar_ref} className=\"sidebar\">\n                    {cur_content}\n                </div>\n                <div className=\"sidebar-title\">\n                    <a className=\"no-underline\" onClick={this.do_close_bound}>&nbsp;<span className=\"icon icon-close\" />&nbsp;</a>\n                    {this.props.stack.length>2 &&\n                        <a className=\"no-underline\" onClick={this.do_back_bound}>&nbsp;<span className=\"icon icon-back\" />&nbsp;</a>\n                    }\n                    {cur_title}\n                </div>\n            </div>\n        );\n    }\n}","import React, {Component} from 'react';\nimport Pressure from 'pressure';\n\nimport './PressureHelper.css';\n\nconst THRESHOLD=.4;\nconst MULTIPLIER=25;\nconst BORDER_WIDTH=500; // also change css!\n\nexport class PressureHelper extends  Component {\n    constructor(props) {\n        super(props);\n        this.state={\n            level: 0,\n            fired: false,\n        };\n        this.callback=props.callback;\n        this.esc_interval=null;\n    }\n\n    do_fire() {\n        if(this.esc_interval) {\n            clearInterval(this.esc_interval);\n            this.esc_interval=null;\n        }\n        this.setState({\n            level: 1,\n            fired: true,\n        });\n        this.callback();\n        window.setTimeout(()=>{\n            this.setState({\n                level: 0,\n                fired: false,\n            });\n        },300);\n    }\n\n    componentDidMount() {\n        if(window.config.pressure) {\n            Pressure.set(document.body, {\n                change: (force)=>{\n                    if(!this.state.fired) {\n                        if(force>=.999) {\n                            this.do_fire();\n                        }\n                        else\n                            this.setState({\n                                level: force,\n                            });\n                    }\n                },\n                end: ()=>{\n                    this.setState({\n                        level: 0,\n                        fired: false,\n                    });\n                },\n            }, {\n                polyfill: false,\n                only: 'touch',\n                preventSelect: false,\n            });\n\n            document.addEventListener('keydown',(e)=>{\n                if(!e.repeat && e.key==='Escape') {\n                    if(this.esc_interval)\n                        clearInterval(this.esc_interval);\n                    this.setState({\n                        level: THRESHOLD/2,\n                    },()=>{\n                        this.esc_interval=setInterval(()=>{\n                            let new_level=this.state.level+.1;\n                            if(new_level>=.999)\n                                this.do_fire();\n                            else\n                                this.setState({\n                                    level: new_level,\n                                });\n                        },30);\n                    });\n                }\n            });\n            document.addEventListener('keyup',(e)=>{\n                if(e.key==='Escape') {\n                    if(this.esc_interval) {\n                        clearInterval(this.esc_interval);\n                        this.esc_interval=null;\n                    }\n                    this.setState({\n                        level: 0,\n                    });\n                }\n            });\n        }\n    }\n\n    render() {\n        const pad=MULTIPLIER*(this.state.level-THRESHOLD)-BORDER_WIDTH;\n        return (\n            <div className={\n                'pressure-box'\n                +(this.state.fired ? ' pressure-box-fired' : '')\n                +(this.state.level<=.0001 ? ' pressure-box-empty' : '')\n            } style={{\n                left: pad,\n                right: pad,\n                top: pad,\n                bottom: pad,\n            }} />\n        )\n    }\n}","import React, {Component} from 'react';\nimport {Flow} from './Flows';\nimport {Title} from './Title';\nimport {Sidebar} from './Sidebar';\nimport {PressureHelper} from './PressureHelper';\nimport {TokenCtx} from './UserAction';\nimport {load_config,bgimg_style} from './Config';\nimport {listen_darkmode} from './infrastructure/functions';\nimport {LoginPopup, TitleLine} from './infrastructure/widgets';\n\nconst MAX_SIDEBAR_STACK_SIZE=10;\n\nfunction DeprecatedAlert(props) {\n    return (\n        <div id=\"global-hint-container\" style={{display: 'none'}} />\n    );\n}\n\nclass App extends Component {\n    constructor(props) {\n        super(props);\n        load_config();\n        listen_darkmode({default: undefined, light: false, dark: true}[window.config.color_scheme]);\n        this.state={\n            sidebar_stack: [[null,null]], // list of [status, content]\n            mode: 'list', // list, single, search, attention\n            search_text: null,\n            flow_render_key: +new Date(),\n            token: localStorage['TOKEN']||null,\n        };\n        this.show_sidebar_bound=this.show_sidebar.bind(this);\n        this.set_mode_bound=this.set_mode.bind(this);\n        this.on_pressure_bound=this.on_pressure.bind(this);\n        // a silly self-deceptive approach to ban guests, enough to fool those muggles\n        //                     document             cookie                    'pku_ip_flag=yes'\n        this.inpku_flag=window[atob('ZG9jdW1lbnQ')][atob('Y29va2ll')].indexOf(atob('cGt1X2lwX2ZsYWc9eWVz'))!==-1;\n    }\n\n    static is_darkmode() {\n        if(window.config.color_scheme==='dark') return true;\n        if(window.config.color_scheme==='light') return false;\n        else { // 'default'\n            return window.matchMedia('(prefers-color-scheme: dark)').matches;\n        }\n    }\n\n    on_pressure() {\n        if(this.state.sidebar_stack.length>1)\n            this.show_sidebar(null,null,'clear');\n        else\n            this.set_mode('list',null);\n    }\n\n    show_sidebar(title,content,mode='push') {\n        this.setState((prevState)=>{\n            let ns=prevState.sidebar_stack.slice();\n            if(mode==='push') {\n                if(ns.length>MAX_SIDEBAR_STACK_SIZE)\n                    ns.splice(1,1);\n                ns=ns.concat([[title,content]]);\n            } else if(mode==='pop') {\n                if(ns.length===1) return;\n                ns.pop();\n            } else if(mode==='replace') {\n                ns.pop();\n                ns=ns.concat([[title,content]]);\n            } else if(mode==='clear') {\n                ns=[[null,null]];\n            } else\n                throw new Error('bad show_sidebar mode');\n            return {\n                sidebar_stack: ns,\n            };\n        });\n    }\n\n    set_mode(mode,search_text) {\n        this.setState({\n            mode: mode,\n            search_text: search_text,\n            flow_render_key: +new Date(),\n        });\n    }\n\n    render() {\n        return (\n            <TokenCtx.Provider value={{\n                value: this.state.token,\n                set_value: (x)=>{\n                    localStorage['TOKEN']=x||'';\n                    this.setState({\n                        token: x,\n                    });\n                },\n            }}>\n                <PressureHelper callback={this.on_pressure_bound} />\n                <div className=\"bg-img\" style={bgimg_style()} />\n                <Title show_sidebar={this.show_sidebar_bound} set_mode={this.set_mode_bound} />\n                <TokenCtx.Consumer>{(token)=>(\n                    <div className=\"left-container\">\n                        <DeprecatedAlert token={token.value} />\n                        {!token.value &&\n                            <div className=\"flow-item-row aux-margin\">\n                                <div className=\"box box-tip\">\n                                    <p>\n                                        <LoginPopup token_callback={token.set_value}>{(do_popup)=>(\n                                            <a onClick={do_popup}>\n                                                <span className=\"icon icon-login\" />\n                                                &nbsp;登录到 PKU Helper\n                                            </a>\n                                        )}</LoginPopup>\n                                    </p>\n                                </div>\n                            </div>\n                        }\n                        {this.inpku_flag||token.value ?\n                            <Flow key={this.state.flow_render_key} show_sidebar={this.show_sidebar_bound}\n                                  mode={this.state.mode} search_text={this.state.search_text} token={token.value}\n                            /> :\n                            <TitleLine text=\"请登录后查看内容\" />\n                        }\n                        <br />\n                    </div>\n                )}</TokenCtx.Consumer>\n                <Sidebar show_sidebar={this.show_sidebar_bound} stack={this.state.sidebar_stack} />\n            </TokenCtx.Provider>\n        );\n    }\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n//import {elevate} from './infrastructure/elevator';\nimport registerServiceWorker from './registerServiceWorker';\n\n//elevate();\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n"],"sourceRoot":""}