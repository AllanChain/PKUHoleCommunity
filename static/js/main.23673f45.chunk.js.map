{"version":3,"sources":["infrastructure/functions.js","infrastructure/widgets.js","infrastructure/const.js","infrastructure/appicon/hole.png","infrastructure/appicon/imasugu.png","infrastructure/appicon/imasugu_rev.png","infrastructure/appicon/syllabus.png","infrastructure/appicon/score.png","infrastructure/appicon/course_survey.png","infrastructure/appicon/dropdown.png","infrastructure/appicon/dropdown_rev.png","infrastructure/appicon/homepage.png","color_picker.js","text_splitter.js","cache.js","flows_api.js","Common.js","AudioWidget.js","Message.js","Config.js","UserAction.js","Flows.js","Title.js","Sidebar.js","PressureHelper.js","App.js","registerServiceWorker.js","index.js"],"names":["get_json","res","ok","Error","status","statusText","text","then","t","JSON","parse","e","console","error","trace","log","SyntaxError","substr","listen_darkmode","override","update_color_scheme","undefined","window","matchMedia","matches","document","body","classList","add","remove","addListener","API_VERSION_PARAM","encodeURIComponent","process","REACT_APP_BUILD_INFO","Math","floor","Date","LOGIN_POPUP_ANCHOR_ID","pad2","x","format_time","time","getMonth","getDate","getHours","getMinutes","getSeconds","chinese_format","buildFormatter","chineseStrings","Time","props","stamp","date","formatter","title","toLocaleString","timeZone","hour12","TitleLine","className","GlobalTitle","FALLBACK_APPS","bar","appicon_hole","appicon_imasugu","appicon_imasugu_rev","appicon_syllabus","appicon_score","dropdown","appicon_course_survey","appicon_homepage","fix","SWITCHER_DATA_VER","SWITCHER_DATA_URL","PKUHELPER_ROOT","AppSwitcher","state","apps","get_apps_from_localstorage","ret","localStorage","content","check_fix","this","appid","setTimeout","HOTFIX_CONTEXT","build_info","build_env","eval","fetch","txt","setState","catch","prevProps","prevState","cur_id","app_elem","id","url","icon_normal","icon_hover","new_tab","no_class","ref","href","target","src","dropdown_cur_app","forEach","app","map","length","appicon_dropdown","appicon_dropdown_rev","React","createRef","onClick","closest","current","click","Component","LoginPopupSelf","loading_status","excluded_scopes","username_ref","password_ref","input_token_ref","popup_anchor","getElementById","createElement","appendChild","type","value","method","headers","stringify","json","success","alert","msg","set_token","code","user_token","name","on_close","token","result","ReactDOM","createPortal","perm_alert","bind","scope","checked","indexOf","onChange","chk","exc","slice","pos","splice","push","autoFocus","do_sendcode","disabled","do_login","token_callback","placeholder","do_input_token","LoginPopup","popup_show","on_popup_bound","on_popup","on_close_bound","children","ColorPicker","names","current_h","random","toLowerCase","PID_RE","URL_PID_RE","NICKNAME_RE","URL_RE","split_text","rules","rule","regex","concat","apply","part","split","seg","test","filter","HOLE_CACHE_DB_NAME","Cache","db","added_items_since_maintenance","encrypt","decrypt","open_req","indexedDB","open","onerror","onupgradeneeded","event","createObjectStore","keyPath","createIndex","unique","onsuccess","maintenance","pid","data","s","o","i","key","new_key","charCodeAt","String","fromCharCode","c","target_version","parseInt","Promise","resolve","reject","get_req","store","tx","transaction","objectStore","get","exception","data_str","version","last_access","put","delete","warn","req","count_req","count","index","openKeyCursor","cur","primaryKey","continue","deleteDatabase","cache","hole_cache","token_param","handle_response","response","a","notify","parse_replies","replies","color_picker","sort","b","cid","info","_display_color","variant","API","load_replies","cache_version","API_BASE","startsWith","load_replies_with_cache","cached","set_attention","attention","URLSearchParams","append","report","reason","get_list","page","get_search","keyword","get_single","get_attention","escape_regex","string","replace","build_highlight_re","option","isRegex","RegExp","join","ColoredSpan","style","colors","HighlightedText","parts","idx","p","rel","preventDefault","show_pid","PureComponent","TEXTAREA_BACKUP","SafeTextarea","on_change_bound","on_change","on_keydown_bound","on_keydown","clear","area_ref","change_callback","submit_callback","on_submit","ctrlKey","altKey","focus","onKeyDown","pwa_prompt_event","PromotionBar","is_ios","navigator","userAgent","standalone","prompt","addEventListener","ClickHandler","moved","init_y","init_x","on_begin_bound","on_begin","on_move_bound","on_move","on_end_bound","on_end","MOVE_THRESHOLD","last_fire","touches","screenY","screenX","abs","do_callback","callback","onTouchStart","onMouseDown","onTouchMove","onMouseMove","audio_cache","AudioWidget","all","AMR","load","err","blob","reader","FileReader","onload","raw","decode","wave","PCMData","encode","sampleRate","channelCount","bytesPerSample","binary_wave","Uint8Array","objurl","URL","createObjectURL","Blob","readAsBinaryString","controls","MessageViewer","timestamp","BUILTIN_IMGS","DEFAULT_CONFIG","background_img","background_color","pressure","easter_egg","color_scheme","block_words","alias","attention_sort","load_config","loaded_config","config","Object","assign","keys","save_config","bgimg_style","img","color","background","backgroundImage","encodeURI","backgroundColor","backgroundSize","ConfigBackground","save_changes","img_select","on_select","on_change_img","on_change_color","ConfigColorScheme","ConfigTextArea","display","copy","parsed","float","copy_value","description","onBlur","on_blur","ConfigSwitch","switch","val","ConfigUI","save_changes_bound","chg","confirm","location","reload","reset_settings","array","v","entries","pair","reduce","accumulator","currentValue","line","isNaN","Number","BASE64_RATE","MAX_IMG_DIAM","MAX_IMG_PX","TokenCtx","createContext","set_value","LifeInfoBox","_life_info_cache","CACHE_TIMEOUT_S","today_info","cache_get","card_balance","net_balance","mail_count","INTERNAL_NETWORK_FAILURE","API_NAME","cache_item","state_key","errMsg","errCode","k","value_fn","action","url_fn","cache_set","details","reload_all","render_line","schedule_url","balance","toFixed","InfoSidebar","show_sidebar","serviceWorker","getRegistrations","registrations","registration","unregister","ResetUsertokenWidget","uid","do_reset","LoginForm","Consumer","copy_token","do_popup","ReplyForm","global_keypress_handler_bound","global_keypress_handler","tagName","removeEventListener","on_complete","onSubmit","PostForm","img_tip","img_ref","on_img_change_bound","on_img_change","file","return_url","fixOrientation","fixed_dataurl","image","Image","width","height","compressed","rate","sqrt","canvas","ctx","getContext","drawImage","quality","new_url","quality_l","quality_r","toDataURL","round","on_got_img","readAsDataURL","files","proc_img","d","do_post","accept","IMAGE_BASE","AUDIO_BASE","CLICKABLE_TAGS","audio","QUOTE_BLACKLIST","LATEST_POST_ID","DZ_NAME","load_single_meta","title_elem","single","reply","deletion_detect","Reply","do_filter_name","tag","FlowItem","likenum","r","is_quote","copy_link","img_clickable","latest_reply","FlowSidebar","error_msg","filter_name","rev","syncState","sync_state","reply_ref","prev","update_count","set_variant","max","next_attention","includes","forceCheck","should_text","set","replies_to_show","reverse","replies_cnt","main_thread_elem","show_reply_bar","set_filter_name","toggle_rev","toggle_attention","set_alias","offset","overflow","once","FlowItemRow","reply_status","reply_error","hidden","some","word","attention_override","reply_color_picker","use_reply_promise","reply_promise","hl_rules","search_param","match","quote_id","mode","reveal","FlowItemQuote","FlowChunk","title_button","list","ind","lazyload_key_suffix","Flow","search_text","loaded_pages","chunks","reply_promises_done","sort_by_latest_reply","on_scroll_bound","on_scroll","limit","pLimit","injections","post","_latest_reply","failed","max_id","finished","param","use_search","use_regex","regex_search","data_processed","every","toString","inject_reply_promises","scrollHeight","scrollY","innerHeight","load_page","original_chunk","should_deletion_detect","title_button_sort","sort_by_original","flag_re","APP_SWITCHER_ROUTER","树洞","教室","课表","客户端","成绩","不咕","不咕计划","课程测评","测评","ControlBar","set_mode","on_keypress_bound","on_keypress","do_refresh_bound","do_refresh","do_attention_bound","do_attention","hash","decodeURIComponent","lastIndexOf","flag_res","exec","scrollTo","onKeyPress","AppSwitcherHusk","firstChild","querySelectorAll","el","pathname","Title","Sidebar","do_close_bound","do_close","do_back_bound","do_back","contents","stack","cur_title","onTouchEnd","PressureHelper","level","fired","esc_interval","clearInterval","Pressure","change","force","do_fire","end","polyfill","only","preventSelect","repeat","THRESHOLD","setInterval","new_level","pad","left","right","top","bottom","DeprecatedAlert","App","default","light","dark","sidebar_stack","flow_render_key","show_sidebar_bound","set_mode_bound","on_pressure_bound","on_pressure","inpku_flag","atob","ns","position","pop","Provider","isLocalhost","Boolean","hostname","registerValidSW","swUrl","register","onupdatefound","installingWorker","installing","onstatechange","controller","render","origin","ready","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.23673f45.chunk.js","sourcesContent":["export function get_json(res) {\n    if(!res.ok) throw Error(`网络错误 ${res.status} ${res.statusText}`);\n    return (\n        res\n            .text()\n            .then((t)=>{\n                try {\n                    return JSON.parse(t);\n                } catch(e) {\n                    console.error('json parse error');\n                    console.trace(e);\n                    console.log(t);\n                    throw new SyntaxError('JSON Parse Error '+t.substr(0,50));\n                }\n            })\n    );\n}\n\nexport function listen_darkmode(override) { // override: true/false/undefined\n    function update_color_scheme() {\n        if(override===undefined ? window.matchMedia('(prefers-color-scheme: dark)').matches : override)\n            document.body.classList.add('root-dark-mode');\n        else\n            document.body.classList.remove('root-dark-mode');\n    }\n\n    update_color_scheme();\n    window.matchMedia('(prefers-color-scheme: dark)').addListener(()=>{\n        update_color_scheme();\n    });\n}\n\nexport function API_VERSION_PARAM() {\n    return '&PKUHelperAPI=3.0&jsapiver='+encodeURIComponent((process.env.REACT_APP_BUILD_INFO||'null')+'-'+(Math.floor(+new Date()/7200000)*2));\n}","import React, {Component, PureComponent} from 'react';\nimport ReactDOM from 'react-dom';\n\nimport TimeAgo from 'react-timeago';\nimport chineseStrings from 'react-timeago/lib/language-strings/zh-CN';\nimport buildFormatter from 'react-timeago/lib/formatters/buildFormatter';\n\nimport './global.css';\nimport './widgets.css';\n\nimport appicon_hole from './appicon/hole.png';\nimport appicon_imasugu from './appicon/imasugu.png';\nimport appicon_imasugu_rev from './appicon/imasugu_rev.png';\nimport appicon_syllabus from './appicon/syllabus.png';\nimport appicon_score from './appicon/score.png';\nimport appicon_course_survey from './appicon/course_survey.png';\nimport appicon_dropdown from './appicon/dropdown.png';\nimport appicon_dropdown_rev from './appicon/dropdown_rev.png';\nimport appicon_homepage from './appicon/homepage.png';\nimport {PKUHELPER_ROOT} from './const';\nimport {get_json, API_VERSION_PARAM} from './functions';\n\nconst LOGIN_POPUP_ANCHOR_ID='pkuhelper_login_popup_anchor';\n\nfunction pad2(x) {\n    return x<10 ? '0'+x : ''+x;\n}\nexport function format_time(time) {\n    return `${time.getMonth()+1}-${pad2(time.getDate())} ${time.getHours()}:${pad2(time.getMinutes())}:${pad2(time.getSeconds())}`;\n}\nconst chinese_format=buildFormatter(chineseStrings);\nexport function Time(props) {\n    const time=new Date(props.stamp*1000);\n    return (\n        <span>\n            <TimeAgo date={time} formatter={chinese_format} title={time.toLocaleString('zh-CN', {\n                timeZone: 'Asia/Shanghai',\n                hour12: false,\n            })} />\n            &nbsp;\n            {format_time(time)}\n        </span>\n    );\n}\n\nexport function TitleLine(props) {\n    return (\n        <p className=\"centered-line title-line aux-margin\">\n            <span className=\"black-outline\">{props.text}</span>\n        </p>\n    )\n}\n\nexport function GlobalTitle(props) {\n    return (\n        <div className=\"aux-margin\">\n            <div className=\"title\">\n                <p className=\"centered-line\">{props.text}</p>\n            </div>\n        </div>\n    );\n}\n\nconst FALLBACK_APPS={\n    // id, text, url, icon_normal, icon_hover, new_tab\n    bar: [\n        ['hole', '树洞', '/hole', appicon_hole, null, false],\n        ['imasugu', '教室', '/spare_classroom', appicon_imasugu, appicon_imasugu_rev, false],\n        ['syllabus', '课表', '/syllabus', appicon_syllabus, null, false],\n        ['score', '成绩', '/my_score', appicon_score, null, false],\n    ],\n    dropdown: [\n        ['course_survey', '课程测评', 'https://courses.pinzhixiaoyuan.com/', appicon_course_survey, null, true],\n        ['homepage', '客户端', '/', appicon_homepage, null, true],\n    ],\n    fix: {},\n};\nconst SWITCHER_DATA_VER='switcher_2';\nconst SWITCHER_DATA_URL=PKUHELPER_ROOT+'web_static/appswitcher_items.json';\n\nexport class AppSwitcher extends Component {\n    constructor(props) {\n        super(props);\n        this.state={\n            apps: this.get_apps_from_localstorage(),\n        }\n    }\n\n    get_apps_from_localstorage() {\n        let ret=FALLBACK_APPS;\n        if(localStorage['APPSWITCHER_ITEMS'])\n            try {\n                let content=JSON.parse(localStorage['APPSWITCHER_ITEMS'])[SWITCHER_DATA_VER];\n                if(!content || !content.bar)\n                    throw new Error('content is empty');\n\n                ret=content;\n            } catch(e) {\n                console.error('load appswitcher items from localstorage failed');\n                console.trace(e);\n            }\n\n        return ret;\n    }\n\n    check_fix() {\n        if(this.state.apps && this.state.apps.fix && this.state.apps.fix[this.props.appid])\n            setTimeout(()=>{\n                window.HOTFIX_CONTEXT={\n                    build_info: process.env.REACT_APP_BUILD_INFO || '---',\n                    build_env: process.env.NODE_ENV,\n                };\n                eval(this.state.apps.fix[this.props.appid]);\n            },1); // make it async so failures won't be critical\n    }\n\n    componentDidMount() {\n        this.check_fix();\n        setTimeout(()=>{\n            fetch(SWITCHER_DATA_URL)\n                .then((res)=>{\n                    if(!res.ok) throw Error(`网络错误 ${res.status} ${res.statusText}`);\n                    return res.text();\n                })\n                .then((txt)=>{\n                    if(txt!==localStorage['APPSWITCHER_ITEMS']) {\n                        console.log('loaded new appswitcher items',txt);\n                        localStorage['APPSWITCHER_ITEMS']=txt;\n\n                        this.setState({\n                            apps: this.get_apps_from_localstorage(),\n                        });\n                    } else {\n                        console.log('appswitcher items unchanged');\n                    }\n                })\n                .catch((e)=>{\n                    console.error('loading appswitcher items failed');\n                    console.trace(e);\n                });\n        },500);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if(this.state.apps!==prevState.apps)\n            this.check_fix();\n    }\n\n    render() {\n        let cur_id=this.props.appid;\n\n        function app_elem([id,title,url,icon_normal,icon_hover,new_tab],no_class=false,ref=null) {\n            return (\n                <a ref={ref} key={id} className={no_class ? null : ('app-switcher-item'+(id===cur_id ? ' app-switcher-item-current' : ''))}\n                   href={url} target={new_tab ? '_blank' : '_self'}>\n                    {!!icon_normal && [\n                        <img key=\"normal\" src={icon_normal} className=\"app-switcher-logo-normal\" />,\n                        <img key=\"hover\" src={icon_hover||icon_normal} className=\"app-switcher-logo-hover\" />\n                    ]}\n                    <span>{title}</span>\n                </a>\n            );\n        }\n\n        let dropdown_cur_app=null;\n        this.state.apps.dropdown.forEach((app)=>{\n            if(app[0]===cur_id)\n                dropdown_cur_app=app;\n        });\n\n        //console.log(JSON.stringify(this.state.apps));\n\n        return (\n            <div className=\"app-switcher\">\n                <span className=\"app-switcher-desc app-switcher-left\">PKUHelper</span>\n                {this.state.apps.bar.map((app)=>\n                    app_elem(app)\n                )}\n                {!!this.state.apps.dropdown.length &&\n                    <div className={\n                        'app-switcher-item app-switcher-dropdown '\n                        +(dropdown_cur_app ? ' app-switcher-item-current' : '')\n                    }>\n                        <p className=\"app-switcher-dropdown-title\">\n                            {!!dropdown_cur_app ?\n                                app_elem((()=>{\n                                    let [id,title,_url,icon_normal,icon_hover,_new_tab]=dropdown_cur_app;\n                                    return [id,title+'▾',null,icon_normal,icon_hover,false];\n                                })(),true) :\n                                app_elem(['-placeholder-elem','更多▾',null,appicon_dropdown,appicon_dropdown_rev,false],true)\n                            }\n                        </p>\n                        {this.state.apps.dropdown.map((app)=>{\n                            let ref=React.createRef();\n                            return (\n                                <p key={app[0]} className=\"app-switcher-dropdown-item\" onClick={(e)=>{\n                                    if(!e.target.closest('a') && ref.current)\n                                        ref.current.click();\n                                }}>\n                                    {app_elem(app,true,ref)}\n                                </p>\n                            );\n                        })}\n                    </div>\n                }\n                <span className=\"app-switcher-desc app-switcher-right\">网页版</span>\n            </div>\n        );\n    }\n}\n\nclass LoginPopupSelf extends Component {\n    constructor(props) {\n        super(props);\n        this.state={\n            loading_status: 'idle',\n            excluded_scopes: [],\n        };\n        this.username_ref=React.createRef();\n        this.password_ref=React.createRef();\n        this.input_token_ref=React.createRef();\n\n        this.popup_anchor=document.getElementById(LOGIN_POPUP_ANCHOR_ID);\n        if(!this.popup_anchor) {\n            this.popup_anchor=document.createElement('div');\n            this.popup_anchor.id=LOGIN_POPUP_ANCHOR_ID;\n            document.body.appendChild(this.popup_anchor);\n        }\n    }\n\n    do_sendcode(type) {\n        if(this.state.loading_status==='loading')\n            return;\n\n        this.setState({\n            loading_status: 'loading',\n        },()=>{\n            fetch(\n                PKUHELPER_ROOT+'api_xmcp/login/send_code'\n                +'?user='+encodeURIComponent(this.username_ref.current.value)\n                +'&code_type='+encodeURIComponent(type)\n                +API_VERSION_PARAM(), {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        excluded_scopes: this.state.excluded_scopes||[],\n                    }),\n                }\n            )\n                .then(get_json)\n                .then((json)=>{\n                    console.log(json);\n                    if(!json.success)\n                        throw new Error(JSON.stringify(json));\n\n                    alert(json.msg);\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                })\n                .catch((e)=>{\n                    console.error(e);\n                    alert('发送失败\\n'+e);\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                });\n\n        });\n    }\n\n    do_login(set_token) {\n        if(this.state.loading_status==='loading')\n            return;\n\n        this.setState({\n            loading_status: 'loading',\n        },()=>{\n            fetch(\n                PKUHELPER_ROOT+'api_xmcp/login/login'\n                +'?user='+encodeURIComponent(this.username_ref.current.value)\n                +'&valid_code='+encodeURIComponent(this.password_ref.current.value)\n                +API_VERSION_PARAM(), {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        excluded_scopes: this.state.excluded_scopes||[],\n                    }),\n                }\n            )\n                .then(get_json)\n                .then((json)=>{\n                    if(json.code!==0) {\n                        if(json.msg) throw new Error(json.msg);\n                        throw new Error(JSON.stringify(json));\n                    }\n\n                    set_token(json.user_token);\n                    alert(`成功以 ${json.name} 的身份登录`);\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                    this.props.on_close();\n                })\n                .catch((e)=>{\n                    console.error(e);\n                    alert('登录失败\\n'+e);\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                });\n        });\n    }\n\n    do_input_token(set_token) {\n        if(this.state.loading_status==='loading')\n            return;\n\n        let token=this.input_token_ref.current.value;\n        this.setState({\n            loading_status: 'loading',\n        },()=>{\n            fetch(PKUHELPER_ROOT+'api_xmcp/hole/system_msg?user_token='+encodeURIComponent(token)+API_VERSION_PARAM())\n                .then((res)=>res.json())\n                .then((json)=>{\n                    if(json.error)\n                        throw new Error(json.error);\n                    if(json.result.length===0)\n                        throw new Error('result check failed');\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                    set_token(token);\n                    this.props.on_close();\n                })\n                .catch((e)=>{\n                    alert('Token检验失败\\n'+e);\n                    this.setState({\n                        loading_status: 'done',\n                    });\n                    console.error(e);\n                });\n        });\n    }\n\n    perm_alert() {\n        alert('如果你不需要 PKU Helper 的某项功能，可以取消相应权限。\\n其中【状态信息】包括你的网费、校园卡余额等。\\n该设置应用到你的【所有】设备，取消后如需再次启用相应功能需要重新登录。');\n    }\n\n    render() {\n        let PERM_SCOPES=[\n            ['score','成绩查询'],\n            ['syllabus','课表查询'],\n            ['my_info','状态信息'],\n        ];\n\n        return ReactDOM.createPortal(\n            <div>\n                <div className=\"pkuhelper-login-popup-shadow\" />\n                <div className=\"pkuhelper-login-popup\">\n                    <p>\n                        <b>接收验证码来登录 PKU Helper</b>\n                    </p>\n                    <p>\n                        授权功能<a onClick={this.perm_alert.bind(this)}>(?)</a>\n                        {PERM_SCOPES.map(([scope,title])=>(\n                            <label key={scope} className=\"perm-item\">\n                                <input type=\"checkbox\" checked={this.state.excluded_scopes.indexOf(scope)===-1} onChange={(e)=>{\n                                    let chk=e.target.checked;\n                                    this.setState((prevState)=>{\n                                        let exc=prevState.excluded_scopes.slice();\n                                        if(chk) { // remove from exc\n                                            let pos=exc.indexOf(scope);\n                                            if(pos!==-1)\n                                                exc.splice(pos,1);\n                                        } else { // add to exc\n                                            exc.push(scope);\n                                        }\n                                        return {\n                                            excluded_scopes: exc,\n                                        };\n                                    });\n                                }} />\n                                {title}\n                            </label>\n                        ))}\n                    </p>\n                    <p>\n                        <label>\n                            　学号&nbsp;\n                            <input ref={this.username_ref} type=\"tel\" autoFocus={true} />\n                        </label>\n                        <span className=\"pkuhelper-login-type\">\n                                <a onClick={(e)=>this.do_sendcode('sms')}>\n                                    &nbsp;短信&nbsp;\n                                </a>\n                                /\n                                <a onClick={(e)=>this.do_sendcode('mail')}>\n                                    &nbsp;邮件&nbsp;\n                                </a>\n                            </span>\n                    </p>\n                    <p>\n                        <label>\n                            验证码&nbsp;\n                            <input ref={this.password_ref} type=\"tel\" />\n                        </label>\n                        <button type=\"button\" disabled={this.state.loading_status==='loading'}\n                                onClick={(e)=>this.do_login(this.props.token_callback)}>\n                            登录\n                        </button>\n                    </p>\n                    <hr />\n                    <p>\n                        <b>从其他设备导入登录状态</b>\n                    </p>\n                    <p>\n                        <input ref={this.input_token_ref} placeholder=\"User Token\" />\n                        <button type=\"button\" disabled={this.state.loading_status==='loading'}\n                                onClick={(e)=>this.do_input_token(this.props.token_callback)}>\n                            导入\n                        </button>\n                    </p>\n                    <hr />\n                    <p>\n                        <button onClick={this.props.on_close}>\n                            取消\n                        </button>\n                    </p>\n                </div>\n            </div>,\n            this.popup_anchor,\n        );\n    }\n}\n\nexport class LoginPopup extends Component {\n    constructor(props) {\n        super(props);\n        this.state={\n            popup_show: false,\n        };\n        this.on_popup_bound=this.on_popup.bind(this);\n        this.on_close_bound=this.on_close.bind(this);\n    }\n\n    on_popup() {\n        this.setState({\n            popup_show: true,\n        });\n    }\n    on_close() {\n        this.setState({\n            popup_show: false,\n        });\n    }\n\n    render() {\n        return (\n            <>\n                {this.props.children(this.on_popup_bound)}\n                {this.state.popup_show &&\n                    <LoginPopupSelf token_callback={this.props.token_callback} on_close={this.on_close_bound} />\n                }\n            </>\n        );\n    }\n}","export const PKUHELPER_ROOT='//pkuhelper.pku.edu.cn/';\n","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFdklEQVR42sVW+VNTVxS+f4Od9oeW0RmlU8dOcRx3BEHbqiio3dtfamds+0N1bGe62emirYpSLRYDguAWJQihLZBAEkgKgbCHgIBAXbBTtgSykhAQEL/ecyWtwwMHx9DemS/vvXvv+c73zj3n5DEAjHBodJz9MD7BvuP3KVbb0xqV1p6lzENzS9u7Y3zOVWNittXPMmvMWmaNjZgeW8OZY91i1pSbzSqcg6y01Lj7V7UOap3Bma9WhyiKtEyh0bGsQg0L+P3n5talDNZ5LpWZCwqYqqYxJk9TggK1Bkpza7pWrWNdsZHM/uKymZ1Pgvb07ohiel0Jy7VcO1ug0iCfc+WbW7fUa0vYrUw5u6G8IhXglR1l/qR45tu/l9WeTo5XGqvxS3k1tPmF+t6Y8MXOVYui+3ZEb+ROHoq+HVEb3WtCo23bIhZrCwoNuZyHuKpTU474v/2M+dOSmDdDJhVgzUxn1oQDcd7w59C5+00oqxqgsLTBnHAIQ8vnoy9uPbiDWYH2kk1dwmFkWdqRU2nG9V2vw8e5rScOx/ZnX5YK6Dvw6Z6+VzYMepY8hT8++ZALMONKfQuqkxLhWf88rNvCZy2A54KwqTp1UnCQgPZ9H8Cz5ElYX93gsR38/COpgO3r5bata+FYHYrKve8jp7EDuW23USRLQveKhXDERc5agCMuAt0rF6JQdkpw5DS1o3LPbsFti1nLIxQplx7BljVyO3fSExUG/YYVyFMVIa/lOvLfewcdyxbAvTNq1gJobzu3Ue16G3nNnCNfDUP0cvRELwX5IF9SAbERchtftO+MRsOKUKjXhUG9JRJlSxegm4fUvn32OUB7ycYYNh/qzRFQh4cJTuK23Y+kVED/1nA5BxycwMZxbWUoml4IQdemVXBujwStPQpc3KZr8yo0hYWglXMRJ3FPrksF2F57Sc4BK4f9jZfhfmuzgPPNTWLO9oggG7IN8BDnAzxSAaWL5sk58C+emMS8x8S0PFIBjQf3yznwH0EqwAfIOTAThqZgpjXf7CAV4PAMyjkwFXa3R1xHx+9i4h4wzn/o6r8zKtb6XW4MjdwBnxLw+ofF3HRcD2D2AlxeH5yDXpgsjdBWmFBcVY3S2jr0DTiEKN/wCFpu3ERReQUM1TW4+VcXfFxQ0AQMDvmFiPQcJb5PTkHi+Qs4cEqGo2fS0dndCxrFlVX4OvEkvvjxOCrMDSISQRMQgM3pgtXhFPd0lV3OxOmsKyICdByd3T04xkVVNFhw994cCPDwSIyMjQtyGhVms4hIt61fPA/wcz+WnjF3Alw8DygKvXYHbvf0IlmhgDy/QCQdCeviQuZUAL04kX/1UyK++TkJB2XJ+JMLIWd0DHMugEqNMrysrh6GmlocP3ceOlMlhkfHRA7MuYCByXoPDD0vucOnU2HlR0IOe/oHRBJSuU4EswoCjYjelOqeGhENpVaHhIyzounQcPNSjU87g/qWVvF83zYIAty+IdGI1GVGXCpQ4Te9ARnKXHx5/AQqLU3CWUNbu5g7kpomypOaFdmQ7WMLoPKjClCo1Dh54SJSMhVIy85BbXMLRnhUKNzUGU+cPYdsjRYpiixc4tVBzcsz9AgCXF7vQ3OAOiJlO139PBfG7k4IJ5Qb9Ka0RiUZ2PPQkua+JAKcfJIvzGhEZxwAOZ7aIzwPrLunrE/z3zLN90Brh9zu8vCmMsY3DIozDCYcHJTIlNTNHdelAorLTPG1lmbYuUrfCA/nsB+D/uDA679/fBSBWstVaPTGIxIBXX22EH151UVdqQn1V1sF6ppagoIAX6mpBhpD+YUSY9Uz0s/ygQFWXtPA1MXGjzUGo4Fv1HCoggRNkcGoLykz7fvdVMP0HBIB/xf+Bi8VajXQRja5AAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAG2klEQVR42pVXaUxVRxSee+8DRNlEEA1qBGVLS8XIFllKqiBqUcQispgWLKgFFRsMmxuCiGgA/dM2VdvfJjbpkjRpUrv8aRrTdE2Tpqtt05q0tZVa68aj3zc583J98Cz8+N69983MmbN858wZdeTIEeXG4cOHNfh+4MAB59ChQ8FDQ0Pq+PHjqqKiInTRokV1juO8ppT6FrgGjALf479LGHtm8+bNsZw7MjKijh49GtTd3e0x8szTjQmbm+fBgwedY8eO6W9svCw+Pv5UUFDQZ5Zl/WXb9i3gHjAGeOX9NsZGg4ODv8LcF4qLi/M7Ozu14jDCCaTEpJtjgX3ixAm1ffv2OAh7DhbeAManiTtRUVEXysvLk/v7+1VPT48NuROUuO8PTuBELigoKNgAIT9RGCwzQn+NjIy8sHz58qb8/PziLVu2ZACP5OXlPZaTk/NUbGzsecz5wU+R66mpqTsRTtXb26v8lZiwOWKmUlJS9vht/GNycvKehoaGGI7TrfTQwMCABt8JymhqagrLzs6u9Xg8n3MtuKFlLFy48CTCSl5YbiXuczstT0pK2i0L7/EJq85i4zkcE07QlQ6E8WkJ9H8c6+vr00q1tLSELliwoMctC0qM0BMw1DFK6B8KowVw63pM9GLBHS5ISEho40RuTlLyfTIy+fFHz6Ui2EhlZWVVQdZNyLxLmfSkyLO1B+BSst0C4eYwxmQ1Jy5evLiNQuAyB1prK7GJMxVAsI0NLL4PDg4q8KNcPDGG520Q8yF6qaury6HGwdQ0Li7ueUMcuP0cLeHmjBvJwwX4nhJoIZXnWijjYehgUIfhVUhIyKV9+/bRQx41PDysNm3a9DAG/wHGMOHn+vr6CAixGC8KbG1tDcnMzGyYN29eF9AOZTsnA8Y6OCctLa1l165ds6m4GOBAhgIxP4R8etgLoq5nsdKMnj9//pCxfunSpbtNjAw3VqxYsXO6dQBeHKYCEg6b+4BjazBGQnrDwsLeoOdpfThi8wX/BK6C8ZF0GUNAhtP1RUVFG8RD3ilszjl3kMqtDAMU0GlHZdra2uiFj2TOn2VlZXMVUqOGxYKLw8PDLzDPQR7LnAnUkv+h4CxDSV4LlEDpNQFQgvFSIKe9vV2Hz8ghifmN1OylAgxFdHR0i4L1r+PjFv9EhXuaFjON3CnGhYzX6dOn1ZkzZx4IM4fWm1w3qU7ZpaWljwoZ6YVPFU8ypJ7OUZZXxhzks/09gIXZq1atehwoBdYGAMfWAYVguS0cMB6wyIOampokhsgVTnUN2jA/vZWVlRniAUvKs9Ya58ITzJDpkBAVtYNcIgnFAzqVq6qqojH+u5R5Gq6uuxRIdytgsoChmW4WIB0HxQOWnwJRGP/NrcAVfOgQ8FQTBXwhYPzhTk9GRkYVUnQP0Ay0BEAzzxLMrd+xY0eY+/TjkyGorq5OYDX0hQAkfIfNhBSHbbTYn4QUxK6IRWuqMKnsanB0SqMM57pI+B3TcKe0VboEi+W+NDQHTV1dXSzSKw1IAVIDgGNpSNl41HlNYLOeXuWZg8OoXdJwHGnYzUI0F8Xha3HJlcbGxlB3IaLbSkpKCpgtoijxdwCMSk25ijDUiBzLhHL//v0KLdv7stcNFKJEHRcQ5qwhD8putUlF05qlp6c/O10SonN6kZuyR6AsuN9CemZK/MdwIL2rj2MWDgzkSW6OofH8srm5OQiFhAstFhQQKhoVrB+Kvgycw8FzPgDOYfwlYAShSKAHyH42IKwlqP9vGvLB0G3kim6d2b3OmjXrotEejWgP4wftPQwFlSARp3ocE1IDNKHpZZymtYZ8CPknOB2DMM/DpsDDCWDnEsZFmoZxLKhkMwEhjtQFe4qwpG2zsM5DK1evXp0Fmf+a1gwVt0gaEo/voKASYGijdC6sCzfRyVTQElhvuWvDZP29353CNt017ge5sPoX3h0oG0f/SZln+5pS0xGzAUFannI3komJiR1wl84GOd0caUItyRTlbkw5h9Yx5qwrNERyfnzmzJmv7N27l7zy3RHua8vZMpM07F65wPSHiNkHcNs6nufkBjODCpm23LzTW0w1uHwlGw4xxGx+EeQOlWZnYltulKC76QlcJloZN3dqQZHLuP/14WQsqq2tTdq6dWs0MBsnXCI4tBJrOmbMmPGe1HjfOmTQSViu/Def9Grmvh2hSGVA87cC5Do3+YMHi+T2hDkoOpcLCwuLKds0qZNezQL09w7dyu41Nze3LCIi4lW5DfMyqrtbPl3vXsnxUSj9NrLoSaYawyO8efDl1F8JgncG1gl2Q/zeuHHj3JiYmGZs8rH0B3cFfP8GY52Ys4QymH5s6//vev4fhVL/4/SeszAAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAFfklEQVR42qWXWWicVRiG/39mUim4NRq88MZWXIpLe+FS6lYKtZsW0UrRUmyllUIXpQiN3hXBC1sxdyom6q2lVRGhUqvFClURUVFUsu+ZmD2TTDKTycTn/fudcPzNJJMaeDOTnHO+7z3ffoLm5uagFFpaWpJ8LmloaAgaGxuD3t7epePj49unpqbeLhQKn4EvwQVwjv+dYm1fOp2u0t76+vqgqampAhmp+XTMqxwB0XcUr8pmsydQ8jPK0oYe0G3f+8AgGGDPn+x9t7+//8HW1taIODKSiyWQ0MGurq4bEKbbjoEZUATTYApMgglDrnDpp2j7hPzk5ORJyN9qJBLlEoiUDw4ObkNIhydQ6JHQ4eHhF1jfgLlXg7v5vn5oaGj3xMTE++xpjZ0ZyWQy+7Fo4Cw6H4GENnLgcExIu/6HRa7XugjOBcno7Oy8EjI7ccVvOstnJIP4OG4kwlIEopuj6JAdlElnuFUtiq/Tmt1ApkwiTJ+hIWF+TmiP9nZ0dChgj/my+LtGJPyYcAHnzL5VfuRAXgfGxsZe1rrWLCOCcuAHMO7agazs1CUWM7KkyYtiwm0OdUuL7KJTLiFAt/VvWQ4SdiYpZbjkCbOEAjhHYN7hLiWWS8QEU7/jfM73Ov3PlAfOrEZoQbi9Zu6UvnOhaic/n89/3dbWFq1FBQNGd7IwbinWiTWuRkjolLe3t1+BKZ8nJV8FRyH4ylxgrVp7RkdHDxIDyxwJXQQZARb4wSxcxCpbpTtiy6E3HTuYHnI+crGB8v2xrFgQEHrLBa0XYxtdvcjlcp9HMcDtr4LZr8Ysze2v8fI11MGBgYFtZqFiGcq1J0+wvWRyQnNnILOj6yfb8zc/VQGp8RR/9Mr8sDppfgtjUR1QcFZBdjN4FGwsAa1tAverDMcKT5Si6HvNKmmGorZbjGrFRqwx9d65Uk4H5a/FIF71nBv6+voesdKt/nEq4NcX1lByKq9+jvoW4OB9NJjHwCawuQS0tgU8jLkTMRKRO3t6em5ReVZ1Bd+KwFfW1bKq7UYgjPWF7ZYhZQchMVDtVc7AlXB0VJpy9YwzInDeCpAI3OUT8LJg72KzgMx6ww9Cj8C1rLeBFkfgrOeC9XEXWPSmRkZGdpCih8EBcLAEDqiXsHePmlI8DswFy9E1rHoDLioIP+JLvyKT4rCrVBBqKvqfQRjaVLXGglA6zyot9lhEFl0Jjqeh0N3dXcXhleA2cHsJaG0lZr7R0vlfWaCeg4WOWhqOkYYvilEVVvjLikMbplsaL0RE9UPms1FDpgRGLcLTuOHZeCFSbUDXBQvoIQrRTa4U17rgIeCe8eIgCkKEHVlsEHK792KlOOQi95j5p2lI56NSLH+x8IAKkRZg+AeNpILDUUuVEKxSiateh+iHoE6jVwnUsf4BqMGyy72OGHVVKu0ZV8656K6oGWl0lmlYPO2l0DFzQcqZ73LghhNL5Z2uV3DJX+iOumRKG1IWnTcrMGxoEMOn3UjtDSTlwO1VO0+Zhe/V9OxGM9J9nbk5FZ8H99nkop1Z0vJJu00YL88LjGSz8YPyNVZpC2bd407nf4ZS+Qlfn/AHSU0ymCv0htKkd9PAS9toZHMTkWSprugizu8E3seSpfiacyy3m4pEjdfbReY7zLbFxqiSY7lLNW69VgOHnXXKT2tSduRKPkwcCQ0U9uqZTS2E/ah+Tmdcp64GKsEysIIYWqsGhKJvrNDMntObQCNZXPmCTzOErkbg2di0U7CUVeHpstdTxpRO+1OTCDNNbXCZFFc+7+PUjdQyO758HJN+apNTxh6iae9xOmBVUBYbhvQ5sug5pdrlPk79B0aFUsleyVUUG/WOT8D39jS/CH7XJ2tH2LNCe60hJRd6nv8Dwj5T3q96iTAAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,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\"","// https://martin.ankerl.com/2009/12/09/how-to-create-random-colors-programmatically/\n\nconst golden_ratio_conjugate = 0.618033988749895;\n\nexport class ColorPicker {\n  constructor() {\n    this.names = {};\n    this.current_h = Math.random();\n  }\n\n  get(name) {\n    name = name.toLowerCase();\n    if (name === '洞主') return ['hsl(0,0%,97%)', 'hsl(0,0%,16%)'];\n\n    if (!this.names[name]) {\n      this.current_h += golden_ratio_conjugate;\n      this.current_h %= 1;\n      this.names[name] = [\n        `hsl(${this.current_h * 360}, 50%, 90%)`,\n        `hsl(${this.current_h * 360}, 60%, 20%)`,\n      ];\n    }\n    return this.names[name];\n  }\n}\n","// regexp should match the WHOLE segmented part\nexport const PID_RE =\n  /(^|[^\\d\\u20e3\\ufe0e\\ufe0f])([1-9]\\d{4,6})(?![\\d\\u20e3\\ufe0e\\ufe0f])/g;\nexport const URL_PID_RE =\n  /((?:https?:\\/\\/)?pkuhelper\\.pku\\.edu\\.cn\\/hole\\/?#(?:#|%23)([1-9]\\d{4,6}))(?!\\d|\\u20e3|\\ufe0e|\\ufe0f)/g;\nexport const NICKNAME_RE =\n  /(^|[^A-Za-z])((?:(?:Angry|Baby|Crazy|Diligent|Excited|Fat|Greedy|Hungry|Interesting|Jolly|Kind|Little|Magic|Naïve|Old|Powerful|Quiet|Rich|Superman|THU|Undefined|Valuable|Wifeless|Xiangbuchulai|Young|Zombie)\\s)?(?:Alice|Bob|Carol|Dave|Eve|Francis|Grace|Hans|Isabella|Jason|Kate|Louis|Margaret|Nathan|Olivia|Paul|Queen|Richard|Susan|Thomas|Uma|Vivian|Winnie|Xander|Yasmine|Zach)|You Win(?: \\d+)?|洞主)(?![A-Za-z])/gi;\nexport const URL_RE =\n  /(^|[^.@a-zA-Z0-9_])((?:https?:\\/\\/)?(?:(?:[\\w-]+\\.)+[a-zA-Z]{2,3}|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})(?::\\d{1,5})?(?:\\/[\\w~!@#$%^&*\\-_=+[\\]{};:,./?|]*)?)(?![a-zA-Z0-9])/gi;\n\nexport function split_text(txt, rules) {\n  // rules: [['name',/regex/],...]\n  // return: [['name','part'],[null,'part'],...]\n\n  txt = [[null, txt]];\n  rules.forEach((rule) => {\n    const [name, regex] = rule;\n    txt = [].concat.apply(\n      [],\n      txt.map((part) => {\n        const [rule, content] = part;\n        if (rule)\n          // already tagged by previous rules\n          return [part];\n        else {\n          return content\n            .split(regex)\n            .map((seg) => (regex.test(seg) ? [name, seg] : [null, seg]))\n            .filter(([name, seg]) => name !== null || seg);\n        }\n      }),\n    );\n  });\n  return txt;\n}\n","const HOLE_CACHE_DB_NAME = 'hole_cache_db';\nconst CACHE_DB_VER = 1;\nconst MAINTENANCE_STEP = 150;\nconst MAINTENANCE_COUNT = 1000;\n\nconst ENC_KEY = 42;\n\nclass Cache {\n  constructor() {\n    this.db = null;\n    this.added_items_since_maintenance = 0;\n    this.encrypt = this.encrypt.bind(this);\n    this.decrypt = this.decrypt.bind(this);\n    const open_req = indexedDB.open(HOLE_CACHE_DB_NAME, CACHE_DB_VER);\n    open_req.onerror = console.error.bind(console);\n    open_req.onupgradeneeded = (event) => {\n      console.log('comment cache db upgrade');\n      const db = event.target.result;\n      const store = db.createObjectStore('comment', {\n        keyPath: 'pid',\n      });\n      store.createIndex('last_access', 'last_access', { unique: false });\n    };\n    open_req.onsuccess = (event) => {\n      console.log('comment cache db loaded');\n      this.db = event.target.result;\n      setTimeout(this.maintenance.bind(this), 1);\n    };\n  }\n\n  // use window.hole_cache.encrypt() only after cache is loaded!\n  encrypt(pid, data) {\n    const s = JSON.stringify(data);\n    let o = '';\n    for (let i = 0, key = (ENC_KEY ^ pid) % 128; i < s.length; i++) {\n      const c = s.charCodeAt(i);\n      const new_key = (key ^ (c / 2)) % 128;\n      o += String.fromCharCode(key ^ s.charCodeAt(i));\n      key = new_key;\n    }\n    return o;\n  }\n\n  // use window.hole_cache.decrypt() only after cache is loaded!\n  decrypt(pid, s) {\n    let o = '';\n    if (typeof s !== typeof 'str') return null;\n\n    for (let i = 0, key = (ENC_KEY ^ pid) % 128; i < s.length; i++) {\n      const c = key ^ s.charCodeAt(i);\n      o += String.fromCharCode(c);\n      key = (key ^ (c / 2)) % 128;\n    }\n\n    try {\n      return JSON.parse(o);\n    } catch (e) {\n      console.error('decrypt failed');\n      console.trace(e);\n      return null;\n    }\n  }\n\n  get(pid, target_version) {\n    pid = parseInt(pid);\n    return new Promise((resolve, reject) => {\n      if (!this.db) return resolve(null);\n      let get_req, store;\n      try {\n        const tx = this.db.transaction(['comment'], 'readwrite');\n        store = tx.objectStore('comment');\n        get_req = store.get(pid);\n      } catch (e) {\n        // ios sometimes fail at here, just ignore it\n        console.exception(e);\n        resolve(null);\n      }\n      get_req.onsuccess = () => {\n        const res = get_req.result;\n        if (!res || !res.data_str) {\n          //console.log('comment cache miss '+pid);\n          resolve(null);\n        } else if (target_version === res.version) {\n          // hit\n          console.log('comment cache hit', pid);\n          res.last_access = +new Date();\n          store.put(res);\n          const data = this.decrypt(pid, res.data_str);\n          resolve(data); // obj or null\n        } else {\n          // expired\n          console.log(\n            'comment cache expired',\n            pid,\n            ': ver',\n            res.version,\n            'target',\n            target_version,\n          );\n          store.delete(pid);\n          resolve(null);\n        }\n      };\n      get_req.onerror = (e) => {\n        console.warn('comment cache indexeddb open failed');\n        console.error(e);\n        resolve(null);\n      };\n    });\n  }\n\n  put(pid, target_version, data) {\n    pid = parseInt(pid);\n    return new Promise((resolve, reject) => {\n      if (!this.db) return resolve();\n      try {\n        const tx = this.db.transaction(['comment'], 'readwrite');\n        const store = tx.objectStore('comment');\n        store.put({\n          pid: pid,\n          version: target_version,\n          data_str: this.encrypt(pid, data),\n          last_access: +new Date(),\n        });\n        console.log('comment cache put', pid); // ! REMOVED in official\n        if (++this.added_items_since_maintenance === MAINTENANCE_STEP)\n          setTimeout(this.maintenance.bind(this), 1);\n      } catch (e) {\n        console.exception(e);\n        return resolve();\n      }\n    });\n  }\n\n  delete(pid) {\n    pid = parseInt(pid);\n    return new Promise((resolve, reject) => {\n      if (!this.db) return resolve();\n      let req;\n      try {\n        const tx = this.db.transaction(['comment'], 'readwrite');\n        const store = tx.objectStore('comment');\n        req = store.delete(pid);\n      } catch (e) {\n        console.exception(e);\n        return resolve();\n      }\n      console.log('comment cache delete', pid); // ! REMOVED in official\n      req.onerror = () => {\n        console.warn('comment cache delete failed ', pid);\n        return resolve();\n      };\n      req.onsuccess = () => resolve();\n    });\n  }\n\n  maintenance() {\n    if (!this.db) return;\n    const tx = this.db.transaction(['comment'], 'readwrite');\n    const store = tx.objectStore('comment');\n    const count_req = store.count();\n    count_req.onsuccess = () => {\n      let count = count_req.result;\n      if (count > MAINTENANCE_COUNT) {\n        console.log('comment cache db maintenance', count);\n        store.index('last_access').openKeyCursor().onsuccess = (e) => {\n          const cur = e.target.result;\n          if (cur) {\n            //console.log('maintenance: delete',cur);\n            store.delete(cur.primaryKey);\n            if (--count > MAINTENANCE_COUNT) cur.continue();\n          }\n        };\n      } else {\n        console.log('comment cache db no need to maintenance', count);\n      }\n      this.added_items_since_maintenance = 0;\n    };\n    count_req.onerror = console.error.bind(console);\n  }\n\n  clear() {\n    if (!this.db) return;\n    try {\n      indexedDB.deleteDatabase(HOLE_CACHE_DB_NAME);\n      console.log('delete comment cache db');\n    } catch (e) {\n      console.exception(e);\n    }\n  }\n}\n\nexport function cache() {\n  if (!window.hole_cache) window.hole_cache = new Cache();\n  return window.hole_cache;\n}\n","import { get_json, API_VERSION_PARAM } from './infrastructure/functions';\nimport { PKUHELPER_ROOT } from './infrastructure/const';\nimport { API_BASE } from './Common';\nimport { cache } from './cache';\n\nexport { PKUHELPER_ROOT, API_VERSION_PARAM };\n\nexport function token_param(token) {\n  return API_VERSION_PARAM() + (token ? '&user_token=' + token : '');\n}\n\nexport { get_json };\n\nconst SEARCH_PAGESIZE = 50;\n\nconst handle_response = async (response, notify = false) => {\n  const json = await get_json(response);\n  if (json.code !== 0) {\n    if (json.msg) {\n      if (notify) alert(json.msg);\n      else throw new Error(json.msg);\n    } else throw new Error(JSON.stringify(json));\n  }\n  return json;\n};\n\nconst parse_replies = (replies, color_picker) =>\n  replies\n    .sort((a, b) => parseInt(a.cid, 10) - parseInt(b.cid, 10))\n    .map((info) => {\n      info._display_color = color_picker.get(info.name);\n      info.variant = {};\n      return info;\n    });\n\nexport const API = {\n  load_replies: async (pid, token, color_picker, cache_version) => {\n    pid = parseInt(pid);\n    const response = await fetch(\n      API_BASE + '/api.php?action=getcomment&pid=' + pid + token_param(token),\n    );\n    const json = await handle_response(response);\n    // Helper warnings are not cacheable\n    if (json.data.length !== 1 || !json.data[0].text.startsWith('[Helper]')) {\n      cache().put(pid, cache_version, json);\n    }\n    json.data = parse_replies(json.data, color_picker);\n    return json;\n  },\n\n  load_replies_with_cache: async (pid, token, color_picker, cache_version) => {\n    pid = parseInt(pid);\n    let json = await cache().get(pid, cache_version);\n    if (json) {\n      json.data = parse_replies(json.data, color_picker);\n      return { data: json, cached: true };\n    } else {\n      json = await API.load_replies(pid, token, color_picker, cache_version);\n      return { data: json, cached: !json };\n    }\n  },\n\n  set_attention: async (pid, attention, token) => {\n    const data = new URLSearchParams();\n    data.append('user_token', token);\n    data.append('pid', pid);\n    data.append('switch', attention ? '1' : '0');\n    const response = await fetch(\n      API_BASE + '/api.php?action=attention' + token_param(token),\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded',\n        },\n        body: data,\n      },\n    );\n    // Delete cache to update `attention` on next reload\n    cache().delete(pid);\n    return handle_response(response, true);\n  },\n\n  report: async (pid, reason, token) => {\n    const data = new URLSearchParams();\n    data.append('user_token', token);\n    data.append('pid', pid);\n    data.append('reason', reason);\n    const response = await fetch(\n      API_BASE + '/api.php?action=report' + token_param(token),\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded',\n        },\n        body: data,\n      },\n    );\n    return handle_response(response, true);\n  },\n\n  get_list: async (page, token) => {\n    const response = await fetch(\n      API_BASE + '/api.php?action=getlist' + '&p=' + page + token_param(token),\n    );\n    return handle_response(response);\n  },\n\n  get_search: async (page, keyword, token) => {\n    const response = await fetch(\n      API_BASE +\n        '/api.php?action=search' +\n        '&pagesize=' +\n        SEARCH_PAGESIZE +\n        '&page=' +\n        page +\n        '&keywords=' +\n        encodeURIComponent(keyword) +\n        token_param(token),\n    );\n    return handle_response(response);\n  },\n\n  get_single: async (pid, token) => {\n    const response = await fetch(\n      API_BASE + '/api.php?action=getone' + '&pid=' + pid + token_param(token),\n    );\n    return handle_response(response);\n  },\n\n  get_attention: async (token) => {\n    const response = await fetch(\n      API_BASE + '/api.php?action=getattention' + token_param(token),\n    );\n    return handle_response(response);\n  },\n};\n","import React, { Component, PureComponent } from 'react';\nimport { format_time, Time, TitleLine } from './infrastructure/widgets';\nimport { PKUHELPER_ROOT } from './flows_api';\n\nimport './Common.css';\n\nexport { format_time, Time, TitleLine };\n\nexport const API_BASE = PKUHELPER_ROOT + 'services/pkuhole';\n\n// https://stackoverflow.com/questions/3446170/escape-string-for-use-in-javascript-regex\nfunction escape_regex(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nexport function build_highlight_re(\n  txt,\n  split = ' ',\n  option = 'g',\n  isRegex = false,\n) {\n  if (isRegex) {\n    try {\n      return new RegExp('(' + txt.slice(1, -1) + ')', option);\n    } catch (e) {\n      return /^$/g;\n    }\n  } else {\n    return txt\n      ? new RegExp(\n          `(${txt\n            .split(split)\n            .filter((x) => !!x)\n            .map(escape_regex)\n            .join('|')})`,\n          option,\n        )\n      : /^$/g;\n  }\n}\n\nexport function ColoredSpan(props) {\n  return (\n    <span\n      className=\"colored-span\"\n      style={{\n        '--coloredspan-bgcolor-light': props.colors[0],\n        '--coloredspan-bgcolor-dark': props.colors[1],\n      }}\n    >\n      {props.children}\n    </span>\n  );\n}\n\nexport class HighlightedText extends PureComponent {\n  render() {\n    function normalize_url(url) {\n      return /^https?:\\/\\//.test(url) ? url : 'http://' + url;\n    }\n    return (\n      <pre>\n        {this.props.parts.map((part, idx) => {\n          const [rule, p] = part;\n          return (\n            <span key={idx}>\n              {rule === 'url_pid' ? (\n                <span className=\"url-pid-link\" title={p}>\n                  /hole/##\n                </span>\n              ) : rule === 'url' ? (\n                <a href={normalize_url(p)} target=\"_blank\" rel=\"noopener\">\n                  {p}\n                </a>\n              ) : rule === 'pid' ? (\n                <a\n                  href={'##' + p}\n                  onClick={(e) => {\n                    e.preventDefault();\n                    this.props.show_pid(p);\n                  }}\n                >\n                  {p}\n                </a>\n              ) : rule === 'nickname' ? (\n                <ColoredSpan colors={this.props.color_picker.get(p)}>\n                  {p}\n                </ColoredSpan>\n              ) : rule === 'search' ? (\n                <span className=\"search-query-highlight\">{p}</span>\n              ) : (\n                p\n              )}\n            </span>\n          );\n        })}\n      </pre>\n    );\n  }\n}\n\nwindow.TEXTAREA_BACKUP = {};\n\nexport class SafeTextarea extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      text: '',\n    };\n    this.on_change_bound = this.on_change.bind(this);\n    this.on_keydown_bound = this.on_keydown.bind(this);\n    this.clear = this.clear.bind(this);\n    this.area_ref = React.createRef();\n    this.change_callback = props.on_change || (() => {});\n    this.submit_callback = props.on_submit || (() => {});\n  }\n\n  componentDidMount() {\n    this.setState(\n      {\n        text: window.TEXTAREA_BACKUP[this.props.id] || '',\n      },\n      () => {\n        this.change_callback(this.state.text);\n      },\n    );\n  }\n\n  componentWillUnmount() {\n    window.TEXTAREA_BACKUP[this.props.id] = this.state.text;\n    this.change_callback(this.state.text);\n  }\n\n  on_change(event) {\n    this.setState({\n      text: event.target.value,\n    });\n    this.change_callback(event.target.value);\n  }\n  on_keydown(event) {\n    if (event.key === 'Enter' && event.ctrlKey && !event.altKey) {\n      event.preventDefault();\n      this.submit_callback();\n    }\n  }\n\n  clear() {\n    this.setState({\n      text: '',\n    });\n  }\n  set(text) {\n    this.change_callback(text);\n    this.setState({\n      text: text,\n    });\n  }\n  get() {\n    return this.state.text;\n  }\n  focus() {\n    this.area_ref.current.focus();\n  }\n\n  render() {\n    return (\n      <textarea\n        ref={this.area_ref}\n        onChange={this.on_change_bound}\n        value={this.state.text}\n        onKeyDown={this.on_keydown_bound}\n      />\n    );\n  }\n}\n\nlet pwa_prompt_event = null;\nwindow.addEventListener('beforeinstallprompt', (e) => {\n  console.log('pwa: received before install prompt');\n  pwa_prompt_event = e;\n});\n\nexport function PromotionBar(props) {\n  const is_ios = /iPhone|iPad|iPod/i.test(window.navigator.userAgent);\n  const is_installed =\n    window.matchMedia('(display-mode: standalone)').matches ||\n    window.navigator.standalone;\n\n  if (is_installed) return null;\n\n  if (is_ios)\n    // noinspection JSConstructorReturnsPrimitive\n    return !navigator.standalone ? (\n      <div className=\"box promotion-bar\">\n        <span className=\"icon icon-about\" />\n        &nbsp; 用 Safari 把树洞 <b>添加到主屏幕</b> 更好用\n      </div>\n    ) : null;\n  // noinspection JSConstructorReturnsPrimitive\n  else\n    return pwa_prompt_event ? (\n      <div className=\"box promotion-bar\">\n        <span className=\"icon icon-about\" />\n        &nbsp; 把网页版树洞{' '}\n        <b>\n          <a\n            onClick={() => {\n              if (pwa_prompt_event) pwa_prompt_event.prompt();\n            }}\n          >\n            安装到桌面\n          </a>\n        </b>{' '}\n        更好用\n      </div>\n    ) : null;\n}\n\nexport class ClickHandler extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      moved: true,\n      init_y: 0,\n      init_x: 0,\n    };\n    this.on_begin_bound = this.on_begin.bind(this);\n    this.on_move_bound = this.on_move.bind(this);\n    this.on_end_bound = this.on_end.bind(this);\n\n    this.MOVE_THRESHOLD = 3;\n    this.last_fire = 0;\n  }\n\n  on_begin(e) {\n    //console.log('click',(e.touches?e.touches[0]:e).screenY,(e.touches?e.touches[0]:e).screenX);\n    this.setState({\n      moved: false,\n      init_y: (e.touches ? e.touches[0] : e).screenY,\n      init_x: (e.touches ? e.touches[0] : e).screenX,\n    });\n  }\n  on_move(e) {\n    if (!this.state.moved) {\n      const mvmt =\n        Math.abs((e.touches ? e.touches[0] : e).screenY - this.state.init_y) +\n        Math.abs((e.touches ? e.touches[0] : e).screenX - this.state.init_x);\n      //console.log('move',mvmt);\n      if (mvmt > this.MOVE_THRESHOLD)\n        this.setState({\n          moved: true,\n        });\n    }\n  }\n  on_end(event) {\n    //console.log('end');\n    if (!this.state.moved) this.do_callback(event);\n    this.setState({\n      moved: true,\n    });\n  }\n\n  do_callback(event) {\n    if (this.last_fire + 100 > +new Date()) return;\n    this.last_fire = +new Date();\n    this.props.callback(event);\n  }\n\n  render() {\n    return (\n      <div\n        onTouchStart={this.on_begin_bound}\n        onMouseDown={this.on_begin_bound}\n        onTouchMove={this.on_move_bound}\n        onMouseMove={this.on_move_bound}\n        onClick={this.on_end_bound}\n      >\n        {this.props.children}\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport load from 'load-script';\n\nwindow.audio_cache = {};\n\nfunction load_amrnb() {\n  return new Promise((resolve, reject) => {\n    if (window.AMR) resolve();\n    else\n      load('static/amr_all.min.js', (err) => {\n        if (err) reject(err);\n        else resolve();\n      });\n  });\n}\n\nexport class AudioWidget extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      url: this.props.src,\n      state: 'waiting',\n      data: null,\n    };\n  }\n\n  load() {\n    if (window.audio_cache[this.state.url]) {\n      this.setState({\n        state: 'loaded',\n        data: window.audio_cache[this.state.url],\n      });\n      return;\n    }\n\n    console.log('fetching audio', this.state.url);\n    this.setState({\n      state: 'loading',\n    });\n    Promise.all([fetch(this.state.url), load_amrnb()]).then((res) => {\n      res[0].blob().then((blob) => {\n        const reader = new FileReader();\n        reader.onload = (event) => {\n          const raw = new window.AMR().decode(event.target.result);\n          if (!raw) {\n            alert('audio decoding failed');\n            return;\n          }\n          const wave = window.PCMData.encode({\n            sampleRate: 8000,\n            channelCount: 1,\n            bytesPerSample: 2,\n            data: raw,\n          });\n          const binary_wave = new Uint8Array(wave.length);\n          for (let i = 0; i < wave.length; i++)\n            binary_wave[i] = wave.charCodeAt(i);\n\n          const objurl = URL.createObjectURL(\n            new Blob([binary_wave], { type: 'audio/wav' }),\n          );\n          window.audio_cache[this.state.url] = objurl;\n          this.setState({\n            state: 'loaded',\n            data: objurl,\n          });\n        };\n        reader.readAsBinaryString(blob);\n      });\n      this.setState({\n        state: 'decoding',\n      });\n    });\n  }\n\n  render() {\n    if (this.state.state === 'waiting')\n      return (\n        <p>\n          <a onClick={this.load.bind(this)}>加载音频</a>\n        </p>\n      );\n    if (this.state.state === 'loading') return <p>正在下载……</p>;\n    else if (this.state.state === 'decoding') return <p>正在解码……</p>;\n    else if (this.state.state === 'loaded')\n      return (\n        <p>\n          <audio src={this.state.data} controls />\n        </p>\n      );\n  }\n}\n","import React, { PureComponent } from 'react';\nimport { PKUHELPER_ROOT, get_json, API_VERSION_PARAM } from './flows_api';\nimport { Time } from './Common';\n\nexport class MessageViewer extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading_status: 'idle',\n      msg: [],\n    };\n  }\n\n  componentDidMount() {\n    this.load();\n  }\n\n  load() {\n    if (this.state.loading_status === 'loading') return;\n    this.setState(\n      {\n        loading_status: 'loading',\n      },\n      () => {\n        fetch(\n          PKUHELPER_ROOT +\n            'api_xmcp/hole/system_msg?user_token=' +\n            encodeURIComponent(this.props.token) +\n            API_VERSION_PARAM(),\n        )\n          .then(get_json)\n          .then((json) => {\n            if (json.error) throw new Error(json.error);\n            else\n              this.setState({\n                loading_status: 'done',\n                msg: json.result,\n              });\n          })\n          .catch((err) => {\n            console.error(err);\n            alert('' + err);\n            this.setState({\n              loading_status: 'failed',\n            });\n          });\n      },\n    );\n  }\n\n  render() {\n    if (this.state.loading_status === 'loading')\n      return <p className=\"box box-tip\">加载中……</p>;\n    else if (this.state.loading_status === 'failed')\n      return (\n        <div className=\"box box-tip\">\n          <a\n            onClick={() => {\n              this.load();\n            }}\n          >\n            重新加载\n          </a>\n        </div>\n      );\n    else if (this.state.loading_status === 'done')\n      return this.state.msg.map((msg) => (\n        <div className=\"box\" key={msg.timestamp}>\n          <div className=\"box-header\">\n            <Time stamp={msg.timestamp} />\n            <b>{msg.title}</b>\n          </div>\n          <div className=\"box-content\">\n            <pre>{msg.content}</pre>\n          </div>\n        </div>\n      ));\n    else return null;\n  }\n}\n","import React, { PureComponent } from 'react';\n\nimport copy from 'copy-to-clipboard';\n\nimport './Config.css';\n\nconst BUILTIN_IMGS = {\n  'static/bg/gbp.jpg': '寻觅繁星（默认）',\n  'static/bg/eriri.jpg': '平成著名画师',\n  'static/bg/yurucamp.jpg': '露营天下第一',\n  'static/bg/minecraft.jpg': '麦恩·库拉夫特',\n  'static/bg/sif.jpg': '梦开始的地方',\n};\n\nconst DEFAULT_CONFIG = {\n  background_img: 'static/bg/gbp.jpg',\n  background_color: '#113366',\n  pressure: false,\n  easter_egg: true,\n  color_scheme: 'default',\n  block_words: [],\n  alias: {},\n  attention_sort: false,\n};\n\nexport function load_config() {\n  const config = Object.assign({}, DEFAULT_CONFIG);\n  let loaded_config;\n  try {\n    loaded_config = JSON.parse(localStorage['hole_config'] || '{}');\n  } catch (e) {\n    alert('设置加载失败，将重置为默认设置！\\n' + e);\n    delete localStorage['hole_config'];\n    loaded_config = {};\n  }\n\n  // unrecognized configs are removed\n  Object.keys(loaded_config).forEach((key) => {\n    if (config[key] !== undefined) config[key] = loaded_config[key];\n  });\n\n  console.log('config loaded', config);\n  window.config = config;\n}\nexport function save_config() {\n  localStorage['hole_config'] = JSON.stringify(window.config);\n  load_config();\n}\n\nexport function bgimg_style(img, color) {\n  if (img === undefined) img = window.config.background_img;\n  if (color === undefined) color = window.config.background_color;\n  return {\n    background: 'transparent center center',\n    backgroundImage: img === null ? 'unset' : 'url(\"' + encodeURI(img) + '\")',\n    backgroundColor: color,\n    backgroundSize: 'cover',\n  };\n}\n\nclass ConfigBackground extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      img: window.config.background_img,\n      color: window.config.background_color,\n    };\n  }\n\n  save_changes() {\n    this.props.callback({\n      background_img: this.state.img,\n      background_color: this.state.color,\n    });\n  }\n\n  on_select(e) {\n    const value = e.target.value;\n    this.setState(\n      {\n        img: value === '##other' ? '' : value === '##color' ? null : value,\n      },\n      this.save_changes.bind(this),\n    );\n  }\n  on_change_img(e) {\n    this.setState(\n      {\n        img: e.target.value,\n      },\n      this.save_changes.bind(this),\n    );\n  }\n  on_change_color(e) {\n    this.setState(\n      {\n        color: e.target.value,\n      },\n      this.save_changes.bind(this),\n    );\n  }\n\n  render() {\n    const img_select =\n      this.state.img === null\n        ? '##color'\n        : Object.keys(BUILTIN_IMGS).indexOf(this.state.img) === -1\n        ? '##other'\n        : this.state.img;\n    return (\n      <div>\n        <p>\n          <b>背景图片：</b>\n          <select\n            className=\"config-select\"\n            value={img_select}\n            onChange={this.on_select.bind(this)}\n          >\n            {Object.keys(BUILTIN_IMGS).map((key) => (\n              <option key={key} value={key}>\n                {BUILTIN_IMGS[key]}\n              </option>\n            ))}\n            <option value=\"##other\">输入图片网址……</option>\n            <option value=\"##color\">纯色背景……</option>\n          </select>\n          &nbsp;\n          <small>#background_img</small>&nbsp;\n          {img_select === '##other' && (\n            <input\n              type=\"url\"\n              placeholder=\"图片网址\"\n              value={this.state.img}\n              onChange={this.on_change_img.bind(this)}\n            />\n          )}\n          {img_select === '##color' && (\n            <input\n              type=\"color\"\n              value={this.state.color}\n              onChange={this.on_change_color.bind(this)}\n            />\n          )}\n        </p>\n        <div\n          className=\"bg-preview\"\n          style={bgimg_style(this.state.img, this.state.color)}\n        />\n      </div>\n    );\n  }\n}\n\nclass ConfigColorScheme extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      color_scheme: window.config.color_scheme,\n    };\n  }\n\n  save_changes() {\n    this.props.callback({\n      color_scheme: this.state.color_scheme,\n    });\n  }\n\n  on_select(e) {\n    const value = e.target.value;\n    this.setState(\n      {\n        color_scheme: value,\n      },\n      this.save_changes.bind(this),\n    );\n  }\n\n  render() {\n    return (\n      <div>\n        <p>\n          <b>夜间模式：</b>\n          <select\n            className=\"config-select\"\n            value={this.state.color_scheme}\n            onChange={this.on_select.bind(this)}\n          >\n            <option value=\"default\">跟随系统</option>\n            <option value=\"light\">始终浅色模式</option>\n            <option value=\"dark\">始终深色模式</option>\n          </select>\n          &nbsp;<small>#color_scheme</small>\n        </p>\n        <p className=\"config-description\">\n          选择浅色或深色模式，深色模式下将会调暗图片亮度\n        </p>\n      </div>\n    );\n  }\n}\n\nclass ConfigTextArea extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      [props.id]: this.props.display(window.config[props.id]),\n    };\n  }\n\n  /* save_changes() {\n    this.props.callback({\n      [this.props.id]: this.props.sift(this.state[this.props.id]),\n    });\n  } */\n\n  copy_value() {\n    if (copy(this.state[this.props.id]))\n      alert(`成功将${this.props.name}的内容复制到剪贴板！\\n请一定不要泄露哦`);\n  }\n\n  on_blur(e) {\n    const value = e.target.value;\n    const parsed = this.props.parse(value);\n    this.setState(\n      {\n        [this.props.id]: value,\n      },\n      () => {\n        this.props.callback({\n          [this.props.id]: parsed,\n        });\n      },\n    );\n  }\n\n  on_change(e) {\n    const value = e.target.value;\n    this.setState((state) => {\n      return { [this.props.id]: value };\n    });\n  }\n\n  render() {\n    return (\n      <div>\n        <label>\n          <p>\n            <b>{this.props.name}</b>&nbsp;<small>#{this.props.id}</small>\n            <a style={{ float: 'right' }} onClick={this.copy_value.bind(this)}>\n              <small>复制</small>\n            </a>\n          </p>\n          <p className=\"config-description\">{this.props.description}</p>\n          <textarea\n            name={'config-' + this.props.id}\n            id={`config-textarea-${this.props.id}`}\n            className=\"config-textarea\"\n            value={this.state[this.props.id]}\n            onChange={this.on_change.bind(this)}\n            onBlur={this.on_blur.bind(this)}\n          />\n        </label>\n      </div>\n    );\n  }\n}\n\nclass ConfigSwitch extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      switch: window.config[this.props.id],\n    };\n  }\n\n  on_change(e) {\n    const val = e.target.checked;\n    this.setState(\n      {\n        switch: val,\n      },\n      () => {\n        this.props.callback({\n          [this.props.id]: val,\n        });\n      },\n    );\n  }\n\n  render() {\n    return (\n      <div>\n        <p>\n          <label>\n            <input\n              name={'config-' + this.props.id}\n              type=\"checkbox\"\n              checked={this.state.switch}\n              onChange={this.on_change.bind(this)}\n            />\n            &nbsp;<b>{this.props.name}</b>\n            &nbsp;<small>#{this.props.id}</small>\n          </label>\n        </p>\n        <p className=\"config-description\">{this.props.description}</p>\n      </div>\n    );\n  }\n}\n\nexport class ConfigUI extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.save_changes_bound = this.save_changes.bind(this);\n  }\n\n  save_changes(chg) {\n    console.log(chg);\n    Object.keys(chg).forEach((key) => {\n      window.config[key] = chg[key];\n    });\n    save_config();\n  }\n\n  reset_settings() {\n    if (window.confirm('重置所有设置？')) {\n      window.config = {};\n      save_config();\n      window.location.reload();\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <div className=\"box config-ui-header\">\n          <p>\n            这些功能仍在测试，可能不稳定（\n            <a onClick={this.reset_settings.bind(this)}>全部重置</a>）\n          </p>\n          <p>\n            <b>\n              修改设置后{' '}\n              <a\n                onClick={() => {\n                  window.location.reload();\n                }}\n              >\n                刷新页面\n              </a>{' '}\n              方可生效\n            </b>\n          </p>\n        </div>\n        <div className=\"box\">\n          <ConfigBackground\n            id=\"background\"\n            callback={this.save_changes_bound}\n          />\n          <hr />\n          <ConfigColorScheme\n            id=\"color-scheme\"\n            callback={this.save_changes_bound}\n          />\n          <hr />\n          <ConfigSwitch\n            callback={this.save_changes_bound}\n            id=\"pressure\"\n            name=\"快速返回\"\n            description=\"短暂按住 Esc 键或重压屏幕（3D Touch）可以快速返回或者刷新树洞\"\n          />\n          <hr />\n          <ConfigSwitch\n            callback={this.save_changes_bound}\n            id=\"easter_egg\"\n            name=\"允许彩蛋\"\n            description=\"在某些情况下显示彩蛋\"\n          />\n        </div>\n        <div className=\"box\">\n          <ConfigTextArea\n            id=\"block_words\"\n            callback={this.save_changes_bound}\n            name=\"设置屏蔽词\"\n            description={'包含屏蔽词的树洞会被折叠，每行写一个屏蔽词'}\n            display={(array) => array.join('\\n')}\n            parse={(string) => string.split('\\n').filter((v) => v)}\n          />\n          <hr />\n          <ConfigTextArea\n            id=\"alias\"\n            callback={this.save_changes_bound}\n            name=\"设置别名\"\n            description={`可用 #别名 代替 #PID（树洞号）进行查询，每行由树洞号、半角空格、别名顺序连接，如“472865 网页版发布”，别名中不可包含空格`}\n            display={(map) =>\n              Object.entries(map)\n                .map((pair) => pair[1] + ' ' + pair[0])\n                .reduce(\n                  (accumulator, currentValue) =>\n                    !!accumulator\n                      ? currentValue + '\\n' + accumulator\n                      : currentValue,\n                  '',\n                )\n            }\n            parse={(string) => {\n              const map = {};\n              string\n                .split('\\n')\n                .filter((value) => value)\n                .forEach((line) => {\n                  const pair = line.split(' ');\n                  if (pair.length === 2 && !isNaN(Number(pair[0]))) {\n                    map[pair[1]] = Number(pair[0]);\n                  }\n                });\n              return map;\n            }}\n          />\n          <hr />\n          <ConfigSwitch\n            callback={this.save_changes_bound}\n            id=\"attention_sort\"\n            name=\"关注列表排序\"\n            description=\"启用后，可以将关注列表按最后回复时间排序。不建议在性能较差的设备上启用\"\n          />\n        </div>\n        <div className=\"box\">\n          <p>\n            新功能建议或问题反馈请在&nbsp;\n            <a\n              href=\"https://github.com/AllanChain/PKUHoleCommunity/issues\"\n              target=\"_blank\"\n            >\n              GitHub <span className=\"icon icon-github\" />\n            </a>\n            &nbsp;提出。\n          </p>\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport { API_BASE, SafeTextarea, PromotionBar } from './Common';\nimport { MessageViewer } from './Message';\nimport { LoginPopup } from './infrastructure/widgets';\nimport { ConfigUI } from './Config';\nimport fixOrientation from 'fix-orientation';\nimport copy from 'copy-to-clipboard';\nimport { cache } from './cache';\nimport {\n  API_VERSION_PARAM,\n  PKUHELPER_ROOT,\n  get_json,\n  token_param,\n} from './flows_api';\n\nimport './UserAction.css';\n\nconst BASE64_RATE = 4 / 3;\nconst MAX_IMG_DIAM = 8000;\nconst MAX_IMG_PX = 5000000;\nconst MAX_IMG_FILESIZE = 450000 * BASE64_RATE;\n\nexport const TokenCtx = React.createContext({\n  value: null,\n  set_value: () => {},\n});\n\nclass LifeInfoBox extends Component {\n  constructor(props) {\n    super(props);\n    if (!window._life_info_cache) window._life_info_cache = {};\n    this.CACHE_TIMEOUT_S = 15;\n    this.state = {\n      today_info: this.cache_get('today_info'),\n      card_balance: this.cache_get('card_balance'),\n      net_balance: this.cache_get('net_balance'),\n      mail_count: this.cache_get('mail_count'),\n    };\n    this.INTERNAL_NETWORK_FAILURE = '_network_failure';\n    this.API_NAME = {\n      today_info: 'hole/today_info',\n      card_balance: 'isop/card_balance',\n      net_balance: 'isop/net_balance',\n      mail_count: 'isop/mail_count',\n    };\n  }\n\n  cache_get(key) {\n    const cache_item = window._life_info_cache[key];\n    if (\n      !cache_item ||\n      +new Date() - cache_item[0] > 1000 * this.CACHE_TIMEOUT_S\n    )\n      return null;\n    else return cache_item[1];\n  }\n  cache_set(key, value) {\n    if (\n      !window._life_info_cache[key] ||\n      window._life_info_cache[key][1] !== value\n    )\n      window._life_info_cache[key] = [+new Date(), value];\n  }\n\n  load(state_key) {\n    this.setState(\n      {\n        [state_key]: null,\n      },\n      () => {\n        fetch(\n          PKUHELPER_ROOT +\n            'api_xmcp/' +\n            this.API_NAME[state_key] +\n            '?user_token=' +\n            encodeURIComponent(this.props.token) +\n            API_VERSION_PARAM(),\n        )\n          .then(get_json)\n          .then((json) => {\n            //console.log(json);\n            this.setState({\n              [state_key]: json,\n            });\n          })\n          .catch((e) => {\n            this.setState({\n              [state_key]: {\n                errMsg: '网络错误 ' + e,\n                errCode: this.INTERNAL_NETWORK_FAILURE,\n                success: false,\n              },\n            });\n          });\n      },\n    );\n  }\n\n  componentDidMount() {\n    ['today_info', 'card_balance', 'net_balance', 'mail_count'].forEach((k) => {\n      if (!this.state[k]) this.load(k);\n    });\n  }\n\n  reload_all() {\n    ['today_info', 'card_balance', 'net_balance', 'mail_count'].forEach((k) => {\n      this.load(k);\n    });\n  }\n\n  render_line(state_key, title, value_fn, action, url_fn, do_login) {\n    const s = this.state[state_key];\n    if (!s)\n      return (\n        <tr>\n          <td>{title}</td>\n          <td>加载中……</td>\n          <td />\n        </tr>\n      );\n    else if (!s.success) {\n      let type = '加载失败';\n      if (s.errCode === this.INTERNAL_NETWORK_FAILURE) type = '网络错误';\n      else if (['E01', 'E02', 'E03'].indexOf(s.errCode) !== -1)\n        type = '授权失效';\n\n      let details = JSON.stringify(s);\n      if (s.errMsg) details = s.errMsg;\n      else if (s.error) details = s.error;\n\n      return (\n        <tr>\n          <td>{title}</td>\n          <td className=\"life-info-error\">\n            <a onClick={() => alert(details)}>{type}</a>\n          </td>\n          <td>\n            {type === '授权失效' ? (\n              <a onClick={do_login}>\n                <span className=\"icon icon-forward\" />\n                &nbsp;重新登录\n              </a>\n            ) : (\n              <a onClick={() => this.load(state_key)}>\n                <span className=\"icon icon-forward\" />\n                &nbsp;重试\n              </a>\n            )}\n          </td>\n        </tr>\n      );\n    } else {\n      this.cache_set(state_key, s);\n\n      return (\n        <tr>\n          <td>{title}</td>\n          <td>{value_fn(s)}</td>\n          <td>\n            <a href={url_fn(s)} target=\"_blank\">\n              <span className=\"icon icon-forward\" />\n              &nbsp;{action}\n            </a>\n          </td>\n        </tr>\n      );\n    }\n  }\n\n  render() {\n    return (\n      <LoginPopup\n        token_callback={(t) => {\n          this.props.set_token(t);\n          this.reload_all();\n        }}\n      >\n        {(do_login) => (\n          <div className=\"box\">\n            <table className=\"life-info-table\">\n              <tbody>\n                {this.render_line(\n                  'today_info',\n                  '今日',\n                  (s) => s.info,\n                  '校历',\n                  (s) => s.schedule_url,\n                  do_login,\n                )}\n                {this.render_line(\n                  'card_balance',\n                  '校园卡',\n                  (s) => `余额￥${s.balance.toFixed(2)}`,\n                  '充值',\n                  () =>\n                    'https://virtualprod.alipay.com/educate/educatePcRecharge.htm?schoolCode=PKU&schoolName=',\n                  do_login,\n                )}\n                {this.render_line(\n                  'net_balance',\n                  '网费',\n                  (s) => `余额￥${s.balance.toFixed(2)}`,\n                  '充值',\n                  () => 'https://its.pku.edu.cn/epay.jsp',\n                  do_login,\n                )}\n                {this.render_line(\n                  'mail_count',\n                  '邮件',\n                  (s) => `未读 ${s.count} 封`,\n                  '查看',\n                  () => 'https://mail.pku.edu.cn/',\n                  do_login,\n                )}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </LoginPopup>\n    );\n  }\n}\n\nexport function InfoSidebar(props) {\n  return (\n    <div>\n      <PromotionBar />\n      <LoginForm show_sidebar={props.show_sidebar} />\n      <div className=\"box list-menu\">\n        <a\n          onClick={() => {\n            props.show_sidebar('设置', <ConfigUI />);\n          }}\n        >\n          <span className=\"icon icon-settings\" />\n          <label>网页版树洞设置</label>\n        </a>\n        &nbsp;&nbsp;\n        <a\n          href=\"http://pkuhelper.pku.edu.cn/treehole_rules.html\"\n          target=\"_blank\"\n        >\n          <span className=\"icon icon-textfile\" />\n          <label>树洞规范</label>\n        </a>\n        &nbsp;&nbsp;\n        <a\n          href=\"https://github.com/AllanChain/PKUHoleCommunity/issues\"\n          target=\"_blank\"\n        >\n          <span className=\"icon icon-github\" />\n          <label>意见反馈</label>\n        </a>\n      </div>\n      <div className=\"box help-desc-box\">\n        <p>\n          PKUHelper 网页版树洞社区版 by @xmcp, and awesome community. 基于&nbsp;\n          <a\n            href=\"https://www.gnu.org/licenses/gpl-3.0.zh-cn.html\"\n            target=\"_blank\"\n          >\n            GPLv3\n          </a>\n          &nbsp;协议在{' '}\n          <a\n            href=\"https://github.com/AllanChain/PKUHoleCommunity\"\n            target=\"_blank\"\n          >\n            GitHub\n          </a>{' '}\n          开源\n        </p>\n        <p>\n          PKUHelper 网页版的诞生离不开&nbsp;\n          <a href=\"https://reactjs.org/\" target=\"_blank\" rel=\"noopener\">\n            React\n          </a>\n          、\n          <a href=\"https://icomoon.io/#icons\" target=\"_blank\" rel=\"noopener\">\n            IcoMoon\n          </a>\n          &nbsp;等开源项目\n        </p>\n        <p>PKU Helper 的“同意”</p>\n        <blockquote>\n          <p>\n            根据 GPL，你有权 fork【网页版树洞前端】的代码并进行相应的修改。\n            请注意，你的修改版本必须依然基于 GPL 授权，并依据此公开源码。\n          </p>\n          <p>\n            根据树洞规范 5.3 规定，非官方客户端在 PKU Helper\n            团队认定造成不利影响，\n            例如非法攻击服务器、盗取用户个人信息时，我们有权对其进行封禁。\n          </p>\n        </blockquote>\n        <p>\n          用户需对不恰当使用此版本或利用此版本的漏洞对 PKU Helper\n          造成的不利影响承担风险。 作为社区版本，社区（no\n          warranty）维护版本的安全，同时也欢迎同学实现你的想法。\n        </p>\n        <p>\n          <a\n            onClick={() => {\n              if ('serviceWorker' in navigator) {\n                navigator.serviceWorker\n                  .getRegistrations()\n                  .then((registrations) => {\n                    for (const registration of registrations) {\n                      console.log('unregister', registration);\n                      registration.unregister();\n                    }\n                  });\n              }\n              cache().clear();\n              setTimeout(() => {\n                window.location.reload(true);\n              }, 200);\n            }}\n          >\n            强制检查更新\n          </a>\n          （Community v{process.env.REACT_APP_VERSION || '---'}{' '}\n          {process.env.NODE_ENV} 会自动在后台检查更新并在下次访问时更新）\n        </p>\n      </div>\n    </div>\n  );\n}\n\nclass ResetUsertokenWidget extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading_status: 'done',\n    };\n  }\n\n  do_reset() {\n    if (\n      window.confirm(\n        '您正在重置 UserToken！\\n您的账号将会在【所有设备】上注销，您需要手动重新登录！',\n      )\n    ) {\n      const uid = window.prompt(\n        '您正在重置 UserToken！\\n请输入您的学号以确认身份：',\n      );\n      if (uid)\n        this.setState(\n          {\n            loading_status: 'loading',\n          },\n          () => {\n            fetch(PKUHELPER_ROOT + 'api_xmcp/hole/reset_usertoken', {\n              method: 'post',\n              headers: {\n                'Content-Type': 'application/json',\n              },\n              body: JSON.stringify({\n                user_token: this.props.token,\n                uid: uid,\n              }),\n            })\n              .then(get_json)\n              .then((json) => {\n                if (json.error) throw new Error(json.error);\n                else alert('重置成功！您需要在所有设备上重新登录。');\n\n                this.setState({\n                  loading_status: 'done',\n                });\n              })\n              .catch((e) => {\n                alert('重置失败：' + e);\n                this.setState({\n                  loading_status: 'done',\n                });\n              });\n          },\n        );\n    }\n  }\n\n  render() {\n    if (this.state.loading_status === 'done')\n      return <a onClick={this.do_reset.bind(this)}>重置</a>;\n    else if (this.state.loading_status === 'loading')\n      return (\n        <a>\n          <span className=\"icon icon-loading\" />\n        </a>\n      );\n  }\n}\n\nexport class LoginForm extends Component {\n  copy_token(token) {\n    if (copy(token)) alert('复制成功！\\n请一定不要泄露哦');\n  }\n\n  render() {\n    return (\n      <TokenCtx.Consumer>\n        {(token) => (\n          <div>\n            {!!token.value && (\n              <LifeInfoBox token={token.value} set_token={token.set_value} />\n            )}\n            <div className=\"login-form box\">\n              {token.value ? (\n                <div>\n                  <p>\n                    <b>您已登录。</b>\n                    <button\n                      type=\"button\"\n                      onClick={() => {\n                        token.set_value(null);\n                      }}\n                    >\n                      <span className=\"icon icon-logout\" /> 注销\n                    </button>\n                    <br />\n                  </p>\n                  <p>\n                    根据计算中心要求，访问授权三个月内有效，过期需重新登录。\n                  </p>\n                  <p>\n                    <a\n                      onClick={() => {\n                        this.props.show_sidebar(\n                          '系统消息',\n                          <MessageViewer token={token.value} />,\n                        );\n                      }}\n                    >\n                      查看系统消息\n                    </a>\n                    <br />\n                    当您发送的内容违规时，我们将用系统消息提示您\n                  </p>\n                  <p>\n                    <a onClick={this.copy_token.bind(this, token.value)}>\n                      复制 User Token\n                    </a>\n                    <br />\n                    User Token\n                    用于迁移登录状态，切勿告知他人，若怀疑被盗号请尽快{' '}\n                    <ResetUsertokenWidget token={token.value} />\n                  </p>\n                </div>\n              ) : (\n                <LoginPopup token_callback={token.set_value}>\n                  {(do_popup) => (\n                    <div>\n                      <p>\n                        <button type=\"button\" onClick={do_popup}>\n                          <span className=\"icon icon-login\" />\n                          &nbsp;登录\n                        </button>\n                      </p>\n                      <p>\n                        <small>\n                          PKU Helper 面向北京大学学生，通过\n                          ISOP（北京大学数据共享开放服务平台）验证您的身份并提供服务。\n                        </small>\n                      </p>\n                    </div>\n                  )}\n                </LoginPopup>\n              )}\n            </div>\n          </div>\n        )}\n      </TokenCtx.Consumer>\n    );\n  }\n}\n\nexport class ReplyForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      text: '',\n      loading_status: 'done',\n    };\n    this.on_change_bound = this.on_change.bind(this);\n    this.area_ref = this.props.area_ref || React.createRef();\n    this.global_keypress_handler_bound =\n      this.global_keypress_handler.bind(this);\n  }\n\n  global_keypress_handler(e) {\n    if (\n      e.code === 'Enter' &&\n      !e.ctrlKey &&\n      !e.altKey &&\n      ['input', 'textarea'].indexOf(e.target.tagName.toLowerCase()) === -1\n    ) {\n      if (this.area_ref.current) {\n        e.preventDefault();\n        this.area_ref.current.focus();\n      }\n    }\n  }\n  componentDidMount() {\n    document.addEventListener('keypress', this.global_keypress_handler_bound);\n  }\n  componentWillUnmount() {\n    document.removeEventListener(\n      'keypress',\n      this.global_keypress_handler_bound,\n    );\n  }\n\n  on_change(value) {\n    this.setState({\n      text: value,\n    });\n  }\n\n  on_submit(event) {\n    if (event) event.preventDefault();\n    if (this.state.loading_status === 'loading') return;\n    this.setState({\n      loading_status: 'loading',\n    });\n\n    const data = new URLSearchParams();\n    data.append('pid', this.props.pid);\n    data.append('text', this.state.text);\n    data.append('user_token', this.props.token);\n    fetch(\n      API_BASE + '/api.php?action=docomment' + token_param(this.props.token),\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded',\n        },\n        body: data,\n      },\n    )\n      .then(get_json)\n      .then((json) => {\n        if (json.code !== 0) {\n          if (json.msg) alert(json.msg);\n          throw new Error(JSON.stringify(json));\n        }\n\n        this.setState({\n          loading_status: 'done',\n          text: '',\n        });\n        this.area_ref.current.clear();\n        this.props.on_complete();\n      })\n      .catch((e) => {\n        console.error(e);\n        alert('回复失败');\n        this.setState({\n          loading_status: 'done',\n        });\n      });\n  }\n\n  render() {\n    return (\n      <form\n        onSubmit={this.on_submit.bind(this)}\n        className={'reply-form box' + (this.state.text ? ' reply-sticky' : '')}\n      >\n        <SafeTextarea\n          key={this.props.pid}\n          ref={this.area_ref}\n          id={this.props.pid}\n          on_change={this.on_change_bound}\n          on_submit={this.on_submit.bind(this)}\n        />\n        {this.state.loading_status === 'loading' ? (\n          <button disabled=\"disabled\">\n            <span className=\"icon icon-loading\" />\n          </button>\n        ) : (\n          <button type=\"submit\">\n            <span className=\"icon icon-send\" />\n          </button>\n        )}\n      </form>\n    );\n  }\n}\n\nexport class PostForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      text: '',\n      loading_status: 'done',\n      img_tip: null,\n    };\n    this.img_ref = React.createRef();\n    this.area_ref = React.createRef();\n    this.on_change_bound = this.on_change.bind(this);\n    this.on_img_change_bound = this.on_img_change.bind(this);\n  }\n\n  componentDidMount() {\n    if (this.area_ref.current) this.area_ref.current.focus();\n  }\n\n  on_change(value) {\n    this.setState({\n      text: value,\n    });\n  }\n\n  do_post(text, img) {\n    const data = new URLSearchParams();\n    data.append('text', this.state.text);\n    data.append('type', img ? 'image' : 'text');\n    data.append('user_token', this.props.token);\n    if (img) data.append('data', img);\n\n    fetch(API_BASE + '/api.php?action=dopost' + token_param(this.props.token), {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      body: data,\n    })\n      .then(get_json)\n      .then((json) => {\n        if (json.code !== 0) {\n          if (json.msg) alert(json.msg);\n          throw new Error(JSON.stringify(json));\n        }\n\n        this.setState({\n          loading_status: 'done',\n          text: '',\n        });\n        this.area_ref.current.clear();\n        this.props.on_complete();\n      })\n      .catch((e) => {\n        console.error(e);\n        alert('发表失败');\n        this.setState({\n          loading_status: 'done',\n        });\n      });\n  }\n\n  proc_img(file) {\n    return new Promise((resolve, reject) => {\n      function return_url(url) {\n        const idx = url.indexOf(';base64,');\n        if (idx === -1) throw new Error('img not base64 encoded');\n\n        return url.substr(idx + 8);\n      }\n\n      const reader = new FileReader();\n      function on_got_img(url) {\n        const image = new Image();\n        image.onload = () => {\n          let width = image.width;\n          let height = image.height;\n          let compressed = false;\n\n          if (width > MAX_IMG_DIAM) {\n            height = (height * MAX_IMG_DIAM) / width;\n            width = MAX_IMG_DIAM;\n            compressed = true;\n          }\n          if (height > MAX_IMG_DIAM) {\n            width = (width * MAX_IMG_DIAM) / height;\n            height = MAX_IMG_DIAM;\n            compressed = true;\n          }\n          if (height * width > MAX_IMG_PX) {\n            const rate = Math.sqrt((height * width) / MAX_IMG_PX);\n            height /= rate;\n            width /= rate;\n            compressed = true;\n          }\n          console.log('chosen img size', width, height);\n\n          const canvas = document.createElement('canvas');\n          const ctx = canvas.getContext('2d');\n          canvas.width = width;\n          canvas.height = height;\n          ctx.drawImage(image, 0, 0, width, height);\n\n          let quality_l = 0.1,\n            quality_r = 0.9,\n            quality,\n            new_url;\n          while (quality_r - quality_l >= 0.03) {\n            quality = (quality_r + quality_l) / 2;\n            new_url = canvas.toDataURL('image/jpeg', quality);\n            console.log(\n              quality_l,\n              quality_r,\n              'trying quality',\n              quality,\n              'size',\n              new_url.length,\n            );\n            if (new_url.length <= MAX_IMG_FILESIZE) quality_l = quality;\n            else quality_r = quality;\n          }\n          if (quality_l >= 0.101) {\n            console.log('chosen img quality', quality);\n            resolve({\n              img: return_url(new_url),\n              quality: quality,\n              width: Math.round(width),\n              height: Math.round(height),\n              compressed: compressed,\n            });\n          } else {\n            reject('图片过大，无法上传');\n          }\n        };\n        image.src = url;\n      }\n      reader.onload = (event) => {\n        fixOrientation(event.target.result, {}, (fixed_dataurl) => {\n          on_got_img(fixed_dataurl);\n        });\n      };\n      reader.readAsDataURL(file);\n    });\n  }\n\n  on_img_change() {\n    if (this.img_ref.current && this.img_ref.current.files.length)\n      this.setState(\n        {\n          img_tip: '（正在处理图片……）',\n        },\n        () => {\n          this.proc_img(this.img_ref.current.files[0])\n            .then((d) => {\n              this.setState({\n                img_tip:\n                  `（${d.compressed ? '压缩到' : '尺寸'} ${d.width}*${\n                    d.height\n                  } / ` +\n                  `质量 ${Math.floor(d.quality * 100)}% / ${Math.floor(\n                    d.img.length / BASE64_RATE / 1000,\n                  )}KB）`,\n              });\n            })\n            .catch((e) => {\n              this.setState({\n                img_tip: `图片无效：${e}`,\n              });\n            });\n        },\n      );\n    else\n      this.setState({\n        img_tip: null,\n      });\n  }\n\n  on_submit(event) {\n    if (event) event.preventDefault();\n    if (this.state.loading_status === 'loading') return;\n    if (this.img_ref.current.files.length) {\n      this.setState({\n        loading_status: 'processing',\n      });\n      this.proc_img(this.img_ref.current.files[0])\n        .then((d) => {\n          this.setState({\n            loading_status: 'loading',\n          });\n          this.do_post(this.state.text, d.img);\n        })\n        .catch((e) => {\n          alert(e);\n        });\n    } else {\n      this.setState({\n        loading_status: 'loading',\n      });\n      this.do_post(this.state.text, null);\n    }\n  }\n\n  render() {\n    return (\n      <form onSubmit={this.on_submit.bind(this)} className=\"post-form box\">\n        <div className=\"post-form-bar\">\n          <label>\n            图片\n            <input\n              ref={this.img_ref}\n              type=\"file\"\n              accept=\"image/*\"\n              disabled={this.state.loading_status !== 'done'}\n              onChange={this.on_img_change_bound}\n            />\n          </label>\n          {this.state.loading_status !== 'done' ? (\n            <button disabled=\"disabled\">\n              <span className=\"icon icon-loading\" />\n              &nbsp;正在\n              {this.state.loading_status === 'processing' ? '处理' : '上传'}\n            </button>\n          ) : (\n            <button type=\"submit\">\n              <span className=\"icon icon-send\" />\n              &nbsp;发表\n            </button>\n          )}\n        </div>\n        {!!this.state.img_tip && (\n          <p className=\"post-form-img-tip\">\n            <a\n              onClick={() => {\n                this.img_ref.current.value = '';\n                this.on_img_change();\n              }}\n            >\n              删除图片\n            </a>\n            {this.state.img_tip}\n          </p>\n        )}\n        <SafeTextarea\n          ref={this.area_ref}\n          id=\"new_post\"\n          on_change={this.on_change_bound}\n          on_submit={this.on_submit.bind(this)}\n        />\n        <p>\n          <small>\n            请遵守\n            <a\n              href=\"http://pkuhelper.pku.edu.cn/treehole_rules.html\"\n              target=\"_blank\"\n            >\n              树洞管理规范\n            </a>\n            ，文明发言\n          </small>\n        </p>\n      </form>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\nimport copy from 'copy-to-clipboard';\nimport pLimit from 'p-limit';\nimport { ColorPicker } from './color_picker';\nimport {\n  split_text,\n  NICKNAME_RE,\n  PID_RE,\n  URL_RE,\n  URL_PID_RE,\n} from './text_splitter';\nimport {\n  format_time,\n  build_highlight_re,\n  Time,\n  TitleLine,\n  HighlightedText,\n  ClickHandler,\n  ColoredSpan,\n} from './Common';\nimport './Flows.css';\nimport LazyLoad, { forceCheck } from 'react-lazyload';\nimport { AudioWidget } from './AudioWidget';\nimport { TokenCtx, ReplyForm } from './UserAction';\n\nimport { API, PKUHELPER_ROOT } from './flows_api';\n\nimport { load_config, save_config } from './Config';\n\nconst IMAGE_BASE = PKUHELPER_ROOT + 'services/pkuhole/images/';\nconst AUDIO_BASE = PKUHELPER_ROOT + 'services/pkuhole/audios/';\n\nconst CLICKABLE_TAGS = { a: true, audio: true };\nconst PREVIEW_REPLY_COUNT = 10;\nconst QUOTE_BLACKLIST = [\n  '23333',\n  '233333',\n  '66666',\n  '666666',\n  '10086',\n  '10000',\n  '100000',\n  '99999',\n  '999999',\n  '55555',\n  '555555',\n];\n\nwindow.LATEST_POST_ID = parseInt(localStorage['_LATEST_POST_ID'], 10) || 0;\n\nconst DZ_NAME = '洞主';\n\nfunction load_single_meta(show_sidebar, token) {\n  return async (pid, replace = false) => {\n    const color_picker = new ColorPicker();\n    const title_elem = '树洞 #' + pid;\n    show_sidebar(\n      title_elem,\n      <div className=\"box box-tip\">正在加载 #{pid}</div>,\n      replace ? 'replace' : 'push',\n    );\n    try {\n      const single = await API.get_single(pid, token);\n      single.data.variant = {};\n      const { data: replies } = await API.load_replies_with_cache(\n        pid,\n        token,\n        color_picker,\n        parseInt(single.data.reply),\n      );\n      show_sidebar(\n        title_elem,\n        <FlowSidebar\n          key={+new Date()}\n          info={single.data}\n          replies={replies.data}\n          attention={replies.attention}\n          token={token}\n          show_sidebar={show_sidebar}\n          color_picker={color_picker}\n          deletion_detect={localStorage['DELETION_DETECT'] === 'on'}\n        />,\n        'replace',\n      );\n    } catch (e) {\n      console.error(e);\n      show_sidebar(\n        title_elem,\n        <div className=\"box box-tip\">\n          <p>\n            <a onClick={() => load_single_meta(show_sidebar, token)(pid, true)}>\n              重新加载\n            </a>\n          </p>\n          <p>{'' + e}</p>\n        </div>,\n        'replace',\n      );\n    }\n  };\n}\n\nclass Reply extends PureComponent {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const parts = split_text(this.props.info.text, [\n      ['url_pid', URL_PID_RE],\n      ['url', URL_RE],\n      ['pid', PID_RE],\n      ['nickname', NICKNAME_RE],\n    ]);\n\n    return (\n      <div\n        className={'flow-reply box'}\n        style={\n          this.props.info._display_color\n            ? {\n                '--box-bgcolor-light': this.props.info._display_color[0],\n                '--box-bgcolor-dark': this.props.info._display_color[1],\n              }\n            : null\n        }\n      >\n        <div className=\"box-header\">\n          <code className=\"box-id\">#{this.props.info.cid}</code>\n          {!!this.props.do_filter_name && (\n            <span\n              className=\"reply-header-badge clickable\"\n              onClick={() => {\n                this.props.do_filter_name(this.props.info.name);\n              }}\n            >\n              <span className=\"icon icon-locate\" />\n            </span>\n          )}\n          &nbsp;\n          {this.props.info.tag !== null && (\n            <span className=\"box-header-tag\">{this.props.info.tag}</span>\n          )}\n          <Time stamp={this.props.info.timestamp} />\n        </div>\n        <div className=\"box-content\">\n          <HighlightedText\n            parts={parts}\n            color_picker={this.props.color_picker}\n            show_pid={this.props.show_pid}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nclass FlowItem extends PureComponent {\n  constructor(props) {\n    super(props);\n  }\n\n  copy_link(event) {\n    event.preventDefault();\n    copy(\n      `${event.target.href}${\n        this.props.info.tag ? ' 【' + this.props.info.tag + '】' : ''\n      }\\n` +\n        `${this.props.info.text}${\n          this.props.info.type === 'image'\n            ? ' [图片]'\n            : this.props.info.type === 'audio'\n            ? ' [语音]'\n            : ''\n        }\\n` +\n        `（${format_time(new Date(this.props.info.timestamp * 1000))} ${\n          this.props.info.likenum\n        }关注 ${this.props.info.reply}回复）\\n` +\n        this.props.replies\n          .map((r) => (r.tag ? '【' + r.tag + '】' : '') + r.text)\n          .join('\\n'),\n    );\n  }\n\n  render() {\n    const props = this.props;\n    const parts =\n      props.parts ||\n      split_text(props.info.text, [\n        ['url_pid', URL_PID_RE],\n        ['url', URL_RE],\n        ['pid', PID_RE],\n        ['nickname', NICKNAME_RE],\n      ]);\n    return (\n      <div className={'flow-item' + (props.is_quote ? ' flow-item-quote' : '')}>\n        {!!props.is_quote && (\n          <div className=\"quote-tip black-outline\">\n            <div>\n              <span className=\"icon icon-quote\" />\n            </div>\n            <div>\n              <small>提到</small>\n            </div>\n          </div>\n        )}\n        <div className=\"box\">\n          {!!window.LATEST_POST_ID &&\n            parseInt(props.info.pid, 10) > window.LATEST_POST_ID && (\n              <div className=\"flow-item-dot\" />\n            )}\n          {!!this.props.attention && !this.props.cached && (\n            <div className=\"flow-item-dot\" />\n          )}\n          <div className=\"box-header\">\n            {!!this.props.do_filter_name && (\n              <span\n                className=\"reply-header-badge clickable\"\n                onClick={() => {\n                  this.props.do_filter_name(DZ_NAME);\n                }}\n              >\n                <span className=\"icon icon-locate\" />\n              </span>\n            )}\n            {!!parseInt(props.info.likenum, 10) && (\n              <span className=\"box-header-badge\">\n                {props.info.likenum}&nbsp;\n                <span\n                  className={\n                    'icon icon-' + (props.attention ? 'star-ok' : 'star')\n                  }\n                />\n              </span>\n            )}\n            {!!parseInt(props.info.reply, 10) && (\n              <span className=\"box-header-badge\">\n                {props.info.reply}&nbsp;\n                <span className=\"icon icon-reply\" />\n              </span>\n            )}\n            <code className=\"box-id\">\n              <a\n                href={'##' + props.info.pid}\n                onClick={this.copy_link.bind(this)}\n              >\n                #{props.info.pid}\n              </a>\n            </code>\n            &nbsp;\n            {props.info.tag !== null && (\n              <span className=\"box-header-tag\">{props.info.tag}</span>\n            )}\n            <Time stamp={props.info.timestamp} />\n          </div>\n          <div className=\"box-content\">\n            <HighlightedText\n              parts={parts}\n              color_picker={props.color_picker}\n              show_pid={props.show_pid}\n            />\n            {props.info.type === 'image' && (\n              <p className=\"img\">\n                {props.img_clickable ? (\n                  <a\n                    className=\"no-underline\"\n                    href={IMAGE_BASE + props.info.url}\n                    target=\"_blank\"\n                  >\n                    <img src={IMAGE_BASE + props.info.url} />\n                  </a>\n                ) : (\n                  <img src={IMAGE_BASE + props.info.url} />\n                )}\n              </p>\n            )}\n            {props.info.type === 'audio' && (\n              <AudioWidget src={AUDIO_BASE + props.info.url} />\n            )}\n          </div>\n          {!!(props.attention && props.info.variant.latest_reply) && (\n            <p className=\"box-footer\">\n              最新回复 <Time stamp={props.info.variant.latest_reply} />\n            </p>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nclass FlowSidebar extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      attention: props.attention,\n      info: props.info,\n      replies: props.replies,\n      loading_status: 'done',\n      error_msg: null,\n      filter_name: null,\n      rev: false,\n    };\n    this.color_picker = props.color_picker;\n    this.syncState = props.sync_state || (() => {});\n    this.reply_ref = React.createRef();\n  }\n\n  set_variant(cid, variant) {\n    this.setState(\n      (prev) => {\n        if (cid)\n          return {\n            replies: prev.replies.map((reply) => {\n              if (reply.cid === cid)\n                return Object.assign({}, reply, {\n                  variant: Object.assign({}, reply.variant, variant),\n                });\n              else return reply;\n            }),\n          };\n        else\n          return {\n            info: Object.assign({}, prev.info, {\n              variant: Object.assign({}, prev.info.variant, variant),\n            }),\n          };\n      },\n      function () {\n        this.syncState({\n          info: this.state.info,\n          replies: this.state.replies,\n        });\n      },\n    );\n  }\n\n  load_replies(update_count = true) {\n    this.setState({\n      loading_status: 'loading',\n      error_msg: null,\n    });\n    API.load_replies(\n      this.state.info.pid,\n      this.props.token,\n      this.color_picker,\n      null,\n    )\n      .then((json) => {\n        this.setState(\n          (prev, props) => ({\n            replies: json.data,\n            info: update_count\n              ? Object.assign({}, prev.info, {\n                  reply: '' + json.data.length,\n                })\n              : prev.info,\n            attention: !!json.attention,\n            loading_status: 'done',\n            error_msg: null,\n          }),\n          () => {\n            this.syncState({\n              replies: this.state.replies,\n              attention: this.state.attention,\n              info: this.state.info,\n            });\n            if (this.state.replies.length)\n              this.set_variant(null, {\n                latest_reply: Math.max.apply(\n                  null,\n                  this.state.replies.map((r) => parseInt(r.timestamp)),\n                ),\n              });\n          },\n        );\n      })\n      .catch((e) => {\n        console.error(e);\n        this.setState({\n          replies: [],\n          loading_status: 'done',\n          error_msg: '' + e,\n        });\n      });\n  }\n\n  toggle_attention() {\n    this.setState({\n      loading_status: 'loading',\n    });\n    const next_attention = !this.state.attention;\n    API.set_attention(this.state.info.pid, next_attention, this.props.token)\n      .then((json) => {\n        this.setState({\n          loading_status: 'done',\n          attention: next_attention,\n        });\n        this.syncState({\n          attention: next_attention,\n        });\n      })\n      .catch((e) => {\n        this.setState({\n          loading_status: 'done',\n        });\n        alert('设置关注失败');\n        console.error(e);\n      });\n  }\n\n  report() {\n    const reason = prompt(`举报 #${this.state.info.pid} 的理由：`);\n    if (reason !== null) {\n      API.report(this.state.info.pid, reason, this.props.token)\n        .then((json) => {\n          alert('举报成功');\n        })\n        .catch((e) => {\n          alert('举报失败');\n          console.error(e);\n        });\n    }\n  }\n\n  set_alias() {\n    load_config();\n    const alias = prompt(`给 #${this.state.info.pid} 添加别名：`);\n    if (alias === null) return;\n    if (alias.includes(' ')) return alert('别名不合法，设置别名失败');\n\n    let override = true;\n    if (\n      alias in window.config.alias &&\n      this.state.info.pid !== window.config.alias[alias]\n    ) {\n      override = confirm(\n        `是否将“#${alias}”从 #${window.config.alias[alias]} ` +\n          `改为 #${this.state.info.pid}？`,\n      );\n    }\n    if (override) {\n      window.config.alias[alias] = this.state.info.pid;\n      save_config();\n    }\n  }\n\n  set_filter_name(name) {\n    this.setState((prevState) => ({\n      filter_name: name === prevState.filter_name ? null : name,\n    }));\n  }\n\n  toggle_rev() {\n    this.setState((prevState) => ({ rev: !prevState.rev }), forceCheck);\n  }\n\n  show_reply_bar(name, event) {\n    if (this.reply_ref.current && !event.target.closest('a, .clickable')) {\n      const text = this.reply_ref.current.get();\n      if (\n        /^\\s*(?:Re (?:|洞主|(?:[A-Z][a-z]+ )?(?:[A-Z][a-z]+)|You Win(?: \\d+)?):)?\\s*$/.test(\n          text,\n        )\n      ) {\n        // text is nearly empty so we can replace it\n        const should_text = 'Re ' + name + ': ';\n        if (should_text === this.reply_ref.current.get())\n          this.reply_ref.current.set('');\n        else this.reply_ref.current.set(should_text);\n      }\n    }\n  }\n\n  render() {\n    if (this.state.loading_status === 'loading')\n      return <p className=\"box box-tip\">加载中……</p>;\n\n    const show_pid = load_single_meta(\n      this.props.show_sidebar,\n      this.props.token,\n    );\n\n    const replies_to_show = this.state.filter_name\n      ? this.state.replies.filter((r) => r.name === this.state.filter_name)\n      : this.state.replies.slice();\n    if (this.state.rev) replies_to_show.reverse();\n\n    // may not need key, for performance\n    // key for lazyload elem\n    // let view_mode_key =\n    //   (this.state.rev ? 'y-' : 'n-') + (this.state.filter_name || 'null');\n\n    const replies_cnt = { [DZ_NAME]: 1 };\n    replies_to_show.forEach((r) => {\n      if (replies_cnt[r.name] === undefined) replies_cnt[r.name] = 0;\n      replies_cnt[r.name]++;\n    });\n\n    // hide main thread when filtered\n    const main_thread_elem =\n      this.state.filter_name && this.state.filter_name !== DZ_NAME ? null : (\n        <ClickHandler\n          callback={(e) => {\n            this.show_reply_bar('', e);\n          }}\n        >\n          <FlowItem\n            info={this.state.info}\n            attention={this.state.attention}\n            img_clickable={true}\n            color_picker={this.color_picker}\n            show_pid={show_pid}\n            replies={this.state.replies}\n            set_variant={(variant) => {\n              this.set_variant(null, variant);\n            }}\n            do_filter_name={\n              replies_cnt[DZ_NAME] > 1 ? this.set_filter_name.bind(this) : null\n            }\n          />\n        </ClickHandler>\n      );\n\n    return (\n      <div className=\"flow-item-row sidebar-flow-item\">\n        <div className=\"box box-tip sidebar-toolbar\">\n          {!!this.props.token && (\n            <span className=\"sidebar-toolbar-item\">\n              <a onClick={this.report.bind(this)}>\n                <span className=\"icon icon-flag\" />\n                <label>举报</label>\n              </a>\n            </span>\n          )}\n          <span className=\"sidebar-toolbar-item\">\n            <a onClick={this.load_replies.bind(this)}>\n              <span className=\"icon icon-refresh\" />\n              <label>刷新</label>\n            </a>\n          </span>\n          {(this.state.replies.length >= 1 || this.state.rev) && (\n            <span className=\"sidebar-toolbar-item\">\n              <a onClick={this.toggle_rev.bind(this)}>\n                <span className=\"icon icon-order-rev\" />\n                <label>{this.state.rev ? '还原' : '逆序'}</label>\n              </a>\n            </span>\n          )}\n          {!!this.props.token && (\n            <span className=\"sidebar-toolbar-item\">\n              <a\n                onClick={() => {\n                  this.toggle_attention();\n                }}\n              >\n                {this.state.attention ? (\n                  <span>\n                    <span className=\"icon icon-star-ok\" />\n                    <label>已关注</label>\n                  </span>\n                ) : (\n                  <span>\n                    <span className=\"icon icon-star\" />\n                    <label>未关注</label>\n                  </span>\n                )}\n              </a>\n            </span>\n          )}\n          {!!this.props.token && (\n            <span className=\"sidebar-toolbar-dropdown sidebar-toolbar-item\">\n              <span className=\"sidebar-toolbar-dropdown-title\">\n                <a>\n                  <span className=\"icon icon-menu\" />\n                  <label>更多▾</label>\n                </a>\n              </span>\n              <div className=\"sidebar-toolbar-dropdown-content\">\n                <div className=\"sidebar-toolbar-dropdown-item\">\n                  <a onClick={this.set_alias.bind(this)}>\n                    <span className=\"icon icon-link\" />\n                    <label>别名</label>\n                  </a>\n                </div>\n              </div>\n            </span>\n          )}\n        </div>\n        {!!this.state.filter_name && (\n          <div className=\"box box-tip flow-item filter-name-bar\">\n            <p>\n              <span style={{ float: 'left' }}>\n                <a\n                  onClick={() => {\n                    this.set_filter_name(null);\n                  }}\n                >\n                  还原\n                </a>\n              </span>\n              <span className=\"icon icon-locate\" />\n              &nbsp;当前只看&nbsp;\n              <ColoredSpan\n                colors={this.color_picker.get(this.state.filter_name)}\n              >\n                {this.state.filter_name}\n              </ColoredSpan>\n            </p>\n          </div>\n        )}\n        {!this.state.rev && main_thread_elem}\n        {!!this.state.error_msg && (\n          <div className=\"box box-tip flow-item\">\n            <p>回复加载失败</p>\n            <p>{this.state.error_msg}</p>\n          </div>\n        )}\n        {this.props.deletion_detect &&\n          parseInt(this.state.info.reply) > this.state.replies.length &&\n          !!this.state.replies.length && (\n            <div className=\"box box-tip flow-item box-danger\">\n              {parseInt(this.state.info.reply) - this.state.replies.length}{' '}\n              条回复被删除\n            </div>\n          )}\n        {replies_to_show.map((reply, i) => (\n          <LazyLoad\n            key={i}\n            offset={1500}\n            height=\"5em\"\n            overflow={true}\n            once={true}\n          >\n            <ClickHandler\n              callback={(e) => {\n                this.show_reply_bar(reply.name, e);\n              }}\n            >\n              <Reply\n                info={reply}\n                color_picker={this.color_picker}\n                show_pid={show_pid}\n                set_variant={(variant) => {\n                  this.set_variant(reply.cid, variant);\n                }}\n                do_filter_name={\n                  replies_cnt[reply.name] > 1\n                    ? this.set_filter_name.bind(this)\n                    : null\n                }\n              />\n            </ClickHandler>\n          </LazyLoad>\n        ))}\n        {this.state.rev && main_thread_elem}\n        {this.props.token ? (\n          <ReplyForm\n            pid={this.state.info.pid}\n            token={this.props.token}\n            area_ref={this.reply_ref}\n            on_complete={this.load_replies.bind(this)}\n          />\n        ) : (\n          <div className=\"box box-tip flow-item\">登录后可以回复树洞</div>\n        )}\n      </div>\n    );\n  }\n}\n\nclass FlowItemRow extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      replies: [],\n      reply_status: 'done',\n      reply_error: null,\n      info: Object.assign({}, props.info, { variant: {} }),\n      hidden: window.config.block_words.some((word) =>\n        props.info.text.includes(word),\n      ),\n      attention:\n        props.attention_override === null ? false : props.attention_override,\n      cached: true, // default no display anything\n    };\n    this.color_picker = props.info.reply_color_picker\n      ? props.info.reply_color_picker\n      : new ColorPicker();\n  }\n\n  componentDidMount() {\n    if (parseInt(this.state.info.reply, 10)) {\n      this.load_replies(null, /*update_count=*/ false);\n    }\n  }\n\n  reveal() {\n    this.setState({ hidden: false });\n  }\n\n  load_replies(callback, update_count = true) {\n    this.setState({\n      reply_status: 'loading',\n      reply_error: null,\n    });\n\n    if (this.state.info.use_reply_promise) {\n      console.log(\n        'fetching reply',\n        this.state.info.pid,\n        'from resolved promise',\n      );\n      this.state.info.reply_promise\n        .then(({ data: json, cached, latest_reply }) => {\n          this.setState(\n            (prev, props) => ({\n              replies: json.data,\n              info: Object.assign({}, prev.info, {\n                reply: update_count ? '' + json.data.length : prev.info.reply,\n                variant: json.data.length ? { latest_reply } : {}, // info._latest_reply in state is always null, Don't use it!\n              }),\n              attention: !!json.attention,\n              reply_status: 'done',\n              reply_error: null,\n              cached,\n            }),\n            callback,\n          );\n        })\n        .catch((e) => {\n          console.error(e);\n          this.setState(\n            {\n              replies: [],\n              reply_status: 'failed',\n              reply_error: '' + e,\n            },\n            callback,\n          );\n        });\n\n      return;\n    }\n\n    console.log('fetching reply', this.state.info.pid);\n    API.load_replies_with_cache(\n      this.state.info.pid,\n      this.props.token,\n      this.color_picker,\n      parseInt(this.state.info.reply),\n    )\n      .then(({ data: json, cached }) => {\n        this.setState(\n          (prev, props) => ({\n            replies: json.data,\n            info: Object.assign({}, prev.info, {\n              reply: update_count ? '' + json.data.length : prev.info.reply,\n              variant: json.data.length\n                ? {\n                    latest_reply: Math.max.apply(\n                      null,\n                      json.data.map((r) => parseInt(r.timestamp)),\n                    ),\n                  }\n                : {},\n            }),\n            attention: !!json.attention,\n            reply_status: 'done',\n            reply_error: null,\n            cached,\n          }),\n          callback,\n        );\n      })\n      .catch((e) => {\n        console.error(e);\n        this.setState(\n          {\n            replies: [],\n            reply_status: 'failed',\n            reply_error: '' + e,\n          },\n          callback,\n        );\n      });\n  }\n\n  show_sidebar() {\n    this.props.show_sidebar(\n      '树洞 #' + this.state.info.pid,\n      <FlowSidebar\n        key={+new Date()}\n        info={this.state.info}\n        replies={this.state.replies}\n        attention={this.state.attention}\n        sync_state={this.setState.bind(this)}\n        token={this.props.token}\n        show_sidebar={this.props.show_sidebar}\n        color_picker={this.color_picker}\n        deletion_detect={this.props.deletion_detect}\n      />,\n    );\n  }\n\n  render() {\n    const show_pid = load_single_meta(\n      this.props.show_sidebar,\n      this.props.token,\n      [this.state.info.pid],\n    );\n\n    const hl_rules = [\n      ['url_pid', URL_PID_RE],\n      ['url', URL_RE],\n      ['pid', PID_RE],\n      ['nickname', NICKNAME_RE],\n    ];\n    if (this.props.search_param) {\n      hl_rules.push([\n        'search',\n        !!this.props.search_param.match(/\\/.+\\//)\n          ? build_highlight_re(this.props.search_param, ' ', 'gi', true) // Use regex\n          : build_highlight_re(this.props.search_param, ' ', 'gi'), // Don't use regex\n      ]);\n    }\n    const parts = split_text(this.state.info.text, hl_rules);\n\n    let quote_id = null;\n    if (!this.props.is_quote)\n      for (const [mode, content] of parts)\n        if (\n          mode === 'pid' &&\n          QUOTE_BLACKLIST.indexOf(content) === -1 &&\n          parseInt(content) < parseInt(this.state.info.pid)\n        )\n          if (quote_id === null) quote_id = parseInt(content);\n          else {\n            quote_id = null;\n            break;\n          }\n\n    const res = (\n      <div\n        className={\n          'flow-item-row flow-item-row-with-prompt' +\n          (this.props.is_quote ? ' flow-item-row-quote' : '')\n        }\n        onClick={(event) => {\n          if (!CLICKABLE_TAGS[event.target.tagName.toLowerCase()])\n            this.show_sidebar();\n        }}\n      >\n        <FlowItem\n          parts={parts}\n          info={this.state.info}\n          attention={this.state.attention}\n          img_clickable={false}\n          is_quote={this.props.is_quote}\n          color_picker={this.color_picker}\n          show_pid={show_pid}\n          replies={this.state.replies}\n          cached={this.state.cached}\n        />\n        <div className=\"flow-reply-row\">\n          {this.state.reply_status === 'loading' && (\n            <div className=\"box box-tip\">加载中</div>\n          )}\n          {this.state.reply_status === 'failed' && (\n            <div className=\"box box-tip\">\n              <p>\n                <a\n                  onClick={() => {\n                    this.load_replies();\n                  }}\n                >\n                  重新加载评论\n                </a>\n              </p>\n              <p>{this.state.reply_error}</p>\n            </div>\n          )}\n          {this.state.replies.slice(0, PREVIEW_REPLY_COUNT).map((reply) => (\n            <Reply\n              key={reply.cid}\n              info={reply}\n              color_picker={this.color_picker}\n              show_pid={show_pid}\n            />\n          ))}\n          {this.state.replies.length > PREVIEW_REPLY_COUNT && (\n            <div className=\"box box-tip\">\n              还有 {this.state.replies.length - PREVIEW_REPLY_COUNT} 条\n            </div>\n          )}\n        </div>\n      </div>\n    );\n\n    if (this.state.hidden) {\n      return (\n        <div\n          className=\"flow-item-row flow-item-row-with-prompt\"\n          onClick={() => this.reveal()}\n        >\n          <div\n            className={\n              'flow-item' + (this.props.is_quote ? ' flow-item-quote' : '')\n            }\n          >\n            {!!this.props.is_quote && (\n              <div className=\"quote-tip black-outline\">\n                <div>\n                  <span className=\"icon icon-quote\" />\n                </div>\n                <div>\n                  <small>提到</small>\n                </div>\n              </div>\n            )}\n            <div className=\"box\">\n              <div className=\"box-header\">\n                {!!this.props.do_filter_name && (\n                  <span\n                    className=\"reply-header-badge clickable\"\n                    onClick={() => {\n                      this.props.do_filter_name(DZ_NAME);\n                    }}\n                  >\n                    <span className=\"icon icon-locate\" />\n                  </span>\n                )}\n                <code className=\"box-id\">#{this.props.info.pid}</code>\n                &nbsp;\n                {this.props.info.tag !== null && (\n                  <span className=\"box-header-tag\">{this.props.info.tag}</span>\n                )}\n                <Time stamp={this.props.info.timestamp} />\n                <span className=\"box-header-badge\">\n                  <span className=\"icon icon-block\" />\n                </span>\n                <div style={{ clear: 'both' }} />\n              </div>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    return quote_id ? (\n      <div>\n        {res}\n        <FlowItemQuote\n          pid={quote_id}\n          show_sidebar={this.props.show_sidebar}\n          token={this.props.token}\n          deletion_detect={this.props.deletion_detect}\n        />\n      </div>\n    ) : (\n      res\n    );\n  }\n}\n\nclass FlowItemQuote extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading_status: 'empty',\n      error_msg: null,\n      info: null,\n    };\n  }\n\n  componentDidMount() {\n    this.load();\n  }\n\n  load() {\n    this.setState(\n      {\n        loading_status: 'loading',\n      },\n      () => {\n        API.get_single(this.props.pid, this.props.token)\n          .then((json) => {\n            this.setState({\n              loading_status: 'done',\n              info: json.data,\n            });\n          })\n          .catch((err) => {\n            if (('' + err).indexOf('没有这条树洞') !== -1)\n              this.setState({\n                loading_status: 'empty',\n              });\n            else\n              this.setState({\n                loading_status: 'error',\n                error_msg: '' + err,\n              });\n          });\n      },\n    );\n  }\n\n  render() {\n    if (this.state.loading_status === 'empty') return null;\n    else if (this.state.loading_status === 'loading')\n      return (\n        <div className=\"aux-margin\">\n          <div className=\"box box-tip\">\n            <span className=\"icon icon-loading\" />\n            提到了 #{this.props.pid}\n          </div>\n        </div>\n      );\n    else if (this.state.loading_status === 'error')\n      return (\n        <div className=\"aux-margin\">\n          <div className=\"box box-tip\">\n            <p>\n              <a onClick={this.load.bind(this)}>重新加载</a>\n            </p>\n            <p>{this.state.error_msg}</p>\n          </div>\n        </div>\n      );\n    // 'done'\n    else\n      return (\n        <FlowItemRow\n          info={this.state.info}\n          show_sidebar={this.props.show_sidebar}\n          token={this.props.token}\n          is_quote={true}\n          deletion_detect={this.props.deletion_detect}\n        />\n      );\n  }\n}\n\nfunction FlowChunk(props) {\n  return (\n    <TokenCtx.Consumer>\n      {({ value: token }) => (\n        <div className=\"flow-chunk\">\n          {!!props.title && <TitleLine text={props.title} />}\n          <p className=\"title-button black-outline\">\n            {!!props.title_button && props.title_button}\n          </p>\n          {props.list.map((info, ind) => (\n            <LazyLoad\n              key={`${info.pid}-${props.lazyload_key_suffix}`}\n              offset={1500}\n              height=\"15em\"\n              once={true}\n            >\n              <div>\n                {!!(\n                  props.deletion_detect &&\n                  props.mode === 'list' &&\n                  ind &&\n                  props.list[ind - 1].pid - info.pid > 1\n                ) && (\n                  <div className=\"flow-item-row\">\n                    <div className=\"box box-tip flow-item box-danger\">\n                      {props.list[ind - 1].pid - info.pid - 1} 条被删除\n                    </div>\n                  </div>\n                )}\n                <FlowItemRow\n                  info={info}\n                  show_sidebar={props.show_sidebar}\n                  token={token}\n                  attention_override={\n                    props.mode === 'attention_finished' ? true : null\n                  }\n                  deletion_detect={props.deletion_detect}\n                  search_param={props.search_param}\n                />\n              </div>\n            </LazyLoad>\n          ))}\n        </div>\n      )}\n    </TokenCtx.Consumer>\n  );\n}\n\nexport class Flow extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      mode: props.mode,\n      search_param: props.search_text,\n      loaded_pages: 0,\n      chunks: {\n        title: '',\n        data: [],\n      },\n      loading_status: 'done',\n      error_msg: null,\n      reply_promises_done: false,\n      sort_by_latest_reply: false,\n      lazyload_key_suffix: 0,\n    };\n    this.on_scroll_bound = this.on_scroll.bind(this);\n    window.LATEST_POST_ID = parseInt(localStorage['_LATEST_POST_ID'], 10) || 0;\n  }\n\n  inject_reply_promises(data) {\n    const limit = pLimit(25);\n    const injections = [];\n    for (const post of data) {\n      const color_picker = new ColorPicker();\n      const reply_promise = limit(async () => {\n        try {\n          console.log('fetching reply with promise', post.pid);\n          const { data: json, cached } = await API.load_replies_with_cache(\n            post.pid,\n            this.props.token,\n            color_picker,\n            parseInt(post.reply),\n          );\n          const latest_reply = json.data.length\n            ? Math.max(...json.data.map((r) => parseInt(r.timestamp)))\n            : post.timestamp;\n          post._latest_reply = latest_reply;\n          return {\n            data: json,\n            cached,\n            latest_reply,\n          };\n        } catch (e) {\n          console.error(e);\n          reject(e);\n        }\n      });\n      injections.push(reply_promise);\n      post.use_reply_promise = true;\n      post.reply_color_picker = color_picker;\n      post.reply_promise = reply_promise;\n      // `_latest_reply` is not a promise and can only\n      // be used in Flow component!\n      post._latest_reply = null;\n    }\n\n    Promise.all(injections)\n      .then(() => {\n        this.setState({\n          reply_promises_done: true,\n        });\n      })\n      .catch((e) => {\n        console.error(e);\n      });\n\n    return data;\n  }\n\n  load_page(page) {\n    const failed = (err) => {\n      console.error(err);\n      this.setState((prev, props) => ({\n        loaded_pages: prev.loaded_pages - 1,\n        loading_status: 'failed',\n        error_msg: '' + err,\n      }));\n    };\n\n    if (page > this.state.loaded_pages + 1) throw new Error('bad page');\n    if (page === this.state.loaded_pages + 1) {\n      console.log('fetching page', page);\n      if (this.state.mode === 'list') {\n        API.get_list(page, this.props.token)\n          .then((json) => {\n            if (page === 1 && json.data.length) {\n              // update latest_post_id\n              let max_id = -1;\n              json.data.forEach((x) => {\n                if (parseInt(x.pid, 10) > max_id) max_id = parseInt(x.pid, 10);\n              });\n              localStorage['_LATEST_POST_ID'] = '' + max_id;\n            }\n            this.setState((prev, props) => ({\n              chunks: {\n                title: 'News Feed',\n                data: prev.chunks.data.concat(\n                  json.data.filter(\n                    (x) =>\n                      prev.chunks.data.length === 0 ||\n                      !prev.chunks.data\n                        .slice(-100)\n                        .some((p) => p.pid === x.pid),\n                  ),\n                ),\n              },\n              loading_status: 'done',\n            }));\n          })\n          .catch(failed);\n      } else if (this.state.mode === 'search') {\n        API.get_search(page, this.state.search_param, this.props.token)\n          .then((json) => {\n            const finished = json.data.length === 0;\n            this.setState((prev, props) => ({\n              chunks: {\n                title: 'Result for \"' + this.state.search_param + '\"',\n                data: prev.chunks.data.concat(\n                  json.data.filter(\n                    (x) =>\n                      prev.chunks.data.length === 0 ||\n                      !prev.chunks.data\n                        .slice(-100)\n                        .some((p) => p.pid === x.pid),\n                  ),\n                ),\n              },\n              mode: finished ? 'search_finished' : 'search',\n              loading_status: 'done',\n            }));\n          })\n          .catch(failed);\n      } else if (this.state.mode === 'single') {\n        let param = this.state.search_param.substr(1);\n        if (param in window.config.alias) param = window.config.alias[param];\n        const pid = parseInt(param, 10);\n        API.get_single(pid, this.props.token)\n          .then((json) => {\n            this.setState({\n              chunks: {\n                title: 'PID = ' + pid,\n                data: [json.data],\n              },\n              mode: 'single_finished',\n              loading_status: 'done',\n            });\n          })\n          .catch(failed);\n      } else if (this.state.mode === 'attention') {\n        const use_search = !!this.state.search_param;\n        const use_regex =\n          use_search && !!this.state.search_param.match(/\\/.+\\//);\n        let regex_search = /.+/;\n        if (use_regex) {\n          try {\n            regex_search = new RegExp(this.state.search_param.slice(1, -1));\n          } catch (e) {\n            alert(`请检查正则表达式合法性！\\n${e}`);\n            regex_search = /.+/;\n          }\n        }\n        API.get_attention(this.props.token)\n          .then((json) => {\n            const data_processed = !use_search\n              ? json.data // No Search\n              : !use_regex\n              ? json.data.filter((post) =>\n                  this.state.search_param\n                    .split(' ')\n                    .every((keyword) => post.text.includes(keyword)),\n                ) // Search, Not using regex\n              : json.data.filter((post) => !!post.text.match(regex_search)); // Search, Using regex\n            this.setState({\n              chunks: {\n                title: `${\n                  use_search\n                    ? use_regex\n                      ? `Result for RegEx ${regex_search.toString()} in `\n                      : `Result for \"${this.state.search_param}\" in `\n                    : ''\n                }Attention List`,\n                data: window.config.attention_sort\n                  ? this.inject_reply_promises(data_processed)\n                  : data_processed,\n              },\n              mode: 'attention_finished',\n              loading_status: 'done',\n            });\n          })\n          .catch(failed);\n      } else {\n        console.log('nothing to load');\n        return;\n      }\n\n      this.setState((prev, props) => ({\n        loaded_pages: prev.loaded_pages + 1,\n        loading_status: 'loading',\n        error_msg: null,\n      }));\n    }\n  }\n\n  on_scroll(event) {\n    if (event.target === document) {\n      const avail =\n        document.body.scrollHeight - window.scrollY - window.innerHeight;\n      if (avail < window.innerHeight && this.state.loading_status === 'done')\n        this.load_page(this.state.loaded_pages + 1);\n    }\n  }\n\n  sort_by_latest_reply() {\n    this.setState((prev) => ({\n      original_chunk: prev.chunks,\n      chunks: {\n        title: prev.chunks.title,\n        data: prev.chunks.data\n          .slice(0)\n          .sort((a, b) => b._latest_reply - a._latest_reply),\n      },\n      lazyload_key_suffix: prev.lazyload_key_suffix + 1,\n      sort_by_latest_reply: true,\n    }));\n  }\n\n  sort_by_original() {\n    this.setState((prev) => ({\n      chunks: prev.original_chunk,\n      lazyload_key_suffix: prev.lazyload_key_suffix + 1,\n      sort_by_latest_reply: false,\n    }));\n  }\n\n  componentDidMount() {\n    this.load_page(1);\n    window.addEventListener('scroll', this.on_scroll_bound);\n    window.addEventListener('resize', this.on_scroll_bound);\n  }\n  componentWillUnmount() {\n    window.removeEventListener('scroll', this.on_scroll_bound);\n    window.removeEventListener('resize', this.on_scroll_bound);\n  }\n\n  render() {\n    const should_deletion_detect = localStorage['DELETION_DETECT'] === 'on';\n    const title_button_sort =\n      this.state.reply_promises_done &&\n      (this.state.sort_by_latest_reply ? (\n        <a onClick={this.sort_by_original.bind(this)}>[ 按最新回复时间排序 ]</a>\n      ) : (\n        <a onClick={this.sort_by_latest_reply.bind(this)}>[ 按发布时间排序 ]</a>\n      ));\n    return (\n      <div className=\"flow-container\">\n        <FlowChunk\n          title={this.state.chunks.title}\n          title_button={title_button_sort}\n          list={this.state.chunks.data}\n          mode={this.state.mode}\n          search_param={this.state.search_param || null}\n          show_sidebar={this.props.show_sidebar}\n          deletion_detect={should_deletion_detect}\n          lazyload_key_suffix={this.state.lazyload_key_suffix}\n        />\n        {this.state.loading_status === 'failed' && (\n          <div className=\"aux-margin\">\n            <div className=\"box box-tip\">\n              <p>\n                <a\n                  onClick={() => {\n                    this.load_page(this.state.loaded_pages + 1);\n                  }}\n                >\n                  重新加载\n                </a>\n              </p>\n              <p>{this.state.error_msg}</p>\n            </div>\n          </div>\n        )}\n        <TitleLine\n          text={\n            this.state.loading_status === 'loading' ? (\n              <span>\n                <span className=\"icon icon-loading\" />\n                &nbsp;Loading...\n              </span>\n            ) : (\n              '© xmcp & awesome community'\n            )\n          }\n        />\n      </div>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\nimport { AppSwitcher } from './infrastructure/widgets';\nimport { InfoSidebar, PostForm } from './UserAction';\nimport { TokenCtx } from './UserAction';\n\nimport './Title.css';\n\nconst flag_re = /^\\/\\/setflag ([a-zA-Z0-9_]+)=(.*)$/;\n\nconst APP_SWITCHER_ROUTER = {\n  树洞: 'https://pkuhelper.pku.edu.cn/hole',\n  教室: 'https://pkuhelper.pku.edu.cn/spare_classroom/',\n  课表: 'https://pkuhelper.pku.edu.cn/syllabus/',\n  客户端: 'https://pkuhelper.pku.edu.cn/',\n  成绩: 'https://pkuhelper.pku.edu.cn/my_score',\n  不咕: 'https://pkuhelper.pku.edu.cn/ddl',\n  不咕计划: 'https://pkuhelper.pku.edu.cn/ddl',\n  课程测评: 'https://courses.pinzhixiaoyuan.com/',\n  测评: 'https://courses.pinzhixiaoyuan.com/',\n};\n\nclass ControlBar extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      search_text: '',\n    };\n    this.set_mode = props.set_mode;\n\n    this.on_change_bound = this.on_change.bind(this);\n    this.on_keypress_bound = this.on_keypress.bind(this);\n    this.do_refresh_bound = this.do_refresh.bind(this);\n    this.do_attention_bound = this.do_attention.bind(this);\n  }\n\n  componentDidMount() {\n    if (window.location.hash) {\n      let text = decodeURIComponent(window.location.hash).substr(1);\n      if (text.lastIndexOf('?') !== -1)\n        text = text.substr(0, text.lastIndexOf('?')); // fuck wechat '#param?nsukey=...'\n      this.setState(\n        {\n          search_text: text,\n        },\n        () => {\n          this.on_keypress({ key: 'Enter' });\n        },\n      );\n    }\n  }\n\n  on_change(event) {\n    this.setState({\n      search_text: event.target.value,\n    });\n  }\n\n  on_keypress(event) {\n    if (event.key === 'Enter') {\n      const flag_res = flag_re.exec(this.state.search_text);\n      if (flag_res) {\n        if (flag_res[2]) {\n          localStorage[flag_res[1]] = flag_res[2];\n          alert(\n            'Set Flag ' +\n              flag_res[1] +\n              '=' +\n              flag_res[2] +\n              '\\nYou may need to refresh this webpage.',\n          );\n        } else {\n          delete localStorage[flag_res[1]];\n          alert(\n            'Clear Flag ' +\n              flag_res[1] +\n              '\\nYou may need to refresh this webpage.',\n          );\n        }\n        return;\n      }\n\n      const mode = this.state.search_text.startsWith('#')\n        ? 'single'\n        : this.props.mode !== 'attention'\n        ? 'search'\n        : 'attention';\n      this.set_mode(mode, this.state.search_text || '');\n    }\n  }\n\n  do_refresh() {\n    window.scrollTo(0, 0);\n    this.setState({\n      search_text: '',\n    });\n    this.set_mode('list', null);\n  }\n\n  do_attention() {\n    window.scrollTo(0, 0);\n    this.setState({\n      search_text: '',\n    });\n    this.set_mode('attention', null);\n  }\n\n  render() {\n    return (\n      <TokenCtx.Consumer>\n        {({ value: token }) => (\n          <div className=\"control-bar\">\n            <a\n              className=\"no-underline control-btn\"\n              onClick={this.do_refresh_bound}\n            >\n              <span className=\"icon icon-refresh\" />\n              <span className=\"control-btn-label\">最新</span>\n            </a>\n            {!!token && (\n              <a\n                className=\"no-underline control-btn\"\n                onClick={this.do_attention_bound}\n              >\n                <span className=\"icon icon-attention\" />\n                <span className=\"control-btn-label\">关注</span>\n              </a>\n            )}\n            <input\n              className=\"control-search\"\n              value={this.state.search_text}\n              placeholder={`${\n                this.props.mode === 'attention' ? '在关注中' : ''\n              }搜索 或 #PID`}\n              onChange={this.on_change_bound}\n              onKeyPress={this.on_keypress_bound}\n            />\n            <a\n              className=\"no-underline control-btn\"\n              onClick={() => {\n                this.props.show_sidebar(\n                  'P大树洞 (社区版)',\n                  <InfoSidebar show_sidebar={this.props.show_sidebar} />,\n                );\n              }}\n            >\n              <span className={'icon icon-' + (token ? 'about' : 'login')} />\n              <span className=\"control-btn-label\">\n                {token ? '账户' : '登录'}\n              </span>\n            </a>\n            {!!token && (\n              <a\n                className=\"no-underline control-btn\"\n                onClick={() => {\n                  this.props.show_sidebar(\n                    '发表树洞',\n                    <PostForm\n                      token={token}\n                      on_complete={() => {\n                        this.props.show_sidebar(null, null, 'clear');\n                        this.do_refresh();\n                      }}\n                    />,\n                  );\n                }}\n              >\n                <span className=\"icon icon-plus\" />\n                <span className=\"control-btn-label\">发表</span>\n              </a>\n            )}\n          </div>\n        )}\n      </TokenCtx.Consumer>\n    );\n  }\n}\n\nclass AppSwitcherHusk extends PureComponent {\n  render() {\n    return (\n      <div id=\"app-switcher-shell\">\n        <AppSwitcher appid=\"hole\" />\n      </div>\n    );\n  }\n\n  componentDidMount() {\n    const appSwitcher =\n      document.getElementById('app-switcher-shell').firstChild;\n    const appList = appSwitcher.querySelectorAll('a');\n    appList.forEach((el) => {\n      if (el.text in APP_SWITCHER_ROUTER)\n        el.href = APP_SWITCHER_ROUTER[el.text];\n      else if (el.text !== '更多▾') {\n        el.href = 'https://pkuhelper.pku.edu.cn' + el.pathname;\n        el.style = 'filter: grayscale(100%); opacity: 0.25';\n        el.title = '可能失效的按钮';\n      }\n\n      if (el.text === '树洞') el.title = '官方版树洞';\n    });\n  }\n}\n\nexport function Title(props) {\n  return (\n    <div className=\"title-bar\">\n      {/* <AppSwitcher appid=\"hole\" /> */}\n      <AppSwitcherHusk />\n      <div className=\"aux-margin\">\n        <div className=\"title\">\n          <p className=\"centered-line\">\n            <span\n              onClick={() =>\n                props.show_sidebar(\n                  'P大树洞 (社区版)',\n                  <InfoSidebar show_sidebar={props.show_sidebar} />,\n                )\n              }\n            >\n              P大树洞\n              <small>\n                {' '}\n                (社区版\n                {!!process.env.REACT_APP_VERSION.includes('beta') && (\n                  <sup>β</sup>\n                )}\n                {!!process.env.REACT_APP_VERSION.includes('alpha') && (\n                  <sup>α</sup>\n                )}\n                )\n              </small>\n            </span>\n          </p>\n        </div>\n        <ControlBar\n          show_sidebar={props.show_sidebar}\n          set_mode={props.set_mode}\n          mode={props.mode}\n        />\n      </div>\n    </div>\n  );\n}\n","import React, { PureComponent } from 'react';\nimport './Sidebar.css';\n\nexport class Sidebar extends PureComponent {\n  constructor(props) {\n    super(props);\n    // this.sidebar_ref = React.createRef();\n    this.do_close_bound = this.do_close.bind(this);\n    this.do_back_bound = this.do_back.bind(this);\n  }\n\n  do_close() {\n    this.props.show_sidebar(null, null, 'clear');\n  }\n  do_back() {\n    this.props.show_sidebar(null, null, 'pop');\n  }\n\n  render() {\n    // hide old contents to remember state\n    const contents = this.props.stack.map(\n      ({ 1: content }, i) =>\n        content && (\n          <div\n            key={i}\n            className={\n              'sidebar-content ' +\n              (i === this.props.stack.length - 1\n                ? 'sidebar-content-show'\n                : 'sidebar-content-hide')\n            }\n          >\n            {content}\n          </div>\n        ),\n    );\n    const cur_title = this.props.stack[this.props.stack.length - 1][0];\n    return (\n      <div\n        className={\n          'sidebar-container ' +\n          (cur_title !== null ? 'sidebar-on' : 'sidebar-off')\n        }\n      >\n        <div\n          className=\"sidebar-shadow\"\n          onClick={this.do_back_bound}\n          onTouchEnd={(e) => {\n            e.preventDefault();\n            e.target.click();\n          }}\n        />\n        <div className=\"sidebar\">{contents}</div>\n        <div className=\"sidebar-title\">\n          <a className=\"no-underline\" onClick={this.do_close_bound}>\n            &nbsp;\n            <span className=\"icon icon-close\" />\n            &nbsp;\n          </a>\n          {this.props.stack.length > 2 && (\n            <a className=\"no-underline\" onClick={this.do_back_bound}>\n              &nbsp;\n              <span className=\"icon icon-back\" />\n              &nbsp;\n            </a>\n          )}\n          {cur_title}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport Pressure from 'pressure';\n\nimport './PressureHelper.css';\n\nconst THRESHOLD = 0.4;\nconst MULTIPLIER = 25;\nconst BORDER_WIDTH = 500; // also change css!\n\nexport class PressureHelper extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      level: 0,\n      fired: false,\n    };\n    this.callback = props.callback;\n    this.esc_interval = null;\n  }\n\n  do_fire() {\n    if (this.esc_interval) {\n      clearInterval(this.esc_interval);\n      this.esc_interval = null;\n    }\n    this.setState({\n      level: 1,\n      fired: true,\n    });\n    this.callback();\n    window.setTimeout(() => {\n      this.setState({\n        level: 0,\n        fired: false,\n      });\n    }, 300);\n  }\n\n  componentDidMount() {\n    if (window.config.pressure) {\n      Pressure.set(\n        document.body,\n        {\n          change: (force) => {\n            if (!this.state.fired) {\n              if (force >= 0.999) {\n                this.do_fire();\n              } else\n                this.setState({\n                  level: force,\n                });\n            }\n          },\n          end: () => {\n            this.setState({\n              level: 0,\n              fired: false,\n            });\n          },\n        },\n        {\n          polyfill: false,\n          only: 'touch',\n          preventSelect: false,\n        },\n      );\n\n      document.addEventListener('keydown', (e) => {\n        if (!e.repeat && e.key === 'Escape') {\n          if (this.esc_interval) clearInterval(this.esc_interval);\n          this.setState(\n            {\n              level: THRESHOLD / 2,\n            },\n            () => {\n              this.esc_interval = setInterval(() => {\n                const new_level = this.state.level + 0.1;\n                if (new_level >= 0.999) this.do_fire();\n                else\n                  this.setState({\n                    level: new_level,\n                  });\n              }, 30);\n            },\n          );\n        }\n      });\n      document.addEventListener('keyup', (e) => {\n        if (e.key === 'Escape') {\n          if (this.esc_interval) {\n            clearInterval(this.esc_interval);\n            this.esc_interval = null;\n          }\n          this.setState({\n            level: 0,\n          });\n        }\n      });\n    }\n  }\n\n  render() {\n    const pad = MULTIPLIER * (this.state.level - THRESHOLD) - BORDER_WIDTH;\n    return (\n      <div\n        className={\n          'pressure-box' +\n          (this.state.fired ? ' pressure-box-fired' : '') +\n          (this.state.level <= 0.0001 ? ' pressure-box-empty' : '')\n        }\n        style={{\n          left: pad,\n          right: pad,\n          top: pad,\n          bottom: pad,\n        }}\n      />\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport { Flow } from './Flows';\nimport { Title } from './Title';\nimport { Sidebar } from './Sidebar';\nimport { PressureHelper } from './PressureHelper';\nimport { TokenCtx } from './UserAction';\nimport { load_config, bgimg_style } from './Config';\nimport { listen_darkmode } from './infrastructure/functions';\nimport { LoginPopup, TitleLine } from './infrastructure/widgets';\nimport { cache } from './cache';\n\nconst MAX_SIDEBAR_STACK_SIZE = 10;\n\nfunction DeprecatedAlert(props) {\n  return <div id=\"global-hint-container\" />;\n}\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    load_config();\n    listen_darkmode(\n      { default: undefined, light: false, dark: true }[\n        window.config.color_scheme\n      ],\n    );\n    this.state = {\n      sidebar_stack: [[null, null]], // list of [status, content]\n      mode: 'list', // list, single, search, attention\n      search_text: null,\n      flow_render_key: +new Date(),\n      token: localStorage['TOKEN'] || null,\n    };\n    this.show_sidebar_bound = this.show_sidebar.bind(this);\n    this.set_mode_bound = this.set_mode.bind(this);\n    this.on_pressure_bound = this.on_pressure.bind(this);\n    // a silly self-deceptive approach to ban guests, enough to fool those muggles\n    //                     document             cookie                    'pku_ip_flag=yes'\n    this.inpku_flag =\n      window[atob('ZG9jdW1lbnQ')][atob('Y29va2ll')].indexOf(\n        atob('cGt1X2lwX2ZsYWc9eWVz'),\n      ) !== -1;\n  }\n\n  componentDidMount() {\n    cache(); // init indexeddb\n  }\n\n  static is_darkmode() {\n    if (window.config.color_scheme === 'dark') return true;\n    if (window.config.color_scheme === 'light') return false;\n    else {\n      // 'default'\n      return window.matchMedia('(prefers-color-scheme: dark)').matches;\n    }\n  }\n\n  on_pressure() {\n    if (this.state.sidebar_stack.length > 1)\n      this.show_sidebar(null, null, 'clear');\n    else this.set_mode('list', null);\n  }\n\n  show_sidebar(title, content, mode = 'push') {\n    this.setState((prevState) => {\n      let ns = prevState.sidebar_stack.slice();\n      if (mode === 'push') {\n        if (ns.length === 1) {\n          document.body.style.top = `-${window.scrollY}px`;\n          document.body.style.position = 'fixed';\n          document.body.style.width = '100vw'; // Be responsive with fixed position\n        }\n        if (ns.length > MAX_SIDEBAR_STACK_SIZE) ns.splice(1, 1);\n        ns = ns.concat([[title, content]]);\n      } else if (mode === 'pop') {\n        if (ns.length === 1) return;\n        if (ns.length === 2) {\n          const scrollY = document.body.style.top;\n          document.body.style.position = '';\n          document.body.style.top = '';\n          document.body.style.width = '';\n          window.scrollTo(0, parseInt(scrollY || '0') * -1);\n        }\n        ns.pop();\n      } else if (mode === 'replace') {\n        ns.pop();\n        ns = ns.concat([[title, content]]);\n      } else if (mode === 'clear') {\n        const scrollY = document.body.style.top;\n        document.body.style.position = '';\n        document.body.style.top = '';\n        document.body.style.width = '';\n        window.scrollTo(0, parseInt(scrollY || '0') * -1);\n        ns = [[null, null]];\n      } else throw new Error('bad show_sidebar mode');\n      return {\n        sidebar_stack: ns,\n      };\n    });\n  }\n\n  set_mode(mode, search_text) {\n    this.setState({\n      mode: mode,\n      search_text: search_text,\n      flow_render_key: +new Date(),\n    });\n  }\n\n  render() {\n    return (\n      <TokenCtx.Provider\n        value={{\n          value: this.state.token,\n          set_value: (x) => {\n            localStorage['TOKEN'] = x || '';\n            this.setState({\n              token: x,\n            });\n          },\n        }}\n      >\n        <PressureHelper callback={this.on_pressure_bound} />\n        <div className=\"bg-img\" style={bgimg_style()} />\n        <Title\n          show_sidebar={this.show_sidebar_bound}\n          set_mode={this.set_mode_bound}\n          mode={this.state.mode}\n        />\n        <TokenCtx.Consumer>\n          {(token) => (\n            <div className=\"left-container\">\n              {!token.value && (\n                <div className=\"flow-item-row aux-margin\">\n                  <div className=\"box box-tip\">\n                    <p>\n                      <LoginPopup token_callback={token.set_value}>\n                        {(do_popup) => (\n                          <a onClick={do_popup}>\n                            <span className=\"icon icon-login\" />\n                            &nbsp;登录到 PKU Helper\n                          </a>\n                        )}\n                      </LoginPopup>\n                    </p>\n                  </div>\n                </div>\n              )}\n              <DeprecatedAlert token={token.value} />\n              {this.inpku_flag || token.value ? (\n                <Flow\n                  key={this.state.flow_render_key}\n                  show_sidebar={this.show_sidebar_bound}\n                  mode={this.state.mode}\n                  search_text={this.state.search_text}\n                  token={token.value}\n                />\n              ) : (\n                <TitleLine text=\"请登录后查看内容\" />\n              )}\n              <br />\n            </div>\n          )}\n        </TokenCtx.Consumer>\n        <Sidebar\n          show_sidebar={this.show_sidebar_bound}\n          stack={this.state.sidebar_stack}\n        />\n      </TokenCtx.Provider>\n    );\n  }\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n    ),\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ',\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.',\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n//import {elevate} from './infrastructure/elevator';\nimport registerServiceWorker from './registerServiceWorker';\n\n//elevate();\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n"],"sourceRoot":""}