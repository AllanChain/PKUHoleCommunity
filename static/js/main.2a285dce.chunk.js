(this.webpackJsonpwebhole=this.webpackJsonpwebhole||[]).push([[0],[,,,,,,,function(e,t,a){"use strict";function n(e){if(!e.ok)throw Error("\u7f51\u7edc\u9519\u8bef ".concat(e.status," ").concat(e.statusText));return e.text().then((function(e){try{return JSON.parse(e)}catch(t){throw console.error("json parse error"),console.trace(t),console.log(e),new SyntaxError("JSON Parse Error "+e.substr(0,50))}}))}function r(e){function t(){(void 0===e?window.matchMedia("(prefers-color-scheme: dark)").matches:e)?document.body.classList.add("root-dark-mode"):document.body.classList.remove("root-dark-mode")}t(),window.matchMedia("(prefers-color-scheme: dark)").addListener((function(){t()}))}function o(){return"&PKUHelperAPI=3.0&jsapiver="+encodeURIComponent((Object({NODE_ENV:"production",PUBLIC_URL:"/PKUHoleCommunity",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_VERSION:"0.5.1"}).REACT_APP_BUILD_INFO||"null")+"-"+2*Math.floor(+new Date/72e5))}a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return o}))},,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",(function(){return format_time})),__webpack_require__.d(__webpack_exports__,"c",(function(){return Time})),__webpack_require__.d(__webpack_exports__,"d",(function(){return TitleLine})),__webpack_require__.d(__webpack_exports__,"a",(function(){return AppSwitcher})),__webpack_require__.d(__webpack_exports__,"b",(function(){return LoginPopup}));var _home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10),_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1),_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2),_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(4),_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(3),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__),react_dom__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(12),react_dom__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_7__),react_timeago__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(20),react_timeago__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(react_timeago__WEBPACK_IMPORTED_MODULE_8__),react_timeago_lib_language_strings_zh_CN__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(21),react_timeago_lib_language_strings_zh_CN__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(react_timeago_lib_language_strings_zh_CN__WEBPACK_IMPORTED_MODULE_9__),react_timeago_lib_formatters_buildFormatter__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(22),react_timeago_lib_formatters_buildFormatter__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(react_timeago_lib_formatters_buildFormatter__WEBPACK_IMPORTED_MODULE_10__),_global_css__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(48),_global_css__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_global_css__WEBPACK_IMPORTED_MODULE_11__),_widgets_css__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(49),_widgets_css__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_widgets_css__WEBPACK_IMPORTED_MODULE_12__),_appicon_hole_png__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(23),_appicon_hole_png__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(_appicon_hole_png__WEBPACK_IMPORTED_MODULE_13__),_appicon_imasugu_png__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(24),_appicon_imasugu_png__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(_appicon_imasugu_png__WEBPACK_IMPORTED_MODULE_14__),_appicon_imasugu_rev_png__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(25),_appicon_imasugu_rev_png__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(_appicon_imasugu_rev_png__WEBPACK_IMPORTED_MODULE_15__),_appicon_syllabus_png__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(26),_appicon_syllabus_png__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(_appicon_syllabus_png__WEBPACK_IMPORTED_MODULE_16__),_appicon_score_png__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(27),_appicon_score_png__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(_appicon_score_png__WEBPACK_IMPORTED_MODULE_17__),_appicon_course_survey_png__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(28),_appicon_course_survey_png__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(_appicon_course_survey_png__WEBPACK_IMPORTED_MODULE_18__),_appicon_dropdown_png__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(29),_appicon_dropdown_png__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(_appicon_dropdown_png__WEBPACK_IMPORTED_MODULE_19__),_appicon_dropdown_rev_png__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(30),_appicon_dropdown_rev_png__WEBPACK_IMPORTED_MODULE_20___default=__webpack_require__.n(_appicon_dropdown_rev_png__WEBPACK_IMPORTED_MODULE_20__),_appicon_homepage_png__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(31),_appicon_homepage_png__WEBPACK_IMPORTED_MODULE_21___default=__webpack_require__.n(_appicon_homepage_png__WEBPACK_IMPORTED_MODULE_21__),_const__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(13),_functions__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(7),LOGIN_POPUP_ANCHOR_ID="pkuhelper_login_popup_anchor";function pad2(e){return e<10?"0"+e:""+e}function format_time(e){return"".concat(e.getMonth()+1,"-").concat(pad2(e.getDate())," ").concat(e.getHours(),":").concat(pad2(e.getMinutes()),":").concat(pad2(e.getSeconds()))}var chinese_format=react_timeago_lib_formatters_buildFormatter__WEBPACK_IMPORTED_MODULE_10___default()(react_timeago_lib_language_strings_zh_CN__WEBPACK_IMPORTED_MODULE_9___default.a);function Time(e){var t=new Date(1e3*e.stamp);return react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("span",null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(react_timeago__WEBPACK_IMPORTED_MODULE_8___default.a,{date:t,formatter:chinese_format,title:t.toLocaleString("zh-CN",{timeZone:"Asia/Shanghai",hour12:!1})}),"\xa0",format_time(t))}function TitleLine(e){return react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("p",{className:"centered-line title-line aux-margin"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("span",{className:"black-outline"},e.text))}function GlobalTitle(e){return react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"aux-margin"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"title"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("p",{className:"centered-line"},e.text)))}var FALLBACK_APPS={bar:[["hole","\u6811\u6d1e","/hole",_appicon_hole_png__WEBPACK_IMPORTED_MODULE_13___default.a,null,!1],["imasugu","\u6559\u5ba4","/spare_classroom",_appicon_imasugu_png__WEBPACK_IMPORTED_MODULE_14___default.a,_appicon_imasugu_rev_png__WEBPACK_IMPORTED_MODULE_15___default.a,!1],["syllabus","\u8bfe\u8868","/syllabus",_appicon_syllabus_png__WEBPACK_IMPORTED_MODULE_16___default.a,null,!1],["score","\u6210\u7ee9","/my_score",_appicon_score_png__WEBPACK_IMPORTED_MODULE_17___default.a,null,!1]],dropdown:[["course_survey","\u8bfe\u7a0b\u6d4b\u8bc4","https://courses.pinzhixiaoyuan.com/",_appicon_course_survey_png__WEBPACK_IMPORTED_MODULE_18___default.a,null,!0],["homepage","\u5ba2\u6237\u7aef","/",_appicon_homepage_png__WEBPACK_IMPORTED_MODULE_21___default.a,null,!0]],fix:{}},SWITCHER_DATA_VER="switcher_2",SWITCHER_DATA_URL=_const__WEBPACK_IMPORTED_MODULE_22__.a+"web_static/appswitcher_items.json",AppSwitcher=function(_Component){Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__.a)(AppSwitcher,_Component);var _super=Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_5__.a)(AppSwitcher);function AppSwitcher(e){var t;return Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__.a)(this,AppSwitcher),(t=_super.call(this,e)).state={apps:t.get_apps_from_localstorage()},t}return Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_3__.a)(AppSwitcher,[{key:"get_apps_from_localstorage",value:function(){var e=FALLBACK_APPS;if(localStorage.APPSWITCHER_ITEMS)try{var t=JSON.parse(localStorage.APPSWITCHER_ITEMS)[SWITCHER_DATA_VER];if(!t||!t.bar)throw new Error("content is empty");e=t}catch(a){console.error("load appswitcher items from localstorage failed"),console.trace(a)}return e}},{key:"check_fix",value:function check_fix(){var _this2=this;this.state.apps&&this.state.apps.fix&&this.state.apps.fix[this.props.appid]&&setTimeout((function(){window.HOTFIX_CONTEXT={build_info:Object({NODE_ENV:"production",PUBLIC_URL:"/PKUHoleCommunity",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_VERSION:"0.5.1"}).REACT_APP_BUILD_INFO||"---",build_env:"production"},eval(_this2.state.apps.fix[_this2.props.appid])}),1)}},{key:"componentDidMount",value:function(){var e=this;this.check_fix(),setTimeout((function(){fetch(SWITCHER_DATA_URL).then((function(e){if(!e.ok)throw Error("\u7f51\u7edc\u9519\u8bef ".concat(e.status," ").concat(e.statusText));return e.text()})).then((function(t){t!==localStorage.APPSWITCHER_ITEMS?(console.log("loaded new appswitcher items",t),localStorage.APPSWITCHER_ITEMS=t,e.setState({apps:e.get_apps_from_localstorage()})):console.log("appswitcher items unchanged")})).catch((function(e){console.error("loading appswitcher items failed"),console.trace(e)}))}),500)}},{key:"componentDidUpdate",value:function(e,t){this.state.apps!==t.apps&&this.check_fix()}},{key:"render",value:function(){var e=this.props.appid;function t(t){var a=Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(t,6),n=a[0],r=a[1],o=a[2],i=a[3],s=a[4],l=a[5],c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],_=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("a",{ref:_,key:n,className:c?null:"app-switcher-item"+(n===e?" app-switcher-item-current":""),href:o,target:l?"_blank":"_self"},!!i&&[react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("img",{key:"normal",src:i,className:"app-switcher-logo-normal"}),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("img",{key:"hover",src:s||i,className:"app-switcher-logo-hover"})],react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("span",null,r))}var a=null;return this.state.apps.dropdown.forEach((function(t){t[0]===e&&(a=t)})),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"app-switcher"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("span",{className:"app-switcher-desc app-switcher-left"},"PKUHelper"),this.state.apps.bar.map((function(e){return t(e)})),!!this.state.apps.dropdown.length&&react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"app-switcher-item app-switcher-dropdown "+(a?" app-switcher-item-current":"")},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("p",{className:"app-switcher-dropdown-title"},t(a?function(){var e=a,t=Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(e,6),n=t[0],r=t[1],o=(t[2],t[3]),i=t[4];t[5];return[n,r+"\u25be",null,o,i,!1]}():["-placeholder-elem","\u66f4\u591a\u25be",null,_appicon_dropdown_png__WEBPACK_IMPORTED_MODULE_19___default.a,_appicon_dropdown_rev_png__WEBPACK_IMPORTED_MODULE_20___default.a,!1],!0)),this.state.apps.dropdown.map((function(e){var a=react__WEBPACK_IMPORTED_MODULE_6___default.a.createRef();return react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("p",{key:e[0],className:"app-switcher-dropdown-item",onClick:function(e){!e.target.closest("a")&&a.current&&a.current.click()}},t(e,!0,a))}))),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("span",{className:"app-switcher-desc app-switcher-right"},"\u7f51\u9875\u7248"))}}]),AppSwitcher}(react__WEBPACK_IMPORTED_MODULE_6__.Component),LoginPopupSelf=function(e){Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__.a)(a,e);var t=Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_5__.a)(a);function a(e){var n;return Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__.a)(this,a),(n=t.call(this,e)).state={loading_status:"idle",excluded_scopes:[]},n.username_ref=react__WEBPACK_IMPORTED_MODULE_6___default.a.createRef(),n.password_ref=react__WEBPACK_IMPORTED_MODULE_6___default.a.createRef(),n.input_token_ref=react__WEBPACK_IMPORTED_MODULE_6___default.a.createRef(),n.popup_anchor=document.getElementById(LOGIN_POPUP_ANCHOR_ID),n.popup_anchor||(n.popup_anchor=document.createElement("div"),n.popup_anchor.id=LOGIN_POPUP_ANCHOR_ID,document.body.appendChild(n.popup_anchor)),n}return Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_3__.a)(a,[{key:"do_sendcode",value:function(e){var t=this;"loading"!==this.state.loading_status&&this.setState({loading_status:"loading"},(function(){fetch(_const__WEBPACK_IMPORTED_MODULE_22__.a+"api_xmcp/login/send_code?user="+encodeURIComponent(t.username_ref.current.value)+"&code_type="+encodeURIComponent(e)+Object(_functions__WEBPACK_IMPORTED_MODULE_23__.a)(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({excluded_scopes:t.state.excluded_scopes||[]})}).then(_functions__WEBPACK_IMPORTED_MODULE_23__.b).then((function(e){if(console.log(e),!e.success)throw new Error(JSON.stringify(e));alert(e.msg),t.setState({loading_status:"done"})})).catch((function(e){console.error(e),alert("\u53d1\u9001\u5931\u8d25\n"+e),t.setState({loading_status:"done"})}))}))}},{key:"do_login",value:function(e){var t=this;"loading"!==this.state.loading_status&&this.setState({loading_status:"loading"},(function(){fetch(_const__WEBPACK_IMPORTED_MODULE_22__.a+"api_xmcp/login/login?user="+encodeURIComponent(t.username_ref.current.value)+"&valid_code="+encodeURIComponent(t.password_ref.current.value)+Object(_functions__WEBPACK_IMPORTED_MODULE_23__.a)(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({excluded_scopes:t.state.excluded_scopes||[]})}).then(_functions__WEBPACK_IMPORTED_MODULE_23__.b).then((function(a){if(0!==a.code){if(a.msg)throw new Error(a.msg);throw new Error(JSON.stringify(a))}e(a.user_token),alert("\u6210\u529f\u4ee5 ".concat(a.name," \u7684\u8eab\u4efd\u767b\u5f55")),t.setState({loading_status:"done"}),t.props.on_close()})).catch((function(e){console.error(e),alert("\u767b\u5f55\u5931\u8d25\n"+e),t.setState({loading_status:"done"})}))}))}},{key:"do_input_token",value:function(e){var t=this;if("loading"!==this.state.loading_status){var a=this.input_token_ref.current.value;this.setState({loading_status:"loading"},(function(){fetch(_const__WEBPACK_IMPORTED_MODULE_22__.a+"api_xmcp/hole/system_msg?user_token="+encodeURIComponent(a)+Object(_functions__WEBPACK_IMPORTED_MODULE_23__.a)()).then((function(e){return e.json()})).then((function(n){if(n.error)throw new Error(n.error);if(0===n.result.length)throw new Error("result check failed");t.setState({loading_status:"done"}),e(a),t.props.on_close()})).catch((function(e){alert("Token\u68c0\u9a8c\u5931\u8d25\n"+e),t.setState({loading_status:"done"}),console.error(e)}))}))}}},{key:"perm_alert",value:function(){alert("\u5982\u679c\u4f60\u4e0d\u9700\u8981 PKU Helper \u7684\u67d0\u9879\u529f\u80fd\uff0c\u53ef\u4ee5\u53d6\u6d88\u76f8\u5e94\u6743\u9650\u3002\n\u5176\u4e2d\u3010\u72b6\u6001\u4fe1\u606f\u3011\u5305\u62ec\u4f60\u7684\u7f51\u8d39\u3001\u6821\u56ed\u5361\u4f59\u989d\u7b49\u3002\n\u8be5\u8bbe\u7f6e\u5e94\u7528\u5230\u4f60\u7684\u3010\u6240\u6709\u3011\u8bbe\u5907\uff0c\u53d6\u6d88\u540e\u5982\u9700\u518d\u6b21\u542f\u7528\u76f8\u5e94\u529f\u80fd\u9700\u8981\u91cd\u65b0\u767b\u5f55\u3002")}},{key:"render",value:function(){var e=this;return react_dom__WEBPACK_IMPORTED_MODULE_7___default.a.createPortal(react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"pkuhelper-login-popup-shadow"}),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"pkuhelper-login-popup"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("b",null,"\u63a5\u6536\u9a8c\u8bc1\u7801\u6765\u767b\u5f55 PKU Helper")),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("p",null,"\u6388\u6743\u529f\u80fd",react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("a",{onClick:this.perm_alert.bind(this)},"(?)"),[["score","\u6210\u7ee9\u67e5\u8be2"],["syllabus","\u8bfe\u8868\u67e5\u8be2"],["my_info","\u72b6\u6001\u4fe1\u606f"]].map((function(t){var a=Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.a)(t,2),n=a[0],r=a[1];return react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("label",{key:n,className:"perm-item"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("input",{type:"checkbox",checked:-1===e.state.excluded_scopes.indexOf(n),onChange:function(t){var a=t.target.checked;e.setState((function(e){var t=e.excluded_scopes.slice();if(a){var r=t.indexOf(n);-1!==r&&t.splice(r,1)}else t.push(n);return{excluded_scopes:t}}))}}),r)}))),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("label",null,"\u3000\u5b66\u53f7\xa0",react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("input",{ref:this.username_ref,type:"tel",autoFocus:!0})),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("span",{className:"pkuhelper-login-type"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("a",{onClick:function(t){return e.do_sendcode("sms")}},"\xa0\u77ed\u4fe1\xa0"),"/",react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("a",{onClick:function(t){return e.do_sendcode("mail")}},"\xa0\u90ae\u4ef6\xa0"))),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("label",null,"\u9a8c\u8bc1\u7801\xa0",react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("input",{ref:this.password_ref,type:"tel"})),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("button",{type:"button",disabled:"loading"===this.state.loading_status,onClick:function(t){return e.do_login(e.props.token_callback)}},"\u767b\u5f55")),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("hr",null),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("b",null,"\u4ece\u5176\u4ed6\u8bbe\u5907\u5bfc\u5165\u767b\u5f55\u72b6\u6001")),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("input",{ref:this.input_token_ref,placeholder:"User Token"}),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("button",{type:"button",disabled:"loading"===this.state.loading_status,onClick:function(t){return e.do_input_token(e.props.token_callback)}},"\u5bfc\u5165")),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("hr",null),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("button",{onClick:this.props.on_close},"\u53d6\u6d88")))),this.popup_anchor)}}]),a}(react__WEBPACK_IMPORTED_MODULE_6__.Component),LoginPopup=function(e){Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__.a)(a,e);var t=Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_5__.a)(a);function a(e){var n;return Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__.a)(this,a),(n=t.call(this,e)).state={popup_show:!1},n.on_popup_bound=n.on_popup.bind(Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_0__.a)(n)),n.on_close_bound=n.on_close.bind(Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_0__.a)(n)),n}return Object(_home_runner_work_PKUHoleCommunity_PKUHoleCommunity_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_3__.a)(a,[{key:"on_popup",value:function(){this.setState({popup_show:!0})}},{key:"on_close",value:function(){this.setState({popup_show:!1})}},{key:"render",value:function(){return react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_6___default.a.Fragment,null,this.props.children(this.on_popup_bound),this.state.popup_show&&react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(LoginPopupSelf,{token_callback:this.props.token_callback,on_close:this.on_close_bound}))}}]),a}(react__WEBPACK_IMPORTED_MODULE_6__.Component)},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n="//pkuhelper.pku.edu.cn/"},,,,,,,,,,function(e,t){e.exports="data:image/png;base64,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"},function(e,t){e.exports="data:image/png;base64,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"},function(e,t){e.exports="data:image/png;base64,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"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFdklEQVR42sVW+VNTVxS+f4Od9oeW0RmlU8dOcRx3BEHbqiio3dtfamds+0N1bGe62emirYpSLRYDguAWJQihLZBAEkgKgbCHgIBAXbBTtgSykhAQEL/ecyWtwwMHx9DemS/vvXvv+c73zj3n5DEAjHBodJz9MD7BvuP3KVbb0xqV1p6lzENzS9u7Y3zOVWNittXPMmvMWmaNjZgeW8OZY91i1pSbzSqcg6y01Lj7V7UOap3Bma9WhyiKtEyh0bGsQg0L+P3n5talDNZ5LpWZCwqYqqYxJk9TggK1Bkpza7pWrWNdsZHM/uKymZ1Pgvb07ohiel0Jy7VcO1ug0iCfc+WbW7fUa0vYrUw5u6G8IhXglR1l/qR45tu/l9WeTo5XGqvxS3k1tPmF+t6Y8MXOVYui+3ZEb+ROHoq+HVEb3WtCo23bIhZrCwoNuZyHuKpTU474v/2M+dOSmDdDJhVgzUxn1oQDcd7w59C5+00oqxqgsLTBnHAIQ8vnoy9uPbiDWYH2kk1dwmFkWdqRU2nG9V2vw8e5rScOx/ZnX5YK6Dvw6Z6+VzYMepY8hT8++ZALMONKfQuqkxLhWf88rNvCZy2A54KwqTp1UnCQgPZ9H8Cz5ElYX93gsR38/COpgO3r5bata+FYHYrKve8jp7EDuW23USRLQveKhXDERc5agCMuAt0rF6JQdkpw5DS1o3LPbsFti1nLIxQplx7BljVyO3fSExUG/YYVyFMVIa/lOvLfewcdyxbAvTNq1gJobzu3Ue16G3nNnCNfDUP0cvRELwX5IF9SAbERchtftO+MRsOKUKjXhUG9JRJlSxegm4fUvn32OUB7ycYYNh/qzRFQh4cJTuK23Y+kVED/1nA5BxycwMZxbWUoml4IQdemVXBujwStPQpc3KZr8yo0hYWglXMRJ3FPrksF2F57Sc4BK4f9jZfhfmuzgPPNTWLO9oggG7IN8BDnAzxSAaWL5sk58C+emMS8x8S0PFIBjQf3yznwH0EqwAfIOTAThqZgpjXf7CAV4PAMyjkwFXa3R1xHx+9i4h4wzn/o6r8zKtb6XW4MjdwBnxLw+ofF3HRcD2D2AlxeH5yDXpgsjdBWmFBcVY3S2jr0DTiEKN/wCFpu3ERReQUM1TW4+VcXfFxQ0AQMDvmFiPQcJb5PTkHi+Qs4cEqGo2fS0dndCxrFlVX4OvEkvvjxOCrMDSISQRMQgM3pgtXhFPd0lV3OxOmsKyICdByd3T04xkVVNFhw994cCPDwSIyMjQtyGhVms4hIt61fPA/wcz+WnjF3Alw8DygKvXYHbvf0IlmhgDy/QCQdCeviQuZUAL04kX/1UyK++TkJB2XJ+JMLIWd0DHMugEqNMrysrh6GmlocP3ceOlMlhkfHRA7MuYCByXoPDD0vucOnU2HlR0IOe/oHRBJSuU4EswoCjYjelOqeGhENpVaHhIyzounQcPNSjU87g/qWVvF83zYIAty+IdGI1GVGXCpQ4Te9ARnKXHx5/AQqLU3CWUNbu5g7kpomypOaFdmQ7WMLoPKjClCo1Dh54SJSMhVIy85BbXMLRnhUKNzUGU+cPYdsjRYpiixc4tVBzcsz9AgCXF7vQ3OAOiJlO139PBfG7k4IJ5Qb9Ka0RiUZ2PPQkua+JAKcfJIvzGhEZxwAOZ7aIzwPrLunrE/z3zLN90Brh9zu8vCmMsY3DIozDCYcHJTIlNTNHdelAorLTPG1lmbYuUrfCA/nsB+D/uDA679/fBSBWstVaPTGIxIBXX22EH151UVdqQn1V1sF6ppagoIAX6mpBhpD+YUSY9Uz0s/ygQFWXtPA1MXGjzUGo4Fv1HCoggRNkcGoLykz7fvdVMP0HBIB/xf+Bi8VajXQRja5AAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,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"},function(e,t){e.exports="data:image/png;base64,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"},function(e,t){e.exports="data:image/png;base64,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"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAFfklEQVR42qWXWWicVRiG/39mUim4NRq88MZWXIpLe+FS6lYKtZsW0UrRUmyllUIXpQiN3hXBC1sxdyom6q2lVRGhUqvFClURUVFUsu+ZmD2TTDKTycTn/fudcPzNJJMaeDOTnHO+7z3ffoLm5uagFFpaWpJ8LmloaAgaGxuD3t7epePj49unpqbeLhQKn4EvwQVwjv+dYm1fOp2u0t76+vqgqampAhmp+XTMqxwB0XcUr8pmsydQ8jPK0oYe0G3f+8AgGGDPn+x9t7+//8HW1taIODKSiyWQ0MGurq4bEKbbjoEZUATTYApMgglDrnDpp2j7hPzk5ORJyN9qJBLlEoiUDw4ObkNIhydQ6JHQ4eHhF1jfgLlXg7v5vn5oaGj3xMTE++xpjZ0ZyWQy+7Fo4Cw6H4GENnLgcExIu/6HRa7XugjOBcno7Oy8EjI7ccVvOstnJIP4OG4kwlIEopuj6JAdlElnuFUtiq/Tmt1ApkwiTJ+hIWF+TmiP9nZ0dChgj/my+LtGJPyYcAHnzL5VfuRAXgfGxsZe1rrWLCOCcuAHMO7agazs1CUWM7KkyYtiwm0OdUuL7KJTLiFAt/VvWQ4SdiYpZbjkCbOEAjhHYN7hLiWWS8QEU7/jfM73Ov3PlAfOrEZoQbi9Zu6UvnOhaic/n89/3dbWFq1FBQNGd7IwbinWiTWuRkjolLe3t1+BKZ8nJV8FRyH4ylxgrVp7RkdHDxIDyxwJXQQZARb4wSxcxCpbpTtiy6E3HTuYHnI+crGB8v2xrFgQEHrLBa0XYxtdvcjlcp9HMcDtr4LZr8Ysze2v8fI11MGBgYFtZqFiGcq1J0+wvWRyQnNnILOj6yfb8zc/VQGp8RR/9Mr8sDppfgtjUR1QcFZBdjN4FGwsAa1tAverDMcKT5Si6HvNKmmGorZbjGrFRqwx9d65Uk4H5a/FIF71nBv6+voesdKt/nEq4NcX1lByKq9+jvoW4OB9NJjHwCawuQS0tgU8jLkTMRKRO3t6em5ReVZ1Bd+KwFfW1bKq7UYgjPWF7ZYhZQchMVDtVc7AlXB0VJpy9YwzInDeCpAI3OUT8LJg72KzgMx6ww9Cj8C1rLeBFkfgrOeC9XEXWPSmRkZGdpCih8EBcLAEDqiXsHePmlI8DswFy9E1rHoDLioIP+JLvyKT4rCrVBBqKvqfQRjaVLXGglA6zyot9lhEFl0Jjqeh0N3dXcXhleA2cHsJaG0lZr7R0vlfWaCeg4WOWhqOkYYvilEVVvjLikMbplsaL0RE9UPms1FDpgRGLcLTuOHZeCFSbUDXBQvoIQrRTa4U17rgIeCe8eIgCkKEHVlsEHK792KlOOQi95j5p2lI56NSLH+x8IAKkRZg+AeNpILDUUuVEKxSiateh+iHoE6jVwnUsf4BqMGyy72OGHVVKu0ZV8656K6oGWl0lmlYPO2l0DFzQcqZ73LghhNL5Z2uV3DJX+iOumRKG1IWnTcrMGxoEMOn3UjtDSTlwO1VO0+Zhe/V9OxGM9J9nbk5FZ8H99nkop1Z0vJJu00YL88LjGSz8YPyNVZpC2bd407nf4ZS+Qlfn/AHSU0ymCv0htKkd9PAS9toZHMTkWSprugizu8E3seSpfiacyy3m4pEjdfbReY7zLbFxqiSY7lLNW69VgOHnXXKT2tSduRKPkwcCQ0U9uqZTS2E/ah+Tmdcp64GKsEysIIYWqsGhKJvrNDMntObQCNZXPmCTzOErkbg2di0U7CUVeHpstdTxpRO+1OTCDNNbXCZFFc+7+PUjdQyO758HJN+apNTxh6iae9xOmBVUBYbhvQ5sug5pdrlPk79B0aFUsleyVUUG/WOT8D39jS/CH7XJ2tH2LNCe60hJRd6nv8Dwj5T3q96iTAAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,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"},,,,,function(e,t,a){e.exports=a(65)},,,,,function(e,t,a){},,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(12),i=a.n(o),s=(a(41),a(1)),l=a(2),c=a(5),_=a(4),u=a(3),p=a(35),d=a(10),h=a(17),m=a(11),f=a(6),E=a.n(f),b=a(8),g=a(15),v=a.n(g),k=a(19),A=a.n(k),w=function(){function e(){Object(s.a)(this,e),this.names={},this.current_h=Math.random()}return Object(l.a)(e,[{key:"get",value:function(e){return"\u6d1e\u4e3b"===(e=e.toLowerCase())?["hsl(0,0%,97%)","hsl(0,0%,16%)"]:(this.names[e]||(this.current_h+=.618033988749895,this.current_h%=1,this.names[e]=["hsl(".concat(360*this.current_h,", 50%, 90%)"),"hsl(".concat(360*this.current_h,", 60%, 20%)")]),this.names[e])}}]),e}(),O=/(^|[^\d\u20e3\ufe0e\ufe0f])([2-9]\d{4,5}|1\d{4,6})(?![\d\u20e3\ufe0e\ufe0f])/g,y=/((?:https?:\/\/)?pkuhelper\.pku\.edu\.cn\/hole\/?#(?:#|%23)([2-9]\d{4,5}|1\d{4,6}))(?!\d|\u20e3|\ufe0e|\ufe0f)/g,C=/(^|[^A-Za-z])((?:(?:Angry|Baby|Crazy|Diligent|Excited|Fat|Greedy|Hungry|Interesting|Jolly|Kind|Little|Magic|Na\xefve|Old|Powerful|Quiet|Rich|Superman|THU|Undefined|Valuable|Wifeless|Xiangbuchulai|Young|Zombie)\s)?(?:Alice|Bob|Carol|Dave|Eve|Francis|Grace|Hans|Isabella|Jason|Kate|Louis|Margaret|Nathan|Olivia|Paul|Queen|Richard|Susan|Thomas|Uma|Vivian|Winnie|Xander|Yasmine|Zach)|You Win(?: \d+)?|\u6d1e\u4e3b)(?![A-Za-z])/gi,P=/(^|[^.@a-zA-Z0-9_])((?:https?:\/\/)?(?:(?:[\w-]+\.)+[a-zA-Z]{2,3}|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?::\d{1,5})?(?:\/[\w~!@#$%^&*()\-_=+[\]{};:,./?|]*)?)(?![a-zA-Z0-9])/gi;function D(e,t){return e=[[null,e]],t.forEach((function(t){var a=Object(d.a)(t,2),n=a[0],r=a[1];e=[].concat.apply([],e.map((function(e){var t=Object(d.a)(e,2),a=t[0],o=t[1];return a?[e]:o.split(r).map((function(e){return r.test(e)?[n,e]:[null,e]})).filter((function(e){var t=Object(d.a)(e,2),a=t[0],n=t[1];return null!==a||n}))})))})),e}var M=a(9),U=a(7),I=a(13),R=function(){function e(){var t=this;Object(s.a)(this,e),this.db=null,this.added_items_since_maintenance=0,this.encrypt=this.encrypt.bind(this),this.decrypt=this.decrypt.bind(this);var a=indexedDB.open("hole_cache_db",1);a.onerror=console.error.bind(console),a.onupgradeneeded=function(e){console.log("comment cache db upgrade"),e.target.result.createObjectStore("comment",{keyPath:"pid"}).createIndex("last_access","last_access",{unique:!1})},a.onsuccess=function(e){console.log("comment cache db loaded"),t.db=e.target.result,setTimeout(t.maintenance.bind(t),1)}}return Object(l.a)(e,[{key:"encrypt",value:function(e,t){for(var a=JSON.stringify(t),n="",r=0,o=(42^e)%128;r<a.length;r++){var i=(o^a.charCodeAt(r)/2)%128;n+=String.fromCharCode(o^a.charCodeAt(r)),o=i}return n}},{key:"decrypt",value:function(e,t){var a="";if("string"!==typeof t)return null;for(var n=0,r=(42^e)%128;n<t.length;n++){var o=r^t.charCodeAt(n);a+=String.fromCharCode(o),r=(r^o/2)%128}try{return JSON.parse(a)}catch(i){return console.error("decrypt failed"),console.trace(i),null}}},{key:"get",value:function(e,t){var a=this;return e=parseInt(e),new Promise((function(n,r){if(!a.db)return n(null);var o,i;try{var s=a.db.transaction(["comment"],"readwrite");i=s.objectStore("comment"),o=i.get(e)}catch(l){console.exception(l),n(null)}o.onsuccess=function(){var r=o.result;if(r&&r.data_str)if(t===r.version){console.log("comment cache hit",e),r.last_access=+new Date,i.put(r);var s=a.decrypt(e,r.data_str);n(s)}else console.log("comment cache expired",e,": ver",r.version,"target",t),i.delete(e),n(null);else n(null)},o.onerror=function(e){console.warn("comment cache indexeddb open failed"),console.error(e),n(null)}}))}},{key:"put",value:function(e,t,a){var n=this;return e=parseInt(e),new Promise((function(r,o){if(!n.db)return r();try{n.db.transaction(["comment"],"readwrite").objectStore("comment").put({pid:e,version:t,data_str:n.encrypt(e,a),last_access:+new Date}),console.log("comment cache put",e),150===++n.added_items_since_maintenance&&setTimeout(n.maintenance.bind(n),1)}catch(i){return console.exception(i),r()}}))}},{key:"delete",value:function(e){var t=this;return e=parseInt(e),new Promise((function(a,n){if(!t.db)return a();var r;try{r=t.db.transaction(["comment"],"readwrite").objectStore("comment").delete(e)}catch(o){return console.exception(o),a()}console.log("comment cache delete",e),r.onerror=function(){return console.warn("comment cache delete failed ",e),a()},r.onsuccess=function(){return a()}}))}},{key:"maintenance",value:function(){var e=this;if(this.db){var t=this.db.transaction(["comment"],"readwrite").objectStore("comment"),a=t.count();a.onsuccess=function(){var n=a.result;n>1e3?(console.log("comment cache db maintenance",n),t.index("last_access").openKeyCursor().onsuccess=function(e){var a=e.target.result;a&&(t.delete(a.primaryKey),--n>1e3&&a.continue())}):console.log("comment cache db no need to maintenance",n),e.added_items_since_maintenance=0},a.onerror=console.error.bind(console)}}},{key:"clear",value:function(){if(this.db)try{indexedDB.deleteDatabase("hole_cache_db"),console.log("delete comment cache db")}catch(e){console.exception(e)}}}]),e}();function x(){return window.hole_cache||(window.hole_cache=new R),window.hole_cache}function N(e){return Object(U.a)()+(e?"&user_token="+e:"")}var T=function(){var e=Object(b.a)(E.a.mark((function e(t){var a,n,r=arguments;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]&&r[1],e.next=3,Object(U.b)(t);case 3:if(0===(n=e.sent).code){e.next=14;break}if(!n.msg){e.next=13;break}if(!a){e.next=10;break}alert(n.msg),e.next=11;break;case 10:throw new Error(n.msg);case 11:e.next=14;break;case 13:throw new Error(JSON.stringify(n));case 14:return e.abrupt("return",n);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(e,t){return e.sort((function(e,t){return parseInt(e.cid,10)-parseInt(t.cid,10)})).map((function(e){return e._display_color=t.get(e.name),e.variant={},e}))},j={load_replies:function(){var e=Object(b.a)(E.a.mark((function e(t,a,n,r){var o,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=parseInt(t),e.next=3,fetch(L+"/api.php?action=getcomment&pid="+t+N(a));case 3:return o=e.sent,e.next=6,T(o);case 6:return i=e.sent,x().put(t,r,i),i.data=K(i.data,n),e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),load_replies_with_cache:function(){var e=Object(b.a)(E.a.mark((function e(t,a,n,r){var o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=parseInt(t),e.next=3,x().get(t,r);case 3:if(!(o=e.sent)){e.next=9;break}return o.data=K(o.data,n),e.abrupt("return",{data:o,cached:!0});case 9:return e.next=11,j.load_replies(t,a,n,r);case 11:return o=e.sent,e.abrupt("return",{data:o,cached:!o});case 13:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),set_attention:function(){var e=Object(b.a)(E.a.mark((function e(t,a,n){var r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new URLSearchParams).append("user_token",n),r.append("pid",t),r.append("switch",a?"1":"0"),e.next=6,fetch(L+"/api.php?action=attention"+N(n),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r});case 6:return o=e.sent,x().delete(t),e.abrupt("return",T(o,!0));case 9:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),report:function(){var e=Object(b.a)(E.a.mark((function e(t,a,n){var r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new URLSearchParams).append("user_token",n),r.append("pid",t),r.append("reason",a),e.next=6,fetch(L+"/api.php?action=report"+N(n),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r});case 6:return o=e.sent,e.abrupt("return",T(o,!0));case 8:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),get_list:function(){var e=Object(b.a)(E.a.mark((function e(t,a){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(L+"/api.php?action=getlist&p="+t+N(a));case 2:return n=e.sent,e.abrupt("return",T(n));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),get_search:function(){var e=Object(b.a)(E.a.mark((function e(t,a,n){var r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(L+"/api.php?action=search&pagesize=50&page="+t+"&keywords="+encodeURIComponent(a)+N(n));case 2:return r=e.sent,e.abrupt("return",T(r));case 4:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),get_single:function(){var e=Object(b.a)(E.a.mark((function e(t,a){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(L+"/api.php?action=getone&pid="+t+N(a));case 2:return n=e.sent,e.abrupt("return",T(n));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),get_attention:function(){var e=Object(b.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(L+"/api.php?action=getattention"+N(t));case 2:return a=e.sent,e.abrupt("return",T(a));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},L=(a(50),I.a+"services/pkuhole");function S(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function W(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"g",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!n)return e?new RegExp("(".concat(e.split(t).filter((function(e){return!!e})).map(S).join("|"),")"),a):/^$/g;try{return new RegExp("("+e.slice(1,-1)+")",a)}catch(r){return/^$/g}}function B(e){return r.a.createElement("span",{className:"colored-span",style:{"--coloredspan-bgcolor-light":e.colors[0],"--coloredspan-bgcolor-dark":e.colors[1]}},e.children)}var H=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("pre",null,this.props.parts.map((function(t,a){var n,o=Object(d.a)(t,2),i=o[0],s=o[1];return r.a.createElement("span",{key:a},"url_pid"===i?r.a.createElement("span",{className:"url-pid-link",title:s},"/hole/##"):"url"===i?r.a.createElement("a",{href:(n=s,/^https?:\/\//.test(n)?n:"http://"+n),target:"_blank",rel:"noopener"},s):"pid"===i?r.a.createElement("a",{href:"##"+s,onClick:function(t){t.preventDefault(),e.props.show_pid(s)}},s):"nickname"===i?r.a.createElement(B,{colors:e.props.color_picker.get(s)},s):"search"===i?r.a.createElement("span",{className:"search-query-highlight"},s):s)})))}}]),a}(n.PureComponent);window.TEXTAREA_BACKUP={};var Q=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={text:""},n.on_change_bound=n.on_change.bind(Object(c.a)(n)),n.on_keydown_bound=n.on_keydown.bind(Object(c.a)(n)),n.clear=n.clear.bind(Object(c.a)(n)),n.area_ref=r.a.createRef(),n.change_callback=e.on_change||function(){},n.submit_callback=e.on_submit||function(){},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.setState({text:window.TEXTAREA_BACKUP[this.props.id]||""},(function(){e.change_callback(e.state.text)}))}},{key:"componentWillUnmount",value:function(){window.TEXTAREA_BACKUP[this.props.id]=this.state.text,this.change_callback(this.state.text)}},{key:"on_change",value:function(e){this.setState({text:e.target.value}),this.change_callback(e.target.value)}},{key:"on_keydown",value:function(e){"Enter"===e.key&&e.ctrlKey&&!e.altKey&&(e.preventDefault(),this.submit_callback())}},{key:"clear",value:function(){this.setState({text:""})}},{key:"set",value:function(e){this.change_callback(e),this.setState({text:e})}},{key:"get",value:function(){return this.state.text}},{key:"focus",value:function(){this.area_ref.current.focus()}},{key:"render",value:function(){return r.a.createElement("textarea",{ref:this.area_ref,onChange:this.on_change_bound,value:this.state.text,onKeyDown:this.on_keydown_bound})}}]),a}(n.Component),q=null;function G(e){var t=/iPhone|iPad|iPod/i.test(window.navigator.userAgent);return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone?null:t?navigator.standalone?null:r.a.createElement("div",{className:"box promotion-bar"},r.a.createElement("span",{className:"icon icon-about"}),"\xa0 \u7528 Safari \u628a\u6811\u6d1e ",r.a.createElement("b",null,"\u6dfb\u52a0\u5230\u4e3b\u5c4f\u5e55")," \u66f4\u597d\u7528"):q?r.a.createElement("div",{className:"box promotion-bar"},r.a.createElement("span",{className:"icon icon-about"}),"\xa0 \u628a\u7f51\u9875\u7248\u6811\u6d1e"," ",r.a.createElement("b",null,r.a.createElement("a",{onClick:function(){q&&q.prompt()}},"\u5b89\u88c5\u5230\u684c\u9762"))," ","\u66f4\u597d\u7528"):null}window.addEventListener("beforeinstallprompt",(function(e){console.log("pwa: received before install prompt"),q=e}));var F=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={moved:!0,init_y:0,init_x:0},n.on_begin_bound=n.on_begin.bind(Object(c.a)(n)),n.on_move_bound=n.on_move.bind(Object(c.a)(n)),n.on_end_bound=n.on_end.bind(Object(c.a)(n)),n.MOVE_THRESHOLD=3,n.last_fire=0,n}return Object(l.a)(a,[{key:"on_begin",value:function(e){this.setState({moved:!1,init_y:(e.touches?e.touches[0]:e).screenY,init_x:(e.touches?e.touches[0]:e).screenX})}},{key:"on_move",value:function(e){this.state.moved||Math.abs((e.touches?e.touches[0]:e).screenY-this.state.init_y)+Math.abs((e.touches?e.touches[0]:e).screenX-this.state.init_x)>this.MOVE_THRESHOLD&&this.setState({moved:!0})}},{key:"on_end",value:function(e){this.state.moved||this.do_callback(e),this.setState({moved:!0})}},{key:"do_callback",value:function(e){this.last_fire+100>+new Date||(this.last_fire=+new Date,this.props.callback(e))}},{key:"render",value:function(){return r.a.createElement("div",{onTouchStart:this.on_begin_bound,onMouseDown:this.on_begin_bound,onTouchMove:this.on_move_bound,onMouseMove:this.on_move_bound,onClick:this.on_end_bound},this.props.children)}}]),a}(n.PureComponent);a(51);function X(e,t,a,n){n=n||!1,e.addEventListener?e.addEventListener(t,a,n):e.attachEvent&&e.attachEvent("on".concat(t),(function(t){a.call(e,t||window.event)}))}function V(e,t,a,n){n=n||!1,e.removeEventListener?e.removeEventListener(t,a,n):e.detachEvent&&e.detachEvent("on".concat(t),a)}var z=function(e){if(!(e instanceof HTMLElement))return document.documentElement;for(var t="absolute"===e.style.position,a=/(scroll|auto)/,n=e;n;){if(!n.parentNode)return e.ownerDocument||document.documentElement;var r=window.getComputedStyle(n),o=r.position,i=r.overflow,s=r["overflow-x"],l=r["overflow-y"];if("static"===o&&t)n=n.parentNode;else{if(a.test(i)&&a.test(s)&&a.test(l))return n;n=n.parentNode}}return e.ownerDocument||e.documentElement||document.documentElement};var Y=0,Z=0,J="data-lazyload-listened",$=[],ee=[],te=!1;try{var ae=Object.defineProperty({},"passive",{get:function(){te=!0}});window.addEventListener("test",null,ae)}catch(rt){}var ne,re=!!te&&{capture:!1,passive:!0},oe=function(e){var t=i.a.findDOMNode(e);if(t instanceof HTMLElement){var a=z(t);(e.props.overflow&&a!==t.ownerDocument&&a!==document&&a!==document.documentElement?function(e,t){var a,n,r=i.a.findDOMNode(e);try{var o=t.getBoundingClientRect();a=o.top,n=o.height}catch(rt){a=Y,n=Z}var s,l,c=window.innerHeight||document.documentElement.clientHeight,_=Math.max(a,0),u=Math.min(c,a+n)-_;try{var p=r.getBoundingClientRect();s=p.top,l=p.height}catch(rt){s=Y,l=Z}var d=s-_,h=Array.isArray(e.props.offset)?e.props.offset:[e.props.offset,e.props.offset];return d-h[0]<=u&&d+l+h[1]>=0}(e,a):function(e){var t,a,n=i.a.findDOMNode(e);if(!(n.offsetWidth||n.offsetHeight||n.getClientRects().length))return!1;try{var r=n.getBoundingClientRect();t=r.top,a=r.height}catch(rt){t=Y,a=Z}var o=window.innerHeight||document.documentElement.clientHeight,s=Array.isArray(e.props.offset)?e.props.offset:[e.props.offset,e.props.offset];return t-s[0]<=o&&t+a+s[1]>=0}(e))?e.state.visible&&!e.state.hidden||(e.props.once&&ee.push(e),e.setState({visible:!0,hidden:!1})):e.props.once||(e.props.unmountIfInvisible?!0===e.visible&&e.setState({visible:!1}):e.props.hiddenIfInvisible&&!1===e.state.hidden&&e.setState({hidden:!0}))}},ie=function(){for(var e=0;e<$.length;++e){var t=$[e];oe(t)}ee.forEach((function(e){var t=$.indexOf(e);-1!==t&&$.splice(t,1)})),ee=[]},se=null,le=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={visible:!1,hidden:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=window,t=this.props.scrollContainer;t&&"string"===typeof t&&(e=e.document.querySelector(t));var a=void 0!==this.props.debounce&&"throttle"===ne||"debounce"===ne&&void 0===this.props.debounce;if(a&&(V(e,"scroll",se,re),V(window,"resize",se,re),se=null),se||(void 0!==this.props.debounce?(se=function(e,t,a){var n,r,o,i,s,l=function l(){var c=+new Date-i;c<t&&c>=0?n=setTimeout(l,t-c):(n=null,a||(s=e.apply(o,r),n||(o=null,r=null)))};return function(){o=this,r=arguments,i=+new Date;var c=a&&!n;return n||(n=setTimeout(l,t)),c&&(s=e.apply(o,r),o=null,r=null),s}}(ie,"number"===typeof this.props.debounce?this.props.debounce:300),ne="debounce"):void 0!==this.props.throttle?(se=function(e,t,a){var n,r;return t||(t=250),function(){var o=a||this,i=+new Date,s=arguments;n&&i<n+t?(clearTimeout(r),r=setTimeout((function(){n=i,e.apply(o,s)}),t)):(n=i,e.apply(o,s))}}(ie,"number"===typeof this.props.throttle?this.props.throttle:300),ne="throttle"):se=ie),this.props.overflow){var n=z(i.a.findDOMNode(this));if(n&&"function"===typeof n.getAttribute){var r=+n.getAttribute(J)+1;1===r&&n.addEventListener("scroll",se,re),n.setAttribute(J,r)}}else if(0===$.length||a){var o=this.props,s=o.scroll,l=o.resize;s&&X(e,"scroll",se,re),l&&X(window,"resize",se,re)}$.push(this),oe(this)}},{key:"componentWillUnmount",value:function(){if(this.props.overflow){var e=z(i.a.findDOMNode(this));if(e&&"function"===typeof e.getAttribute){var t=+e.getAttribute(J)-1;0===t?(e.removeEventListener("scroll",se,re),e.removeAttribute(J)):e.setAttribute(J,t)}}var a=$.indexOf(this);-1!==a&&$.splice(a,1),0===$.length&&"undefined"!==typeof window&&(V(window,"resize",se,re),V(window,"scroll",se,re))}},{key:"render",value:function(){return this.state.visible?this.props.hiddenIfInvisible?this.state.hidden?r.a.createElement("div",{style:{visibility:"hidden"}},this.props.children):r.a.createElement("div",null,this.props.children):this.props.children:this.props.placeholder?this.props.placeholder:r.a.createElement("div",{style:{height:this.props.height},className:"lazyload-placeholder"})}}]),a}(n.PureComponent);le.defaultProps={once:!1,offset:0,overflow:!1,resize:!1,scroll:!0,unmountIfInvisible:!1,hiddenIfInvisible:!1};var ce=le,_e=a(32),ue=a.n(_e);window.audio_cache={};var pe=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={url:n.props.src,state:"waiting",data:null},n}return Object(l.a)(a,[{key:"load",value:function(){var e=this;window.audio_cache[this.state.url]?this.setState({state:"loaded",data:window.audio_cache[this.state.url]}):(console.log("fetching audio",this.state.url),this.setState({state:"loading"}),Promise.all([fetch(this.state.url),new Promise((function(e,t){window.AMR?e():ue()("static/amr_all.min.js",(function(a){a?t(a):e()}))}))]).then((function(t){t[0].blob().then((function(t){var a=new FileReader;a.onload=function(t){var a=(new window.AMR).decode(t.target.result);if(a){for(var n=window.PCMData.encode({sampleRate:8e3,channelCount:1,bytesPerSample:2,data:a}),r=new Uint8Array(n.length),o=0;o<n.length;o++)r[o]=n.charCodeAt(o);var i=URL.createObjectURL(new Blob([r],{type:"audio/wav"}));window.audio_cache[e.state.url]=i,e.setState({state:"loaded",data:i})}else alert("audio decoding failed")},a.readAsBinaryString(t)})),e.setState({state:"decoding"})})))}},{key:"render",value:function(){return"waiting"===this.state.state?r.a.createElement("p",null,r.a.createElement("a",{onClick:this.load.bind(this)},"\u52a0\u8f7d\u97f3\u9891")):"loading"===this.state.state?r.a.createElement("p",null,"\u6b63\u5728\u4e0b\u8f7d\u2026\u2026"):"decoding"===this.state.state?r.a.createElement("p",null,"\u6b63\u5728\u89e3\u7801\u2026\u2026"):"loaded"===this.state.state?r.a.createElement("p",null,r.a.createElement("audio",{src:this.state.data,controls:!0})):void 0}}]),a}(n.Component),de=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={loading_status:"idle",msg:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.load()}},{key:"load",value:function(){var e=this;"loading"!==this.state.loading_status&&this.setState({loading_status:"loading"},(function(){fetch(I.a+"api_xmcp/hole/system_msg?user_token="+encodeURIComponent(e.props.token)+Object(U.a)()).then(U.b).then((function(t){if(t.error)throw new Error(t.error);e.setState({loading_status:"done",msg:t.result})})).catch((function(t){console.error(t),alert(""+t),e.setState({loading_status:"failed"})}))}))}},{key:"render",value:function(){var e=this;return"loading"===this.state.loading_status?r.a.createElement("p",{className:"box box-tip"},"\u52a0\u8f7d\u4e2d\u2026\u2026"):"failed"===this.state.loading_status?r.a.createElement("div",{className:"box box-tip"},r.a.createElement("a",{onClick:function(){e.load()}},"\u91cd\u65b0\u52a0\u8f7d")):"done"===this.state.loading_status?this.state.msg.map((function(e){return r.a.createElement("div",{className:"box",key:e.timestamp},r.a.createElement("div",{className:"box-header"},r.a.createElement(M.c,{stamp:e.timestamp}),r.a.createElement("b",null,e.title)),r.a.createElement("div",{className:"box-content"},r.a.createElement("pre",null,e.content)))})):null}}]),a}(n.PureComponent),he=(a(52),{"static/bg/gbp.jpg":"\u5bfb\u89c5\u7e41\u661f\uff08\u9ed8\u8ba4\uff09","static/bg/eriri.jpg":"\u5e73\u6210\u8457\u540d\u753b\u5e08","static/bg/yurucamp.jpg":"\u9732\u8425\u5929\u4e0b\u7b2c\u4e00","static/bg/minecraft.jpg":"\u9ea6\u6069\xb7\u5e93\u62c9\u592b\u7279","static/bg/sif.jpg":"\u68a6\u5f00\u59cb\u7684\u5730\u65b9"}),me={background_img:"static/bg/gbp.jpg",background_color:"#113366",pressure:!1,easter_egg:!0,color_scheme:"default",block_words:[],alias:{},attention_sort:!1};function fe(){var e,t=Object.assign({},me);try{e=JSON.parse(localStorage.hole_config||"{}")}catch(rt){alert("\u8bbe\u7f6e\u52a0\u8f7d\u5931\u8d25\uff0c\u5c06\u91cd\u7f6e\u4e3a\u9ed8\u8ba4\u8bbe\u7f6e\uff01\n"+rt),delete localStorage.hole_config,e={}}Object.keys(e).forEach((function(a){void 0!==t[a]&&(t[a]=e[a])})),console.log("config loaded",t),window.config=t}function Ee(){localStorage.hole_config=JSON.stringify(window.config),fe()}function be(e,t){return void 0===e&&(e=window.config.background_img),void 0===t&&(t=window.config.background_color),{background:"transparent center center",backgroundImage:null===e?"unset":'url("'+encodeURI(e)+'")',backgroundColor:t,backgroundSize:"cover"}}var ge=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={img:window.config.background_img,color:window.config.background_color},n}return Object(l.a)(a,[{key:"save_changes",value:function(){this.props.callback({background_img:this.state.img,background_color:this.state.color})}},{key:"on_select",value:function(e){var t=e.target.value;this.setState({img:"##other"===t?"":"##color"===t?null:t},this.save_changes.bind(this))}},{key:"on_change_img",value:function(e){this.setState({img:e.target.value},this.save_changes.bind(this))}},{key:"on_change_color",value:function(e){this.setState({color:e.target.value},this.save_changes.bind(this))}},{key:"render",value:function(){var e=null===this.state.img?"##color":-1===Object.keys(he).indexOf(this.state.img)?"##other":this.state.img;return r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("b",null,"\u80cc\u666f\u56fe\u7247\uff1a"),r.a.createElement("select",{className:"config-select",value:e,onChange:this.on_select.bind(this)},Object.keys(he).map((function(e){return r.a.createElement("option",{key:e,value:e},he[e])})),r.a.createElement("option",{value:"##other"},"\u8f93\u5165\u56fe\u7247\u7f51\u5740\u2026\u2026"),r.a.createElement("option",{value:"##color"},"\u7eaf\u8272\u80cc\u666f\u2026\u2026")),"\xa0",r.a.createElement("small",null,"#background_img"),"\xa0","##other"===e&&r.a.createElement("input",{type:"url",placeholder:"\u56fe\u7247\u7f51\u5740",value:this.state.img,onChange:this.on_change_img.bind(this)}),"##color"===e&&r.a.createElement("input",{type:"color",value:this.state.color,onChange:this.on_change_color.bind(this)})),r.a.createElement("div",{className:"bg-preview",style:be(this.state.img,this.state.color)}))}}]),a}(n.PureComponent),ve=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={color_scheme:window.config.color_scheme},n}return Object(l.a)(a,[{key:"save_changes",value:function(){this.props.callback({color_scheme:this.state.color_scheme})}},{key:"on_select",value:function(e){var t=e.target.value;this.setState({color_scheme:t},this.save_changes.bind(this))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("b",null,"\u591c\u95f4\u6a21\u5f0f\uff1a"),r.a.createElement("select",{className:"config-select",value:this.state.color_scheme,onChange:this.on_select.bind(this)},r.a.createElement("option",{value:"default"},"\u8ddf\u968f\u7cfb\u7edf"),r.a.createElement("option",{value:"light"},"\u59cb\u7ec8\u6d45\u8272\u6a21\u5f0f"),r.a.createElement("option",{value:"dark"},"\u59cb\u7ec8\u6df1\u8272\u6a21\u5f0f")),"\xa0",r.a.createElement("small",null,"#color_scheme")),r.a.createElement("p",{className:"config-description"},"\u9009\u62e9\u6d45\u8272\u6216\u6df1\u8272\u6a21\u5f0f\uff0c\u6df1\u8272\u6a21\u5f0f\u4e0b\u5c06\u4f1a\u8c03\u6697\u56fe\u7247\u4eae\u5ea6"))}}]),a}(n.PureComponent),ke=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state=Object(m.a)({},e.id,n.props.display(window.config[e.id])),n}return Object(l.a)(a,[{key:"copy_value",value:function(){v()(this.state[this.props.id])&&alert("\u6210\u529f\u5c06".concat(this.props.name,"\u7684\u5185\u5bb9\u590d\u5236\u5230\u526a\u8d34\u677f\uff01\n\u8bf7\u4e00\u5b9a\u4e0d\u8981\u6cc4\u9732\u54e6"))}},{key:"on_blur",value:function(e){var t=this,a=e.target.value,n=this.props.parse(a);this.setState(Object(m.a)({},this.props.id,a),(function(){t.props.callback(Object(m.a)({},t.props.id,n))}))}},{key:"on_change",value:function(e){var t=this,a=e.target.value;this.setState((function(e){return Object(m.a)({},t.props.id,a)}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("label",null,r.a.createElement("p",null,r.a.createElement("b",null,this.props.name),"\xa0",r.a.createElement("small",null,"#",this.props.id),r.a.createElement("a",{style:{float:"right"},onClick:this.copy_value.bind(this)},r.a.createElement("small",null,"\u590d\u5236"))),r.a.createElement("p",{className:"config-description"},this.props.description),r.a.createElement("textarea",{name:"config-"+this.props.id,id:"config-textarea-".concat(this.props.id),className:"config-textarea",value:this.state[this.props.id],onChange:this.on_change.bind(this),onBlur:this.on_blur.bind(this)})))}}]),a}(n.PureComponent),Ae=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={switch:window.config[n.props.id]},n}return Object(l.a)(a,[{key:"on_change",value:function(e){var t=this,a=e.target.checked;this.setState({switch:a},(function(){t.props.callback(Object(m.a)({},t.props.id,a))}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("label",null,r.a.createElement("input",{name:"config-"+this.props.id,type:"checkbox",checked:this.state.switch,onChange:this.on_change.bind(this)}),"\xa0",r.a.createElement("b",null,this.props.name),"\xa0",r.a.createElement("small",null,"#",this.props.id))),r.a.createElement("p",{className:"config-description"},this.props.description))}}]),a}(n.PureComponent),we=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).save_changes_bound=n.save_changes.bind(Object(c.a)(n)),n}return Object(l.a)(a,[{key:"save_changes",value:function(e){console.log(e),Object.keys(e).forEach((function(t){window.config[t]=e[t]})),Ee()}},{key:"reset_settings",value:function(){window.confirm("\u91cd\u7f6e\u6240\u6709\u8bbe\u7f6e\uff1f")&&(window.config={},Ee(),window.location.reload())}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"box config-ui-header"},r.a.createElement("p",null,"\u8fd9\u4e9b\u529f\u80fd\u4ecd\u5728\u6d4b\u8bd5\uff0c\u53ef\u80fd\u4e0d\u7a33\u5b9a\uff08",r.a.createElement("a",{onClick:this.reset_settings.bind(this)},"\u5168\u90e8\u91cd\u7f6e"),"\uff09"),r.a.createElement("p",null,r.a.createElement("b",null,"\u4fee\u6539\u8bbe\u7f6e\u540e"," ",r.a.createElement("a",{onClick:function(){window.location.reload()}},"\u5237\u65b0\u9875\u9762")," ","\u65b9\u53ef\u751f\u6548"))),r.a.createElement("div",{className:"box"},r.a.createElement(ge,{id:"background",callback:this.save_changes_bound}),r.a.createElement("hr",null),r.a.createElement(ve,{id:"color-scheme",callback:this.save_changes_bound}),r.a.createElement("hr",null),r.a.createElement(Ae,{callback:this.save_changes_bound,id:"pressure",name:"\u5feb\u901f\u8fd4\u56de",description:"\u77ed\u6682\u6309\u4f4f Esc \u952e\u6216\u91cd\u538b\u5c4f\u5e55\uff083D Touch\uff09\u53ef\u4ee5\u5feb\u901f\u8fd4\u56de\u6216\u8005\u5237\u65b0\u6811\u6d1e"}),r.a.createElement("hr",null),r.a.createElement(Ae,{callback:this.save_changes_bound,id:"easter_egg",name:"\u5141\u8bb8\u5f69\u86cb",description:"\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u663e\u793a\u5f69\u86cb"})),r.a.createElement("div",{className:"box"},r.a.createElement(ke,{id:"block_words",callback:this.save_changes_bound,name:"\u8bbe\u7f6e\u5c4f\u853d\u8bcd",description:"\u5305\u542b\u5c4f\u853d\u8bcd\u7684\u6811\u6d1e\u4f1a\u88ab\u6298\u53e0\uff0c\u6bcf\u884c\u5199\u4e00\u4e2a\u5c4f\u853d\u8bcd",display:function(e){return e.join("\n")},parse:function(e){return e.split("\n").filter((function(e){return e}))}}),r.a.createElement("hr",null),r.a.createElement(ke,{id:"alias",callback:this.save_changes_bound,name:"\u8bbe\u7f6e\u522b\u540d",description:"\u53ef\u7528 #\u522b\u540d \u4ee3\u66ff #PID\uff08\u6811\u6d1e\u53f7\uff09\u8fdb\u884c\u67e5\u8be2\uff0c\u6bcf\u884c\u7531\u6811\u6d1e\u53f7\u3001\u534a\u89d2\u7a7a\u683c\u3001\u522b\u540d\u987a\u5e8f\u8fde\u63a5\uff0c\u5982\u201c472865 \u7f51\u9875\u7248\u53d1\u5e03\u201d\uff0c\u522b\u540d\u4e2d\u4e0d\u53ef\u5305\u542b\u7a7a\u683c",display:function(e){return Object.entries(e).map((function(e){return e[1]+" "+e[0]})).reduce((function(e,t){return e?t+"\n"+e:t}),"")},parse:function(e){var t={};return e.split("\n").filter((function(e){return e})).forEach((function(e){var a=e.split(" ");2!==a.length||isNaN(Number(a[0]))||(t[a[1]]=Number(a[0]))})),t}}),r.a.createElement("hr",null),r.a.createElement(Ae,{callback:this.save_changes_bound,id:"attention_sort",name:"\u5173\u6ce8\u5217\u8868\u6392\u5e8f",description:"\u542f\u7528\u540e\uff0c\u53ef\u4ee5\u5c06\u5173\u6ce8\u5217\u8868\u6309\u6700\u540e\u56de\u590d\u65f6\u95f4\u6392\u5e8f\u3002\u4e0d\u5efa\u8bae\u5728\u6027\u80fd\u8f83\u5dee\u7684\u8bbe\u5907\u4e0a\u542f\u7528"})),r.a.createElement("div",{className:"box"},r.a.createElement("p",null,"\u65b0\u529f\u80fd\u5efa\u8bae\u6216\u95ee\u9898\u53cd\u9988\u8bf7\u5728\xa0",r.a.createElement("a",{href:"https://github.com/AllanChain/PKUHoleCommunity/issues",target:"_blank"},"GitHub ",r.a.createElement("span",{className:"icon icon-github"})),"\xa0\u63d0\u51fa\u3002")))}}]),a}(n.PureComponent),Oe=a(33),ye=a.n(Oe),Ce=(a(61),r.a.createContext({value:null,set_value:function(){}})),Pe=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),n=t.call(this,e),window._life_info_cache||(window._life_info_cache={}),n.CACHE_TIMEOUT_S=15,n.state={today_info:n.cache_get("today_info"),card_balance:n.cache_get("card_balance"),net_balance:n.cache_get("net_balance"),mail_count:n.cache_get("mail_count")},n.INTERNAL_NETWORK_FAILURE="_network_failure",n.API_NAME={today_info:"hole/today_info",card_balance:"isop/card_balance",net_balance:"isop/net_balance",mail_count:"isop/mail_count"},n}return Object(l.a)(a,[{key:"cache_get",value:function(e){var t=window._life_info_cache[e];return!t||+new Date-t[0]>1e3*this.CACHE_TIMEOUT_S?null:t[1]}},{key:"cache_set",value:function(e,t){window._life_info_cache[e]&&window._life_info_cache[e][1]===t||(window._life_info_cache[e]=[+new Date,t])}},{key:"load",value:function(e){var t=this;this.setState(Object(m.a)({},e,null),(function(){fetch(I.a+"api_xmcp/"+t.API_NAME[e]+"?user_token="+encodeURIComponent(t.props.token)+Object(U.a)()).then(U.b).then((function(a){t.setState(Object(m.a)({},e,a))})).catch((function(a){t.setState(Object(m.a)({},e,{errMsg:"\u7f51\u7edc\u9519\u8bef "+a,errCode:t.INTERNAL_NETWORK_FAILURE,success:!1}))}))}))}},{key:"componentDidMount",value:function(){var e=this;["today_info","card_balance","net_balance","mail_count"].forEach((function(t){e.state[t]||e.load(t)}))}},{key:"reload_all",value:function(){var e=this;["today_info","card_balance","net_balance","mail_count"].forEach((function(t){e.load(t)}))}},{key:"render_line",value:function(e,t,a,n,o,i){var s=this,l=this.state[e];if(l){if(l.success)return this.cache_set(e,l),r.a.createElement("tr",null,r.a.createElement("td",null,t),r.a.createElement("td",null,a(l)),r.a.createElement("td",null,r.a.createElement("a",{href:o(l),target:"_blank"},r.a.createElement("span",{className:"icon icon-forward"}),"\xa0",n)));var c="\u52a0\u8f7d\u5931\u8d25";l.errCode===this.INTERNAL_NETWORK_FAILURE?c="\u7f51\u7edc\u9519\u8bef":-1!==["E01","E02","E03"].indexOf(l.errCode)&&(c="\u6388\u6743\u5931\u6548");var _=JSON.stringify(l);return l.errMsg?_=l.errMsg:l.error&&(_=l.error),r.a.createElement("tr",null,r.a.createElement("td",null,t),r.a.createElement("td",{className:"life-info-error"},r.a.createElement("a",{onClick:function(){return alert(_)}},c)),r.a.createElement("td",null,"\u6388\u6743\u5931\u6548"===c?r.a.createElement("a",{onClick:i},r.a.createElement("span",{className:"icon icon-forward"}),"\xa0\u91cd\u65b0\u767b\u5f55"):r.a.createElement("a",{onClick:function(){return s.load(e)}},r.a.createElement("span",{className:"icon icon-forward"}),"\xa0\u91cd\u8bd5")))}return r.a.createElement("tr",null,r.a.createElement("td",null,t),r.a.createElement("td",null,"\u52a0\u8f7d\u4e2d\u2026\u2026"),r.a.createElement("td",null))}},{key:"render",value:function(){var e=this;return r.a.createElement(M.b,{token_callback:function(t){e.props.set_token(t),e.reload_all()}},(function(t){return r.a.createElement("div",{className:"box"},r.a.createElement("table",{className:"life-info-table"},r.a.createElement("tbody",null,e.render_line("today_info","\u4eca\u65e5",(function(e){return e.info}),"\u6821\u5386",(function(e){return e.schedule_url}),t),e.render_line("card_balance","\u6821\u56ed\u5361",(function(e){return"\u4f59\u989d\uffe5".concat(e.balance.toFixed(2))}),"\u5145\u503c",(function(){return"https://virtualprod.alipay.com/educate/educatePcRecharge.htm?schoolCode=PKU&schoolName="}),t),e.render_line("net_balance","\u7f51\u8d39",(function(e){return"\u4f59\u989d\uffe5".concat(e.balance.toFixed(2))}),"\u5145\u503c",(function(){return"https://its.pku.edu.cn/epay.jsp"}),t),e.render_line("mail_count","\u90ae\u4ef6",(function(e){return"\u672a\u8bfb ".concat(e.count," \u5c01")}),"\u67e5\u770b",(function(){return"https://mail.pku.edu.cn/"}),t))))}))}}]),a}(n.Component);function De(e){return r.a.createElement("div",null,r.a.createElement(G,null),r.a.createElement(Ue,{show_sidebar:e.show_sidebar}),r.a.createElement("div",{className:"box list-menu"},r.a.createElement("a",{onClick:function(){e.show_sidebar("\u8bbe\u7f6e",r.a.createElement(we,null))}},r.a.createElement("span",{className:"icon icon-settings"}),r.a.createElement("label",null,"\u7f51\u9875\u7248\u6811\u6d1e\u8bbe\u7f6e")),"\xa0\xa0",r.a.createElement("a",{href:"http://pkuhelper.pku.edu.cn/treehole_rules.html",target:"_blank"},r.a.createElement("span",{className:"icon icon-textfile"}),r.a.createElement("label",null,"\u6811\u6d1e\u89c4\u8303")),"\xa0\xa0",r.a.createElement("a",{href:"https://github.com/AllanChain/PKUHoleCommunity/issues",target:"_blank"},r.a.createElement("span",{className:"icon icon-github"}),r.a.createElement("label",null,"\u610f\u89c1\u53cd\u9988"))),r.a.createElement("div",{className:"box help-desc-box"},r.a.createElement("p",null,"PKUHelper \u7f51\u9875\u7248\u6811\u6d1e\u793e\u533a\u7248 by @xmcp, and awesome community. \u57fa\u4e8e\xa0",r.a.createElement("a",{href:"https://www.gnu.org/licenses/gpl-3.0.zh-cn.html",target:"_blank"},"GPLv3"),"\xa0\u534f\u8bae\u5728"," ",r.a.createElement("a",{href:"https://github.com/AllanChain/PKUHoleCommunity",target:"_blank"},"GitHub")," ","\u5f00\u6e90"),r.a.createElement("p",null,"PKUHelper \u7f51\u9875\u7248\u7684\u8bde\u751f\u79bb\u4e0d\u5f00\xa0",r.a.createElement("a",{href:"https://reactjs.org/",target:"_blank",rel:"noopener"},"React"),"\u3001",r.a.createElement("a",{href:"https://icomoon.io/#icons",target:"_blank",rel:"noopener"},"IcoMoon"),"\xa0\u7b49\u5f00\u6e90\u9879\u76ee"),r.a.createElement("p",null,"PKU Helper \u7684\u201c\u540c\u610f\u201d"),r.a.createElement("blockquote",null,r.a.createElement("p",null,"\u6839\u636e GPL\uff0c\u4f60\u6709\u6743 fork\u3010\u7f51\u9875\u7248\u6811\u6d1e\u524d\u7aef\u3011\u7684\u4ee3\u7801\u5e76\u8fdb\u884c\u76f8\u5e94\u7684\u4fee\u6539\u3002 \u8bf7\u6ce8\u610f\uff0c\u4f60\u7684\u4fee\u6539\u7248\u672c\u5fc5\u987b\u4f9d\u7136\u57fa\u4e8e GPL \u6388\u6743\uff0c\u5e76\u4f9d\u636e\u6b64\u516c\u5f00\u6e90\u7801\u3002"),r.a.createElement("p",null,"\u6839\u636e\u6811\u6d1e\u89c4\u8303 5.3 \u89c4\u5b9a\uff0c\u975e\u5b98\u65b9\u5ba2\u6237\u7aef\u5728 PKU Helper \u56e2\u961f\u8ba4\u5b9a\u9020\u6210\u4e0d\u5229\u5f71\u54cd\uff0c \u4f8b\u5982\u975e\u6cd5\u653b\u51fb\u670d\u52a1\u5668\u3001\u76d7\u53d6\u7528\u6237\u4e2a\u4eba\u4fe1\u606f\u65f6\uff0c\u6211\u4eec\u6709\u6743\u5bf9\u5176\u8fdb\u884c\u5c01\u7981\u3002")),r.a.createElement("p",null,"\u7528\u6237\u9700\u5bf9\u4e0d\u6070\u5f53\u4f7f\u7528\u6b64\u7248\u672c\u6216\u5229\u7528\u6b64\u7248\u672c\u7684\u6f0f\u6d1e\u5bf9 PKU Helper \u9020\u6210\u7684\u4e0d\u5229\u5f71\u54cd\u627f\u62c5\u98ce\u9669\u3002 \u4f5c\u4e3a\u793e\u533a\u7248\u672c\uff0c\u793e\u533a\uff08no warranty\uff09\u7ef4\u62a4\u7248\u672c\u7684\u5b89\u5168\uff0c\u540c\u65f6\u4e5f\u6b22\u8fce\u540c\u5b66\u5b9e\u73b0\u4f60\u7684\u60f3\u6cd5\u3002"),r.a.createElement("p",null,r.a.createElement("a",{onClick:function(){"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((function(e){var t,a=Object(h.a)(e);try{for(a.s();!(t=a.n()).done;){var n=t.value;console.log("unregister",n),n.unregister()}}catch(r){a.e(r)}finally{a.f()}})),x().clear(),setTimeout((function(){window.location.reload(!0)}),200)}},"\u5f3a\u5236\u68c0\u67e5\u66f4\u65b0"),"\uff08Community v","0.5.1"," ","production"," \u4f1a\u81ea\u52a8\u5728\u540e\u53f0\u68c0\u67e5\u66f4\u65b0\u5e76\u5728\u4e0b\u6b21\u8bbf\u95ee\u65f6\u66f4\u65b0\uff09")))}var Me=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={loading_status:"done"},n}return Object(l.a)(a,[{key:"do_reset",value:function(){var e=this;if(window.confirm("\u60a8\u6b63\u5728\u91cd\u7f6e UserToken\uff01\n\u60a8\u7684\u8d26\u53f7\u5c06\u4f1a\u5728\u3010\u6240\u6709\u8bbe\u5907\u3011\u4e0a\u6ce8\u9500\uff0c\u60a8\u9700\u8981\u624b\u52a8\u91cd\u65b0\u767b\u5f55\uff01")){var t=window.prompt("\u60a8\u6b63\u5728\u91cd\u7f6e UserToken\uff01\n\u8bf7\u8f93\u5165\u60a8\u7684\u5b66\u53f7\u4ee5\u786e\u8ba4\u8eab\u4efd\uff1a");t&&this.setState({loading_status:"loading"},(function(){fetch(I.a+"api_xmcp/hole/reset_usertoken",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_token:e.props.token,uid:t})}).then(U.b).then((function(t){if(t.error)throw new Error(t.error);alert("\u91cd\u7f6e\u6210\u529f\uff01\u60a8\u9700\u8981\u5728\u6240\u6709\u8bbe\u5907\u4e0a\u91cd\u65b0\u767b\u5f55\u3002"),e.setState({loading_status:"done"})})).catch((function(t){alert("\u91cd\u7f6e\u5931\u8d25\uff1a"+t),e.setState({loading_status:"done"})}))}))}}},{key:"render",value:function(){return"done"===this.state.loading_status?r.a.createElement("a",{onClick:this.do_reset.bind(this)},"\u91cd\u7f6e"):"loading"===this.state.loading_status?r.a.createElement("a",null,r.a.createElement("span",{className:"icon icon-loading"})):void 0}}]),a}(n.Component),Ue=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"copy_token",value:function(e){v()(e)&&alert("\u590d\u5236\u6210\u529f\uff01\n\u8bf7\u4e00\u5b9a\u4e0d\u8981\u6cc4\u9732\u54e6")}},{key:"render",value:function(){var e=this;return r.a.createElement(Ce.Consumer,null,(function(t){return r.a.createElement("div",null,!!t.value&&r.a.createElement(Pe,{token:t.value,set_token:t.set_value}),r.a.createElement("div",{className:"login-form box"},t.value?r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("b",null,"\u60a8\u5df2\u767b\u5f55\u3002"),r.a.createElement("button",{type:"button",onClick:function(){t.set_value(null)}},r.a.createElement("span",{className:"icon icon-logout"})," \u6ce8\u9500"),r.a.createElement("br",null)),r.a.createElement("p",null,"\u6839\u636e\u8ba1\u7b97\u4e2d\u5fc3\u8981\u6c42\uff0c\u8bbf\u95ee\u6388\u6743\u4e09\u4e2a\u6708\u5185\u6709\u6548\uff0c\u8fc7\u671f\u9700\u91cd\u65b0\u767b\u5f55\u3002"),r.a.createElement("p",null,r.a.createElement("a",{onClick:function(){e.props.show_sidebar("\u7cfb\u7edf\u6d88\u606f",r.a.createElement(de,{token:t.value}))}},"\u67e5\u770b\u7cfb\u7edf\u6d88\u606f"),r.a.createElement("br",null),"\u5f53\u60a8\u53d1\u9001\u7684\u5185\u5bb9\u8fdd\u89c4\u65f6\uff0c\u6211\u4eec\u5c06\u7528\u7cfb\u7edf\u6d88\u606f\u63d0\u793a\u60a8"),r.a.createElement("p",null,r.a.createElement("a",{onClick:e.copy_token.bind(e,t.value)},"\u590d\u5236 User Token"),r.a.createElement("br",null),"User Token \u7528\u4e8e\u8fc1\u79fb\u767b\u5f55\u72b6\u6001\uff0c\u5207\u52ff\u544a\u77e5\u4ed6\u4eba\uff0c\u82e5\u6000\u7591\u88ab\u76d7\u53f7\u8bf7\u5c3d\u5feb"," ",r.a.createElement(Me,{token:t.value}))):r.a.createElement(M.b,{token_callback:t.set_value},(function(e){return r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("button",{type:"button",onClick:e},r.a.createElement("span",{className:"icon icon-login"}),"\xa0\u767b\u5f55")),r.a.createElement("p",null,r.a.createElement("small",null,"PKU Helper \u9762\u5411\u5317\u4eac\u5927\u5b66\u5b66\u751f\uff0c\u901a\u8fc7 ISOP\uff08\u5317\u4eac\u5927\u5b66\u6570\u636e\u5171\u4eab\u5f00\u653e\u670d\u52a1\u5e73\u53f0\uff09\u9a8c\u8bc1\u60a8\u7684\u8eab\u4efd\u5e76\u63d0\u4f9b\u670d\u52a1\u3002")))}))))}))}}]),a}(n.Component),Ie=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={text:"",loading_status:"done"},n.on_change_bound=n.on_change.bind(Object(c.a)(n)),n.area_ref=n.props.area_ref||r.a.createRef(),n.global_keypress_handler_bound=n.global_keypress_handler.bind(Object(c.a)(n)),n}return Object(l.a)(a,[{key:"global_keypress_handler",value:function(e){"Enter"!==e.code||e.ctrlKey||e.altKey||-1!==["input","textarea"].indexOf(e.target.tagName.toLowerCase())||this.area_ref.current&&(e.preventDefault(),this.area_ref.current.focus())}},{key:"componentDidMount",value:function(){document.addEventListener("keypress",this.global_keypress_handler_bound)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keypress",this.global_keypress_handler_bound)}},{key:"on_change",value:function(e){this.setState({text:e})}},{key:"on_submit",value:function(e){var t=this;if(e&&e.preventDefault(),"loading"!==this.state.loading_status){this.setState({loading_status:"loading"});var a=new URLSearchParams;a.append("pid",this.props.pid),a.append("text",this.state.text),a.append("user_token",this.props.token),fetch(L+"/api.php?action=docomment"+N(this.props.token),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a}).then(U.b).then((function(e){if(0!==e.code)throw e.msg&&alert(e.msg),new Error(JSON.stringify(e));t.setState({loading_status:"done",text:""}),t.area_ref.current.clear(),t.props.on_complete()})).catch((function(e){console.error(e),alert("\u56de\u590d\u5931\u8d25"),t.setState({loading_status:"done"})}))}}},{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.on_submit.bind(this),className:"reply-form box"+(this.state.text?" reply-sticky":"")},r.a.createElement(Q,{key:this.props.pid,ref:this.area_ref,id:this.props.pid,on_change:this.on_change_bound,on_submit:this.on_submit.bind(this)}),"loading"===this.state.loading_status?r.a.createElement("button",{disabled:"disabled"},r.a.createElement("span",{className:"icon icon-loading"})):r.a.createElement("button",{type:"submit"},r.a.createElement("span",{className:"icon icon-send"})))}}]),a}(n.Component),Re=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={text:"",loading_status:"done",img_tip:null},n.img_ref=r.a.createRef(),n.area_ref=r.a.createRef(),n.on_change_bound=n.on_change.bind(Object(c.a)(n)),n.on_img_change_bound=n.on_img_change.bind(Object(c.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.area_ref.current&&this.area_ref.current.focus()}},{key:"on_change",value:function(e){this.setState({text:e})}},{key:"do_post",value:function(e,t){var a=this,n=new URLSearchParams;n.append("text",this.state.text),n.append("type",t?"image":"text"),n.append("user_token",this.props.token),t&&n.append("data",t),fetch(L+"/api.php?action=dopost"+N(this.props.token),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n}).then(U.b).then((function(e){if(0!==e.code)throw e.msg&&alert(e.msg),new Error(JSON.stringify(e));a.setState({loading_status:"done",text:""}),a.area_ref.current.clear(),a.props.on_complete()})).catch((function(e){console.error(e),alert("\u53d1\u8868\u5931\u8d25"),a.setState({loading_status:"done"})}))}},{key:"proc_img",value:function(e){return new Promise((function(t,a){function n(e){var t=e.indexOf(";base64,");if(-1===t)throw new Error("img not base64 encoded");return e.substr(t+8)}var r=new FileReader;r.onload=function(e){ye()(e.target.result,{},(function(e){!function(e){var r=new Image;r.onload=function(){var e=r.width,o=r.height,i=!1;if(e>8e3&&(o=8e3*o/e,e=8e3,i=!0),o>8e3&&(e=8e3*e/o,o=8e3,i=!0),o*e>5e6){var s=Math.sqrt(o*e/5e6);o/=s,e/=s,i=!0}console.log("chosen img size",e,o);var l=document.createElement("canvas"),c=l.getContext("2d");l.width=e,l.height=o,c.drawImage(r,0,0,e,o);for(var _,u,p=.1,d=.9;d-p>=.03;)_=(d+p)/2,u=l.toDataURL("image/jpeg",_),console.log(p,d,"trying quality",_,"size",u.length),u.length<=6e5?p=_:d=_;p>=.101?(console.log("chosen img quality",_),t({img:n(u),quality:_,width:Math.round(e),height:Math.round(o),compressed:i})):a("\u56fe\u7247\u8fc7\u5927\uff0c\u65e0\u6cd5\u4e0a\u4f20")},r.src=e}(e)}))},r.readAsDataURL(e)}))}},{key:"on_img_change",value:function(){var e=this;this.img_ref.current&&this.img_ref.current.files.length?this.setState({img_tip:"\uff08\u6b63\u5728\u5904\u7406\u56fe\u7247\u2026\u2026\uff09"},(function(){e.proc_img(e.img_ref.current.files[0]).then((function(t){e.setState({img_tip:"\uff08".concat(t.compressed?"\u538b\u7f29\u5230":"\u5c3a\u5bf8"," ").concat(t.width,"*").concat(t.height," / ")+"\u8d28\u91cf ".concat(Math.floor(100*t.quality),"% / ").concat(Math.floor(t.img.length/(4/3)/1e3),"KB\uff09")})})).catch((function(t){e.setState({img_tip:"\u56fe\u7247\u65e0\u6548\uff1a".concat(t)})}))})):this.setState({img_tip:null})}},{key:"on_submit",value:function(e){var t=this;e&&e.preventDefault(),"loading"!==this.state.loading_status&&(this.img_ref.current.files.length?(this.setState({loading_status:"processing"}),this.proc_img(this.img_ref.current.files[0]).then((function(e){t.setState({loading_status:"loading"}),t.do_post(t.state.text,e.img)})).catch((function(e){alert(e)}))):(this.setState({loading_status:"loading"}),this.do_post(this.state.text,null)))}},{key:"render",value:function(){var e=this;return r.a.createElement("form",{onSubmit:this.on_submit.bind(this),className:"post-form box"},r.a.createElement("div",{className:"post-form-bar"},r.a.createElement("label",null,"\u56fe\u7247",r.a.createElement("input",{ref:this.img_ref,type:"file",accept:"image/*",disabled:"done"!==this.state.loading_status,onChange:this.on_img_change_bound})),"done"!==this.state.loading_status?r.a.createElement("button",{disabled:"disabled"},r.a.createElement("span",{className:"icon icon-loading"}),"\xa0\u6b63\u5728","processing"===this.state.loading_status?"\u5904\u7406":"\u4e0a\u4f20"):r.a.createElement("button",{type:"submit"},r.a.createElement("span",{className:"icon icon-send"}),"\xa0\u53d1\u8868")),!!this.state.img_tip&&r.a.createElement("p",{className:"post-form-img-tip"},r.a.createElement("a",{onClick:function(){e.img_ref.current.value="",e.on_img_change()}},"\u5220\u9664\u56fe\u7247"),this.state.img_tip),r.a.createElement(Q,{ref:this.area_ref,id:"new_post",on_change:this.on_change_bound,on_submit:this.on_submit.bind(this)}),r.a.createElement("p",null,r.a.createElement("small",null,"\u8bf7\u9075\u5b88",r.a.createElement("a",{href:"http://pkuhelper.pku.edu.cn/treehole_rules.html",target:"_blank"},"\u6811\u6d1e\u7ba1\u7406\u89c4\u8303"),"\uff0c\u6587\u660e\u53d1\u8a00")))}}]),a}(n.Component),xe=I.a+"services/pkuhole/images/",Ne=I.a+"services/pkuhole/audios/",Te={a:!0,audio:!0},Ke=["23333","233333","66666","666666","10086","10000","100000","99999","999999","55555","555555"];window.LATEST_POST_ID=parseInt(localStorage._LATEST_POST_ID,10)||0;function je(e,t){return function(){var a=Object(b.a)(E.a.mark((function a(n){var o,i,s,l,c,_,u=arguments;return E.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o=u.length>1&&void 0!==u[1]&&u[1],i=new w,e(s="\u6811\u6d1e #"+n,r.a.createElement("div",{className:"box box-tip"},"\u6b63\u5728\u52a0\u8f7d #",n),o?"replace":"push"),a.prev=4,a.next=7,j.get_single(n,t);case 7:return(l=a.sent).data.variant={},a.next=11,j.load_replies_with_cache(n,t,i,parseInt(l.data.reply));case 11:c=a.sent,_=c.data,e(s,r.a.createElement(We,{key:+new Date,info:l.data,replies:_.data,attention:_.attention,token:t,show_sidebar:e,color_picker:i,deletion_detect:"on"===localStorage.DELETION_DETECT}),"replace"),a.next=20;break;case 16:a.prev=16,a.t0=a.catch(4),console.error(a.t0),e(s,r.a.createElement("div",{className:"box box-tip"},r.a.createElement("p",null,r.a.createElement("a",{onClick:function(){return je(e,t)(n,!0)}},"\u91cd\u65b0\u52a0\u8f7d")),r.a.createElement("p",null,""+a.t0)),"replace");case 20:case"end":return a.stop()}}),a,null,[[4,16]])})));return function(e){return a.apply(this,arguments)}}()}var Le=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){return Object(s.a)(this,a),t.call(this,e)}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=D(this.props.info.text,[["url_pid",y],["url",P],["pid",O],["nickname",C]]);return r.a.createElement("div",{className:"flow-reply box",style:this.props.info._display_color?{"--box-bgcolor-light":this.props.info._display_color[0],"--box-bgcolor-dark":this.props.info._display_color[1]}:null},r.a.createElement("div",{className:"box-header"},r.a.createElement("code",{className:"box-id"},"#",this.props.info.cid),!!this.props.do_filter_name&&r.a.createElement("span",{className:"reply-header-badge clickable",onClick:function(){e.props.do_filter_name(e.props.info.name)}},r.a.createElement("span",{className:"icon icon-locate"})),"\xa0",null!==this.props.info.tag&&r.a.createElement("span",{className:"box-header-tag"},this.props.info.tag),r.a.createElement(M.c,{stamp:this.props.info.timestamp})),r.a.createElement("div",{className:"box-content"},r.a.createElement(H,{parts:t,color_picker:this.props.color_picker,show_pid:this.props.show_pid})))}}]),a}(n.PureComponent),Se=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){return Object(s.a)(this,a),t.call(this,e)}return Object(l.a)(a,[{key:"copy_link",value:function(e){e.preventDefault(),v()("".concat(e.target.href).concat(this.props.info.tag?" \u3010"+this.props.info.tag+"\u3011":"","\n")+"".concat(this.props.info.text).concat("image"===this.props.info.type?" [\u56fe\u7247]":"audio"===this.props.info.type?" [\u8bed\u97f3]":"","\n")+"\uff08".concat(Object(M.e)(new Date(1e3*this.props.info.timestamp))," ").concat(this.props.info.likenum,"\u5173\u6ce8 ").concat(this.props.info.reply,"\u56de\u590d\uff09\n")+this.props.replies.map((function(e){return(e.tag?"\u3010"+e.tag+"\u3011":"")+e.text})).join("\n"))}},{key:"render",value:function(){var e=this,t=this.props,a=t.parts||D(t.info.text,[["url_pid",y],["url",P],["pid",O],["nickname",C]]);return r.a.createElement("div",{className:"flow-item"+(t.is_quote?" flow-item-quote":"")},!!t.is_quote&&r.a.createElement("div",{className:"quote-tip black-outline"},r.a.createElement("div",null,r.a.createElement("span",{className:"icon icon-quote"})),r.a.createElement("div",null,r.a.createElement("small",null,"\u63d0\u5230"))),r.a.createElement("div",{className:"box"},!!window.LATEST_POST_ID&&parseInt(t.info.pid,10)>window.LATEST_POST_ID&&r.a.createElement("div",{className:"flow-item-dot"}),!!this.props.attention&&!this.props.cached&&r.a.createElement("div",{className:"flow-item-dot"}),r.a.createElement("div",{className:"box-header"},!!this.props.do_filter_name&&r.a.createElement("span",{className:"reply-header-badge clickable",onClick:function(){e.props.do_filter_name("\u6d1e\u4e3b")}},r.a.createElement("span",{className:"icon icon-locate"})),!!parseInt(t.info.likenum,10)&&r.a.createElement("span",{className:"box-header-badge"},t.info.likenum,"\xa0",r.a.createElement("span",{className:"icon icon-"+(t.attention?"star-ok":"star")})),!!parseInt(t.info.reply,10)&&r.a.createElement("span",{className:"box-header-badge"},t.info.reply,"\xa0",r.a.createElement("span",{className:"icon icon-reply"})),r.a.createElement("code",{className:"box-id"},r.a.createElement("a",{href:"##"+t.info.pid,onClick:this.copy_link.bind(this)},"#",t.info.pid)),"\xa0",null!==t.info.tag&&r.a.createElement("span",{className:"box-header-tag"},t.info.tag),r.a.createElement(M.c,{stamp:t.info.timestamp})),r.a.createElement("div",{className:"box-content"},r.a.createElement(H,{parts:a,color_picker:t.color_picker,show_pid:t.show_pid}),"image"===t.info.type&&r.a.createElement("p",{className:"img"},t.img_clickable?r.a.createElement("a",{className:"no-underline",href:xe+t.info.url,target:"_blank"},r.a.createElement("img",{src:xe+t.info.url})):r.a.createElement("img",{src:xe+t.info.url})),"audio"===t.info.type&&r.a.createElement(pe,{src:Ne+t.info.url})),!(!t.attention||!t.info.variant.latest_reply)&&r.a.createElement("p",{className:"box-footer"},"\u6700\u65b0\u56de\u590d ",r.a.createElement(M.c,{stamp:t.info.variant.latest_reply}))))}}]),a}(n.PureComponent),We=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={attention:e.attention,info:e.info,replies:e.replies,loading_status:"done",error_msg:null,filter_name:null,rev:!1},n.color_picker=e.color_picker,n.syncState=e.sync_state||function(){},n.reply_ref=r.a.createRef(),n}return Object(l.a)(a,[{key:"set_variant",value:function(e,t){this.setState((function(a){return e?{replies:a.replies.map((function(a){return a.cid===e?Object.assign({},a,{variant:Object.assign({},a.variant,t)}):a}))}:{info:Object.assign({},a.info,{variant:Object.assign({},a.info.variant,t)})}}),(function(){this.syncState({info:this.state.info,replies:this.state.replies})}))}},{key:"load_replies",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState({loading_status:"loading",error_msg:null}),j.load_replies(this.state.info.pid,this.props.token,this.color_picker,null).then((function(a){e.setState((function(e,n){return{replies:a.data,info:t?Object.assign({},e.info,{reply:""+a.data.length}):e.info,attention:!!a.attention,loading_status:"done",error_msg:null}}),(function(){e.syncState({replies:e.state.replies,attention:e.state.attention,info:e.state.info}),e.state.replies.length&&e.set_variant(null,{latest_reply:Math.max.apply(null,e.state.replies.map((function(e){return parseInt(e.timestamp)})))})}))})).catch((function(t){console.error(t),e.setState({replies:[],loading_status:"done",error_msg:""+t})}))}},{key:"toggle_attention",value:function(){var e=this;this.setState({loading_status:"loading"});var t=!this.state.attention;j.set_attention(this.state.info.pid,t,this.props.token).then((function(a){e.setState({loading_status:"done",attention:t}),e.syncState({attention:t})})).catch((function(t){e.setState({loading_status:"done"}),alert("\u8bbe\u7f6e\u5173\u6ce8\u5931\u8d25"),console.error(t)}))}},{key:"report",value:function(){var e=prompt("\u4e3e\u62a5 #".concat(this.state.info.pid," \u7684\u7406\u7531\uff1a"));null!==e&&j.report(this.state.info.pid,e,this.props.token).then((function(e){alert("\u4e3e\u62a5\u6210\u529f")})).catch((function(e){alert("\u4e3e\u62a5\u5931\u8d25"),console.error(e)}))}},{key:"set_alias",value:function(){fe();var e=prompt("\u7ed9 #".concat(this.state.info.pid," \u6dfb\u52a0\u522b\u540d\uff1a"));if(null!==e){if(e.includes(" "))return alert("\u522b\u540d\u4e0d\u5408\u6cd5\uff0c\u8bbe\u7f6e\u522b\u540d\u5931\u8d25");var t=!0;e in window.config.alias&&this.state.info.pid!==window.config.alias[e]&&(t=confirm("\u662f\u5426\u5c06\u201c#".concat(e,"\u201d\u4ece #").concat(window.config.alias[e]," ")+"\u6539\u4e3a #".concat(this.state.info.pid,"\uff1f"))),t&&(window.config.alias[e]=this.state.info.pid,Ee())}}},{key:"set_filter_name",value:function(e){this.setState((function(t){return{filter_name:e===t.filter_name?null:e}}))}},{key:"toggle_rev",value:function(){this.setState((function(e){return{rev:!e.rev}}),ie)}},{key:"show_reply_bar",value:function(e,t){if(this.reply_ref.current&&!t.target.closest("a, .clickable")){var a=this.reply_ref.current.get();if(/^\s*(?:Re (?:|\u6d1e\u4e3b|(?:[A-Z][a-z]+ )?(?:[A-Z][a-z]+)|You Win(?: \d+)?):)?\s*$/.test(a)){var n="Re "+e+": ";n===this.reply_ref.current.get()?this.reply_ref.current.set(""):this.reply_ref.current.set(n)}}}},{key:"render",value:function(){var e=this;if("loading"===this.state.loading_status)return r.a.createElement("p",{className:"box box-tip"},"\u52a0\u8f7d\u4e2d\u2026\u2026");var t=je(this.props.show_sidebar,this.props.token),a=this.state.filter_name?this.state.replies.filter((function(t){return t.name===e.state.filter_name})):this.state.replies.slice();this.state.rev&&a.reverse();var n=Object(m.a)({},"\u6d1e\u4e3b",1);a.forEach((function(e){void 0===n[e.name]&&(n[e.name]=0),n[e.name]++}));var o=this.state.filter_name&&"\u6d1e\u4e3b"!==this.state.filter_name?null:r.a.createElement(F,{callback:function(t){e.show_reply_bar("",t)}},r.a.createElement(Se,{info:this.state.info,attention:this.state.attention,img_clickable:!0,color_picker:this.color_picker,show_pid:t,replies:this.state.replies,set_variant:function(t){e.set_variant(null,t)},do_filter_name:n["\u6d1e\u4e3b"]>1?this.set_filter_name.bind(this):null}));return r.a.createElement("div",{className:"flow-item-row sidebar-flow-item"},r.a.createElement("div",{className:"box box-tip sidebar-toolbar"},!!this.props.token&&r.a.createElement("span",{className:"sidebar-toolbar-item"},r.a.createElement("a",{onClick:this.report.bind(this)},r.a.createElement("span",{className:"icon icon-flag"}),r.a.createElement("label",null,"\u4e3e\u62a5"))),r.a.createElement("span",{className:"sidebar-toolbar-item"},r.a.createElement("a",{onClick:this.load_replies.bind(this)},r.a.createElement("span",{className:"icon icon-refresh"}),r.a.createElement("label",null,"\u5237\u65b0"))),(this.state.replies.length>=1||this.state.rev)&&r.a.createElement("span",{className:"sidebar-toolbar-item"},r.a.createElement("a",{onClick:this.toggle_rev.bind(this)},r.a.createElement("span",{className:"icon icon-order-rev"}),r.a.createElement("label",null,this.state.rev?"\u8fd8\u539f":"\u9006\u5e8f"))),!!this.props.token&&r.a.createElement("span",{className:"sidebar-toolbar-item"},r.a.createElement("a",{onClick:function(){e.toggle_attention()}},this.state.attention?r.a.createElement("span",null,r.a.createElement("span",{className:"icon icon-star-ok"}),r.a.createElement("label",null,"\u5df2\u5173\u6ce8")):r.a.createElement("span",null,r.a.createElement("span",{className:"icon icon-star"}),r.a.createElement("label",null,"\u672a\u5173\u6ce8")))),!!this.props.token&&r.a.createElement("span",{className:"sidebar-toolbar-dropdown sidebar-toolbar-item"},r.a.createElement("span",{className:"sidebar-toolbar-dropdown-title"},r.a.createElement("a",null,r.a.createElement("span",{className:"icon icon-menu"}),r.a.createElement("label",null,"\u66f4\u591a\u25be"))),r.a.createElement("div",{className:"sidebar-toolbar-dropdown-content"},r.a.createElement("div",{className:"sidebar-toolbar-dropdown-item"},r.a.createElement("a",{onClick:this.set_alias.bind(this)},r.a.createElement("span",{className:"icon icon-link"}),r.a.createElement("label",null,"\u522b\u540d")))))),!!this.state.filter_name&&r.a.createElement("div",{className:"box box-tip flow-item filter-name-bar"},r.a.createElement("p",null,r.a.createElement("span",{style:{float:"left"}},r.a.createElement("a",{onClick:function(){e.set_filter_name(null)}},"\u8fd8\u539f")),r.a.createElement("span",{className:"icon icon-locate"}),"\xa0\u5f53\u524d\u53ea\u770b\xa0",r.a.createElement(B,{colors:this.color_picker.get(this.state.filter_name)},this.state.filter_name))),!this.state.rev&&o,!!this.state.error_msg&&r.a.createElement("div",{className:"box box-tip flow-item"},r.a.createElement("p",null,"\u56de\u590d\u52a0\u8f7d\u5931\u8d25"),r.a.createElement("p",null,this.state.error_msg)),this.props.deletion_detect&&parseInt(this.state.info.reply)>this.state.replies.length&&!!this.state.replies.length&&r.a.createElement("div",{className:"box box-tip flow-item box-danger"},parseInt(this.state.info.reply)-this.state.replies.length," ","\u6761\u56de\u590d\u88ab\u5220\u9664"),a.map((function(a,o){return r.a.createElement(ce,{key:o,offset:1500,height:"5em",overflow:!0,once:!0},r.a.createElement(F,{callback:function(t){e.show_reply_bar(a.name,t)}},r.a.createElement(Le,{info:a,color_picker:e.color_picker,show_pid:t,set_variant:function(t){e.set_variant(a.cid,t)},do_filter_name:n[a.name]>1?e.set_filter_name.bind(e):null})))})),this.state.rev&&o,this.props.token?r.a.createElement(Ie,{pid:this.state.info.pid,token:this.props.token,area_ref:this.reply_ref,on_complete:this.load_replies.bind(this)}):r.a.createElement("div",{className:"box box-tip flow-item"},"\u767b\u5f55\u540e\u53ef\u4ee5\u56de\u590d\u6811\u6d1e"))}}]),a}(n.PureComponent),Be=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={replies:[],reply_status:"done",reply_error:null,info:Object.assign({},e.info,{variant:{}}),hidden:window.config.block_words.some((function(t){return e.info.text.includes(t)})),attention:null!==e.attention_override&&e.attention_override,cached:!0},n.color_picker=e.info.reply_color_picker?e.info.reply_color_picker:new w,n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){parseInt(this.state.info.reply,10)&&this.load_replies(null,!1)}},{key:"reveal",value:function(){this.setState({hidden:!1})}},{key:"load_replies",value:function(e){var t=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.setState({reply_status:"loading",reply_error:null}),this.state.info.use_reply_promise)return console.log("fetching reply",this.state.info.pid,"from resolved promise"),void this.state.info.reply_promise.then((function(n){var r=n.data,o=n.cached,i=n.latest_reply;t.setState((function(e,t){return{replies:r.data,info:Object.assign({},e.info,{reply:a?""+r.data.length:e.info.reply,variant:r.data.length?{latest_reply:i}:{}}),attention:!!r.attention,reply_status:"done",reply_error:null,cached:o}}),e)})).catch((function(a){console.error(a),t.setState({replies:[],reply_status:"failed",reply_error:""+a},e)}));console.log("fetching reply",this.state.info.pid),j.load_replies_with_cache(this.state.info.pid,this.props.token,this.color_picker,parseInt(this.state.info.reply)).then((function(n){var r=n.data,o=n.cached;t.setState((function(e,t){return{replies:r.data,info:Object.assign({},e.info,{reply:a?""+r.data.length:e.info.reply,variant:r.data.length?{latest_reply:Math.max.apply(null,r.data.map((function(e){return parseInt(e.timestamp)})))}:{}}),attention:!!r.attention,reply_status:"done",reply_error:null,cached:o}}),e)})).catch((function(a){console.error(a),t.setState({replies:[],reply_status:"failed",reply_error:""+a},e)}))}},{key:"show_sidebar",value:function(){this.props.show_sidebar("\u6811\u6d1e #"+this.state.info.pid,r.a.createElement(We,{key:+new Date,info:this.state.info,replies:this.state.replies,attention:this.state.attention,sync_state:this.setState.bind(this),token:this.props.token,show_sidebar:this.props.show_sidebar,color_picker:this.color_picker,deletion_detect:this.props.deletion_detect}))}},{key:"render",value:function(){var e=this,t=je(this.props.show_sidebar,this.props.token,this.state.info.pid),a=[["url_pid",y],["url",P],["pid",O],["nickname",C]];this.props.search_param&&a.push(["search",this.props.search_param.match(/\/.+\//)?W(this.props.search_param," ","gi",!0):W(this.props.search_param," ","gi")]);var n=D(this.state.info.text,a),o=null;if(!this.props.is_quote){var i,s=Object(h.a)(n);try{for(s.s();!(i=s.n()).done;){var l=Object(d.a)(i.value,2),c=l[0],_=l[1];if("pid"===c&&-1===Ke.indexOf(_)&&parseInt(_)<parseInt(this.state.info.pid)){if(null!==o){o=null;break}o=parseInt(_)}}}catch(p){s.e(p)}finally{s.f()}}var u=r.a.createElement("div",{className:"flow-item-row flow-item-row-with-prompt"+(this.props.is_quote?" flow-item-row-quote":""),onClick:function(t){Te[t.target.tagName.toLowerCase()]||e.show_sidebar()}},r.a.createElement(Se,{parts:n,info:this.state.info,attention:this.state.attention,img_clickable:!1,is_quote:this.props.is_quote,color_picker:this.color_picker,show_pid:t,replies:this.state.replies,cached:this.state.cached}),r.a.createElement("div",{className:"flow-reply-row"},"loading"===this.state.reply_status&&r.a.createElement("div",{className:"box box-tip"},"\u52a0\u8f7d\u4e2d"),"failed"===this.state.reply_status&&r.a.createElement("div",{className:"box box-tip"},r.a.createElement("p",null,r.a.createElement("a",{onClick:function(){e.load_replies()}},"\u91cd\u65b0\u52a0\u8f7d\u8bc4\u8bba")),r.a.createElement("p",null,this.state.reply_error)),this.state.replies.slice(0,10).map((function(a){return r.a.createElement(Le,{key:a.cid,info:a,color_picker:e.color_picker,show_pid:t})})),this.state.replies.length>10&&r.a.createElement("div",{className:"box box-tip"},"\u8fd8\u6709 ",this.state.replies.length-10," \u6761")));return this.state.hidden?r.a.createElement("div",{className:"flow-item-row flow-item-row-with-prompt",onClick:function(){return e.reveal()}},r.a.createElement("div",{className:"flow-item"+(this.props.is_quote?" flow-item-quote":"")},!!this.props.is_quote&&r.a.createElement("div",{className:"quote-tip black-outline"},r.a.createElement("div",null,r.a.createElement("span",{className:"icon icon-quote"})),r.a.createElement("div",null,r.a.createElement("small",null,"\u63d0\u5230"))),r.a.createElement("div",{className:"box"},r.a.createElement("div",{className:"box-header"},!!this.props.do_filter_name&&r.a.createElement("span",{className:"reply-header-badge clickable",onClick:function(){e.props.do_filter_name("\u6d1e\u4e3b")}},r.a.createElement("span",{className:"icon icon-locate"})),r.a.createElement("code",{className:"box-id"},"#",this.props.info.pid),"\xa0",null!==this.props.info.tag&&r.a.createElement("span",{className:"box-header-tag"},this.props.info.tag),r.a.createElement(M.c,{stamp:this.props.info.timestamp}),r.a.createElement("span",{className:"box-header-badge"},r.a.createElement("span",{className:"icon icon-block"})),r.a.createElement("div",{style:{clear:"both"}}))))):o?r.a.createElement("div",null,u,r.a.createElement(He,{pid:o,show_sidebar:this.props.show_sidebar,token:this.props.token,deletion_detect:this.props.deletion_detect})):u}}]),a}(n.PureComponent),He=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={loading_status:"empty",error_msg:null,info:null},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.load()}},{key:"load",value:function(){var e=this;this.setState({loading_status:"loading"},(function(){j.get_single(e.props.pid,e.props.token).then((function(t){e.setState({loading_status:"done",info:t.data})})).catch((function(t){-1!==(""+t).indexOf("\u6ca1\u6709\u8fd9\u6761\u6811\u6d1e")?e.setState({loading_status:"empty"}):e.setState({loading_status:"error",error_msg:""+t})}))}))}},{key:"render",value:function(){return"empty"===this.state.loading_status?null:"loading"===this.state.loading_status?r.a.createElement("div",{className:"aux-margin"},r.a.createElement("div",{className:"box box-tip"},r.a.createElement("span",{className:"icon icon-loading"}),"\u63d0\u5230\u4e86 #",this.props.pid)):"error"===this.state.loading_status?r.a.createElement("div",{className:"aux-margin"},r.a.createElement("div",{className:"box box-tip"},r.a.createElement("p",null,r.a.createElement("a",{onClick:this.load.bind(this)},"\u91cd\u65b0\u52a0\u8f7d")),r.a.createElement("p",null,this.state.error_msg))):r.a.createElement(Be,{info:this.state.info,show_sidebar:this.props.show_sidebar,token:this.props.token,is_quote:!0,deletion_detect:this.props.deletion_detect})}}]),a}(n.PureComponent);function Qe(e){return r.a.createElement(Ce.Consumer,null,(function(t){var a=t.value;return r.a.createElement("div",{className:"flow-chunk"},!!e.title&&r.a.createElement(M.d,{text:e.title}),r.a.createElement("p",{className:"title-button black-outline"},!!e.title_button&&e.title_button),e.list.map((function(t,n){return r.a.createElement(ce,{key:"".concat(t.pid,"-").concat(e.lazyload_key_suffix),offset:1500,height:"15em",hiddenIfInvisible:!0},r.a.createElement("div",null,!!(e.deletion_detect&&"list"===e.mode&&n&&e.list[n-1].pid-t.pid>1)&&r.a.createElement("div",{className:"flow-item-row"},r.a.createElement("div",{className:"box box-tip flow-item box-danger"},e.list[n-1].pid-t.pid-1," \u6761\u88ab\u5220\u9664")),r.a.createElement(Be,{info:t,show_sidebar:e.show_sidebar,token:a,attention_override:"attention_finished"===e.mode||null,deletion_detect:e.deletion_detect,search_param:e.search_param})))})))}))}var qe=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={mode:e.mode,search_param:e.search_text,loaded_pages:0,chunks:{title:"",data:[]},loading_status:"done",error_msg:null,reply_promises_done:!1,sort_by_latest_reply:!1,lazyload_key_suffix:0},n.on_scroll_bound=n.on_scroll.bind(Object(c.a)(n)),window.LATEST_POST_ID=parseInt(localStorage._LATEST_POST_ID,10)||0,n}return Object(l.a)(a,[{key:"inject_reply_promises",value:function(e){var t,a=this,n=A()(25),r=[],o=Object(h.a)(e);try{var i=function(){var e=t.value,o=new w,i=n(Object(b.a)(E.a.mark((function t(){var n,r,i,s;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("fetching reply with promise",e.pid),t.next=4,j.load_replies_with_cache(e.pid,a.props.token,o,parseInt(e.reply));case 4:return n=t.sent,r=n.data,i=n.cached,s=r.data.length?Math.max.apply(Math,Object(p.a)(r.data.map((function(e){return parseInt(e.timestamp)})))):e.timestamp,e._latest_reply=s,t.abrupt("return",{data:r,cached:i,latest_reply:s});case 12:t.prev=12,t.t0=t.catch(0),console.error(t.t0),reject(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,12]])}))));r.push(i),e.use_reply_promise=!0,e.reply_color_picker=o,e.reply_promise=i,e._latest_reply=null};for(o.s();!(t=o.n()).done;)i()}catch(s){o.e(s)}finally{o.f()}return Promise.all(r).then((function(){a.setState({reply_promises_done:!0})})).catch((function(e){console.error(e)})),e}},{key:"load_page",value:function(e){var t=this,a=function(e){console.error(e),t.setState((function(t,a){return{loaded_pages:t.loaded_pages-1,loading_status:"failed",error_msg:""+e}}))};if(e>this.state.loaded_pages+1)throw new Error("bad page");if(e===this.state.loaded_pages+1){if(console.log("fetching page",e),"list"===this.state.mode)j.get_list(e,this.props.token).then((function(a){if(1===e&&a.data.length){var n=-1;a.data.forEach((function(e){parseInt(e.pid,10)>n&&(n=parseInt(e.pid,10))})),localStorage._LATEST_POST_ID=""+n}t.setState((function(e,t){return{chunks:{title:"News Feed",data:e.chunks.data.concat(a.data.filter((function(t){return 0===e.chunks.data.length||!e.chunks.data.slice(-100).some((function(e){return e.pid===t.pid}))})))},loading_status:"done"}}))})).catch(a);else if("search"===this.state.mode)j.get_search(e,this.state.search_param,this.props.token).then((function(e){var a=0===e.data.length;t.setState((function(n,r){return{chunks:{title:'Result for "'+t.state.search_param+'"',data:n.chunks.data.concat(e.data.filter((function(e){return 0===n.chunks.data.length||!n.chunks.data.slice(-100).some((function(t){return t.pid===e.pid}))})))},mode:a?"search_finished":"search",loading_status:"done"}}))})).catch(a);else if("single"===this.state.mode){var n=this.state.search_param.substr(1);n in window.config.alias&&(n=window.config.alias[n]);var r=parseInt(n,10);j.get_single(r,this.props.token).then((function(e){t.setState({chunks:{title:"PID = "+r,data:[e.data]},mode:"single_finished",loading_status:"done"})})).catch(a)}else{if("attention"!==this.state.mode)return void console.log("nothing to load");var o=!!this.state.search_param,i=o&&!!this.state.search_param.match(/\/.+\//),s=/.+/;if(i)try{s=new RegExp(this.state.search_param.slice(1,-1))}catch(rt){alert("\u8bf7\u68c0\u67e5\u6b63\u5219\u8868\u8fbe\u5f0f\u5408\u6cd5\u6027\uff01\n".concat(rt)),s=/.+/}j.get_attention(this.props.token).then((function(e){var a=o?i?e.data.filter((function(e){return!!e.text.match(s)})):e.data.filter((function(e){return t.state.search_param.split(" ").every((function(t){return e.text.includes(t)}))})):e.data;t.setState({chunks:{title:"".concat(o?i?"Result for RegEx ".concat(s.toString()," in "):'Result for "'.concat(t.state.search_param,'" in '):"","Attention List"),data:window.config.attention_sort?t.inject_reply_promises(a):a},mode:"attention_finished",loading_status:"done"})})).catch(a)}this.setState((function(e,t){return{loaded_pages:e.loaded_pages+1,loading_status:"loading",error_msg:null}}))}}},{key:"on_scroll",value:function(e){e.target===document&&(document.body.scrollHeight-window.scrollY-window.innerHeight<window.innerHeight&&"done"===this.state.loading_status&&this.load_page(this.state.loaded_pages+1))}},{key:"sort_by_latest_reply",value:function(){this.setState((function(e){return{original_chunk:e.chunks,chunks:{title:e.chunks.title,data:e.chunks.data.slice(0).sort((function(e,t){return t._latest_reply-e._latest_reply}))},lazyload_key_suffix:e.lazyload_key_suffix+1,sort_by_latest_reply:!0}}))}},{key:"sort_by_original",value:function(){this.setState((function(e){return{chunks:e.original_chunk,lazyload_key_suffix:e.lazyload_key_suffix+1,sort_by_latest_reply:!1}}))}},{key:"componentDidMount",value:function(){this.load_page(1),window.addEventListener("scroll",this.on_scroll_bound),window.addEventListener("resize",this.on_scroll_bound)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.on_scroll_bound),window.removeEventListener("resize",this.on_scroll_bound)}},{key:"render",value:function(){var e=this,t="on"===localStorage.DELETION_DETECT,a=this.state.reply_promises_done&&(this.state.sort_by_latest_reply?r.a.createElement("a",{onClick:this.sort_by_original.bind(this)},"[ \u6309\u6700\u65b0\u56de\u590d\u65f6\u95f4\u6392\u5e8f ]"):r.a.createElement("a",{onClick:this.sort_by_latest_reply.bind(this)},"[ \u6309\u53d1\u5e03\u65f6\u95f4\u6392\u5e8f ]"));return r.a.createElement("div",{className:"flow-container"},r.a.createElement(Qe,{title:this.state.chunks.title,title_button:a,list:this.state.chunks.data,mode:this.state.mode,search_param:this.state.search_param||null,show_sidebar:this.props.show_sidebar,deletion_detect:t,lazyload_key_suffix:this.state.lazyload_key_suffix}),"failed"===this.state.loading_status&&r.a.createElement("div",{className:"aux-margin"},r.a.createElement("div",{className:"box box-tip"},r.a.createElement("p",null,r.a.createElement("a",{onClick:function(){e.load_page(e.state.loaded_pages+1)}},"\u91cd\u65b0\u52a0\u8f7d")),r.a.createElement("p",null,this.state.error_msg))),r.a.createElement(M.d,{text:"loading"===this.state.loading_status?r.a.createElement("span",null,r.a.createElement("span",{className:"icon icon-loading"}),"\xa0Loading..."):"\xa9 xmcp & awesome community"}))}}]),a}(n.PureComponent),Ge=(a(62),/^\/\/setflag ([a-zA-Z0-9_]+)=(.*)$/),Fe={"\u6811\u6d1e":"https://pkuhelper.pku.edu.cn/hole","\u6559\u5ba4":"https://pkuhelper.pku.edu.cn/spare_classroom/","\u8bfe\u8868":"https://pkuhelper.pku.edu.cn/syllabus/","\u5ba2\u6237\u7aef":"https://pkuhelper.pku.edu.cn/","\u6210\u7ee9":"https://pkuhelper.pku.edu.cn/my_score","\u4e0d\u5495":"https://pkuhelper.pku.edu.cn/ddl","\u4e0d\u5495\u8ba1\u5212":"https://pkuhelper.pku.edu.cn/ddl","\u8bfe\u7a0b\u6d4b\u8bc4":"https://courses.pinzhixiaoyuan.com/","\u6d4b\u8bc4":"https://courses.pinzhixiaoyuan.com/"},Xe=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={search_text:""},n.set_mode=e.set_mode,n.on_change_bound=n.on_change.bind(Object(c.a)(n)),n.on_keypress_bound=n.on_keypress.bind(Object(c.a)(n)),n.do_refresh_bound=n.do_refresh.bind(Object(c.a)(n)),n.do_attention_bound=n.do_attention.bind(Object(c.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;if(window.location.hash){var t=decodeURIComponent(window.location.hash).substr(1);-1!==t.lastIndexOf("?")&&(t=t.substr(0,t.lastIndexOf("?"))),this.setState({search_text:t},(function(){e.on_keypress({key:"Enter"})}))}}},{key:"on_change",value:function(e){this.setState({search_text:e.target.value})}},{key:"on_keypress",value:function(e){if("Enter"===e.key){var t=Ge.exec(this.state.search_text);if(t)return void(t[2]?(localStorage[t[1]]=t[2],alert("Set Flag "+t[1]+"="+t[2]+"\nYou may need to refresh this webpage.")):(delete localStorage[t[1]],alert("Clear Flag "+t[1]+"\nYou may need to refresh this webpage.")));var a=this.state.search_text.startsWith("#")?"single":"attention"!==this.props.mode?"search":"attention";this.set_mode(a,this.state.search_text||"")}}},{key:"do_refresh",value:function(){window.scrollTo(0,0),this.setState({search_text:""}),this.set_mode("list",null)}},{key:"do_attention",value:function(){window.scrollTo(0,0),this.setState({search_text:""}),this.set_mode("attention",null)}},{key:"render",value:function(){var e=this;return r.a.createElement(Ce.Consumer,null,(function(t){var a=t.value;return r.a.createElement("div",{className:"control-bar"},r.a.createElement("a",{className:"no-underline control-btn",onClick:e.do_refresh_bound},r.a.createElement("span",{className:"icon icon-refresh"}),r.a.createElement("span",{className:"control-btn-label"},"\u6700\u65b0")),!!a&&r.a.createElement("a",{className:"no-underline control-btn",onClick:e.do_attention_bound},r.a.createElement("span",{className:"icon icon-attention"}),r.a.createElement("span",{className:"control-btn-label"},"\u5173\u6ce8")),r.a.createElement("input",{className:"control-search",value:e.state.search_text,placeholder:"".concat("attention"===e.props.mode?"\u5728\u5173\u6ce8\u4e2d":"","\u641c\u7d22 \u6216 #PID"),onChange:e.on_change_bound,onKeyPress:e.on_keypress_bound}),r.a.createElement("a",{className:"no-underline control-btn",onClick:function(){e.props.show_sidebar("P\u5927\u6811\u6d1e (\u793e\u533a\u7248)",r.a.createElement(De,{show_sidebar:e.props.show_sidebar}))}},r.a.createElement("span",{className:"icon icon-"+(a?"about":"login")}),r.a.createElement("span",{className:"control-btn-label"},a?"\u8d26\u6237":"\u767b\u5f55")),!!a&&r.a.createElement("a",{className:"no-underline control-btn",onClick:function(){e.props.show_sidebar("\u53d1\u8868\u6811\u6d1e",r.a.createElement(Re,{token:a,on_complete:function(){e.props.show_sidebar(null,null,"clear"),e.do_refresh()}}))}},r.a.createElement("span",{className:"icon icon-plus"}),r.a.createElement("span",{className:"control-btn-label"},"\u53d1\u8868")))}))}}]),a}(n.PureComponent),Ve=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{id:"app-switcher-shell"},r.a.createElement(M.a,{appid:"hole"}))}},{key:"componentDidMount",value:function(){document.getElementById("app-switcher-shell").firstChild.querySelectorAll("a").forEach((function(e){e.text in Fe?e.href=Fe[e.text]:"\u66f4\u591a\u25be"!==e.text&&(e.href="https://pkuhelper.pku.edu.cn"+e.pathname,e.style="filter: grayscale(100%); opacity: 0.25",e.title="\u53ef\u80fd\u5931\u6548\u7684\u6309\u94ae"),"\u6811\u6d1e"===e.text&&(e.title="\u5b98\u65b9\u7248\u6811\u6d1e")}))}}]),a}(n.PureComponent);function ze(e){return r.a.createElement("div",{className:"title-bar"},r.a.createElement(Ve,null),r.a.createElement("div",{className:"aux-margin"},r.a.createElement("div",{className:"title"},r.a.createElement("p",{className:"centered-line"},r.a.createElement("span",{onClick:function(){return e.show_sidebar("P\u5927\u6811\u6d1e (\u793e\u533a\u7248)",r.a.createElement(De,{show_sidebar:e.show_sidebar}))}},"P\u5927\u6811\u6d1e",r.a.createElement("small",null," ","(\u793e\u533a\u7248",!!"0.5.1".includes("beta")&&r.a.createElement("sup",null,"\u03b2"),!!"0.5.1".includes("alpha")&&r.a.createElement("sup",null,"\u03b1"),")")))),r.a.createElement(Xe,{show_sidebar:e.show_sidebar,set_mode:e.set_mode,mode:e.mode})))}a(63);var Ye=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).do_close_bound=n.do_close.bind(Object(c.a)(n)),n.do_back_bound=n.do_back.bind(Object(c.a)(n)),n}return Object(l.a)(a,[{key:"do_close",value:function(){this.props.show_sidebar(null,null,"clear")}},{key:"do_back",value:function(){this.props.show_sidebar(null,null,"pop")}},{key:"render",value:function(){var e=this,t=this.props.stack.map((function(t,a){var n=t[1];return n&&r.a.createElement("div",{key:a,className:"sidebar-content "+(a===e.props.stack.length-1?"sidebar-content-show":"sidebar-content-hide")},n)})),a=this.props.stack[this.props.stack.length-1][0];return r.a.createElement("div",{className:"sidebar-container "+(null!==a?"sidebar-on":"sidebar-off")},r.a.createElement("div",{className:"sidebar-shadow",onClick:this.do_back_bound,onTouchEnd:function(e){e.preventDefault(),e.target.click()}}),r.a.createElement("div",{className:"sidebar"},t),r.a.createElement("div",{className:"sidebar-title"},r.a.createElement("a",{className:"no-underline",onClick:this.do_close_bound},"\xa0",r.a.createElement("span",{className:"icon icon-close"}),"\xa0"),this.props.stack.length>2&&r.a.createElement("a",{className:"no-underline",onClick:this.do_back_bound},"\xa0",r.a.createElement("span",{className:"icon icon-back"}),"\xa0"),a))}}]),a}(n.PureComponent),Ze=a(34),Je=a.n(Ze),$e=(a(64),function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={level:0,fired:!1},n.callback=e.callback,n.esc_interval=null,n}return Object(l.a)(a,[{key:"do_fire",value:function(){var e=this;this.esc_interval&&(clearInterval(this.esc_interval),this.esc_interval=null),this.setState({level:1,fired:!0}),this.callback(),window.setTimeout((function(){e.setState({level:0,fired:!1})}),300)}},{key:"componentDidMount",value:function(){var e=this;window.config.pressure&&(Je.a.set(document.body,{change:function(t){e.state.fired||(t>=.999?e.do_fire():e.setState({level:t}))},end:function(){e.setState({level:0,fired:!1})}},{polyfill:!1,only:"touch",preventSelect:!1}),document.addEventListener("keydown",(function(t){t.repeat||"Escape"!==t.key||(e.esc_interval&&clearInterval(e.esc_interval),e.setState({level:.2},(function(){e.esc_interval=setInterval((function(){var t=e.state.level+.1;t>=.999?e.do_fire():e.setState({level:t})}),30)})))})),document.addEventListener("keyup",(function(t){"Escape"===t.key&&(e.esc_interval&&(clearInterval(e.esc_interval),e.esc_interval=null),e.setState({level:0}))})))}},{key:"render",value:function(){var e=25*(this.state.level-.4)-500;return r.a.createElement("div",{className:"pressure-box"+(this.state.fired?" pressure-box-fired":"")+(this.state.level<=1e-4?" pressure-box-empty":""),style:{left:e,right:e,top:e,bottom:e}})}}]),a}(n.Component));function et(e){return r.a.createElement("div",{id:"global-hint-container"})}var tt=function(e){Object(_.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),n=t.call(this,e),fe(),Object(U.c)({default:void 0,light:!1,dark:!0}[window.config.color_scheme]),n.state={sidebar_stack:[[null,null]],mode:"list",search_text:null,flow_render_key:+new Date,token:localStorage.TOKEN||null},n.show_sidebar_bound=n.show_sidebar.bind(Object(c.a)(n)),n.set_mode_bound=n.set_mode.bind(Object(c.a)(n)),n.on_pressure_bound=n.on_pressure.bind(Object(c.a)(n)),n.inpku_flag=-1!==window[atob("ZG9jdW1lbnQ")][atob("Y29va2ll")].indexOf(atob("cGt1X2lwX2ZsYWc9eWVz")),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){x()}},{key:"on_pressure",value:function(){this.state.sidebar_stack.length>1?this.show_sidebar(null,null,"clear"):this.set_mode("list",null)}},{key:"show_sidebar",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"push";this.setState((function(n){var r=n.sidebar_stack.slice();if("push"===a)1===r.length&&(document.body.style.top="-".concat(window.scrollY,"px"),document.body.style.position="fixed",document.body.style.width="100vw"),r.length>10&&r.splice(1,1),r=r.concat([[e,t]]);else if("pop"===a){if(1===r.length)return;if(2===r.length){var o=document.body.style.top;document.body.style.position="",document.body.style.top="",document.body.style.width="",window.scrollTo(0,-1*parseInt(o||"0"))}r.pop()}else if("replace"===a)r.pop(),r=r.concat([[e,t]]);else{if("clear"!==a)throw new Error("bad show_sidebar mode");var i=document.body.style.top;document.body.style.position="",document.body.style.top="",document.body.style.width="",window.scrollTo(0,-1*parseInt(i||"0")),r=[[null,null]]}return{sidebar_stack:r}}))}},{key:"set_mode",value:function(e,t){this.setState({mode:e,search_text:t,flow_render_key:+new Date})}},{key:"render",value:function(){var e=this;return r.a.createElement(Ce.Provider,{value:{value:this.state.token,set_value:function(t){localStorage.TOKEN=t||"",e.setState({token:t})}}},r.a.createElement($e,{callback:this.on_pressure_bound}),r.a.createElement("div",{className:"bg-img",style:be()}),r.a.createElement(ze,{show_sidebar:this.show_sidebar_bound,set_mode:this.set_mode_bound,mode:this.state.mode}),r.a.createElement(Ce.Consumer,null,(function(t){return r.a.createElement("div",{className:"left-container"},!t.value&&r.a.createElement("div",{className:"flow-item-row aux-margin"},r.a.createElement("div",{className:"box box-tip"},r.a.createElement("p",null,r.a.createElement(M.b,{token_callback:t.set_value},(function(e){return r.a.createElement("a",{onClick:e},r.a.createElement("span",{className:"icon icon-login"}),"\xa0\u767b\u5f55\u5230 PKU Helper")}))))),r.a.createElement(et,{token:t.value}),e.inpku_flag||t.value?r.a.createElement(qe,{key:e.state.flow_render_key,show_sidebar:e.show_sidebar_bound,mode:e.state.mode,search_text:e.state.search_text,token:t.value}):r.a.createElement(M.d,{text:"\u8bf7\u767b\u5f55\u540e\u67e5\u770b\u5185\u5bb9"}),r.a.createElement("br",null))})),r.a.createElement(Ye,{show_sidebar:this.show_sidebar_bound,stack:this.state.sidebar_stack}))}}],[{key:"is_darkmode",value:function(){return"dark"===window.config.color_scheme||"light"!==window.config.color_scheme&&window.matchMedia("(prefers-color-scheme: dark)").matches}}]),a}(n.Component),at=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function nt(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(r.a.createElement(tt,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/PKUHoleCommunity",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/PKUHoleCommunity","/service-worker.js");at?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):nt(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):nt(e)}))}}()}],[[36,1,2]]]);
//# sourceMappingURL=main.2a285dce.chunk.js.map