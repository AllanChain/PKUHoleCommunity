import{j as G,b as ve,c as xe,r as d,R as g,a as de,T as Be,l as Ne,d as Q,f as Se,p as Ie,_ as pe,e as Re,P as Ue,v as Pe,n as Oe}from"./vendor.1e106404.js";const He=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}};He();const Le=.618033988749895;class K{constructor(){this.names={},this.current_h=Math.random()}get(e){return e=e.toLowerCase(),e==="\u6D1E\u4E3B"?["hsl(0,0%,97%)","hsl(0,0%,16%)"]:(this.names[e]||(this.current_h+=Le,this.current_h%=1,this.names[e]=[`hsl(${this.current_h*360}, 50%, 90%)`,`hsl(${this.current_h*360}, 60%, 20%)`]),this.names[e])}}const X=/(^|[^\d\u20e3\ufe0e\ufe0f])([1-9]\d{4,6})(?![\d\u20e3\ufe0e\ufe0f])/g,j=/((?:https?:\/\/)?pkuhelper\.pku\.edu\.cn\/hole\/?#(?:#|%23)([1-9]\d{4,6}))(?!\d|\u20e3|\ufe0e|\ufe0f)/g,W=/(^|[^A-Za-z])((?:(?:Angry|Baby|Crazy|Diligent|Excited|Fat|Greedy|Hungry|Interesting|Jolly|Kind|Little|Magic|Naïve|Old|Powerful|Quiet|Rich|Superman|THU|Undefined|Valuable|Wifeless|Xiangbuchulai|Young|Zombie)\s)?(?:Alice|Bob|Carol|Dave|Eve|Francis|Grace|Hans|Isabella|Jason|Kate|Louis|Margaret|Nathan|Olivia|Paul|Queen|Richard|Susan|Thomas|Uma|Vivian|Winnie|Xander|Yasmine|Zach)|You Win(?: \d+)?|洞主)(?![A-Za-z])/gi,V=/(^|[^.@a-zA-Z0-9_])((?:https?:\/\/)?(?:(?:[\w-]+\.)+[a-zA-Z]{2,3}|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?::\d{1,5})?(?:\/[\w~!@#$%^&*\-_=+[\]{};:,./?|]*)?)(?![a-zA-Z0-9])/gi;function Y(a,e){return a=[[null,a]],e.forEach(s=>{const[i,n]=s;a=[].concat.apply([],a.map(r=>{const[u,l]=r;return u?[r]:l.split(n).map(c=>n.test(c)?[i,c]:[null,c]).filter(([c,h])=>c!==null||h)}))}),a}var Me="data:image/png;base64,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",Te="data:image/png;base64,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",Ge="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAFn0lEQVR42q1XbUidZRh+z/FjavYjGLFFFASrFREx1ikE6Ye50QZ5lBUO/ZEnhMyfWbSQQGxQofu1MGooKGjaNCTRpiu3+ZH+Muc8X87j0ZPf39/f2nWd7keenalHSeHifXzf53nu67nv677v5xgjIyOGjtHR0Z0nMT4+bpqYmAgZHh4O8/l8YYODg/7n2NhYKN6b8HxkTeB+wWDsRwBGTTBm9PX1GTBmzM7OGjMzM/4nvhler9c/5/+Q2NUwNxwaGvI/NzY2iNNbW1vvbW9vfwRkApfxv2V9fT1qcnLSIElF5LAkHjs9wZMtLS0ZMPQOUAx0An2AD/gH6AecQA1gA8EnSASkD01ix6haQFevrq5GYuOvgV5gAHADPcBDQY+88wipX+CRl8RzhyKxM+AinlyM/wAMAXYx5Nrc3GxbW1u7he91OPE9GOwmETwfCMkmjE/zANTHoT3ARcvLy3T7VzQuG/fAWFNLS8s3KSkpH1oslovAu3FxcckFBQVXML8a89xChqH5DfOfoiZ0YQYlgIGJ/2CDt3habGgHenDa2oyMjMuxsbEvFBYWRhcVFYUQGEfk5uaeiImJiYOhG5jr0kh8Oj09veOFYCT8TDl5fn6eBK5zE25Il6elpSXl5+cf4ybcVMfc3JxRVVVlwCOvLy4uUgMPSRrrm+GFpwcGBgylhX0JIGbm/v5+ptozWPyXbOLp7OzMycvLC2feYyMTSQbAxG/FxcVGdna2lSEDmBkePC+KB0wH8UAoqhsJxFJwJAB0lpaWnuV7ZVzfSI35fmpqyqivr49GuCqZNVhLQX62sLBgYL0pmBc4KYwuxaJELO4DPHD/7xDSk/ulkxIu8t8EbxkIA9O2Xwh8x5CqYhZMhGEcwAMfsNgIiSooPERtsJcbpWqaqXqs/4LpKATyqZEDEcDpQ51OJ09yXlzI4nMXLj2u0inQC0rd/EY3S9W8jrWskAMgkyPED6QBdjoSeZWxZwaIkC7ICcyB6aTG1AdJImQUcCtrAp5ekLK1t7dTH6agWUA1U0iVlZXRaC6VUl5Z93+FF6IlnUJ4ogDQ9WatePn7A0jcb2xsPNPb28tWbhyEgF/JdXV1Rltb28dyehYVL2MJElE8JTMCT57YLGNVOVOlXDsYQqR1AdI3SrXsoCFQsWQNz8rKehab3hQvKBI/g9DbeB+1srJiEBQomw++XZXG5JK+4YHR9I6ODn99YYiC3RV2BkzF5uZmw2q1noeIGiUMigQNVEulvAaUAh3ShBzy3SFkWqEJC4sbQW+x1O9F4pGcZijKysrCbTbbJXS+Gq0NO7X7gE/i7da+d8nYLt8oSCuInGV3VZVzt4x6zCUsrxUVFZGo8efsdvs1bHJHPKGMKThgpB3pewOkP5d5ymvq7uCSu8Ip6TnmQBK7lleGo6GhwZyQkHAqPj7+Egh9CdF9j+JSggpXgk1+bGpqugpPpYHoGcw7npOTkwIS97RwOMRz9Nhd3hV2I7FniSUJTqytrQ2FoRMw9Irlv783gNdSU1Ofy8zMjOrq6mIRM9LT0yOQyp+IUadGoFu0QhIvB5LYs8SShMoOhsXtdhutra1+dHd3+wnSML/zek6xoXC9CEN/a2np0kh4dU+oq9ue+amHhALi7wM2HoIG+U5vzxQwOmgkRFcixuxiXCdBgd5RVzeW6gPd25RHdOhKVgR4QUFoziGN/5Ba4tBIuDQSf0Ivz/MOeuhfMvsRlAwKx/0xESRuC4lAT/CuOQx8y/lHQkAnwRJcXl5+LDk5OQmnvC1Xe52EXdK1mi37SAmocPBkJIFwJIJEvZBwiHF6wAcdlHDukREIJEFPSFVNQjhuyak9ShtIbxtvUkdKQL+sKBLQRAT6ixVp+xOI1CBLbqLzXsFvi5NH7oFAIrzQCIlQFK83gfeBC8BJ3heYiv8CA3isy4IxUaYAAAAASUVORK5CYII=",Qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFdklEQVR42sVW+VNTVxS+f4Od9oeW0RmlU8dOcRx3BEHbqiio3dtfamds+0N1bGe62emirYpSLRYDguAWJQihLZBAEkgKgbCHgIBAXbBTtgSykhAQEL/ecyWtwwMHx9DemS/vvXvv+c73zj3n5DEAjHBodJz9MD7BvuP3KVbb0xqV1p6lzENzS9u7Y3zOVWNittXPMmvMWmaNjZgeW8OZY91i1pSbzSqcg6y01Lj7V7UOap3Bma9WhyiKtEyh0bGsQg0L+P3n5talDNZ5LpWZCwqYqqYxJk9TggK1Bkpza7pWrWNdsZHM/uKymZ1Pgvb07ohiel0Jy7VcO1ug0iCfc+WbW7fUa0vYrUw5u6G8IhXglR1l/qR45tu/l9WeTo5XGqvxS3k1tPmF+t6Y8MXOVYui+3ZEb+ROHoq+HVEb3WtCo23bIhZrCwoNuZyHuKpTU474v/2M+dOSmDdDJhVgzUxn1oQDcd7w59C5+00oqxqgsLTBnHAIQ8vnoy9uPbiDWYH2kk1dwmFkWdqRU2nG9V2vw8e5rScOx/ZnX5YK6Dvw6Z6+VzYMepY8hT8++ZALMONKfQuqkxLhWf88rNvCZy2A54KwqTp1UnCQgPZ9H8Cz5ElYX93gsR38/COpgO3r5bata+FYHYrKve8jp7EDuW23USRLQveKhXDERc5agCMuAt0rF6JQdkpw5DS1o3LPbsFti1nLIxQplx7BljVyO3fSExUG/YYVyFMVIa/lOvLfewcdyxbAvTNq1gJobzu3Ue16G3nNnCNfDUP0cvRELwX5IF9SAbERchtftO+MRsOKUKjXhUG9JRJlSxegm4fUvn32OUB7ycYYNh/qzRFQh4cJTuK23Y+kVED/1nA5BxycwMZxbWUoml4IQdemVXBujwStPQpc3KZr8yo0hYWglXMRJ3FPrksF2F57Sc4BK4f9jZfhfmuzgPPNTWLO9oggG7IN8BDnAzxSAaWL5sk58C+emMS8x8S0PFIBjQf3yznwH0EqwAfIOTAThqZgpjXf7CAV4PAMyjkwFXa3R1xHx+9i4h4wzn/o6r8zKtb6XW4MjdwBnxLw+ofF3HRcD2D2AlxeH5yDXpgsjdBWmFBcVY3S2jr0DTiEKN/wCFpu3ERReQUM1TW4+VcXfFxQ0AQMDvmFiPQcJb5PTkHi+Qs4cEqGo2fS0dndCxrFlVX4OvEkvvjxOCrMDSISQRMQgM3pgtXhFPd0lV3OxOmsKyICdByd3T04xkVVNFhw994cCPDwSIyMjQtyGhVms4hIt61fPA/wcz+WnjF3Alw8DygKvXYHbvf0IlmhgDy/QCQdCeviQuZUAL04kX/1UyK++TkJB2XJ+JMLIWd0DHMugEqNMrysrh6GmlocP3ceOlMlhkfHRA7MuYCByXoPDD0vucOnU2HlR0IOe/oHRBJSuU4EswoCjYjelOqeGhENpVaHhIyzounQcPNSjU87g/qWVvF83zYIAty+IdGI1GVGXCpQ4Te9ARnKXHx5/AQqLU3CWUNbu5g7kpomypOaFdmQ7WMLoPKjClCo1Dh54SJSMhVIy85BbXMLRnhUKNzUGU+cPYdsjRYpiixc4tVBzcsz9AgCXF7vQ3OAOiJlO139PBfG7k4IJ5Qb9Ka0RiUZ2PPQkua+JAKcfJIvzGhEZxwAOZ7aIzwPrLunrE/z3zLN90Brh9zu8vCmMsY3DIozDCYcHJTIlNTNHdelAorLTPG1lmbYuUrfCA/nsB+D/uDA679/fBSBWstVaPTGIxIBXX22EH151UVdqQn1V1sF6ppagoIAX6mpBhpD+YUSY9Uz0s/ygQFWXtPA1MXGjzUGo4Fv1HCoggRNkcGoLykz7fvdVMP0HBIB/xf+Bi8VajXQRja5AAAAAElFTkSuQmCC",Ke="data:image/png;base64,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",Xe="data:image/png;base64,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",je="data:image/png;base64,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",We="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAC4jAAAuIwF4pT92AAAFfklEQVR42qWXWWicVRiG/39mUim4NRq88MZWXIpLe+FS6lYKtZsW0UrRUmyllUIXpQiN3hXBC1sxdyom6q2lVRGhUqvFClURUVFUsu+ZmD2TTDKTycTn/fudcPzNJJMaeDOTnHO+7z3ffoLm5uagFFpaWpJ8LmloaAgaGxuD3t7epePj49unpqbeLhQKn4EvwQVwjv+dYm1fOp2u0t76+vqgqampAhmp+XTMqxwB0XcUr8pmsydQ8jPK0oYe0G3f+8AgGGDPn+x9t7+//8HW1taIODKSiyWQ0MGurq4bEKbbjoEZUATTYApMgglDrnDpp2j7hPzk5ORJyN9qJBLlEoiUDw4ObkNIhydQ6JHQ4eHhF1jfgLlXg7v5vn5oaGj3xMTE++xpjZ0ZyWQy+7Fo4Cw6H4GENnLgcExIu/6HRa7XugjOBcno7Oy8EjI7ccVvOstnJIP4OG4kwlIEopuj6JAdlElnuFUtiq/Tmt1ApkwiTJ+hIWF+TmiP9nZ0dChgj/my+LtGJPyYcAHnzL5VfuRAXgfGxsZe1rrWLCOCcuAHMO7agazs1CUWM7KkyYtiwm0OdUuL7KJTLiFAt/VvWQ4SdiYpZbjkCbOEAjhHYN7hLiWWS8QEU7/jfM73Ov3PlAfOrEZoQbi9Zu6UvnOhaic/n89/3dbWFq1FBQNGd7IwbinWiTWuRkjolLe3t1+BKZ8nJV8FRyH4ylxgrVp7RkdHDxIDyxwJXQQZARb4wSxcxCpbpTtiy6E3HTuYHnI+crGB8v2xrFgQEHrLBa0XYxtdvcjlcp9HMcDtr4LZr8Ysze2v8fI11MGBgYFtZqFiGcq1J0+wvWRyQnNnILOj6yfb8zc/VQGp8RR/9Mr8sDppfgtjUR1QcFZBdjN4FGwsAa1tAverDMcKT5Si6HvNKmmGorZbjGrFRqwx9d65Uk4H5a/FIF71nBv6+voesdKt/nEq4NcX1lByKq9+jvoW4OB9NJjHwCawuQS0tgU8jLkTMRKRO3t6em5ReVZ1Bd+KwFfW1bKq7UYgjPWF7ZYhZQchMVDtVc7AlXB0VJpy9YwzInDeCpAI3OUT8LJg72KzgMx6ww9Cj8C1rLeBFkfgrOeC9XEXWPSmRkZGdpCih8EBcLAEDqiXsHePmlI8DswFy9E1rHoDLioIP+JLvyKT4rCrVBBqKvqfQRjaVLXGglA6zyot9lhEFl0Jjqeh0N3dXcXhleA2cHsJaG0lZr7R0vlfWaCeg4WOWhqOkYYvilEVVvjLikMbplsaL0RE9UPms1FDpgRGLcLTuOHZeCFSbUDXBQvoIQrRTa4U17rgIeCe8eIgCkKEHVlsEHK792KlOOQi95j5p2lI56NSLH+x8IAKkRZg+AeNpILDUUuVEKxSiateh+iHoE6jVwnUsf4BqMGyy72OGHVVKu0ZV8656K6oGWl0lmlYPO2l0DFzQcqZ73LghhNL5Z2uV3DJX+iOumRKG1IWnTcrMGxoEMOn3UjtDSTlwO1VO0+Zhe/V9OxGM9J9nbk5FZ8H99nkop1Z0vJJu00YL88LjGSz8YPyNVZpC2bd407nf4ZS+Qlfn/AHSU0ymCv0htKkd9PAS9toZHMTkWSprugizu8E3seSpfiacyy3m4pEjdfbReY7zLbFxqiSY7lLNW69VgOHnXXKT2tSduRKPkwcCQ0U9uqZTS2E/ah+Tmdcp64GKsEysIIYWqsGhKJvrNDMntObQCNZXPmCTzOErkbg2di0U7CUVeHpstdTxpRO+1OTCDNNbXCZFFc+7+PUjdQyO758HJN+apNTxh6iae9xOmBVUBYbhvQ5sug5pdrlPk79B0aFUsleyVUUG/WOT8D39jS/CH7XJ2tH2LNCe60hJRd6nv8Dwj5T3q96iTAAAAAASUVORK5CYII=",Ve="data:image/png;base64,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";const A="//pkuhelper.pku.edu.cn/";function b(a){if(!a.ok)throw Error(`\u7F51\u7EDC\u9519\u8BEF ${a.status} ${a.statusText}`);return a.text().then(e=>{try{return JSON.parse(e)}catch(s){throw console.error("json parse error"),console.trace(s),console.log(e),new SyntaxError("JSON Parse Error "+e.substr(0,50))}})}function Ye(a){function e(){(a===void 0?window.matchMedia("(prefers-color-scheme: dark)").matches:a)?document.body.classList.add("root-dark-mode"):document.body.classList.remove("root-dark-mode")}e(),window.matchMedia("(prefers-color-scheme: dark)").addListener(()=>{e()})}function k(){return"&PKUHelperAPI=3.0&jsapiver="+encodeURIComponent(({}.REACT_APP_BUILD_INFO||"null")+"-"+Math.floor(+new Date/72e5)*2)}const t=G.exports.jsx,o=G.exports.jsxs,me=G.exports.Fragment,ee="pkuhelper_login_popup_anchor";function H(a){return a<10?"0"+a:""+a}function ge(a){return`${a.getMonth()+1}-${H(a.getDate())} ${a.getHours()}:${H(a.getMinutes())}:${H(a.getSeconds())}`}const ze=ve(xe);function v(a){const e=new Date(a.stamp*1e3);return o("span",{children:[t(Be,{date:e,formatter:ze,title:e.toLocaleString("zh-CN",{timeZone:"Asia/Shanghai",hour12:!1})}),"\xA0",ge(e)]})}function z(a){return t("p",{className:"centered-line title-line aux-margin",children:t("span",{className:"black-outline",children:a.text})})}const qe={bar:[["hole","\u6811\u6D1E","/hole",Me,null,!1],["imasugu","\u6559\u5BA4","/spare_classroom",Te,Ge,!1],["syllabus","\u8BFE\u8868","/syllabus",Qe,null,!1],["score","\u6210\u7EE9","/my_score",Ke,null,!1]],dropdown:[["course_survey","\u8BFE\u7A0B\u6D4B\u8BC4","https://courses.pinzhixiaoyuan.com/",Xe,null,!0],["homepage","\u5BA2\u6237\u7AEF","/",Ve,null,!0]],fix:{}};class Ze extends d.exports.Component{constructor(e){super(e),this.state={apps:qe}}render(){const e=this.props.appid;function s([n,r,u,l,c,h],p=!1,w=null){return o("a",{ref:w,className:p?null:"app-switcher-item"+(n===e?" app-switcher-item-current":""),href:u,target:h?"_blank":"_self",children:[!!l&&[t("img",{src:l,className:"app-switcher-logo-normal"},"normal"),t("img",{src:c||l,className:"app-switcher-logo-hover"},"hover")],t("span",{children:r})]},n)}let i=null;return this.state.apps.dropdown.forEach(n=>{n[0]===e&&(i=n)}),o("div",{className:"app-switcher",children:[t("span",{className:"app-switcher-desc app-switcher-left",children:"PKUHelper"}),this.state.apps.bar.map(n=>s(n)),!!this.state.apps.dropdown.length&&o("div",{className:"app-switcher-item app-switcher-dropdown "+(i?" app-switcher-item-current":""),children:[t("p",{className:"app-switcher-dropdown-title",children:s(i?(()=>{const[n,r,u,l,c,h]=i;return[n,r+"\u25BE",null,l,c,!1]})():["-placeholder-elem","\u66F4\u591A\u25BE",null,je,We,!1],!0)}),this.state.apps.dropdown.map(n=>{const r=g.createRef();return t("p",{className:"app-switcher-dropdown-item",onClick:u=>{!u.target.closest("a")&&r.current&&r.current.click()},children:s(n,!0,r)},n[0])})]}),t("span",{className:"app-switcher-desc app-switcher-right",children:"\u7F51\u9875\u7248"})]})}}class Je extends d.exports.Component{constructor(e){super(e),this.state={loading_status:"idle",excluded_scopes:[]},this.username_ref=g.createRef(),this.password_ref=g.createRef(),this.input_token_ref=g.createRef(),this.popup_anchor=document.getElementById(ee),this.popup_anchor||(this.popup_anchor=document.createElement("div"),this.popup_anchor.id=ee,document.body.appendChild(this.popup_anchor))}do_sendcode(e){this.state.loading_status!=="loading"&&this.setState({loading_status:"loading"},()=>{fetch(A+"api_xmcp/login/send_code?user="+encodeURIComponent(this.username_ref.current.value)+"&code_type="+encodeURIComponent(e)+k(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({excluded_scopes:this.state.excluded_scopes||[]})}).then(b).then(s=>{if(console.log(s),!s.success)throw new Error(JSON.stringify(s));alert(s.msg),this.setState({loading_status:"done"})}).catch(s=>{console.error(s),alert(`\u53D1\u9001\u5931\u8D25
`+s),this.setState({loading_status:"done"})})})}do_login(e){this.state.loading_status!=="loading"&&this.setState({loading_status:"loading"},()=>{fetch(A+"api_xmcp/login/login?user="+encodeURIComponent(this.username_ref.current.value)+"&valid_code="+encodeURIComponent(this.password_ref.current.value)+k(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({excluded_scopes:this.state.excluded_scopes||[]})}).then(b).then(s=>{if(s.code!==0)throw s.msg?new Error(s.msg):new Error(JSON.stringify(s));e(s.user_token),alert(`\u6210\u529F\u4EE5 ${s.name} \u7684\u8EAB\u4EFD\u767B\u5F55`),this.setState({loading_status:"done"}),this.props.on_close()}).catch(s=>{console.error(s),alert(`\u767B\u5F55\u5931\u8D25
`+s),this.setState({loading_status:"done"})})})}do_input_token(e){if(this.state.loading_status==="loading")return;const s=this.input_token_ref.current.value;this.setState({loading_status:"loading"},()=>{fetch(A+"api_xmcp/hole/system_msg?user_token="+encodeURIComponent(s)+k()).then(i=>i.json()).then(i=>{if(i.error)throw new Error(i.error);if(i.result.length===0)throw new Error("result check failed");this.setState({loading_status:"done"}),e(s),this.props.on_close()}).catch(i=>{alert(`Token\u68C0\u9A8C\u5931\u8D25
`+i),this.setState({loading_status:"done"}),console.error(i)})})}perm_alert(){alert(`\u5982\u679C\u4F60\u4E0D\u9700\u8981 PKU Helper \u7684\u67D0\u9879\u529F\u80FD\uFF0C\u53EF\u4EE5\u53D6\u6D88\u76F8\u5E94\u6743\u9650\u3002
\u5176\u4E2D\u3010\u72B6\u6001\u4FE1\u606F\u3011\u5305\u62EC\u4F60\u7684\u7F51\u8D39\u3001\u6821\u56ED\u5361\u4F59\u989D\u7B49\u3002
\u8BE5\u8BBE\u7F6E\u5E94\u7528\u5230\u4F60\u7684\u3010\u6240\u6709\u3011\u8BBE\u5907\uFF0C\u53D6\u6D88\u540E\u5982\u9700\u518D\u6B21\u542F\u7528\u76F8\u5E94\u529F\u80FD\u9700\u8981\u91CD\u65B0\u767B\u5F55\u3002`)}render(){const e=[["score","\u6210\u7EE9\u67E5\u8BE2"],["syllabus","\u8BFE\u8868\u67E5\u8BE2"],["my_info","\u72B6\u6001\u4FE1\u606F"]];return de.createPortal(o("div",{children:[t("div",{className:"pkuhelper-login-popup-shadow"}),o("div",{className:"pkuhelper-login-popup",children:[t("p",{children:t("b",{children:"\u63A5\u6536\u9A8C\u8BC1\u7801\u6765\u767B\u5F55 PKU Helper"})}),o("p",{children:["\u6388\u6743\u529F\u80FD",t("a",{onClick:this.perm_alert.bind(this),children:"(?)"}),e.map(([s,i])=>o("label",{className:"perm-item",children:[t("input",{type:"checkbox",checked:this.state.excluded_scopes.indexOf(s)===-1,onChange:n=>{const r=n.target.checked;this.setState(u=>{const l=u.excluded_scopes.slice();if(r){const c=l.indexOf(s);c!==-1&&l.splice(c,1)}else l.push(s);return{excluded_scopes:l}})}}),i]},s))]}),o("p",{children:[o("label",{children:["\u3000\u5B66\u53F7\xA0",t("input",{ref:this.username_ref,type:"tel",autoFocus:!0})]}),o("span",{className:"pkuhelper-login-type",children:[t("a",{onClick:s=>this.do_sendcode("sms"),children:"\xA0\u77ED\u4FE1\xA0"}),"/",t("a",{onClick:s=>this.do_sendcode("mail"),children:"\xA0\u90AE\u4EF6\xA0"})]})]}),o("p",{children:[o("label",{children:["\u9A8C\u8BC1\u7801\xA0",t("input",{ref:this.password_ref,type:"tel"})]}),t("button",{type:"button",disabled:this.state.loading_status==="loading",onClick:s=>this.do_login(this.props.token_callback),children:"\u767B\u5F55"})]}),t("hr",{}),t("p",{children:t("b",{children:"\u4ECE\u5176\u4ED6\u8BBE\u5907\u5BFC\u5165\u767B\u5F55\u72B6\u6001"})}),o("p",{children:[t("input",{ref:this.input_token_ref,placeholder:"User Token"}),t("button",{type:"button",disabled:this.state.loading_status==="loading",onClick:s=>this.do_input_token(this.props.token_callback),children:"\u5BFC\u5165"})]}),t("hr",{}),t("p",{children:t("button",{onClick:this.props.on_close,children:"\u53D6\u6D88"})})]})]}),this.popup_anchor)}}class q extends d.exports.Component{constructor(e){super(e),this.state={popup_show:!1},this.on_popup_bound=this.on_popup.bind(this),this.on_close_bound=this.on_close.bind(this)}on_popup(){this.setState({popup_show:!0})}on_close(){this.setState({popup_show:!1})}render(){return o(me,{children:[this.props.children(this.on_popup_bound),this.state.popup_show&&t(Je,{token_callback:this.props.token_callback,on_close:this.on_close_bound})]})}}const te="hole_cache_db",$e=1,et=150,se=1e3,ie=42;class tt{constructor(){this.db=null,this.added_items_since_maintenance=0,this.encrypt=this.encrypt.bind(this),this.decrypt=this.decrypt.bind(this);const e=indexedDB.open(te,$e);e.onerror=console.error.bind(console),e.onupgradeneeded=s=>{console.log("comment cache db upgrade"),s.target.result.createObjectStore("comment",{keyPath:"pid"}).createIndex("last_access","last_access",{unique:!1})},e.onsuccess=s=>{console.log("comment cache db loaded"),this.db=s.target.result,setTimeout(this.maintenance.bind(this),1)}}encrypt(e,s){const i=JSON.stringify(s);let n="";for(let r=0,u=(ie^e)%128;r<i.length;r++){const l=i.charCodeAt(r),c=(u^l/2)%128;n+=String.fromCharCode(u^i.charCodeAt(r)),u=c}return n}decrypt(e,s){let i="";if(typeof s!="string")return null;for(let n=0,r=(ie^e)%128;n<s.length;n++){const u=r^s.charCodeAt(n);i+=String.fromCharCode(u),r=(r^u/2)%128}try{return JSON.parse(i)}catch(n){return console.error("decrypt failed"),console.trace(n),null}}get(e,s){return e=parseInt(e),new Promise((i,n)=>{if(!this.db)return i(null);let r,u;try{u=this.db.transaction(["comment"],"readwrite").objectStore("comment"),r=u.get(e)}catch(l){console.exception(l),i(null)}r.onsuccess=()=>{const l=r.result;if(!l||!l.data_str)i(null);else if(s===l.version){console.log("comment cache hit",e),l.last_access=+new Date,u.put(l);const c=this.decrypt(e,l.data_str);i(c)}else console.log("comment cache expired",e,": ver",l.version,"target",s),u.delete(e),i(null)},r.onerror=l=>{console.warn("comment cache indexeddb open failed"),console.error(l),i(null)}})}put(e,s,i){return e=parseInt(e),new Promise((n,r)=>{if(!this.db)return n();try{this.db.transaction(["comment"],"readwrite").objectStore("comment").put({pid:e,version:s,data_str:this.encrypt(e,i),last_access:+new Date}),console.log("comment cache put",e),++this.added_items_since_maintenance===et&&setTimeout(this.maintenance.bind(this),1)}catch(u){return console.exception(u),n()}})}delete(e){return e=parseInt(e),new Promise((s,i)=>{if(!this.db)return s();let n;try{n=this.db.transaction(["comment"],"readwrite").objectStore("comment").delete(e)}catch(r){return console.exception(r),s()}console.log("comment cache delete",e),n.onerror=()=>(console.warn("comment cache delete failed ",e),s()),n.onsuccess=()=>s()})}maintenance(){if(!this.db)return;const s=this.db.transaction(["comment"],"readwrite").objectStore("comment"),i=s.count();i.onsuccess=()=>{let n=i.result;n>se?(console.log("comment cache db maintenance",n),s.index("last_access").openKeyCursor().onsuccess=r=>{const u=r.target.result;u&&(s.delete(u.primaryKey),--n>se&&u.continue())}):console.log("comment cache db no need to maintenance",n),this.added_items_since_maintenance=0},i.onerror=console.error.bind(console)}clear(){if(!!this.db)try{indexedDB.deleteDatabase(te),console.log("delete comment cache db")}catch(e){console.exception(e)}}}function y(){return window.hole_cache||(window.hole_cache=new tt),window.hole_cache}function _(a){return k()+(a?"&user_token="+a:"")}const st=50,F=async(a,e=!1)=>{const s=await b(a);if(s.code!==0)if(s.msg)if(e)alert(s.msg);else throw new Error(s.msg);else throw new Error(JSON.stringify(s));return s},ne=(a,e)=>a.sort((s,i)=>parseInt(s.cid,10)-parseInt(i.cid,10)).map(s=>(s._display_color=e.get(s.name),s.variant={},s)),R={iframe:null,load_iframe(){if(this.iframe)return;const a=document.createElement("iframe");a.src="https://pkuhelper.pku.edu.cn/hole/",a.style.width="0",a.style.height="0",a.style.border="none",a.style.position="absolute",document.body.appendChild(a),this.iframe=a},remove_iframe(){this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null)}},m={max_captcha_retry:8,load_replies:async(a,e,s,i,n=0)=>{a=parseInt(a);const r=await fetch(f+"/api.php?action=getcomment&pid="+a+_(e)),u=await F(r);if(u.data.length===1&&u.data[0].text.startsWith("[Helper]")){if(window.config.auto_captcha&&n<m.max_captcha_retry)return R.load_iframe(),new Promise(l=>setTimeout(l,1e3)).then(()=>m.load_replies(a,e,s,i,n+1))}else R.remove_iframe(),y().put(a,i,u);return u.data=ne(u.data,s),u},load_replies_with_cache:async(a,e,s,i)=>{a=parseInt(a);let n=await y().get(a,i);return n?(n.data=ne(n.data,s),{data:n,cached:!0}):(n=await m.load_replies(a,e,s,i),{data:n,cached:!n})},set_attention:async(a,e,s)=>{const i=new URLSearchParams;i.append("user_token",s),i.append("pid",a),i.append("switch",e?"1":"0");const n=await fetch(f+"/api.php?action=attention"+_(s),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i});return y().delete(a),F(n,!0)},report:async(a,e,s)=>{const i=new URLSearchParams;i.append("user_token",s),i.append("pid",a),i.append("reason",e);const n=await fetch(f+"/api.php?action=report"+_(s),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i});return F(n,!0)},get_list:async(a,e,s=0)=>{const i=await fetch(f+"/api.php?action=getlist&p="+a+_(e)),n=await F(i);return window.config.auto_captcha&&s<m.max_captcha_retry?n.data.every(r=>r.text.startsWith("\u4E3A\u4FDD\u969C\u6811\u6D1E"))?(R.load_iframe(),new Promise(r=>setTimeout(r,1e3)).then(()=>m.get_list(a,e))):(R.remove_iframe(),n):n},get_search:async(a,e,s)=>{const i=await fetch(f+"/api.php?action=search&pagesize="+st+"&page="+a+"&keywords="+encodeURIComponent(e)+_(s));return F(i)},get_single:async(a,e)=>{const s=await fetch(f+"/api.php?action=getone&pid="+a+_(e));return F(s)},get_attention:async a=>{const e=await fetch(f+"/api.php?action=getattention"+_(a));return F(e)}};const f=A+"services/pkuhole";function it(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ae(a,e=" ",s="g",i=!1){if(i)try{return new RegExp("("+a.slice(1,-1)+")",s)}catch{return/^$/g}else return a?new RegExp(`(${a.split(e).filter(n=>!!n).map(it).join("|")})`,s):/^$/g}function _e(a){return t("span",{className:"colored-span",style:{"--coloredspan-bgcolor-light":a.colors[0],"--coloredspan-bgcolor-dark":a.colors[1]},children:a.children})}class fe extends d.exports.PureComponent{render(){function e(s){return/^https?:\/\//.test(s)?s:"http://"+s}return t("pre",{children:this.props.parts.map((s,i)=>{const[n,r]=s;return t("span",{children:n==="url_pid"?t("span",{className:"url-pid-link",title:r,children:"/hole/##"}):n==="url"?t("a",{href:e(r),target:"_blank",rel:"noopener",children:r}):n==="pid"?t("a",{href:"##"+r,onClick:u=>{u.preventDefault(),this.props.show_pid(r)},children:r}):n==="nickname"?t(_e,{colors:this.props.color_picker.get(r),children:r}):n==="search"?t("span",{className:"search-query-highlight",children:r}):r},i)})})}}window.TEXTAREA_BACKUP={};class Ae extends d.exports.Component{constructor(e){super(e),this.state={text:""},this.on_change_bound=this.on_change.bind(this),this.on_keydown_bound=this.on_keydown.bind(this),this.clear=this.clear.bind(this),this.area_ref=g.createRef(),this.change_callback=e.on_change||(()=>{}),this.submit_callback=e.on_submit||(()=>{})}componentDidMount(){this.setState({text:window.TEXTAREA_BACKUP[this.props.id]||""},()=>{this.change_callback(this.state.text)})}componentWillUnmount(){window.TEXTAREA_BACKUP[this.props.id]=this.state.text,this.change_callback(this.state.text)}on_change(e){this.setState({text:e.target.value}),this.change_callback(e.target.value)}on_keydown(e){e.key==="Enter"&&e.ctrlKey&&!e.altKey&&(e.preventDefault(),this.submit_callback())}clear(){this.setState({text:""})}set(e){this.change_callback(e),this.setState({text:e})}get(){return this.state.text}focus(){this.area_ref.current.focus()}render(){return t("textarea",{ref:this.area_ref,onChange:this.on_change_bound,value:this.state.text,onKeyDown:this.on_keydown_bound})}}let O=null;window.addEventListener("beforeinstallprompt",a=>{console.log("pwa: received before install prompt"),O=a});function nt(a){const e=/iPhone|iPad|iPod/i.test(window.navigator.userAgent);return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone?null:e?navigator.standalone?null:o("div",{className:"box promotion-bar",children:[t("span",{className:"icon icon-about"}),"\xA0 \u7528 Safari \u628A\u6811\u6D1E ",t("b",{children:"\u6DFB\u52A0\u5230\u4E3B\u5C4F\u5E55"})," \u66F4\u597D\u7528"]}):O?o("div",{className:"box promotion-bar",children:[t("span",{className:"icon icon-about"}),"\xA0 \u628A\u7F51\u9875\u7248\u6811\u6D1E"," ",t("b",{children:t("a",{onClick:()=>{O&&O.prompt()},children:"\u5B89\u88C5\u5230\u684C\u9762"})})," ","\u66F4\u597D\u7528"]}):null}class oe extends d.exports.PureComponent{constructor(e){super(e),this.state={moved:!0,init_y:0,init_x:0},this.on_begin_bound=this.on_begin.bind(this),this.on_move_bound=this.on_move.bind(this),this.on_end_bound=this.on_end.bind(this),this.MOVE_THRESHOLD=3,this.last_fire=0}on_begin(e){this.setState({moved:!1,init_y:(e.touches?e.touches[0]:e).screenY,init_x:(e.touches?e.touches[0]:e).screenX})}on_move(e){this.state.moved||Math.abs((e.touches?e.touches[0]:e).screenY-this.state.init_y)+Math.abs((e.touches?e.touches[0]:e).screenX-this.state.init_x)>this.MOVE_THRESHOLD&&this.setState({moved:!0})}on_end(e){this.state.moved||this.do_callback(e),this.setState({moved:!0})}do_callback(e){this.last_fire+100>+new Date||(this.last_fire=+new Date,this.props.callback(e))}render(){return t("div",{onTouchStart:this.on_begin_bound,onMouseDown:this.on_begin_bound,onTouchMove:this.on_move_bound,onMouseMove:this.on_move_bound,onClick:this.on_end_bound,children:this.props.children})}}window.audio_cache={};function at(){return new Promise((a,e)=>{window.AMR?a():Ne("static/amr_all.min.js",s=>{s?e(s):a()})})}class ot extends d.exports.Component{constructor(e){super(e),this.state={url:this.props.src,state:"waiting",data:null}}load(){if(window.audio_cache[this.state.url]){this.setState({state:"loaded",data:window.audio_cache[this.state.url]});return}console.log("fetching audio",this.state.url),this.setState({state:"loading"}),Promise.all([fetch(this.state.url),at()]).then(e=>{e[0].blob().then(s=>{const i=new FileReader;i.onload=n=>{const r=new window.AMR().decode(n.target.result);if(!r){alert("audio decoding failed");return}const u=window.PCMData.encode({sampleRate:8e3,channelCount:1,bytesPerSample:2,data:r}),l=new Uint8Array(u.length);for(let h=0;h<u.length;h++)l[h]=u.charCodeAt(h);const c=URL.createObjectURL(new Blob([l],{type:"audio/wav"}));window.audio_cache[this.state.url]=c,this.setState({state:"loaded",data:c})},i.readAsBinaryString(s)}),this.setState({state:"decoding"})})}render(){if(this.state.state==="waiting")return t("p",{children:t("a",{onClick:this.load.bind(this),children:"\u52A0\u8F7D\u97F3\u9891"})});if(this.state.state==="loading")return t("p",{children:"\u6B63\u5728\u4E0B\u8F7D\u2026\u2026"});if(this.state.state==="decoding")return t("p",{children:"\u6B63\u5728\u89E3\u7801\u2026\u2026"});if(this.state.state==="loaded")return t("p",{children:t("audio",{src:this.state.data,controls:!0})})}}class rt extends d.exports.PureComponent{constructor(e){super(e),this.state={loading_status:"idle",msg:[]}}componentDidMount(){this.load()}load(){this.state.loading_status!=="loading"&&this.setState({loading_status:"loading"},()=>{fetch(A+"api_xmcp/hole/system_msg?user_token="+encodeURIComponent(this.props.token)+k()).then(b).then(e=>{if(e.error)throw new Error(e.error);this.setState({loading_status:"done",msg:e.result})}).catch(e=>{console.error(e),alert(""+e),this.setState({loading_status:"failed"})})})}render(){return this.state.loading_status==="loading"?t("p",{className:"box box-tip",children:"\u52A0\u8F7D\u4E2D\u2026\u2026"}):this.state.loading_status==="failed"?t("div",{className:"box box-tip",children:t("a",{onClick:()=>{this.load()},children:"\u91CD\u65B0\u52A0\u8F7D"})}):this.state.loading_status==="done"?this.state.msg.map(e=>o("div",{className:"box",children:[o("div",{className:"box-header",children:[t(v,{stamp:e.timestamp}),t("b",{children:e.title})]}),t("div",{className:"box-content",children:t("pre",{children:e.content})})]},e.timestamp)):null}}const L={"static/bg/gbp.jpg":"\u5BFB\u89C5\u7E41\u661F\uFF08\u9ED8\u8BA4\uFF09","static/bg/eriri.jpg":"\u5E73\u6210\u8457\u540D\u753B\u5E08","static/bg/yurucamp.jpg":"\u9732\u8425\u5929\u4E0B\u7B2C\u4E00","static/bg/minecraft.jpg":"\u9EA6\u6069\xB7\u5E93\u62C9\u592B\u7279","static/bg/sif.jpg":"\u68A6\u5F00\u59CB\u7684\u5730\u65B9"},ut={background_img:"static/bg/gbp.jpg",background_color:"#113366",pressure:!1,easter_egg:!0,color_scheme:"default",block_words:[],alias:{},attention_sort:!1,auto_captcha:!1,flow_image:"default"};function Z(){const a=Object.assign({},ut);let e;try{e=JSON.parse(localStorage.hole_config||"{}")}catch(s){alert(`\u8BBE\u7F6E\u52A0\u8F7D\u5931\u8D25\uFF0C\u5C06\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u8BBE\u7F6E\uFF01
`+s),delete localStorage.hole_config,e={}}Object.keys(e).forEach(s=>{a[s]!==void 0&&(a[s]=e[s])}),console.log("config loaded",a),window.config=a}function T(){localStorage.hole_config=JSON.stringify(window.config),Z()}function be(a,e){return a===void 0&&(a=window.config.background_img),e===void 0&&(e=window.config.background_color),{background:"transparent center center",backgroundImage:a===null?"unset":'url("'+encodeURI(a)+'")',backgroundColor:e,backgroundSize:"cover"}}class lt extends d.exports.PureComponent{constructor(e){super(e),this.state={img:window.config.background_img,color:window.config.background_color}}save_changes(){this.props.callback({background_img:this.state.img,background_color:this.state.color})}on_select(e){const s=e.target.value;this.setState({img:s==="##other"?"":s==="##color"?null:s},this.save_changes.bind(this))}on_change_img(e){this.setState({img:e.target.value},this.save_changes.bind(this))}on_change_color(e){this.setState({color:e.target.value},this.save_changes.bind(this))}render(){const e=this.state.img===null?"##color":Object.keys(L).indexOf(this.state.img)===-1?"##other":this.state.img;return o("div",{children:[o("p",{children:[t("b",{children:"\u80CC\u666F\u56FE\u7247\uFF1A"}),o("select",{className:"config-select",value:e,onChange:this.on_select.bind(this),children:[Object.keys(L).map(s=>t("option",{value:s,children:L[s]},s)),t("option",{value:"##other",children:"\u8F93\u5165\u56FE\u7247\u7F51\u5740\u2026\u2026"}),t("option",{value:"##color",children:"\u7EAF\u8272\u80CC\u666F\u2026\u2026"})]}),"\xA0",t("small",{children:"#background_img"}),"\xA0",e==="##other"&&t("input",{type:"url",placeholder:"\u56FE\u7247\u7F51\u5740",value:this.state.img,onChange:this.on_change_img.bind(this)}),e==="##color"&&t("input",{type:"color",value:this.state.color,onChange:this.on_change_color.bind(this)})]}),t("div",{className:"bg-preview",style:be(this.state.img,this.state.color)})]})}}class re extends d.exports.PureComponent{constructor(e){super(e),this.state={[e.id]:this.props.display(window.config[e.id])}}copy_value(){Q(this.state[this.props.id])&&alert(`\u6210\u529F\u5C06${this.props.name}\u7684\u5185\u5BB9\u590D\u5236\u5230\u526A\u8D34\u677F\uFF01
\u8BF7\u4E00\u5B9A\u4E0D\u8981\u6CC4\u9732\u54E6`)}on_blur(e){const s=e.target.value,i=this.props.parse(s);this.setState({[this.props.id]:s},()=>{this.props.callback({[this.props.id]:i})})}on_change(e){const s=e.target.value;this.setState(i=>({[this.props.id]:s}))}render(){return t("div",{children:o("label",{children:[o("p",{children:[t("b",{children:this.props.name}),"\xA0",o("small",{children:["#",this.props.id]}),t("a",{style:{float:"right"},onClick:this.copy_value.bind(this),children:t("small",{children:"\u590D\u5236"})})]}),t("p",{className:"config-description",children:this.props.description}),t("textarea",{name:"config-"+this.props.id,id:`config-textarea-${this.props.id}`,className:"config-textarea",value:this.state[this.props.id],onChange:this.on_change.bind(this),onBlur:this.on_blur.bind(this)})]})})}}class U extends d.exports.PureComponent{constructor(e){super(e),this.state={switch:window.config[this.props.id]}}on_change(e){const s=e.target.checked;this.setState({switch:s},()=>{this.props.callback({[this.props.id]:s})})}render(){return o("div",{children:[t("p",{children:o("label",{children:[t("input",{name:"config-"+this.props.id,type:"checkbox",checked:this.state.switch,onChange:this.on_change.bind(this)}),"\xA0",t("b",{children:this.props.name}),"\xA0",o("small",{children:["#",this.props.id]})]})}),t("p",{className:"config-description",children:this.props.description})]})}}class ue extends d.exports.PureComponent{constructor(e){super(e),this.state={selected:window.config[this.props.id]}}on_change(e){const s=e.target.value;this.setState({selected:s},()=>{this.props.callback({[this.props.id]:s})})}render(){return o("div",{children:[t("p",{children:o("label",{children:[o("b",{children:[this.props.name,"\uFF1A"]}),t("select",{className:"config-select",name:"config-"+this.props.id,value:this.state.selected,onChange:this.on_change.bind(this),children:this.props.options.map(e=>t("option",{value:e.value,children:e.name},e.value))}),"\xA0",o("small",{children:["#",this.props.id]})]})}),t("p",{className:"config-description",children:this.props.description})]})}}class ct extends d.exports.PureComponent{constructor(e){super(e),this.save_changes_bound=this.save_changes.bind(this)}save_changes(e){console.log(e),Object.keys(e).forEach(s=>{window.config[s]=e[s]}),T()}reset_settings(){window.confirm("\u91CD\u7F6E\u6240\u6709\u8BBE\u7F6E\uFF1F")&&(window.config={},T(),window.location.reload())}render(){return o("div",{children:[o("div",{className:"box config-ui-header",children:[o("p",{children:["\u8FD9\u4E9B\u529F\u80FD\u4ECD\u5728\u6D4B\u8BD5\uFF0C\u53EF\u80FD\u4E0D\u7A33\u5B9A\uFF08",t("a",{onClick:this.reset_settings.bind(this),children:"\u5168\u90E8\u91CD\u7F6E"}),"\uFF09"]}),t("p",{children:o("b",{children:["\u4FEE\u6539\u8BBE\u7F6E\u540E"," ",t("a",{onClick:()=>{window.location.reload()},children:"\u5237\u65B0\u9875\u9762"})," ","\u65B9\u53EF\u751F\u6548"]})})]}),o("div",{className:"box",children:[t(lt,{id:"background",callback:this.save_changes_bound}),t("hr",{}),t(ue,{id:"color_scheme",callback:this.save_changes_bound,options:[{value:"default",name:"\u8DDF\u968F\u7CFB\u7EDF"},{value:"light",name:"\u59CB\u7EC8\u6D45\u8272\u6A21\u5F0F"},{value:"dark",name:"\u59CB\u7EC8\u6DF1\u8272\u6A21\u5F0F"}],name:"\u591C\u95F4\u6A21\u5F0F",description:"\u9009\u62E9\u6D45\u8272\u6216\u6DF1\u8272\u6A21\u5F0F\uFF0C\u6DF1\u8272\u6A21\u5F0F\u4E0B\u5C06\u4F1A\u8C03\u6697\u56FE\u7247\u4EAE\u5EA6"}),t("hr",{}),t(U,{callback:this.save_changes_bound,id:"pressure",name:"\u5FEB\u901F\u8FD4\u56DE",description:"\u77ED\u6682\u6309\u4F4F Esc \u952E\u6216\u91CD\u538B\u5C4F\u5E55\uFF083D Touch\uFF09\u53EF\u4EE5\u5FEB\u901F\u8FD4\u56DE\u6216\u8005\u5237\u65B0\u6811\u6D1E"}),t("hr",{}),t(U,{callback:this.save_changes_bound,id:"easter_egg",name:"\u5141\u8BB8\u5F69\u86CB",description:"\u5728\u67D0\u4E9B\u60C5\u51B5\u4E0B\u663E\u793A\u5F69\u86CB"})]}),o("div",{className:"box",children:[t(re,{id:"block_words",callback:this.save_changes_bound,name:"\u8BBE\u7F6E\u5C4F\u853D\u8BCD",description:"\u5305\u542B\u5C4F\u853D\u8BCD\u7684\u6811\u6D1E\u4F1A\u88AB\u6298\u53E0\uFF0C\u6BCF\u884C\u5199\u4E00\u4E2A\u5C4F\u853D\u8BCD",display:e=>e.join(`
`),parse:e=>e.split(`
`).filter(s=>s)}),t("hr",{}),t(re,{id:"alias",callback:this.save_changes_bound,name:"\u8BBE\u7F6E\u522B\u540D",description:"\u53EF\u7528 #\u522B\u540D \u4EE3\u66FF #PID\uFF08\u6811\u6D1E\u53F7\uFF09\u8FDB\u884C\u67E5\u8BE2\uFF0C\u6BCF\u884C\u7531\u6811\u6D1E\u53F7\u3001\u534A\u89D2\u7A7A\u683C\u3001\u522B\u540D\u987A\u5E8F\u8FDE\u63A5\uFF0C\u5982\u201C472865 \u7F51\u9875\u7248\u53D1\u5E03\u201D\uFF0C\u522B\u540D\u4E2D\u4E0D\u53EF\u5305\u542B\u7A7A\u683C",display:e=>Object.entries(e).map(s=>s[1]+" "+s[0]).reduce((s,i)=>s?i+`
`+s:i,""),parse:e=>{const s={};return e.split(`
`).filter(i=>i).forEach(i=>{const n=i.split(" ");n.length===2&&!isNaN(Number(n[0]))&&(s[n[1]]=Number(n[0]))}),s}}),t("hr",{}),t(ue,{callback:this.save_changes_bound,id:"flow_image",name:"\u65F6\u95F4\u7EBF\u56FE\u7247",options:[{value:"default",name:"\u9ED8\u8BA4"},{value:"hidden",name:"\u9ED8\u8BA4\u9690\u85CF"},{value:"thumbnail",name:"\u9ED8\u8BA4\u663E\u793A\u7F29\u7565\u56FE"}],description:"\u9ED8\u8BA4\u5C06\u7EF4\u6301\u539F\u8C8C\uFF0C\u53EF\u9009\u62E9\u9ED8\u8BA4\u9690\u85CF\u548C\u9ED8\u8BA4\u663E\u793A\u7F29\u7565\u56FE\uFF0C\u70B9\u51FB\u540E\u518D\u663E\u793A\u5B8C\u6574\u56FE\u7247"}),t(U,{callback:this.save_changes_bound,id:"attention_sort",name:"\u5173\u6CE8\u5217\u8868\u6392\u5E8F",description:"\u542F\u7528\u540E\uFF0C\u53EF\u4EE5\u5C06\u5173\u6CE8\u5217\u8868\u6309\u6700\u540E\u56DE\u590D\u65F6\u95F4\u6392\u5E8F\u3002\u4E0D\u5EFA\u8BAE\u5728\u6027\u80FD\u8F83\u5DEE\u7684\u8BBE\u5907\u4E0A\u542F\u7528"}),t(U,{callback:this.save_changes_bound,id:"auto_captcha",name:"\u81EA\u52A8\u4EBA\u673A\u9A8C\u8BC1",description:"\u542F\u7528\u540E\uFF0C\u5C06\u81EA\u52A8\u5B8C\u6210\u4EBA\u673A\u9A8C\u8BC1\u3002\u4E0D\u7A33\u5B9A\u3002"})]}),t("div",{className:"box",children:o("p",{children:["\u65B0\u529F\u80FD\u5EFA\u8BAE\u6216\u95EE\u9898\u53CD\u9988\u8BF7\u5728\xA0",o("a",{href:"https://github.com/AllanChain/PKUHoleCommunity/issues",target:"_blank",children:["GitHub ",t("span",{className:"icon icon-github"})]}),"\xA0\u63D0\u51FA\u3002"]})})]})}}const Ee=4/3,C=8e3,le=5e6,ht=45e4*Ee,x=g.createContext({value:null,set_value:()=>{}});class dt extends d.exports.Component{constructor(e){super(e),window._life_info_cache||(window._life_info_cache={}),this.CACHE_TIMEOUT_S=15,this.state={today_info:this.cache_get("today_info"),card_balance:this.cache_get("card_balance"),net_balance:this.cache_get("net_balance"),mail_count:this.cache_get("mail_count")},this.INTERNAL_NETWORK_FAILURE="_network_failure",this.API_NAME={today_info:"hole/today_info",card_balance:"isop/card_balance",net_balance:"isop/net_balance",mail_count:"isop/mail_count"}}cache_get(e){const s=window._life_info_cache[e];return!s||+new Date-s[0]>1e3*this.CACHE_TIMEOUT_S?null:s[1]}cache_set(e,s){(!window._life_info_cache[e]||window._life_info_cache[e][1]!==s)&&(window._life_info_cache[e]=[+new Date,s])}load(e){this.setState({[e]:null},()=>{fetch(A+"api_xmcp/"+this.API_NAME[e]+"?user_token="+encodeURIComponent(this.props.token)+k()).then(b).then(s=>{this.setState({[e]:s})}).catch(s=>{this.setState({[e]:{errMsg:"\u7F51\u7EDC\u9519\u8BEF "+s,errCode:this.INTERNAL_NETWORK_FAILURE,success:!1}})})})}componentDidMount(){["today_info","card_balance","net_balance","mail_count"].forEach(e=>{this.state[e]||this.load(e)})}reload_all(){["today_info","card_balance","net_balance","mail_count"].forEach(e=>{this.load(e)})}render_line(e,s,i,n,r,u){const l=this.state[e];if(l){if(l.success)return this.cache_set(e,l),o("tr",{children:[t("td",{children:s}),t("td",{children:i(l)}),t("td",{children:o("a",{href:r(l),target:"_blank",rel:"noopener",children:[t("span",{className:"icon icon-forward"}),"\xA0",n]})})]});{let c="\u52A0\u8F7D\u5931\u8D25";l.errCode===this.INTERNAL_NETWORK_FAILURE?c="\u7F51\u7EDC\u9519\u8BEF":["E01","E02","E03"].indexOf(l.errCode)!==-1&&(c="\u6388\u6743\u5931\u6548");let h=JSON.stringify(l);return l.errMsg?h=l.errMsg:l.error&&(h=l.error),o("tr",{children:[t("td",{children:s}),t("td",{className:"life-info-error",children:t("a",{onClick:()=>alert(h),children:c})}),t("td",{children:c==="\u6388\u6743\u5931\u6548"?o("a",{onClick:u,children:[t("span",{className:"icon icon-forward"}),"\xA0\u91CD\u65B0\u767B\u5F55"]}):o("a",{onClick:()=>this.load(e),children:[t("span",{className:"icon icon-forward"}),"\xA0\u91CD\u8BD5"]})})]})}}else return o("tr",{children:[t("td",{children:s}),t("td",{children:"\u52A0\u8F7D\u4E2D\u2026\u2026"}),t("td",{})]})}render(){return t(q,{token_callback:e=>{this.props.set_token(e),this.reload_all()},children:e=>t("div",{className:"box",children:t("table",{className:"life-info-table",children:o("tbody",{children:[this.render_line("today_info","\u4ECA\u65E5",s=>s.info,"\u6821\u5386",s=>s.schedule_url,e),this.render_line("card_balance","\u6821\u56ED\u5361",s=>`\u4F59\u989D\uFFE5${s.balance.toFixed(2)}`,"\u5145\u503C",()=>"https://virtualprod.alipay.com/educate/educatePcRecharge.htm?schoolCode=PKU&schoolName=",e),this.render_line("net_balance","\u7F51\u8D39",s=>`\u4F59\u989D\uFFE5${s.balance.toFixed(2)}`,"\u5145\u503C",()=>"https://its.pku.edu.cn/epay.jsp",e),this.render_line("mail_count","\u90AE\u4EF6",s=>`\u672A\u8BFB ${s.count} \u5C01`,"\u67E5\u770B",()=>"https://mail.pku.edu.cn/",e)]})})})})}}function Fe(a){return o("div",{children:[t(nt,{}),t(mt,{show_sidebar:a.show_sidebar}),o("div",{className:"box list-menu",children:[o("a",{onClick:()=>{a.show_sidebar("\u8BBE\u7F6E",t(ct,{}))},children:[t("span",{className:"icon icon-settings"}),t("label",{children:"\u7F51\u9875\u7248\u6811\u6D1E\u8BBE\u7F6E"})]}),"\xA0\xA0",o("a",{href:"http://pkuhelper.pku.edu.cn/treehole_rules.html",target:"_blank",children:[t("span",{className:"icon icon-textfile"}),t("label",{children:"\u6811\u6D1E\u89C4\u8303"})]}),"\xA0\xA0",o("a",{href:"https://github.com/AllanChain/PKUHoleCommunity/issues",target:"_blank",children:[t("span",{className:"icon icon-github"}),t("label",{children:"\u610F\u89C1\u53CD\u9988"})]})]}),o("div",{className:"box help-desc-box",children:[o("p",{children:["PKUHelper \u7F51\u9875\u7248\u6811\u6D1E\u793E\u533A\u7248 by @xmcp, and awesome community. \u57FA\u4E8E\xA0",t("a",{href:"https://www.gnu.org/licenses/gpl-3.0.zh-cn.html",target:"_blank",children:"GPLv3"}),"\xA0\u534F\u8BAE\u5728"," ",t("a",{href:"https://github.com/AllanChain/PKUHoleCommunity",target:"_blank",children:"GitHub"})," ","\u5F00\u6E90"]}),o("p",{children:["PKUHelper \u7F51\u9875\u7248\u7684\u8BDE\u751F\u79BB\u4E0D\u5F00\xA0",t("a",{href:"https://reactjs.org/",target:"_blank",rel:"noopener",children:"React"}),"\u3001",t("a",{href:"https://icomoon.io/#icons",target:"_blank",rel:"noopener",children:"IcoMoon"}),"\xA0\u7B49\u5F00\u6E90\u9879\u76EE"]}),t("p",{children:"PKU Helper \u7684\u201C\u540C\u610F\u201D"}),o("blockquote",{children:[t("p",{children:"\u6839\u636E GPL\uFF0C\u4F60\u6709\u6743 fork\u3010\u7F51\u9875\u7248\u6811\u6D1E\u524D\u7AEF\u3011\u7684\u4EE3\u7801\u5E76\u8FDB\u884C\u76F8\u5E94\u7684\u4FEE\u6539\u3002 \u8BF7\u6CE8\u610F\uFF0C\u4F60\u7684\u4FEE\u6539\u7248\u672C\u5FC5\u987B\u4F9D\u7136\u57FA\u4E8E GPL \u6388\u6743\uFF0C\u5E76\u4F9D\u636E\u6B64\u516C\u5F00\u6E90\u7801\u3002"}),t("p",{children:"\u6839\u636E\u6811\u6D1E\u89C4\u8303 5.3 \u89C4\u5B9A\uFF0C\u975E\u5B98\u65B9\u5BA2\u6237\u7AEF\u5728 PKU Helper \u56E2\u961F\u8BA4\u5B9A\u9020\u6210\u4E0D\u5229\u5F71\u54CD\uFF0C \u4F8B\u5982\u975E\u6CD5\u653B\u51FB\u670D\u52A1\u5668\u3001\u76D7\u53D6\u7528\u6237\u4E2A\u4EBA\u4FE1\u606F\u65F6\uFF0C\u6211\u4EEC\u6709\u6743\u5BF9\u5176\u8FDB\u884C\u5C01\u7981\u3002"})]}),t("p",{children:"\u7528\u6237\u9700\u5BF9\u4E0D\u6070\u5F53\u4F7F\u7528\u6B64\u7248\u672C\u6216\u5229\u7528\u6B64\u7248\u672C\u7684\u6F0F\u6D1E\u5BF9 PKU Helper \u9020\u6210\u7684\u4E0D\u5229\u5F71\u54CD\u627F\u62C5\u98CE\u9669\u3002 \u4F5C\u4E3A\u793E\u533A\u7248\u672C\uFF0C\u793E\u533A\uFF08no warranty\uFF09\u7EF4\u62A4\u7248\u672C\u7684\u5B89\u5168\uFF0C\u540C\u65F6\u4E5F\u6B22\u8FCE\u540C\u5B66\u5B9E\u73B0\u4F60\u7684\u60F3\u6CD5\u3002"}),o("p",{children:[t("a",{onClick:()=>{"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(e=>{for(const s of e)console.log("unregister",s),s.unregister()}),y().clear(),setTimeout(()=>{window.location.reload(!0)},200)},children:"\u5F3A\u5236\u68C0\u67E5\u66F4\u65B0"}),"\uFF08Community v","0.6.0"," ","prod"," ","\u4F1A\u81EA\u52A8\u5728\u540E\u53F0\u68C0\u67E5\u66F4\u65B0\u5E76\u5728\u4E0B\u6B21\u8BBF\u95EE\u65F6\u66F4\u65B0\uFF09"]})]})]})}class pt extends d.exports.Component{constructor(e){super(e),this.state={loading_status:"done"}}do_reset(){if(window.confirm(`\u60A8\u6B63\u5728\u91CD\u7F6E UserToken\uFF01
\u60A8\u7684\u8D26\u53F7\u5C06\u4F1A\u5728\u3010\u6240\u6709\u8BBE\u5907\u3011\u4E0A\u6CE8\u9500\uFF0C\u60A8\u9700\u8981\u624B\u52A8\u91CD\u65B0\u767B\u5F55\uFF01`)){const e=window.prompt(`\u60A8\u6B63\u5728\u91CD\u7F6E UserToken\uFF01
\u8BF7\u8F93\u5165\u60A8\u7684\u5B66\u53F7\u4EE5\u786E\u8BA4\u8EAB\u4EFD\uFF1A`);e&&this.setState({loading_status:"loading"},()=>{fetch(A+"api_xmcp/hole/reset_usertoken",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_token:this.props.token,uid:e})}).then(b).then(s=>{if(s.error)throw new Error(s.error);alert("\u91CD\u7F6E\u6210\u529F\uFF01\u60A8\u9700\u8981\u5728\u6240\u6709\u8BBE\u5907\u4E0A\u91CD\u65B0\u767B\u5F55\u3002"),this.setState({loading_status:"done"})}).catch(s=>{alert("\u91CD\u7F6E\u5931\u8D25\uFF1A"+s),this.setState({loading_status:"done"})})})}}render(){if(this.state.loading_status==="done")return t("a",{onClick:this.do_reset.bind(this),children:"\u91CD\u7F6E"});if(this.state.loading_status==="loading")return t("a",{children:t("span",{className:"icon icon-loading"})})}}class mt extends d.exports.Component{copy_token(e){Q(e)&&alert(`\u590D\u5236\u6210\u529F\uFF01
\u8BF7\u4E00\u5B9A\u4E0D\u8981\u6CC4\u9732\u54E6`)}render(){return t(x.Consumer,{children:e=>o("div",{children:[!!e.value&&t(dt,{token:e.value,set_token:e.set_value}),t("div",{className:"login-form box",children:e.value?o("div",{children:[o("p",{children:[t("b",{children:"\u60A8\u5DF2\u767B\u5F55\u3002"}),o("button",{type:"button",onClick:()=>{e.set_value(null)},children:[t("span",{className:"icon icon-logout"})," \u6CE8\u9500"]}),t("br",{})]}),t("p",{children:"\u6839\u636E\u8BA1\u7B97\u4E2D\u5FC3\u8981\u6C42\uFF0C\u8BBF\u95EE\u6388\u6743\u4E09\u4E2A\u6708\u5185\u6709\u6548\uFF0C\u8FC7\u671F\u9700\u91CD\u65B0\u767B\u5F55\u3002"}),o("p",{children:[t("a",{onClick:()=>{this.props.show_sidebar("\u7CFB\u7EDF\u6D88\u606F",t(rt,{token:e.value}))},children:"\u67E5\u770B\u7CFB\u7EDF\u6D88\u606F"}),t("br",{}),"\u5F53\u60A8\u53D1\u9001\u7684\u5185\u5BB9\u8FDD\u89C4\u65F6\uFF0C\u6211\u4EEC\u5C06\u7528\u7CFB\u7EDF\u6D88\u606F\u63D0\u793A\u60A8"]}),o("p",{children:[t("a",{onClick:this.copy_token.bind(this,e.value),children:"\u590D\u5236 User Token"}),t("br",{}),"User Token \u7528\u4E8E\u8FC1\u79FB\u767B\u5F55\u72B6\u6001\uFF0C\u5207\u52FF\u544A\u77E5\u4ED6\u4EBA\uFF0C\u82E5\u6000\u7591\u88AB\u76D7\u53F7\u8BF7\u5C3D\u5FEB"," ",t(pt,{token:e.value})]})]}):t(q,{token_callback:e.set_value,children:s=>o("div",{children:[t("p",{children:o("button",{type:"button",onClick:s,children:[t("span",{className:"icon icon-login"}),"\xA0\u767B\u5F55"]})}),t("p",{children:t("small",{children:"PKU Helper \u9762\u5411\u5317\u4EAC\u5927\u5B66\u5B66\u751F\uFF0C\u901A\u8FC7 ISOP\uFF08\u5317\u4EAC\u5927\u5B66\u6570\u636E\u5171\u4EAB\u5F00\u653E\u670D\u52A1\u5E73\u53F0\uFF09\u9A8C\u8BC1\u60A8\u7684\u8EAB\u4EFD\u5E76\u63D0\u4F9B\u670D\u52A1\u3002"})})]})})})]})})}}class gt extends d.exports.Component{constructor(e){super(e),this.state={text:"",loading_status:"done"},this.on_change_bound=this.on_change.bind(this),this.area_ref=this.props.area_ref||g.createRef(),this.global_keypress_handler_bound=this.global_keypress_handler.bind(this)}global_keypress_handler(e){e.code==="Enter"&&!e.ctrlKey&&!e.altKey&&["input","textarea"].indexOf(e.target.tagName.toLowerCase())===-1&&this.area_ref.current&&(e.preventDefault(),this.area_ref.current.focus())}componentDidMount(){document.addEventListener("keypress",this.global_keypress_handler_bound)}componentWillUnmount(){document.removeEventListener("keypress",this.global_keypress_handler_bound)}on_change(e){this.setState({text:e})}on_submit(e){if(e&&e.preventDefault(),this.state.loading_status==="loading")return;this.setState({loading_status:"loading"});const s=new URLSearchParams;s.append("pid",this.props.pid),s.append("text",this.state.text),s.append("user_token",this.props.token),fetch(f+"/api.php?action=docomment"+_(this.props.token),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s}).then(b).then(i=>{if(i.code!==0)throw i.msg&&alert(i.msg),new Error(JSON.stringify(i));this.setState({loading_status:"done",text:""}),this.area_ref.current.clear(),this.props.on_complete()}).catch(i=>{console.error(i),alert("\u56DE\u590D\u5931\u8D25"),this.setState({loading_status:"done"})})}render(){return o("form",{onSubmit:this.on_submit.bind(this),className:"reply-form box"+(this.state.text?" reply-sticky":""),children:[t(Ae,{ref:this.area_ref,id:this.props.pid,on_change:this.on_change_bound,on_submit:this.on_submit.bind(this)},this.props.pid),this.state.loading_status==="loading"?t("button",{disabled:"disabled",children:t("span",{className:"icon icon-loading"})}):t("button",{type:"submit",children:t("span",{className:"icon icon-send"})})]})}}class _t extends d.exports.Component{constructor(e){super(e),this.state={text:"",loading_status:"done",img_tip:null},this.img_ref=g.createRef(),this.area_ref=g.createRef(),this.on_change_bound=this.on_change.bind(this),this.on_img_change_bound=this.on_img_change.bind(this)}componentDidMount(){this.area_ref.current&&this.area_ref.current.focus()}on_change(e){this.setState({text:e})}do_post(e,s){const i=new URLSearchParams;i.append("text",this.state.text),i.append("type",s?"image":"text"),i.append("user_token",this.props.token),s&&i.append("data",s),fetch(f+"/api.php?action=dopost"+_(this.props.token),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i}).then(b).then(n=>{if(n.code!==0)throw n.msg&&alert(n.msg),new Error(JSON.stringify(n));this.setState({loading_status:"done",text:""}),this.area_ref.current.clear(),this.props.on_complete()}).catch(n=>{console.error(n),alert("\u53D1\u8868\u5931\u8D25"),this.setState({loading_status:"done"})})}proc_img(e){return new Promise((s,i)=>{function n(l){const c=l.indexOf(";base64,");if(c===-1)throw new Error("img not base64 encoded");return l.substr(c+8)}const r=new FileReader;function u(l){const c=new Image;c.onload=()=>{let h=c.width,p=c.height,w=!1;if(h>C&&(p=p*C/h,h=C,w=!0),p>C&&(h=h*C/p,p=C,w=!0),p*h>le){const $=Math.sqrt(p*h/le);p/=$,h/=$,w=!0}console.log("chosen img size",h,p);const N=document.createElement("canvas"),ye=N.getContext("2d");N.width=h,N.height=p,ye.drawImage(c,0,0,h,p);let D=.1,S=.9,E,I;for(;S-D>=.03;)E=(S+D)/2,I=N.toDataURL("image/jpeg",E),console.log(D,S,"trying quality",E,"size",I.length),I.length<=ht?D=E:S=E;D>=.101?(console.log("chosen img quality",E),s({img:n(I),quality:E,width:Math.round(h),height:Math.round(p),compressed:w})):i("\u56FE\u7247\u8FC7\u5927\uFF0C\u65E0\u6CD5\u4E0A\u4F20")},c.src=l}r.onload=l=>{Se(l.target.result,{},c=>{u(c)})},r.readAsDataURL(e)})}on_img_change(){this.img_ref.current&&this.img_ref.current.files.length?this.setState({img_tip:"\uFF08\u6B63\u5728\u5904\u7406\u56FE\u7247\u2026\u2026\uFF09"},()=>{this.proc_img(this.img_ref.current.files[0]).then(e=>{this.setState({img_tip:`\uFF08${e.compressed?"\u538B\u7F29\u5230":"\u5C3A\u5BF8"} ${e.width}*${e.height} / \u8D28\u91CF ${Math.floor(e.quality*100)}% / ${Math.floor(e.img.length/Ee/1e3)}KB\uFF09`})}).catch(e=>{this.setState({img_tip:`\u56FE\u7247\u65E0\u6548\uFF1A${e}`})})}):this.setState({img_tip:null})}on_submit(e){e&&e.preventDefault(),this.state.loading_status!=="loading"&&(this.img_ref.current.files.length?(this.setState({loading_status:"processing"}),this.proc_img(this.img_ref.current.files[0]).then(s=>{this.setState({loading_status:"loading"}),this.do_post(this.state.text,s.img)}).catch(s=>{alert(s)})):(this.setState({loading_status:"loading"}),this.do_post(this.state.text,null)))}render(){return o("form",{onSubmit:this.on_submit.bind(this),className:"post-form box",children:[o("div",{className:"post-form-bar",children:[o("label",{children:["\u56FE\u7247",t("input",{ref:this.img_ref,type:"file",accept:"image/*",disabled:this.state.loading_status!=="done",onChange:this.on_img_change_bound})]}),this.state.loading_status!=="done"?o("button",{disabled:"disabled",children:[t("span",{className:"icon icon-loading"}),"\xA0\u6B63\u5728",this.state.loading_status==="processing"?"\u5904\u7406":"\u4E0A\u4F20"]}):o("button",{type:"submit",children:[t("span",{className:"icon icon-send"}),"\xA0\u53D1\u8868"]})]}),!!this.state.img_tip&&o("p",{className:"post-form-img-tip",children:[t("a",{onClick:()=>{this.img_ref.current.value="",this.on_img_change()},children:"\u5220\u9664\u56FE\u7247"}),this.state.img_tip]}),t(Ae,{ref:this.area_ref,id:"new_post",on_change:this.on_change_bound,on_submit:this.on_submit.bind(this)}),t("p",{children:o("small",{children:["\u8BF7\u9075\u5B88",t("a",{href:"http://pkuhelper.pku.edu.cn/treehole_rules.html",target:"_blank",children:"\u6811\u6D1E\u7BA1\u7406\u89C4\u8303"}),"\uFF0C\u6587\u660E\u53D1\u8A00"]})})]})}}const P=A+"services/pkuhole/images/",ft=A+"services/pkuhole/audios/",At={a:!0,audio:!0},M=10,bt=["23333","233333","66666","666666","10086","10000","100000","99999","999999","55555","555555"];window.LATEST_POST_ID=parseInt(localStorage._LATEST_POST_ID,10)||0;const B="\u6D1E\u4E3B";function J(a,e){return async(s,i=!1)=>{const n=new K,r="\u6811\u6D1E #"+s;a(r,o("div",{className:"box box-tip",children:["\u6B63\u5728\u52A0\u8F7D #",s]}),i?"replace":"push");try{const u=await m.get_single(s,e);u.data.variant={};const{data:l}=await m.load_replies_with_cache(s,e,n,parseInt(u.data.reply));a(r,t(ke,{info:u.data,replies:l.data,attention:l.attention,token:e,show_sidebar:a,color_picker:n,deletion_detect:localStorage.DELETION_DETECT==="on"},+new Date),"replace")}catch(u){console.error(u),a(r,o("div",{className:"box box-tip",children:[t("p",{children:t("a",{onClick:()=>J(a,e)(s,!0),children:"\u91CD\u65B0\u52A0\u8F7D"})}),t("p",{children:""+u})]}),"replace")}}}class we extends d.exports.PureComponent{constructor(e){super(e)}render(){const e=Y(this.props.info.text,[["url_pid",j],["url",V],["pid",X],["nickname",W]]);return o("div",{className:"flow-reply box",style:this.props.info._display_color?{"--box-bgcolor-light":this.props.info._display_color[0],"--box-bgcolor-dark":this.props.info._display_color[1]}:null,children:[o("div",{className:"box-header",children:[o("code",{className:"box-id",children:["#",this.props.info.cid]}),!!this.props.do_filter_name&&t("span",{className:"reply-header-badge clickable",onClick:()=>{this.props.do_filter_name(this.props.info.name)},children:t("span",{className:"icon icon-locate"})}),"\xA0",this.props.info.tag!==null&&t("span",{className:"box-header-tag",children:this.props.info.tag}),t(v,{stamp:this.props.info.timestamp})]}),t("div",{className:"box-content",children:t(fe,{parts:e,color_picker:this.props.color_picker,show_pid:this.props.show_pid})})]})}}class Ce extends d.exports.PureComponent{constructor(e){super(e),this.state={image_strategy:window.config.flow_image}}copy_link(e){e.preventDefault(),Q(`${e.target.href}${this.props.info.tag?" \u3010"+this.props.info.tag+"\u3011":""}
${this.props.info.text}${this.props.info.type==="image"?" [\u56FE\u7247]":this.props.info.type==="audio"?" [\u8BED\u97F3]":""}
\uFF08${ge(new Date(this.props.info.timestamp*1e3))} ${this.props.info.likenum}\u5173\u6CE8 ${this.props.info.reply}\u56DE\u590D${this.props.replies_filter_name?` \u53EA\u770B[${this.props.replies_filter_name}]`:""}${this.props.replies_is_rev?" \u9006\u5E8F":""}\uFF09
`+this.props.replies_to_show.map(s=>(s.tag?"\u3010"+s.tag+"\u3011":"")+s.text).join(`
`))}show_image(){this.setState({image_strategy:"default"})}render(){const e=this.props,s=e.parts||Y(e.info.text,[["url_pid",j],["url",V],["pid",X],["nickname",W]]);return o("div",{className:"flow-item"+(e.is_quote?" flow-item-quote":""),children:[!!e.is_quote&&o("div",{className:"quote-tip black-outline",children:[t("div",{children:t("span",{className:"icon icon-quote"})}),t("div",{children:t("small",{children:"\u63D0\u5230"})})]}),o("div",{className:"box",children:[!!window.LATEST_POST_ID&&parseInt(e.info.pid,10)>window.LATEST_POST_ID&&t("div",{className:"flow-item-dot"}),!!this.props.attention&&!this.props.cached&&t("div",{className:"flow-item-dot"}),o("div",{className:"box-header",children:[!!this.props.do_filter_name&&t("span",{className:"reply-header-badge clickable",onClick:()=>{this.props.do_filter_name(B)},children:t("span",{className:"icon icon-locate"})}),!!parseInt(e.info.likenum,10)&&o("span",{className:"box-header-badge",children:[e.info.likenum,"\xA0",t("span",{className:"icon icon-"+(e.attention?"star-ok":"star")})]}),!!parseInt(e.info.reply,10)&&o("span",{className:"box-header-badge",children:[e.info.reply,"\xA0",t("span",{className:"icon icon-reply"})]}),t("code",{className:"box-id",style:{"--box-id-copy-content":e.replies_filter_name?`"\u4EC5\u590D\u5236 ${e.replies_filter_name}"`:'"\u590D\u5236\u5168\u6587"'},children:o("a",{href:"##"+e.info.pid,onClick:this.copy_link.bind(this),children:["#",e.info.pid]})}),"\xA0",e.info.tag!==null&&t("span",{className:"box-header-tag",children:e.info.tag}),t(v,{stamp:e.info.timestamp})]}),e.replies_filter_name&&e.replies_filter_name!==B?t("div",{className:"box-content",style:{padding:"0",marginTop:".25em"}}):o("div",{className:"box-content",children:[t(fe,{parts:s,color_picker:e.color_picker,show_pid:e.show_pid}),e.info.type==="image"&&t("p",{className:"img",children:e.img_clickable?t("a",{className:"no-underline",href:P+e.info.url,target:"_blank",rel:"noopener",children:t("img",{src:P+e.info.url})}):this.state.image_strategy==="default"?t("img",{src:P+e.info.url}):this.state.image_strategy==="hidden"?t("a",{onClick:()=>this.show_image(),children:"\u663E\u793A\u56FE\u7247"}):o(me,{children:[t("img",{className:"thumbnail",src:P+e.info.url}),t("div",{children:t("a",{onClick:()=>this.show_image(),children:"\u663E\u793A\u8F83\u5927\u56FE\u7247"})})]})}),e.info.type==="audio"&&t(ot,{src:ft+e.info.url})]}),!!(e.attention&&e.info.variant.latest_reply)&&o("p",{className:"box-footer",children:["\u6700\u65B0\u56DE\u590D ",t(v,{stamp:e.info.variant.latest_reply})]})]})]})}}class ke extends d.exports.PureComponent{constructor(e){super(e),this.state={attention:e.attention,info:e.info,replies:e.replies,loading_status:"done",error_msg:null,filter_name:null,rev:!1},this.color_picker=e.color_picker,this.syncState=e.sync_state||(()=>{}),this.reply_ref=g.createRef()}set_variant(e,s){this.setState(i=>e?{replies:i.replies.map(n=>n.cid===e?Object.assign({},n,{variant:Object.assign({},n.variant,s)}):n)}:{info:Object.assign({},i.info,{variant:Object.assign({},i.info.variant,s)})},function(){this.syncState({info:this.state.info,replies:this.state.replies})})}load_replies(e=!0){this.setState({loading_status:"loading",error_msg:null}),m.load_replies(this.state.info.pid,this.props.token,this.color_picker,null).then(s=>{this.setState((i,n)=>({replies:s.data,info:e?Object.assign({},i.info,{reply:""+s.data.length}):i.info,attention:!!s.attention,loading_status:"done",error_msg:null}),()=>{this.syncState({replies:this.state.replies,attention:this.state.attention,info:this.state.info}),this.state.replies.length&&this.set_variant(null,{latest_reply:Math.max.apply(null,this.state.replies.map(i=>parseInt(i.timestamp)))})})}).catch(s=>{console.error(s),this.setState({replies:[],loading_status:"done",error_msg:""+s})})}toggle_attention(){this.setState({loading_status:"loading"});const e=!this.state.attention;m.set_attention(this.state.info.pid,e,this.props.token).then(s=>{this.setState({loading_status:"done",attention:e}),this.syncState({attention:e})}).catch(s=>{this.setState({loading_status:"done"}),alert("\u8BBE\u7F6E\u5173\u6CE8\u5931\u8D25"),console.error(s)})}report(){const e=prompt(`\u4E3E\u62A5 #${this.state.info.pid} \u7684\u7406\u7531\uFF1A`);e!==null&&m.report(this.state.info.pid,e,this.props.token).then(s=>{alert("\u4E3E\u62A5\u6210\u529F")}).catch(s=>{alert("\u4E3E\u62A5\u5931\u8D25"),console.error(s)})}set_alias(){Z();const e=prompt(`\u7ED9 #${this.state.info.pid} \u6DFB\u52A0\u522B\u540D\uFF1A`);if(e===null)return;if(e.includes(" "))return alert("\u522B\u540D\u4E0D\u5408\u6CD5\uFF0C\u8BBE\u7F6E\u522B\u540D\u5931\u8D25");let s=!0;e in window.config.alias&&this.state.info.pid!==window.config.alias[e]&&(s=confirm(`\u662F\u5426\u5C06\u201C#${e}\u201D\u4ECE #${window.config.alias[e]} \u6539\u4E3A #${this.state.info.pid}\uFF1F`)),s&&(window.config.alias[e]=this.state.info.pid,T())}set_filter_name(e){this.setState(s=>({filter_name:e===s.filter_name?null:e}))}toggle_rev(){this.setState(e=>({rev:!e.rev}),Re)}show_reply_bar(e,s){if(this.reply_ref.current&&!s.target.closest("a, .clickable")){const i=this.reply_ref.current.get();if(/^\s*(?:Re (?:|洞主|(?:[A-Z][a-z]+ )?(?:[A-Z][a-z]+)|You Win(?: \d+)?):)?\s*$/.test(i)){const n="Re "+e+": ";n===this.reply_ref.current.get()?this.reply_ref.current.set(""):this.reply_ref.current.set(n)}}}render(){if(this.state.loading_status==="loading")return t("p",{className:"box box-tip",children:"\u52A0\u8F7D\u4E2D\u2026\u2026"});const e=J(this.props.show_sidebar,this.props.token),s=this.state.filter_name?this.state.replies.filter(r=>r.name===this.state.filter_name):this.state.replies.slice();this.state.rev&&s.reverse();const i={[B]:1};s.forEach(r=>{i[r.name]===void 0&&(i[r.name]=0),i[r.name]++});const n=t(oe,{callback:r=>{this.show_reply_bar("",r)},children:t(Ce,{info:this.state.info,attention:this.state.attention,img_clickable:!0,color_picker:this.color_picker,show_pid:e,replies:this.state.replies,replies_to_show:s,replies_filter_name:this.state.filter_name,replies_is_rev:this.state.rev,set_variant:r=>{this.set_variant(null,r)},do_filter_name:i[B]>1?this.set_filter_name.bind(this):null})});return o("div",{className:"flow-item-row sidebar-flow-item",children:[o("div",{className:"box box-tip sidebar-toolbar",children:[!!this.props.token&&t("span",{className:"sidebar-toolbar-item",children:o("a",{onClick:this.report.bind(this),children:[t("span",{className:"icon icon-flag"}),t("label",{children:"\u4E3E\u62A5"})]})}),t("span",{className:"sidebar-toolbar-item",children:o("a",{onClick:this.load_replies.bind(this),children:[t("span",{className:"icon icon-refresh"}),t("label",{children:"\u5237\u65B0"})]})}),(this.state.replies.length>=1||this.state.rev)&&t("span",{className:"sidebar-toolbar-item",children:o("a",{onClick:this.toggle_rev.bind(this),children:[t("span",{className:"icon icon-order-rev"}),t("label",{children:this.state.rev?"\u8FD8\u539F":"\u9006\u5E8F"})]})}),!!this.props.token&&t("span",{className:"sidebar-toolbar-item",children:t("a",{onClick:()=>{this.toggle_attention()},children:this.state.attention?o("span",{children:[t("span",{className:"icon icon-star-ok"}),t("label",{children:"\u5DF2\u5173\u6CE8"})]}):o("span",{children:[t("span",{className:"icon icon-star"}),t("label",{children:"\u672A\u5173\u6CE8"})]})})}),!!this.props.token&&o("span",{className:"sidebar-toolbar-dropdown sidebar-toolbar-item",children:[t("span",{className:"sidebar-toolbar-dropdown-title",children:o("a",{children:[t("span",{className:"icon icon-menu"}),t("label",{children:"\u66F4\u591A\u25BE"})]})}),t("div",{className:"sidebar-toolbar-dropdown-content",children:t("div",{className:"sidebar-toolbar-dropdown-item",children:o("a",{onClick:this.set_alias.bind(this),children:[t("span",{className:"icon icon-link"}),t("label",{children:"\u522B\u540D"})]})})})]})]}),!!this.state.filter_name&&t("div",{className:"box box-tip flow-item filter-name-bar",children:o("p",{children:[t("span",{style:{float:"left"},children:t("a",{onClick:()=>{this.set_filter_name(null)},children:"\u8FD8\u539F"})}),t("span",{className:"icon icon-locate"}),"\xA0\u5F53\u524D\u53EA\u770B\xA0",t(_e,{colors:this.color_picker.get(this.state.filter_name),children:this.state.filter_name})]})}),!this.state.rev&&n,!!this.state.error_msg&&o("div",{className:"box box-tip flow-item",children:[t("p",{children:"\u56DE\u590D\u52A0\u8F7D\u5931\u8D25"}),t("p",{children:this.state.error_msg})]}),this.props.deletion_detect&&parseInt(this.state.info.reply)>this.state.replies.length&&!!this.state.replies.length&&o("div",{className:"box box-tip flow-item box-danger",children:[parseInt(this.state.info.reply)-this.state.replies.length," ","\u6761\u56DE\u590D\u88AB\u5220\u9664"]}),s.map((r,u)=>t(pe,{offset:1500,height:"5em",overflow:!0,once:!0,children:t(oe,{callback:l=>{this.show_reply_bar(r.name,l)},children:t(we,{info:r,color_picker:this.color_picker,show_pid:e,set_variant:l=>{this.set_variant(r.cid,l)},do_filter_name:i[r.name]>1?this.set_filter_name.bind(this):null})})},u)),this.state.rev&&n,this.props.token?t(gt,{pid:this.state.info.pid,token:this.props.token,area_ref:this.reply_ref,on_complete:this.load_replies.bind(this)}):t("div",{className:"box box-tip flow-item",children:"\u767B\u5F55\u540E\u53EF\u4EE5\u56DE\u590D\u6811\u6D1E"})]})}}class De extends d.exports.PureComponent{constructor(e){super(e),this.state={replies:[],reply_status:"done",reply_error:null,info:Object.assign({},e.info,{variant:{}}),hidden:window.config.block_words.some(s=>e.info.text.includes(s)),attention:e.attention_override===null?!1:e.attention_override,cached:!0},this.color_picker=e.info.reply_color_picker?e.info.reply_color_picker:new K}componentDidMount(){parseInt(this.state.info.reply,10)&&this.load_replies(null,!1)}reveal(){this.setState({hidden:!1})}load_replies(e,s=!0){if(this.setState({reply_status:"loading",reply_error:null}),this.state.info.use_reply_promise){console.log("fetching reply",this.state.info.pid,"from resolved promise"),this.state.info.reply_promise.then(({data:i,cached:n,latest_reply:r})=>{this.setState((u,l)=>({replies:i.data,info:Object.assign({},u.info,{reply:s?""+i.data.length:u.info.reply,variant:i.data.length?{latest_reply:r}:{}}),attention:!!i.attention,reply_status:"done",reply_error:null,cached:n}),e)}).catch(i=>{console.error(i),this.setState({replies:[],reply_status:"failed",reply_error:""+i},e)});return}console.log("fetching reply",this.state.info.pid),m.load_replies_with_cache(this.state.info.pid,this.props.token,this.color_picker,parseInt(this.state.info.reply)).then(({data:i,cached:n})=>{this.setState((r,u)=>({replies:i.data,info:Object.assign({},r.info,{reply:s?""+i.data.length:r.info.reply,variant:i.data.length?{latest_reply:Math.max.apply(null,i.data.map(l=>parseInt(l.timestamp)))}:{}}),attention:!!i.attention,reply_status:"done",reply_error:null,cached:n}),e)}).catch(i=>{console.error(i),this.setState({replies:[],reply_status:"failed",reply_error:""+i},e)})}show_sidebar(){this.props.show_sidebar("\u6811\u6D1E #"+this.state.info.pid,t(ke,{info:this.state.info,replies:this.state.replies,attention:this.state.attention,sync_state:this.setState.bind(this),token:this.props.token,show_sidebar:this.props.show_sidebar,color_picker:this.color_picker,deletion_detect:this.props.deletion_detect},+new Date))}render(){const e=J(this.props.show_sidebar,this.props.token,[this.state.info.pid]),s=[["url_pid",j],["url",V],["pid",X],["nickname",W]];this.props.search_param&&s.push(["search",this.props.search_param.match(/\/.+\//)?ae(this.props.search_param," ","gi",!0):ae(this.props.search_param," ","gi")]);const i=Y(this.state.info.text,s);let n=null;if(!this.props.is_quote){for(const[u,l]of i)if(u==="pid"&&bt.indexOf(l)===-1&&parseInt(l)<parseInt(this.state.info.pid))if(n===null)n=parseInt(l);else{n=null;break}}const r=o("div",{className:"flow-item-row flow-item-row-with-prompt"+(this.props.is_quote?" flow-item-row-quote":""),onClick:u=>{At[u.target.tagName.toLowerCase()]||this.show_sidebar()},children:[t(Ce,{parts:i,info:this.state.info,attention:this.state.attention,img_clickable:!1,is_quote:this.props.is_quote,color_picker:this.color_picker,show_pid:e,replies:this.state.replies,replies_to_show:this.state.replies,replies_filter_name:null,replies_is_rev:!1,cached:this.state.cached}),o("div",{className:"flow-reply-row",children:[this.state.reply_status==="loading"&&t("div",{className:"box box-tip",children:"\u52A0\u8F7D\u4E2D"}),this.state.reply_status==="failed"&&o("div",{className:"box box-tip",children:[t("p",{children:t("a",{onClick:()=>{this.load_replies()},children:"\u91CD\u65B0\u52A0\u8F7D\u8BC4\u8BBA"})}),t("p",{children:this.state.reply_error})]}),this.state.replies.slice(0,M).map(u=>t(we,{info:u,color_picker:this.color_picker,show_pid:e},u.cid)),this.state.replies.length>M&&o("div",{className:"box box-tip",children:["\u8FD8\u6709 ",this.state.replies.length-M," \u6761"]})]})]});return this.state.hidden?t("div",{className:"flow-item-row flow-item-row-with-prompt",onClick:()=>this.reveal(),children:o("div",{className:"flow-item"+(this.props.is_quote?" flow-item-quote":""),children:[!!this.props.is_quote&&o("div",{className:"quote-tip black-outline",children:[t("div",{children:t("span",{className:"icon icon-quote"})}),t("div",{children:t("small",{children:"\u63D0\u5230"})})]}),t("div",{className:"box",children:o("div",{className:"box-header",children:[!!this.props.do_filter_name&&t("span",{className:"reply-header-badge clickable",onClick:()=>{this.props.do_filter_name(B)},children:t("span",{className:"icon icon-locate"})}),o("code",{className:"box-id",children:["#",this.props.info.pid]}),"\xA0",this.props.info.tag!==null&&t("span",{className:"box-header-tag",children:this.props.info.tag}),t(v,{stamp:this.props.info.timestamp}),t("span",{className:"box-header-badge",children:t("span",{className:"icon icon-block"})}),t("div",{style:{clear:"both"}})]})})]})}):n?o("div",{children:[r,t(Et,{pid:n,show_sidebar:this.props.show_sidebar,token:this.props.token,deletion_detect:this.props.deletion_detect})]}):r}}class Et extends d.exports.PureComponent{constructor(e){super(e),this.state={loading_status:"empty",error_msg:null,info:null}}componentDidMount(){this.load()}load(){this.setState({loading_status:"loading"},()=>{m.get_single(this.props.pid,this.props.token).then(e=>{this.setState({loading_status:"done",info:e.data})}).catch(e=>{(""+e).indexOf("\u6CA1\u6709\u8FD9\u6761\u6811\u6D1E")!==-1?this.setState({loading_status:"empty"}):this.setState({loading_status:"error",error_msg:""+e})})})}render(){return this.state.loading_status==="empty"?null:this.state.loading_status==="loading"?t("div",{className:"aux-margin",children:o("div",{className:"box box-tip",children:[t("span",{className:"icon icon-loading"}),"\u63D0\u5230\u4E86 #",this.props.pid]})}):this.state.loading_status==="error"?t("div",{className:"aux-margin",children:o("div",{className:"box box-tip",children:[t("p",{children:t("a",{onClick:this.load.bind(this),children:"\u91CD\u65B0\u52A0\u8F7D"})}),t("p",{children:this.state.error_msg})]})}):t(De,{info:this.state.info,show_sidebar:this.props.show_sidebar,token:this.props.token,is_quote:!0,deletion_detect:this.props.deletion_detect})}}function Ft(a){return t(x.Consumer,{children:({value:e})=>o("div",{className:"flow-chunk",children:[!!a.title&&t(z,{text:a.title}),t("p",{className:"title-button black-outline",children:!!a.title_button&&a.title_button}),a.list.map((s,i)=>t(pe,{offset:1500,height:"15em",once:!0,children:o("div",{children:[!!(a.deletion_detect&&a.mode==="list"&&i&&a.list[i-1].pid-s.pid>1)&&t("div",{className:"flow-item-row",children:o("div",{className:"box box-tip flow-item box-danger",children:[a.list[i-1].pid-s.pid-1," \u6761\u88AB\u5220\u9664"]})}),t(De,{info:s,show_sidebar:a.show_sidebar,token:e,attention_override:a.mode==="attention_finished"?!0:null,deletion_detect:a.deletion_detect,search_param:a.search_param})]})},`${s.pid}-${a.lazyload_key_suffix}`))]})})}class wt extends d.exports.PureComponent{constructor(e){super(e),this.state={mode:e.mode,search_param:e.search_text,loaded_pages:0,chunks:{title:"",data:[]},loading_status:"done",error_msg:null,reply_promises_done:!1,sort_by_latest_reply:!1,lazyload_key_suffix:0},this.on_scroll_bound=this.on_scroll.bind(this),window.LATEST_POST_ID=parseInt(localStorage._LATEST_POST_ID,10)||0}inject_reply_promises(e){const s=Ie(25),i=[];for(const n of e){const r=new K,u=s(async()=>{try{console.log("fetching reply with promise",n.pid);const{data:l,cached:c}=await m.load_replies_with_cache(n.pid,this.props.token,r,parseInt(n.reply)),h=l.data.length?Math.max(...l.data.map(p=>parseInt(p.timestamp))):n.timestamp;return n._latest_reply=h,{data:l,cached:c,latest_reply:h}}catch(l){console.error(l),reject(l)}});i.push(u),n.use_reply_promise=!0,n.reply_color_picker=r,n.reply_promise=u,n._latest_reply=null}return Promise.all(i).then(()=>{this.setState({reply_promises_done:!0})}).catch(n=>{console.error(n)}),e}load_page(e){const s=i=>{console.error(i),this.setState((n,r)=>({loaded_pages:n.loaded_pages-1,loading_status:"failed",error_msg:""+i}))};if(e>this.state.loaded_pages+1)throw new Error("bad page");if(e===this.state.loaded_pages+1){if(console.log("fetching page",e),this.state.mode==="list")m.get_list(e,this.props.token).then(i=>{if(e===1&&i.data.length){let n=-1;i.data.forEach(r=>{parseInt(r.pid,10)>n&&(n=parseInt(r.pid,10))}),localStorage._LATEST_POST_ID=""+n}this.setState((n,r)=>({chunks:{title:"News Feed",data:n.chunks.data.concat(i.data.filter(u=>n.chunks.data.length===0||!n.chunks.data.slice(-100).some(l=>l.pid===u.pid)))},loading_status:"done"}))}).catch(s);else if(this.state.mode==="search")m.get_search(e,this.state.search_param,this.props.token).then(i=>{const n=i.data.length===0;this.setState((r,u)=>({chunks:{title:'Result for "'+this.state.search_param+'"',data:r.chunks.data.concat(i.data.filter(l=>r.chunks.data.length===0||!r.chunks.data.slice(-100).some(c=>c.pid===l.pid)))},mode:n?"search_finished":"search",loading_status:"done"}))}).catch(s);else if(this.state.mode==="single"){let i=this.state.search_param.substr(1);i in window.config.alias&&(i=window.config.alias[i]);const n=parseInt(i,10);m.get_single(n,this.props.token).then(r=>{this.setState({chunks:{title:"PID = "+n,data:[r.data]},mode:"single_finished",loading_status:"done"})}).catch(s)}else if(this.state.mode==="attention"){const i=!!this.state.search_param,n=i&&!!this.state.search_param.match(/\/.+\//);let r=/.+/;if(n)try{r=new RegExp(this.state.search_param.slice(1,-1))}catch(u){alert(`\u8BF7\u68C0\u67E5\u6B63\u5219\u8868\u8FBE\u5F0F\u5408\u6CD5\u6027\uFF01
${u}`),r=/.+/}m.get_attention(this.props.token).then(u=>{const l=i?n?u.data.filter(c=>!!c.text.match(r)):u.data.filter(c=>this.state.search_param.split(" ").every(h=>c.text.includes(h))):u.data;this.setState({chunks:{title:`${i?n?`Result for RegEx ${r.toString()} in `:`Result for "${this.state.search_param}" in `:""}Attention List`,data:window.config.attention_sort?this.inject_reply_promises(l):l},mode:"attention_finished",loading_status:"done"})}).catch(s)}else{console.log("nothing to load");return}this.setState((i,n)=>({loaded_pages:i.loaded_pages+1,loading_status:"loading",error_msg:null}))}}on_scroll(e){e.target===document&&document.body.scrollHeight-window.scrollY-window.innerHeight<window.innerHeight&&this.state.loading_status==="done"&&this.load_page(this.state.loaded_pages+1)}sort_by_latest_reply(){this.setState(e=>({original_chunk:e.chunks,chunks:{title:e.chunks.title,data:e.chunks.data.slice(0).sort((s,i)=>i._latest_reply-s._latest_reply)},lazyload_key_suffix:e.lazyload_key_suffix+1,sort_by_latest_reply:!0}))}sort_by_original(){this.setState(e=>({chunks:e.original_chunk,lazyload_key_suffix:e.lazyload_key_suffix+1,sort_by_latest_reply:!1}))}componentDidMount(){this.load_page(1),window.addEventListener("scroll",this.on_scroll_bound),window.addEventListener("resize",this.on_scroll_bound)}componentWillUnmount(){window.removeEventListener("scroll",this.on_scroll_bound),window.removeEventListener("resize",this.on_scroll_bound)}render(){const e=localStorage.DELETION_DETECT==="on",s=this.state.reply_promises_done&&(this.state.sort_by_latest_reply?t("a",{onClick:this.sort_by_original.bind(this),children:"[ \u6309\u6700\u65B0\u56DE\u590D\u65F6\u95F4\u6392\u5E8F ]"}):t("a",{onClick:this.sort_by_latest_reply.bind(this),children:"[ \u6309\u53D1\u5E03\u65F6\u95F4\u6392\u5E8F ]"}));return o("div",{className:"flow-container",children:[t(Ft,{title:this.state.chunks.title,title_button:s,list:this.state.chunks.data,mode:this.state.mode,search_param:this.state.search_param||null,show_sidebar:this.props.show_sidebar,deletion_detect:e,lazyload_key_suffix:this.state.lazyload_key_suffix}),this.state.loading_status==="failed"&&t("div",{className:"aux-margin",children:o("div",{className:"box box-tip",children:[t("p",{children:t("a",{onClick:()=>{this.load_page(this.state.loaded_pages+1)},children:"\u91CD\u65B0\u52A0\u8F7D"})}),t("p",{children:this.state.error_msg})]})}),t(z,{text:this.state.loading_status==="loading"?o("span",{children:[t("span",{className:"icon icon-loading"}),"\xA0Loading..."]}):"\xA9 xmcp & awesome community"})]})}}const Ct=/^\/\/setflag ([a-zA-Z0-9_]+)=(.*)$/,ce={\u6811\u6D1E:"https://pkuhelper.pku.edu.cn/hole",\u6559\u5BA4:"https://pkuhelper.pku.edu.cn/spare_classroom/",\u8BFE\u8868:"https://pkuhelper.pku.edu.cn/syllabus/",\u5BA2\u6237\u7AEF:"https://pkuhelper.pku.edu.cn/",\u6210\u7EE9:"https://pkuhelper.pku.edu.cn/my_score",\u4E0D\u5495:"https://pkuhelper.pku.edu.cn/ddl",\u4E0D\u5495\u8BA1\u5212:"https://pkuhelper.pku.edu.cn/ddl",\u8BFE\u7A0B\u6D4B\u8BC4:"https://courses.pinzhixiaoyuan.com/",\u6D4B\u8BC4:"https://courses.pinzhixiaoyuan.com/"};class kt extends d.exports.PureComponent{constructor(e){super(e),this.state={search_text:""},this.set_mode=e.set_mode,this.on_change_bound=this.on_change.bind(this),this.on_keypress_bound=this.on_keypress.bind(this),this.do_refresh_bound=this.do_refresh.bind(this),this.do_attention_bound=this.do_attention.bind(this)}componentDidMount(){if(window.location.hash){let e=decodeURIComponent(window.location.hash).substr(1);e.lastIndexOf("?")!==-1&&(e=e.substr(0,e.lastIndexOf("?"))),this.setState({search_text:e},()=>{this.on_keypress({key:"Enter"})})}}on_change(e){this.setState({search_text:e.target.value})}on_keypress(e){if(e.key==="Enter"){const s=Ct.exec(this.state.search_text);if(s){s[2]?(localStorage[s[1]]=s[2],alert("Set Flag "+s[1]+"="+s[2]+`
You may need to refresh this webpage.`)):(delete localStorage[s[1]],alert("Clear Flag "+s[1]+`
You may need to refresh this webpage.`));return}const i=this.state.search_text.startsWith("#")?"single":this.props.mode!=="attention"?"search":"attention";this.set_mode(i,this.state.search_text||"")}}do_refresh(){window.scrollTo(0,0),this.setState({search_text:""}),this.set_mode("list",null)}do_attention(){window.scrollTo(0,0),this.setState({search_text:""}),this.set_mode("attention",null)}render(){return t(x.Consumer,{children:({value:e})=>o("div",{className:"control-bar",children:[o("a",{className:"no-underline control-btn",onClick:this.do_refresh_bound,children:[t("span",{className:"icon icon-refresh"}),t("span",{className:"control-btn-label",children:"\u6700\u65B0"})]}),!!e&&o("a",{className:"no-underline control-btn",onClick:this.do_attention_bound,children:[t("span",{className:"icon icon-attention"}),t("span",{className:"control-btn-label",children:"\u5173\u6CE8"})]}),t("input",{className:"control-search",value:this.state.search_text,placeholder:`${this.props.mode==="attention"?"\u5728\u5173\u6CE8\u4E2D":""}\u641C\u7D22 \u6216 #PID`,onChange:this.on_change_bound,onKeyPress:this.on_keypress_bound}),o("a",{className:"no-underline control-btn",onClick:()=>{this.props.show_sidebar("P\u5927\u6811\u6D1E (\u793E\u533A\u7248)",t(Fe,{show_sidebar:this.props.show_sidebar}))},children:[t("span",{className:"icon icon-"+(e?"about":"login")}),t("span",{className:"control-btn-label",children:e?"\u8D26\u6237":"\u767B\u5F55"})]}),!!e&&o("a",{className:"no-underline control-btn",onClick:()=>{this.props.show_sidebar("\u53D1\u8868\u6811\u6D1E",t(_t,{token:e,on_complete:()=>{this.props.show_sidebar(null,null,"clear"),this.do_refresh()}}))},children:[t("span",{className:"icon icon-plus"}),t("span",{className:"control-btn-label",children:"\u53D1\u8868"})]})]})})}}class Dt extends d.exports.PureComponent{render(){return t("div",{id:"app-switcher-shell",children:t(Ze,{appid:"hole"})})}componentDidMount(){document.getElementById("app-switcher-shell").firstChild.querySelectorAll("a").forEach(i=>{i.text in ce?i.href=ce[i.text]:i.text!=="\u66F4\u591A\u25BE"&&(i.href="https://pkuhelper.pku.edu.cn"+i.pathname,i.style="filter: grayscale(100%); opacity: 0.25",i.title="\u53EF\u80FD\u5931\u6548\u7684\u6309\u94AE"),i.text==="\u6811\u6D1E"&&(i.title="\u5B98\u65B9\u7248\u6811\u6D1E")})}}function yt(a){return o("div",{className:"title-bar",children:[t(Dt,{}),o("div",{className:"aux-margin",children:[t("div",{className:"title",children:t("p",{className:"centered-line",children:o("span",{onClick:()=>a.show_sidebar("P\u5927\u6811\u6D1E (\u793E\u533A\u7248)",t(Fe,{show_sidebar:a.show_sidebar})),children:["P\u5927\u6811\u6D1E",o("small",{children:[" ","(\u793E\u533A\u7248",!!"0.6.0".includes("beta")&&t("sup",{children:"\u03B2"}),!!"0.6.0".includes("alpha")&&t("sup",{children:"\u03B1"}),")"]})]})})}),t(kt,{show_sidebar:a.show_sidebar,set_mode:a.set_mode,mode:a.mode})]})]})}class vt extends d.exports.PureComponent{constructor(e){super(e),this.do_close_bound=this.do_close.bind(this),this.do_back_bound=this.do_back.bind(this)}do_close(){this.props.show_sidebar(null,null,"clear")}do_back(){this.props.show_sidebar(null,null,"pop")}render(){const e=this.props.stack.map(({1:i},n)=>i&&t("div",{className:"sidebar-content "+(n===this.props.stack.length-1?"sidebar-content-show":"sidebar-content-hide"),children:i},n)),s=this.props.stack[this.props.stack.length-1][0];return o("div",{className:"sidebar-container "+(s!==null?"sidebar-on":"sidebar-off"),children:[t("div",{className:"sidebar-shadow",onClick:this.do_back_bound,onTouchEnd:i=>{i.preventDefault(),i.target.click()}}),t("div",{className:"sidebar",children:e}),o("div",{className:"sidebar-title",children:[o("a",{className:"no-underline",onClick:this.do_close_bound,children:["\xA0",t("span",{className:"icon icon-close"}),"\xA0"]}),this.props.stack.length>2&&o("a",{className:"no-underline",onClick:this.do_back_bound,children:["\xA0",t("span",{className:"icon icon-back"}),"\xA0"]}),s]})]})}}const he=.4,xt=25,Bt=500;class Nt extends d.exports.Component{constructor(e){super(e),this.state={level:0,fired:!1},this.callback=e.callback,this.esc_interval=null}do_fire(){this.esc_interval&&(clearInterval(this.esc_interval),this.esc_interval=null),this.setState({level:1,fired:!0}),this.callback(),window.setTimeout(()=>{this.setState({level:0,fired:!1})},300)}componentDidMount(){window.config.pressure&&(Ue.set(document.body,{change:e=>{this.state.fired||(e>=.999?this.do_fire():this.setState({level:e}))},end:()=>{this.setState({level:0,fired:!1})}},{polyfill:!1,only:"touch",preventSelect:!1}),document.addEventListener("keydown",e=>{!e.repeat&&e.key==="Escape"&&(this.esc_interval&&clearInterval(this.esc_interval),this.setState({level:he/2},()=>{this.esc_interval=setInterval(()=>{const s=this.state.level+.1;s>=.999?this.do_fire():this.setState({level:s})},30)}))}),document.addEventListener("keyup",e=>{e.key==="Escape"&&(this.esc_interval&&(clearInterval(this.esc_interval),this.esc_interval=null),this.setState({level:0}))}))}render(){const e=xt*(this.state.level-he)-Bt;return t("div",{className:"pressure-box"+(this.state.fired?" pressure-box-fired":"")+(this.state.level<=1e-4?" pressure-box-empty":""),style:{left:e,right:e,top:e,bottom:e}})}}const St=10;function It(a){const e=localStorage["last-viewed-version"],[s,i]=d.exports.useState(e!=="0.6.0"),n=()=>{i(!1),localStorage.setItem("last-viewed-version","0.6.0")};return t("div",{id:"global-hint-container",children:s&&t("div",{className:"flow-item",children:o("div",{className:"flow-item-row box box-info",children:[t("a",{className:"no-underline box-header-badge",onClick:n,children:t("span",{className:"icon icon-close"})}),o("p",{children:["\u65B0\u7248\u672C (v","0.6.0",") \u5DF2\u5B8C\u6210\u66F4\u65B0\uFF0C \u70B9\u51FB",t("a",{href:"https://github.com/AllanChain/PKUHoleCommunity/releases/tag/v0.6.0",target:"_blank",rel:"noopener noreferrer",onClick:n,children:"\u6B64\u5904"}),"\u67E5\u770B\u66F4\u65B0\u5185\u5BB9\u3002"]})]})})})}class Rt extends d.exports.Component{constructor(e){super(e),Z(),Ye({default:void 0,light:!1,dark:!0}[window.config.color_scheme]),this.state={sidebar_stack:[[null,null]],mode:"list",search_text:null,flow_render_key:+new Date,token:localStorage.TOKEN||null},this.show_sidebar_bound=this.show_sidebar.bind(this),this.set_mode_bound=this.set_mode.bind(this),this.on_pressure_bound=this.on_pressure.bind(this),this.inpku_flag=window[atob("ZG9jdW1lbnQ")][atob("Y29va2ll")].indexOf(atob("cGt1X2lwX2ZsYWc9eWVz"))!==-1}componentDidMount(){y()}static is_darkmode(){return window.config.color_scheme==="dark"?!0:window.config.color_scheme==="light"?!1:window.matchMedia("(prefers-color-scheme: dark)").matches}on_pressure(){this.state.sidebar_stack.length>1?this.show_sidebar(null,null,"clear"):this.set_mode("list",null)}show_sidebar(e,s,i="push"){this.setState(n=>{let r=n.sidebar_stack.slice();if(i==="push")r.length===1&&(document.body.style.top=`-${window.scrollY}px`,document.body.style.position="fixed",document.body.style.width="100vw"),r.length>St&&r.splice(1,1),r=r.concat([[e,s]]);else if(i==="pop"){if(r.length===1)return;if(r.length===2){const u=document.body.style.top;document.body.style.position="",document.body.style.top="",document.body.style.width="",window.scrollTo(0,parseInt(u||"0")*-1)}r.pop()}else if(i==="replace")r.pop(),r=r.concat([[e,s]]);else if(i==="clear"){const u=document.body.style.top;document.body.style.position="",document.body.style.top="",document.body.style.width="",window.scrollTo(0,parseInt(u||"0")*-1),r=[[null,null]]}else throw new Error("bad show_sidebar mode");return{sidebar_stack:r}})}set_mode(e,s){this.setState({mode:e,search_text:s,flow_render_key:+new Date})}render(){return o(x.Provider,{value:{value:this.state.token,set_value:e=>{localStorage.TOKEN=e||"",this.setState({token:e})}},children:[t(Nt,{callback:this.on_pressure_bound}),t("div",{className:"bg-img",style:be()}),t(yt,{show_sidebar:this.show_sidebar_bound,set_mode:this.set_mode_bound,mode:this.state.mode}),t(x.Consumer,{children:e=>o("div",{className:"left-container",children:[!e.value&&t("div",{className:"flow-item-row aux-margin",children:t("div",{className:"box box-tip",children:t("p",{children:t(q,{token_callback:e.set_value,children:s=>o("a",{onClick:s,children:[t("span",{className:"icon icon-login"}),"\xA0\u767B\u5F55\u5230 PKU Helper"]})})})})}),t(It,{token:e.value}),this.inpku_flag||e.value?t(wt,{show_sidebar:this.show_sidebar_bound,mode:this.state.mode,search_text:this.state.search_text,token:e.value},this.state.flow_render_key):t(z,{text:"\u8BF7\u767B\u5F55\u540E\u67E5\u770B\u5185\u5BB9"}),t("br",{})]})}),t(vt,{show_sidebar:this.show_sidebar_bound,stack:this.state.sidebar_stack})]})}}function Ut(a={}){const{immediate:e=!1,onNeedRefresh:s,onOfflineReady:i,onRegistered:n,onRegisterError:r}=a;let u,l;const c=async(h=!0)=>{h&&(u==null||u.addEventListener("controlling",p=>{p.isUpdate&&window.location.reload()})),l&&l.waiting&&await Oe(l.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){u=new Pe("/PKUHoleCommunity/service-worker.js",{scope:"/PKUHoleCommunity/",type:"classic"}),u.addEventListener("activated",h=>{h.isUpdate||i==null||i()});{const h=()=>{s==null||s()};u.addEventListener("waiting",h),u.addEventListener("externalwaiting",h)}u.register({immediate:e}).then(h=>{l=h,n==null||n(h)}).catch(h=>{r==null||r(h)})}return c}de.render(t(Rt,{}),document.getElementById("root"));Ut();
